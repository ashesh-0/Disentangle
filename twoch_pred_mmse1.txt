Evaluating between 0 5

##################################
Predicting 0th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:46<30:00, 46.16s/it]  5%|▌         | 2/40 [00:46<12:07, 19.14s/it]  8%|▊         | 3/40 [00:46<06:28, 10.50s/it] 10%|█         | 4/40 [00:46<03:51,  6.44s/it] 12%|█▎        | 5/40 [00:47<02:26,  4.19s/it] 15%|█▌        | 6/40 [00:47<01:36,  2.84s/it] 18%|█▊        | 7/40 [00:47<01:05,  1.98s/it] 20%|██        | 8/40 [00:47<00:45,  1.42s/it] 22%|██▎       | 9/40 [00:47<00:32,  1.04s/it] 25%|██▌       | 10/40 [00:48<00:23,  1.27it/s] 28%|██▊       | 11/40 [00:48<00:17,  1.63it/s] 30%|███       | 12/40 [00:48<00:13,  2.03it/s] 32%|███▎      | 13/40 [00:48<00:11,  2.45it/s] 35%|███▌      | 14/40 [00:48<00:09,  2.86it/s] 38%|███▊      | 15/40 [00:49<00:07,  3.24it/s] 40%|████      | 16/40 [00:49<00:06,  3.57it/s] 42%|████▎     | 17/40 [00:49<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:49<00:05,  4.05it/s] 48%|████▊     | 19/40 [00:50<00:04,  4.23it/s] 50%|█████     | 20/40 [00:50<00:04,  4.36it/s] 52%|█████▎    | 21/40 [00:50<00:04,  4.43it/s] 55%|█████▌    | 22/40 [00:50<00:03,  4.50it/s] 57%|█████▊    | 23/40 [00:50<00:03,  4.54it/s] 60%|██████    | 24/40 [00:51<00:03,  4.58it/s] 62%|██████▎   | 25/40 [00:51<00:03,  4.60it/s] 65%|██████▌   | 26/40 [00:51<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:51<00:02,  4.63it/s] 70%|███████   | 28/40 [00:51<00:02,  4.65it/s] 72%|███████▎  | 29/40 [00:52<00:02,  4.65it/s] 75%|███████▌  | 30/40 [00:52<00:02,  4.66it/s] 78%|███████▊  | 31/40 [00:52<00:01,  4.65it/s] 80%|████████  | 32/40 [00:52<00:01,  4.66it/s] 82%|████████▎ | 33/40 [00:53<00:01,  4.67it/s] 85%|████████▌ | 34/40 [00:53<00:01,  4.68it/s] 88%|████████▊ | 35/40 [00:53<00:01,  4.69it/s] 90%|█████████ | 36/40 [00:53<00:00,  4.69it/s] 92%|█████████▎| 37/40 [00:53<00:00,  4.69it/s] 95%|█████████▌| 38/40 [00:54<00:00,  4.68it/s] 98%|█████████▊| 39/40 [00:54<00:00,  4.69it/s]100%|██████████| 40/40 [00:54<00:00,  1.36s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_0/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [45.69, 35.33]
Multiscale SSIM on Highres [0.991, 0.978]
Range Invariant Multiscale SSIM on Highres [0.991, 0.979]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_0/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_0/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:12,  1.25it/s] 12%|█▎        | 2/16 [00:01<00:06,  2.19it/s] 19%|█▉        | 3/16 [00:01<00:04,  2.88it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.39it/s] 31%|███▏      | 5/16 [00:01<00:02,  3.74it/s] 38%|███▊      | 6/16 [00:01<00:02,  3.99it/s] 44%|████▍     | 7/16 [00:02<00:02,  4.18it/s] 50%|█████     | 8/16 [00:02<00:01,  4.34it/s] 56%|█████▋    | 9/16 [00:02<00:01,  4.44it/s] 62%|██████▎   | 10/16 [00:02<00:01,  4.50it/s] 69%|██████▉   | 11/16 [00:02<00:01,  4.55it/s] 75%|███████▌  | 12/16 [00:03<00:00,  4.58it/s] 81%|████████▏ | 13/16 [00:03<00:00,  4.59it/s] 88%|████████▊ | 14/16 [00:03<00:00,  4.60it/s] 94%|█████████▍| 15/16 [00:03<00:00,  4.58it/s]100%|██████████| 16/16 [00:04<00:00,  4.59it/s]100%|██████████| 16/16 [00:04<00:00,  3.89it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [31.89, 32.07]
Multiscale SSIM on Highres [0.793, 0.773]
Range Invariant Multiscale SSIM on Highres [0.897, 0.829]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:29,  1.24it/s]  5%|▌         | 2/38 [00:01<00:16,  2.17it/s]  8%|▊         | 3/38 [00:01<00:12,  2.87it/s] 11%|█         | 4/38 [00:01<00:10,  3.39it/s] 13%|█▎        | 5/38 [00:01<00:08,  3.75it/s] 16%|█▌        | 6/38 [00:01<00:08,  3.93it/s] 18%|█▊        | 7/38 [00:02<00:07,  4.13it/s] 21%|██        | 8/38 [00:02<00:07,  4.27it/s] 24%|██▎       | 9/38 [00:02<00:06,  4.37it/s] 26%|██▋       | 10/38 [00:02<00:06,  4.28it/s] 29%|██▉       | 11/38 [00:03<00:06,  4.39it/s] 32%|███▏      | 12/38 [00:03<00:05,  4.47it/s] 34%|███▍      | 13/38 [00:03<00:05,  4.51it/s] 37%|███▋      | 14/38 [00:03<00:05,  4.55it/s] 39%|███▉      | 15/38 [00:03<00:05,  4.57it/s] 42%|████▏     | 16/38 [00:04<00:04,  4.58it/s] 45%|████▍     | 17/38 [00:04<00:04,  4.59it/s] 47%|████▋     | 18/38 [00:04<00:04,  4.61it/s] 50%|█████     | 19/38 [00:04<00:04,  4.61it/s] 53%|█████▎    | 20/38 [00:04<00:03,  4.60it/s] 55%|█████▌    | 21/38 [00:05<00:03,  4.60it/s] 58%|█████▊    | 22/38 [00:05<00:03,  4.60it/s] 61%|██████    | 23/38 [00:05<00:03,  4.63it/s] 63%|██████▎   | 24/38 [00:05<00:03,  4.63it/s] 66%|██████▌   | 25/38 [00:06<00:02,  4.62it/s] 68%|██████▊   | 26/38 [00:06<00:02,  4.63it/s] 71%|███████   | 27/38 [00:06<00:02,  4.62it/s] 74%|███████▎  | 28/38 [00:06<00:02,  4.62it/s] 76%|███████▋  | 29/38 [00:06<00:01,  4.64it/s] 79%|███████▉  | 30/38 [00:07<00:01,  4.65it/s] 82%|████████▏ | 31/38 [00:07<00:01,  4.64it/s] 84%|████████▍ | 32/38 [00:07<00:01,  4.65it/s] 87%|████████▋ | 33/38 [00:07<00:01,  4.62it/s] 89%|████████▉ | 34/38 [00:07<00:00,  4.60it/s] 92%|█████████▏| 35/38 [00:08<00:00,  4.61it/s] 95%|█████████▍| 36/38 [00:08<00:00,  4.63it/s] 97%|█████████▋| 37/38 [00:08<00:00,  4.63it/s]100%|██████████| 38/38 [00:08<00:00,  4.77it/s]100%|██████████| 38/38 [00:08<00:00,  4.26it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F11.46/kth_0/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [29.1, 27.08]
Multiscale SSIM on Highres [0.771, 0.841]
Range Invariant Multiscale SSIM on Highres [0.911, 0.844]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F11.46/kth_0/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F11.46/kth_0/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:31,  1.23it/s]  5%|▌         | 2/40 [00:01<00:18,  2.05it/s]  8%|▊         | 3/40 [00:01<00:13,  2.75it/s] 10%|█         | 4/40 [00:01<00:10,  3.27it/s] 12%|█▎        | 5/40 [00:01<00:09,  3.67it/s] 15%|█▌        | 6/40 [00:01<00:08,  3.94it/s] 18%|█▊        | 7/40 [00:02<00:07,  4.15it/s] 20%|██        | 8/40 [00:02<00:07,  4.30it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.40it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.47it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.53it/s] 30%|███       | 12/40 [00:03<00:06,  4.55it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.58it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.61it/s] 38%|███▊      | 15/40 [00:03<00:05,  4.62it/s] 40%|████      | 16/40 [00:04<00:05,  4.40it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.43it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.48it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.52it/s] 50%|█████     | 20/40 [00:04<00:04,  4.55it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.57it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.58it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.58it/s] 60%|██████    | 24/40 [00:05<00:03,  4.60it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.63it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.63it/s] 70%|███████   | 28/40 [00:06<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:06<00:02,  4.65it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.65it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.64it/s] 80%|████████  | 32/40 [00:07<00:01,  4.63it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.63it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.61it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.63it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.63it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.61it/s] 95%|█████████▌| 38/40 [00:08<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.34it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.2, 34.88]
Multiscale SSIM on Highres [0.846, 0.959]
Range Invariant Multiscale SSIM on Highres [0.847, 0.959]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:31,  1.21it/s]  1%|          | 2/256 [00:01<01:59,  2.13it/s]  1%|          | 3/256 [00:01<01:29,  2.84it/s]  2%|▏         | 4/256 [00:01<01:14,  3.36it/s]  2%|▏         | 5/256 [00:01<01:07,  3.74it/s]  2%|▏         | 6/256 [00:01<01:02,  4.01it/s]  3%|▎         | 7/256 [00:02<00:59,  4.21it/s]  3%|▎         | 8/256 [00:02<00:57,  4.33it/s]  4%|▎         | 9/256 [00:02<00:55,  4.43it/s]  4%|▍         | 10/256 [00:02<00:54,  4.50it/s]  4%|▍         | 11/256 [00:02<00:53,  4.55it/s]  5%|▍         | 12/256 [00:03<00:53,  4.58it/s]  5%|▌         | 13/256 [00:03<00:53,  4.58it/s]  5%|▌         | 14/256 [00:03<00:52,  4.61it/s]  6%|▌         | 15/256 [00:03<00:52,  4.61it/s]  6%|▋         | 16/256 [00:04<00:52,  4.61it/s]  7%|▋         | 17/256 [00:04<00:51,  4.60it/s]  7%|▋         | 18/256 [00:04<00:51,  4.62it/s]  7%|▋         | 19/256 [00:04<00:51,  4.61it/s]  8%|▊         | 20/256 [00:04<00:51,  4.63it/s]  8%|▊         | 21/256 [00:05<00:50,  4.64it/s]  9%|▊         | 22/256 [00:05<00:50,  4.64it/s]  9%|▉         | 23/256 [00:05<00:50,  4.64it/s]  9%|▉         | 24/256 [00:05<00:49,  4.64it/s] 10%|▉         | 25/256 [00:05<00:49,  4.64it/s] 10%|█         | 26/256 [00:06<00:49,  4.65it/s] 11%|█         | 27/256 [00:06<00:49,  4.65it/s] 11%|█         | 28/256 [00:06<00:48,  4.68it/s] 11%|█▏        | 29/256 [00:06<00:48,  4.66it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.67it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.66it/s] 12%|█▎        | 32/256 [00:07<00:47,  4.67it/s] 13%|█▎        | 33/256 [00:07<00:47,  4.67it/s] 13%|█▎        | 34/256 [00:07<00:47,  4.66it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.67it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.66it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.67it/s] 15%|█▍        | 38/256 [00:08<00:46,  4.65it/s] 15%|█▌        | 39/256 [00:08<00:46,  4.64it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.63it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.64it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.64it/s] 17%|█▋        | 43/256 [00:09<00:45,  4.64it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.65it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.63it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.64it/s] 18%|█▊        | 47/256 [00:10<00:45,  4.64it/s] 19%|█▉        | 48/256 [00:10<00:44,  4.65it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.64it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.63it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.64it/s] 20%|██        | 52/256 [00:11<00:43,  4.65it/s] 21%|██        | 53/256 [00:12<00:43,  4.64it/s] 21%|██        | 54/256 [00:12<00:43,  4.64it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.63it/s] 22%|██▏       | 56/256 [00:12<00:43,  4.65it/s] 22%|██▏       | 57/256 [00:12<00:42,  4.64it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.65it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.65it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.64it/s] 24%|██▍       | 61/256 [00:13<00:42,  4.64it/s] 24%|██▍       | 62/256 [00:13<00:41,  4.63it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.62it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.63it/s] 25%|██▌       | 65/256 [00:14<00:41,  4.64it/s] 26%|██▌       | 66/256 [00:14<00:41,  4.63it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.63it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.60it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 70/256 [00:15<00:40,  4.61it/s] 28%|██▊       | 71/256 [00:15<00:40,  4.61it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.61it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.62it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.62it/s] 29%|██▉       | 75/256 [00:16<00:39,  4.63it/s] 30%|██▉       | 76/256 [00:16<00:38,  4.64it/s] 30%|███       | 77/256 [00:17<00:38,  4.63it/s] 30%|███       | 78/256 [00:17<00:39,  4.48it/s] 31%|███       | 79/256 [00:17<00:39,  4.53it/s] 31%|███▏      | 80/256 [00:17<00:38,  4.55it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.56it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.58it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.60it/s] 33%|███▎      | 84/256 [00:18<00:37,  4.60it/s] 33%|███▎      | 85/256 [00:18<00:37,  4.61it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.65it/s] 34%|███▍      | 88/256 [00:19<00:36,  4.64it/s] 35%|███▍      | 89/256 [00:19<00:35,  4.66it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.67it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.67it/s] 36%|███▋      | 93/256 [00:20<00:35,  4.65it/s] 37%|███▋      | 94/256 [00:20<00:34,  4.64it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.66it/s] 39%|███▊      | 99/256 [00:21<00:34,  4.59it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.61it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.61it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.63it/s] 40%|████      | 103/256 [00:22<00:32,  4.64it/s] 41%|████      | 104/256 [00:23<00:32,  4.65it/s] 41%|████      | 105/256 [00:23<00:32,  4.64it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.66it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.66it/s] 42%|████▏     | 108/256 [00:23<00:31,  4.67it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.67it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.68it/s] 44%|████▍     | 113/256 [00:24<00:30,  4.68it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.65it/s] 45%|████▌     | 116/256 [00:25<00:29,  4.67it/s] 46%|████▌     | 117/256 [00:25<00:29,  4.67it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.67it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.66it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 121/256 [00:26<00:28,  4.67it/s] 48%|████▊     | 122/256 [00:26<00:28,  4.67it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.65it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.65it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.67it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.66it/s] 50%|████▉     | 127/256 [00:27<00:27,  4.67it/s] 50%|█████     | 128/256 [00:28<00:27,  4.68it/s] 50%|█████     | 129/256 [00:28<00:27,  4.68it/s] 51%|█████     | 130/256 [00:28<00:26,  4.68it/s] 51%|█████     | 131/256 [00:28<00:26,  4.68it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.69it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.68it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.68it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.66it/s] 53%|█████▎    | 136/256 [00:29<00:28,  4.28it/s] 54%|█████▎    | 137/256 [00:30<00:28,  4.18it/s] 54%|█████▍    | 138/256 [00:30<00:27,  4.30it/s] 54%|█████▍    | 139/256 [00:30<00:26,  4.41it/s] 55%|█████▍    | 140/256 [00:30<00:25,  4.49it/s] 55%|█████▌    | 141/256 [00:31<00:25,  4.55it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.56it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.59it/s] 56%|█████▋    | 144/256 [00:31<00:24,  4.62it/s] 57%|█████▋    | 145/256 [00:31<00:23,  4.63it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.63it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.63it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.66it/s] 58%|█████▊    | 149/256 [00:32<00:22,  4.66it/s] 59%|█████▊    | 150/256 [00:32<00:22,  4.67it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.69it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.67it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.64it/s] 60%|██████    | 154/256 [00:33<00:21,  4.66it/s] 61%|██████    | 155/256 [00:34<00:21,  4.66it/s] 61%|██████    | 156/256 [00:34<00:21,  4.65it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.66it/s] 62%|██████▏   | 158/256 [00:34<00:21,  4.67it/s] 62%|██████▏   | 159/256 [00:34<00:20,  4.68it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.66it/s] 64%|██████▎   | 163/256 [00:35<00:19,  4.65it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.65it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.65it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.66it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.67it/s] 66%|██████▌   | 168/256 [00:36<00:18,  4.66it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.66it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.67it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.68it/s] 67%|██████▋   | 172/256 [00:37<00:17,  4.68it/s] 68%|██████▊   | 173/256 [00:37<00:17,  4.67it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.67it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.68it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.67it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.66it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.65it/s] 70%|███████   | 180/256 [00:39<00:16,  4.64it/s] 71%|███████   | 181/256 [00:39<00:16,  4.64it/s] 71%|███████   | 182/256 [00:39<00:15,  4.66it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.65it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.63it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.65it/s] 73%|███████▎  | 186/256 [00:40<00:15,  4.65it/s] 73%|███████▎  | 187/256 [00:40<00:14,  4.65it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.66it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.66it/s] 75%|███████▍  | 191/256 [00:41<00:13,  4.67it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.66it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.66it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.65it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.64it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.64it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.64it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.65it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.55it/s] 78%|███████▊  | 200/256 [00:43<00:12,  4.57it/s] 79%|███████▊  | 201/256 [00:43<00:11,  4.60it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.60it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.61it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.64it/s] 80%|████████  | 205/256 [00:44<00:10,  4.64it/s] 80%|████████  | 206/256 [00:45<00:10,  4.63it/s] 81%|████████  | 207/256 [00:45<00:10,  4.62it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.62it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.63it/s] 82%|████████▏ | 210/256 [00:45<00:09,  4.63it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.62it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.63it/s] 84%|████████▍ | 215/256 [00:46<00:08,  4.64it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.64it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.64it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.65it/s] 86%|████████▌ | 219/256 [00:47<00:07,  4.63it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.63it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.63it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.63it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.64it/s] 88%|████████▊ | 224/256 [00:48<00:06,  4.64it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.64it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.64it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.64it/s] 89%|████████▉ | 228/256 [00:49<00:06,  4.65it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.65it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.65it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.65it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.65it/s] 91%|█████████ | 233/256 [00:50<00:04,  4.65it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.65it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.67it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.68it/s] 93%|█████████▎| 238/256 [00:51<00:03,  4.69it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.69it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.69it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.68it/s] 95%|█████████▍| 242/256 [00:52<00:02,  4.68it/s] 95%|█████████▍| 243/256 [00:52<00:02,  4.68it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.69it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.69it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.68it/s] 96%|█████████▋| 247/256 [00:53<00:01,  4.66it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.66it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.64it/s] 98%|█████████▊| 252/256 [00:54<00:00,  4.66it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.67it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.67it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.67it/s]100%|██████████| 256/256 [00:55<00:00,  4.67it/s]100%|██████████| 256/256 [00:55<00:00,  4.58it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [38.49, 40.32]
Multiscale SSIM on Highres [0.977, 0.986]
Range Invariant Multiscale SSIM on Highres [0.979, 0.987]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:53,  1.09it/s]  1%|          | 2/256 [00:01<02:13,  1.90it/s]  1%|          | 3/256 [00:01<01:37,  2.61it/s]  2%|▏         | 4/256 [00:01<01:20,  3.14it/s]  2%|▏         | 5/256 [00:01<01:10,  3.55it/s]  2%|▏         | 6/256 [00:02<01:04,  3.86it/s]  3%|▎         | 7/256 [00:02<01:01,  4.08it/s]  3%|▎         | 8/256 [00:02<00:58,  4.24it/s]  4%|▎         | 9/256 [00:02<00:56,  4.36it/s]  4%|▍         | 10/256 [00:02<00:55,  4.43it/s]  4%|▍         | 11/256 [00:03<00:54,  4.49it/s]  5%|▍         | 12/256 [00:03<00:53,  4.54it/s]  5%|▌         | 13/256 [00:03<00:53,  4.56it/s]  5%|▌         | 14/256 [00:03<00:52,  4.58it/s]  6%|▌         | 15/256 [00:03<00:52,  4.59it/s]  6%|▋         | 16/256 [00:04<00:52,  4.60it/s]  7%|▋         | 17/256 [00:04<00:51,  4.61it/s]  7%|▋         | 18/256 [00:04<00:51,  4.62it/s]  7%|▋         | 19/256 [00:04<00:51,  4.63it/s]  8%|▊         | 20/256 [00:05<00:51,  4.62it/s]  8%|▊         | 21/256 [00:05<00:51,  4.59it/s]  9%|▊         | 22/256 [00:05<00:50,  4.60it/s]  9%|▉         | 23/256 [00:05<00:50,  4.59it/s]  9%|▉         | 24/256 [00:05<00:50,  4.61it/s] 10%|▉         | 25/256 [00:06<00:49,  4.62it/s] 10%|█         | 26/256 [00:06<00:49,  4.65it/s] 11%|█         | 27/256 [00:06<00:49,  4.66it/s] 11%|█         | 28/256 [00:06<00:48,  4.67it/s] 11%|█▏        | 29/256 [00:06<00:48,  4.68it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.68it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.65it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.65it/s] 13%|█▎        | 33/256 [00:07<00:47,  4.66it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.67it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.68it/s] 14%|█▍        | 36/256 [00:08<00:46,  4.69it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.68it/s] 15%|█▍        | 38/256 [00:08<00:46,  4.67it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.67it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.67it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.66it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.65it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.65it/s] 17%|█▋        | 44/256 [00:10<00:46,  4.52it/s] 18%|█▊        | 45/256 [00:10<00:46,  4.56it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.60it/s] 18%|█▊        | 47/256 [00:10<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.63it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.65it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.66it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.67it/s] 20%|██        | 52/256 [00:11<00:43,  4.67it/s] 21%|██        | 53/256 [00:12<00:43,  4.66it/s] 21%|██        | 54/256 [00:12<00:43,  4.66it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.66it/s] 22%|██▏       | 56/256 [00:12<00:43,  4.64it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.67it/s] 23%|██▎       | 60/256 [00:13<00:41,  4.68it/s] 24%|██▍       | 61/256 [00:13<00:41,  4.68it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.67it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 65/256 [00:14<00:40,  4.68it/s] 26%|██▌       | 66/256 [00:14<00:40,  4.67it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.68it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.67it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.66it/s] 27%|██▋       | 70/256 [00:15<00:40,  4.65it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.66it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.66it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.67it/s] 29%|██▉       | 74/256 [00:16<00:38,  4.68it/s] 29%|██▉       | 75/256 [00:16<00:38,  4.69it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.67it/s] 30%|███       | 77/256 [00:17<00:38,  4.68it/s] 30%|███       | 78/256 [00:17<00:38,  4.67it/s] 31%|███       | 79/256 [00:17<00:37,  4.67it/s] 31%|███▏      | 80/256 [00:17<00:37,  4.65it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 83/256 [00:18<00:36,  4.68it/s] 33%|███▎      | 84/256 [00:18<00:36,  4.69it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.67it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.68it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.68it/s] 34%|███▍      | 88/256 [00:19<00:35,  4.67it/s] 35%|███▍      | 89/256 [00:19<00:35,  4.68it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.69it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.69it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.67it/s] 36%|███▋      | 93/256 [00:20<00:34,  4.68it/s] 37%|███▋      | 94/256 [00:20<00:34,  4.68it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.69it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.67it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.67it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.67it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.67it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.67it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.67it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.66it/s] 40%|████      | 103/256 [00:22<00:32,  4.67it/s] 41%|████      | 104/256 [00:23<00:32,  4.68it/s] 41%|████      | 105/256 [00:23<00:32,  4.68it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.68it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.67it/s] 42%|████▏     | 108/256 [00:23<00:31,  4.69it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 111/256 [00:24<00:30,  4.68it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.67it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.65it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.63it/s] 45%|████▌     | 116/256 [00:25<00:30,  4.64it/s] 46%|████▌     | 117/256 [00:25<00:29,  4.65it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.66it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.66it/s] 47%|████▋     | 121/256 [00:26<00:28,  4.66it/s] 48%|████▊     | 122/256 [00:26<00:28,  4.65it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.66it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.67it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.66it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.65it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.64it/s] 50%|█████     | 128/256 [00:28<00:27,  4.64it/s] 50%|█████     | 129/256 [00:28<00:27,  4.62it/s] 51%|█████     | 130/256 [00:28<00:27,  4.65it/s] 51%|█████     | 131/256 [00:28<00:26,  4.65it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.65it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.66it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.66it/s] 53%|█████▎    | 135/256 [00:29<00:26,  4.65it/s] 53%|█████▎    | 136/256 [00:29<00:25,  4.65it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.66it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.67it/s] 54%|█████▍    | 139/256 [00:30<00:24,  4.68it/s] 55%|█████▍    | 140/256 [00:30<00:26,  4.45it/s] 55%|█████▌    | 141/256 [00:31<00:27,  4.21it/s] 55%|█████▌    | 142/256 [00:31<00:26,  4.33it/s] 56%|█████▌    | 143/256 [00:31<00:25,  4.43it/s] 56%|█████▋    | 144/256 [00:31<00:24,  4.49it/s] 57%|█████▋    | 145/256 [00:31<00:24,  4.54it/s] 57%|█████▋    | 146/256 [00:32<00:24,  4.57it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.60it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.62it/s] 58%|█████▊    | 149/256 [00:32<00:23,  4.63it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.65it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.65it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.66it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.66it/s] 60%|██████    | 154/256 [00:33<00:21,  4.65it/s] 61%|██████    | 155/256 [00:34<00:21,  4.65it/s] 61%|██████    | 156/256 [00:34<00:21,  4.64it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.61it/s] 62%|██████▏   | 158/256 [00:34<00:21,  4.63it/s] 62%|██████▏   | 159/256 [00:34<00:21,  4.61it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.64it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.65it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.66it/s] 64%|██████▎   | 163/256 [00:35<00:20,  4.64it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.65it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.66it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.66it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.67it/s] 66%|██████▌   | 168/256 [00:36<00:18,  4.68it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.68it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.67it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.66it/s] 67%|██████▋   | 172/256 [00:37<00:18,  4.65it/s] 68%|██████▊   | 173/256 [00:37<00:17,  4.67it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.67it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.66it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.69it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.68it/s] 70%|███████   | 180/256 [00:39<00:16,  4.67it/s] 71%|███████   | 181/256 [00:39<00:16,  4.66it/s] 71%|███████   | 182/256 [00:39<00:15,  4.66it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.66it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.67it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.66it/s] 73%|███████▎  | 186/256 [00:40<00:14,  4.67it/s] 73%|███████▎  | 187/256 [00:40<00:14,  4.67it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.68it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.67it/s] 75%|███████▍  | 191/256 [00:41<00:13,  4.66it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.67it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.68it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.67it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.67it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.68it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.67it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.68it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.69it/s] 78%|███████▊  | 200/256 [00:43<00:11,  4.70it/s] 79%|███████▊  | 201/256 [00:43<00:11,  4.70it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.70it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.69it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.68it/s] 80%|████████  | 205/256 [00:44<00:10,  4.68it/s] 80%|████████  | 206/256 [00:45<00:10,  4.68it/s] 81%|████████  | 207/256 [00:45<00:10,  4.69it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.68it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.68it/s] 82%|████████▏ | 210/256 [00:45<00:09,  4.69it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.69it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.69it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.68it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.67it/s] 84%|████████▍ | 215/256 [00:46<00:08,  4.68it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.69it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.68it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.69it/s] 86%|████████▌ | 219/256 [00:47<00:07,  4.69it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.66it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.68it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.68it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.67it/s] 88%|████████▊ | 224/256 [00:48<00:06,  4.68it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.67it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.67it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.66it/s] 89%|████████▉ | 228/256 [00:49<00:05,  4.68it/s] 89%|████████▉ | 229/256 [00:49<00:05,  4.68it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.66it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.66it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.67it/s] 91%|█████████ | 233/256 [00:50<00:04,  4.67it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.66it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.66it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.66it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.67it/s] 93%|█████████▎| 238/256 [00:51<00:03,  4.67it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.66it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.67it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.68it/s] 95%|█████████▍| 242/256 [00:52<00:03,  4.66it/s] 95%|█████████▍| 243/256 [00:52<00:02,  4.67it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.65it/s] 96%|█████████▋| 247/256 [00:53<00:01,  4.65it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.64it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.66it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.66it/s] 98%|█████████▊| 252/256 [00:54<00:00,  4.66it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.65it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.65it/s]100%|██████████| 256/256 [00:55<00:00,  4.63it/s]100%|██████████| 256/256 [00:55<00:00,  4.58it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [54.23, 40.25]
Multiscale SSIM on Highres [0.999, 0.969]
Range Invariant Multiscale SSIM on Highres [1.0, 0.987]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/stats_disentangle_2405_D18-M3-S0-L8_14.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/15
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/15


Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 111
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:54,  1.09it/s]  1%|          | 2/256 [00:01<02:08,  1.98it/s]  1%|          | 3/256 [00:01<01:34,  2.67it/s]  2%|▏         | 4/256 [00:01<01:18,  3.21it/s]  2%|▏         | 5/256 [00:01<01:09,  3.62it/s]  2%|▏         | 6/256 [00:01<01:03,  3.92it/s]  3%|▎         | 7/256 [00:02<01:00,  4.10it/s]  3%|▎         | 8/256 [00:02<00:58,  4.25it/s]  4%|▎         | 9/256 [00:02<00:56,  4.34it/s]  4%|▍         | 10/256 [00:02<00:55,  4.43it/s]  4%|▍         | 11/256 [00:03<00:54,  4.49it/s]  5%|▍         | 12/256 [00:03<00:54,  4.52it/s]  5%|▌         | 13/256 [00:03<00:53,  4.55it/s]  5%|▌         | 14/256 [00:03<00:52,  4.57it/s]  6%|▌         | 15/256 [00:03<00:52,  4.57it/s]  6%|▋         | 16/256 [00:04<00:52,  4.58it/s]  7%|▋         | 17/256 [00:04<00:51,  4.60it/s]  7%|▋         | 18/256 [00:04<00:51,  4.60it/s]  7%|▋         | 19/256 [00:04<00:51,  4.60it/s]  8%|▊         | 20/256 [00:05<00:51,  4.59it/s]  8%|▊         | 21/256 [00:05<00:54,  4.30it/s]  9%|▊         | 22/256 [00:05<00:55,  4.18it/s]  9%|▉         | 23/256 [00:05<00:54,  4.31it/s]  9%|▉         | 24/256 [00:05<00:53,  4.36it/s] 10%|▉         | 25/256 [00:06<00:51,  4.45it/s] 10%|█         | 26/256 [00:06<00:51,  4.51it/s] 11%|█         | 27/256 [00:06<00:50,  4.56it/s] 11%|█         | 28/256 [00:06<00:49,  4.59it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.62it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.63it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.65it/s] 13%|█▎        | 33/256 [00:07<00:48,  4.64it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.65it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.66it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.68it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.69it/s] 15%|█▍        | 38/256 [00:08<00:46,  4.69it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.68it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.67it/s] 16%|█▋        | 42/256 [00:09<00:45,  4.67it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.69it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.70it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.68it/s] 18%|█▊        | 46/256 [00:10<00:44,  4.68it/s] 18%|█▊        | 47/256 [00:10<00:44,  4.67it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.67it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.68it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.67it/s] 20%|██        | 52/256 [00:11<00:43,  4.69it/s] 21%|██        | 53/256 [00:12<00:43,  4.70it/s] 21%|██        | 54/256 [00:12<00:43,  4.70it/s] 21%|██▏       | 55/256 [00:12<00:42,  4.71it/s] 22%|██▏       | 56/256 [00:12<00:42,  4.70it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.70it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.69it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.68it/s] 23%|██▎       | 60/256 [00:13<00:41,  4.68it/s] 24%|██▍       | 61/256 [00:13<00:41,  4.68it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.69it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.69it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.68it/s] 25%|██▌       | 65/256 [00:14<00:40,  4.68it/s] 26%|██▌       | 66/256 [00:14<00:40,  4.69it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.69it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.68it/s] 27%|██▋       | 69/256 [00:15<00:39,  4.68it/s] 27%|██▋       | 70/256 [00:15<00:39,  4.69it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.69it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.68it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.69it/s] 29%|██▉       | 74/256 [00:16<00:38,  4.70it/s] 29%|██▉       | 75/256 [00:16<00:38,  4.71it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.69it/s] 30%|███       | 77/256 [00:17<00:38,  4.68it/s] 30%|███       | 78/256 [00:17<00:37,  4.69it/s] 31%|███       | 79/256 [00:17<00:37,  4.70it/s] 31%|███▏      | 80/256 [00:17<00:37,  4.70it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.70it/s] 32%|███▏      | 82/256 [00:18<00:36,  4.71it/s] 32%|███▏      | 83/256 [00:18<00:36,  4.70it/s] 33%|███▎      | 84/256 [00:18<00:36,  4.69it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.68it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.69it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.69it/s] 34%|███▍      | 88/256 [00:19<00:35,  4.69it/s] 35%|███▍      | 89/256 [00:19<00:35,  4.70it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.69it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.67it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.60it/s] 36%|███▋      | 93/256 [00:20<00:35,  4.60it/s] 37%|███▋      | 94/256 [00:20<00:35,  4.60it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.68it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.68it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.66it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.67it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.67it/s] 40%|████      | 103/256 [00:22<00:32,  4.66it/s] 41%|████      | 104/256 [00:23<00:32,  4.67it/s] 41%|████      | 105/256 [00:23<00:32,  4.69it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.68it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.67it/s] 42%|████▏     | 108/256 [00:23<00:31,  4.67it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.69it/s] 43%|████▎     | 111/256 [00:24<00:30,  4.70it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.69it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.70it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.68it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.68it/s] 45%|████▌     | 116/256 [00:25<00:30,  4.66it/s] 46%|████▌     | 117/256 [00:25<00:29,  4.67it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.66it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 121/256 [00:26<00:28,  4.69it/s] 48%|████▊     | 122/256 [00:26<00:28,  4.69it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.69it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.69it/s] 49%|████▉     | 125/256 [00:27<00:27,  4.68it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.67it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.68it/s] 50%|█████     | 128/256 [00:28<00:27,  4.67it/s] 50%|█████     | 129/256 [00:28<00:27,  4.67it/s] 51%|█████     | 130/256 [00:28<00:26,  4.67it/s] 51%|█████     | 131/256 [00:28<00:26,  4.69it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.69it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.68it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.68it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.69it/s] 53%|█████▎    | 136/256 [00:29<00:25,  4.70it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.67it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.68it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.68it/s] 55%|█████▍    | 140/256 [00:30<00:24,  4.70it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.70it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.70it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.70it/s] 56%|█████▋    | 144/256 [00:31<00:23,  4.69it/s] 57%|█████▋    | 145/256 [00:31<00:23,  4.69it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.69it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.70it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.69it/s] 58%|█████▊    | 149/256 [00:32<00:22,  4.68it/s] 59%|█████▊    | 150/256 [00:32<00:22,  4.68it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.68it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.68it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.66it/s] 60%|██████    | 154/256 [00:33<00:21,  4.64it/s] 61%|██████    | 155/256 [00:33<00:21,  4.64it/s] 61%|██████    | 156/256 [00:34<00:21,  4.66it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.64it/s] 62%|██████▏   | 158/256 [00:34<00:21,  4.63it/s] 62%|██████▏   | 159/256 [00:34<00:20,  4.64it/s] 62%|██████▎   | 160/256 [00:35<00:21,  4.40it/s] 63%|██████▎   | 161/256 [00:35<00:22,  4.26it/s] 63%|██████▎   | 162/256 [00:35<00:21,  4.38it/s] 64%|██████▎   | 163/256 [00:35<00:20,  4.45it/s] 64%|██████▍   | 164/256 [00:36<00:20,  4.51it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.56it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.60it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.62it/s] 66%|██████▌   | 168/256 [00:36<00:19,  4.55it/s] 66%|██████▌   | 169/256 [00:37<00:19,  4.56it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.60it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.63it/s] 67%|██████▋   | 172/256 [00:37<00:18,  4.64it/s] 68%|██████▊   | 173/256 [00:37<00:17,  4.66it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.67it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.65it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.66it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.66it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.66it/s] 70%|███████   | 180/256 [00:39<00:16,  4.68it/s] 71%|███████   | 181/256 [00:39<00:16,  4.68it/s] 71%|███████   | 182/256 [00:39<00:15,  4.66it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.66it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.68it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.68it/s] 73%|███████▎  | 186/256 [00:40<00:14,  4.68it/s] 73%|███████▎  | 187/256 [00:40<00:14,  4.67it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.69it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.69it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.69it/s] 75%|███████▍  | 191/256 [00:41<00:13,  4.69it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.69it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.70it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.70it/s] 76%|███████▌  | 195/256 [00:42<00:12,  4.70it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.69it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.70it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.68it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.67it/s] 78%|███████▊  | 200/256 [00:43<00:11,  4.68it/s] 79%|███████▊  | 201/256 [00:43<00:11,  4.69it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.70it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.67it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.66it/s] 80%|████████  | 205/256 [00:44<00:10,  4.65it/s] 80%|████████  | 206/256 [00:45<00:10,  4.65it/s] 81%|████████  | 207/256 [00:45<00:10,  4.65it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.67it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.67it/s] 82%|████████▏ | 210/256 [00:45<00:09,  4.66it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.68it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.67it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.59it/s] 84%|████████▍ | 215/256 [00:46<00:08,  4.61it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.64it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.66it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.67it/s] 86%|████████▌ | 219/256 [00:47<00:07,  4.68it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.69it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.68it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.66it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.65it/s] 88%|████████▊ | 224/256 [00:48<00:06,  4.66it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.67it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.67it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.67it/s] 89%|████████▉ | 228/256 [00:49<00:05,  4.68it/s] 89%|████████▉ | 229/256 [00:49<00:05,  4.68it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.68it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.68it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.68it/s] 91%|█████████ | 233/256 [00:50<00:04,  4.68it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.68it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.69it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.68it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.69it/s] 93%|█████████▎| 238/256 [00:51<00:03,  4.70it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.69it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.67it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.69it/s] 95%|█████████▍| 242/256 [00:52<00:02,  4.69it/s] 95%|█████████▍| 243/256 [00:52<00:02,  4.68it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.69it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.70it/s] 96%|█████████▋| 247/256 [00:53<00:01,  4.69it/s] 97%|█████████▋| 248/256 [00:53<00:01,  4.69it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.66it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.68it/s] 98%|█████████▊| 252/256 [00:54<00:00,  4.69it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.67it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.68it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.69it/s]100%|██████████| 256/256 [00:55<00:00,  4.69it/s]100%|██████████| 256/256 [00:55<00:00,  4.59it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [64.95, 39.93]
Multiscale SSIM on Highres [1.0, 0.974]
Range Invariant Multiscale SSIM on Highres [1.0, 0.989]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/stats_disentangle_2405_D18-M3-S0-L8_15.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/10
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/10


Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 357
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<04:08,  1.03it/s]  1%|          | 2/256 [00:01<02:13,  1.90it/s]  1%|          | 3/256 [00:01<01:37,  2.60it/s]  2%|▏         | 4/256 [00:01<01:19,  3.15it/s]  2%|▏         | 5/256 [00:01<01:10,  3.56it/s]  2%|▏         | 6/256 [00:02<01:04,  3.89it/s]  3%|▎         | 7/256 [00:02<01:00,  4.11it/s]  3%|▎         | 8/256 [00:02<00:57,  4.28it/s]  4%|▎         | 9/256 [00:02<00:56,  4.39it/s]  4%|▍         | 10/256 [00:02<00:55,  4.45it/s]  4%|▍         | 11/256 [00:03<00:54,  4.50it/s]  5%|▍         | 12/256 [00:03<00:53,  4.54it/s]  5%|▌         | 13/256 [00:03<00:53,  4.58it/s]  5%|▌         | 14/256 [00:03<00:52,  4.60it/s]  6%|▌         | 15/256 [00:03<00:52,  4.61it/s]  6%|▋         | 16/256 [00:04<00:52,  4.61it/s]  7%|▋         | 17/256 [00:04<00:51,  4.60it/s]  7%|▋         | 18/256 [00:04<00:51,  4.61it/s]  7%|▋         | 19/256 [00:04<00:51,  4.61it/s]  8%|▊         | 20/256 [00:05<00:51,  4.61it/s]  8%|▊         | 21/256 [00:05<00:50,  4.61it/s]  9%|▊         | 22/256 [00:05<00:50,  4.60it/s]  9%|▉         | 23/256 [00:05<00:50,  4.60it/s]  9%|▉         | 24/256 [00:05<00:50,  4.60it/s] 10%|▉         | 25/256 [00:06<00:49,  4.62it/s] 10%|█         | 26/256 [00:06<00:49,  4.62it/s] 11%|█         | 27/256 [00:06<00:49,  4.63it/s] 11%|█         | 28/256 [00:06<00:49,  4.65it/s] 11%|█▏        | 29/256 [00:07<00:48,  4.65it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.65it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.64it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.65it/s] 13%|█▎        | 33/256 [00:07<00:47,  4.66it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.65it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:08<00:50,  4.33it/s] 14%|█▍        | 37/256 [00:08<00:52,  4.18it/s] 15%|█▍        | 38/256 [00:09<00:50,  4.30it/s] 15%|█▌        | 39/256 [00:09<00:49,  4.40it/s] 16%|█▌        | 40/256 [00:09<00:48,  4.48it/s] 16%|█▌        | 41/256 [00:09<00:47,  4.54it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.57it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.60it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.64it/s] 18%|█▊        | 47/256 [00:10<00:44,  4.66it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.66it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.64it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.64it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.64it/s] 20%|██        | 52/256 [00:12<00:43,  4.64it/s] 21%|██        | 53/256 [00:12<00:43,  4.62it/s] 21%|██        | 54/256 [00:12<00:43,  4.63it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.64it/s] 22%|██▏       | 56/256 [00:12<00:42,  4.66it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.65it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.65it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.65it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.64it/s] 24%|██▍       | 61/256 [00:13<00:41,  4.65it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.66it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 64/256 [00:14<00:40,  4.69it/s] 25%|██▌       | 65/256 [00:14<00:40,  4.68it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.68it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.69it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.68it/s] 27%|██▋       | 69/256 [00:15<00:39,  4.68it/s] 27%|██▋       | 70/256 [00:15<00:39,  4.68it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.67it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.67it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.67it/s] 29%|██▉       | 74/256 [00:16<00:38,  4.67it/s] 29%|██▉       | 75/256 [00:16<00:38,  4.67it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.69it/s] 30%|███       | 77/256 [00:17<00:38,  4.68it/s] 30%|███       | 78/256 [00:17<00:38,  4.68it/s] 31%|███       | 79/256 [00:17<00:37,  4.69it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.70it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.68it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.65it/s] 33%|███▎      | 84/256 [00:18<00:36,  4.66it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.68it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.68it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.69it/s] 34%|███▍      | 88/256 [00:19<00:35,  4.69it/s] 35%|███▍      | 89/256 [00:19<00:35,  4.68it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.68it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.68it/s] 36%|███▋      | 93/256 [00:20<00:34,  4.69it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.70it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.68it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.69it/s] 38%|███▊      | 97/256 [00:21<00:33,  4.69it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.69it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.68it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.69it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.69it/s] 40%|███▉      | 102/256 [00:22<00:32,  4.69it/s] 40%|████      | 103/256 [00:22<00:32,  4.70it/s] 41%|████      | 104/256 [00:23<00:32,  4.70it/s] 41%|████      | 105/256 [00:23<00:32,  4.69it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.67it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.68it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.67it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.67it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.69it/s] 43%|████▎     | 111/256 [00:24<00:30,  4.69it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.69it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.69it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.70it/s] 45%|████▍     | 115/256 [00:25<00:29,  4.71it/s] 45%|████▌     | 116/256 [00:25<00:29,  4.70it/s] 46%|████▌     | 117/256 [00:25<00:29,  4.69it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.69it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.69it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.68it/s] 47%|████▋     | 121/256 [00:26<00:28,  4.67it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.68it/s] 49%|████▉     | 125/256 [00:27<00:27,  4.69it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.69it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.69it/s] 50%|█████     | 128/256 [00:28<00:27,  4.69it/s] 50%|█████     | 129/256 [00:28<00:27,  4.69it/s] 51%|█████     | 130/256 [00:28<00:26,  4.70it/s] 51%|█████     | 131/256 [00:28<00:26,  4.67it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.68it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.67it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.67it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.67it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.69it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.70it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.69it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.67it/s] 55%|█████▍    | 140/256 [00:30<00:24,  4.67it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.67it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.67it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.67it/s] 56%|█████▋    | 144/256 [00:31<00:24,  4.65it/s] 57%|█████▋    | 145/256 [00:31<00:23,  4.66it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.65it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 149/256 [00:32<00:22,  4.68it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.68it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.69it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.67it/s] 60%|██████    | 154/256 [00:33<00:21,  4.67it/s] 61%|██████    | 155/256 [00:34<00:21,  4.68it/s] 61%|██████    | 156/256 [00:34<00:21,  4.70it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.69it/s] 62%|██████▏   | 158/256 [00:34<00:21,  4.66it/s] 62%|██████▏   | 159/256 [00:34<00:20,  4.68it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.68it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.68it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.67it/s] 64%|██████▎   | 163/256 [00:35<00:19,  4.69it/s] 64%|██████▍   | 164/256 [00:35<00:19,  4.69it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.69it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.68it/s] 65%|██████▌   | 167/256 [00:36<00:18,  4.69it/s] 66%|██████▌   | 168/256 [00:36<00:18,  4.68it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.69it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.68it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.69it/s] 67%|██████▋   | 172/256 [00:37<00:17,  4.68it/s] 68%|██████▊   | 173/256 [00:37<00:17,  4.69it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.68it/s] 68%|██████▊   | 175/256 [00:38<00:18,  4.40it/s] 69%|██████▉   | 176/256 [00:38<00:18,  4.27it/s] 69%|██████▉   | 177/256 [00:38<00:18,  4.19it/s] 70%|██████▉   | 178/256 [00:39<00:18,  4.31it/s] 70%|██████▉   | 179/256 [00:39<00:17,  4.40it/s] 70%|███████   | 180/256 [00:39<00:16,  4.48it/s] 71%|███████   | 181/256 [00:39<00:16,  4.53it/s] 71%|███████   | 182/256 [00:39<00:16,  4.59it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.59it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.58it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.60it/s] 73%|███████▎  | 186/256 [00:40<00:15,  4.63it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.64it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.64it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.64it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.65it/s] 75%|███████▍  | 191/256 [00:41<00:14,  4.63it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.64it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.64it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.65it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.65it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.67it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.65it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.66it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.67it/s] 78%|███████▊  | 200/256 [00:43<00:13,  4.18it/s] 79%|███████▊  | 201/256 [00:44<00:12,  4.32it/s] 79%|███████▉  | 202/256 [00:44<00:12,  4.41it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.49it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.55it/s] 80%|████████  | 205/256 [00:44<00:11,  4.58it/s] 80%|████████  | 206/256 [00:45<00:10,  4.61it/s] 81%|████████  | 207/256 [00:45<00:10,  4.61it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.62it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.64it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.65it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.66it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.66it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.66it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.67it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.67it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.68it/s] 86%|████████▌ | 219/256 [00:47<00:07,  4.69it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.67it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.68it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.70it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.71it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.70it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.70it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.69it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.68it/s] 89%|████████▉ | 228/256 [00:49<00:05,  4.67it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.65it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.64it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.65it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.66it/s] 91%|█████████ | 233/256 [00:50<00:04,  4.67it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.66it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.66it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.67it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.68it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.69it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.68it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.69it/s] 95%|█████████▍| 242/256 [00:52<00:02,  4.67it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.69it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.69it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.70it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.70it/s] 96%|█████████▋| 247/256 [00:53<00:01,  4.68it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.69it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.69it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.69it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.70it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.70it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.71it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.70it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.70it/s]100%|██████████| 256/256 [00:55<00:00,  4.70it/s]100%|██████████| 256/256 [00:56<00:00,  4.57it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [54.77, 39.21]
Multiscale SSIM on Highres [0.999, 0.966]
Range Invariant Multiscale SSIM on Highres [1.0, 0.985]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/stats_disentangle_2405_D18-M3-S0-L8_10.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/11
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode12
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/11


Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 366
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:16,  1.01s/it]  1%|          | 2/256 [00:01<02:17,  1.84it/s]  1%|          | 3/256 [00:01<01:40,  2.51it/s]  2%|▏         | 4/256 [00:01<01:22,  3.05it/s]  2%|▏         | 5/256 [00:01<01:11,  3.49it/s]  2%|▏         | 6/256 [00:02<01:05,  3.82it/s]  3%|▎         | 7/256 [00:02<01:01,  4.05it/s]  3%|▎         | 8/256 [00:02<00:58,  4.22it/s]  4%|▎         | 9/256 [00:02<00:56,  4.34it/s]  4%|▍         | 10/256 [00:02<00:55,  4.42it/s]  4%|▍         | 11/256 [00:03<00:54,  4.48it/s]  5%|▍         | 12/256 [00:03<00:58,  4.21it/s]  5%|▌         | 13/256 [00:03<00:56,  4.34it/s]  5%|▌         | 14/256 [00:03<00:54,  4.43it/s]  6%|▌         | 15/256 [00:04<00:53,  4.50it/s]  6%|▋         | 16/256 [00:04<00:52,  4.55it/s]  7%|▋         | 17/256 [00:04<00:52,  4.57it/s]  7%|▋         | 18/256 [00:04<00:51,  4.58it/s]  7%|▋         | 19/256 [00:04<00:51,  4.59it/s]  8%|▊         | 20/256 [00:05<00:51,  4.60it/s]  8%|▊         | 21/256 [00:05<00:51,  4.60it/s]  9%|▊         | 22/256 [00:05<00:50,  4.62it/s]  9%|▉         | 23/256 [00:05<00:50,  4.63it/s]  9%|▉         | 24/256 [00:06<00:49,  4.66it/s] 10%|▉         | 25/256 [00:06<00:49,  4.66it/s] 10%|█         | 26/256 [00:06<00:49,  4.67it/s] 11%|█         | 27/256 [00:06<00:48,  4.67it/s] 11%|█         | 28/256 [00:06<00:48,  4.68it/s] 11%|█▏        | 29/256 [00:07<00:48,  4.70it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.69it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.60it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 33/256 [00:07<00:48,  4.63it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.64it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.65it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.67it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.69it/s] 15%|█▍        | 38/256 [00:09<00:50,  4.36it/s] 15%|█▌        | 39/256 [00:09<00:51,  4.24it/s] 16%|█▌        | 40/256 [00:09<00:51,  4.17it/s] 16%|█▌        | 41/256 [00:09<00:49,  4.31it/s] 16%|█▋        | 42/256 [00:10<00:48,  4.42it/s] 17%|█▋        | 43/256 [00:10<00:47,  4.49it/s] 17%|█▋        | 44/256 [00:10<00:46,  4.56it/s] 18%|█▊        | 45/256 [00:10<00:46,  4.57it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.64it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.67it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 50/256 [00:11<00:43,  4.69it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.69it/s] 20%|██        | 52/256 [00:12<00:43,  4.70it/s] 21%|██        | 53/256 [00:12<00:43,  4.68it/s] 21%|██        | 54/256 [00:12<00:43,  4.70it/s] 21%|██▏       | 55/256 [00:12<00:42,  4.68it/s] 22%|██▏       | 56/256 [00:12<00:42,  4.69it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.68it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.66it/s] 24%|██▍       | 61/256 [00:14<00:41,  4.67it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.68it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 65/256 [00:14<00:40,  4.68it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.67it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.67it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.65it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.67it/s] 27%|██▋       | 70/256 [00:15<00:39,  4.68it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.68it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.67it/s] 29%|██▊       | 73/256 [00:16<00:40,  4.57it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.59it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.62it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.63it/s] 30%|███       | 77/256 [00:17<00:38,  4.65it/s] 30%|███       | 78/256 [00:17<00:38,  4.66it/s] 31%|███       | 79/256 [00:17<00:38,  4.65it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.68it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.69it/s] 32%|███▏      | 83/256 [00:18<00:36,  4.69it/s] 33%|███▎      | 84/256 [00:19<00:36,  4.67it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.66it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.67it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.66it/s] 34%|███▍      | 88/256 [00:19<00:36,  4.66it/s] 35%|███▍      | 89/256 [00:20<00:35,  4.66it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.61it/s] 36%|███▋      | 93/256 [00:20<00:35,  4.62it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.63it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 98/256 [00:22<00:33,  4.66it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.66it/s] 39%|███▉      | 100/256 [00:22<00:34,  4.57it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.60it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.62it/s] 40%|████      | 103/256 [00:23<00:33,  4.63it/s] 41%|████      | 104/256 [00:23<00:32,  4.63it/s] 41%|████      | 105/256 [00:23<00:32,  4.64it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.66it/s] 42%|████▏     | 107/256 [00:23<00:32,  4.65it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.64it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.65it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.64it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.61it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.59it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.62it/s] 45%|████▌     | 116/256 [00:25<00:30,  4.62it/s] 46%|████▌     | 117/256 [00:26<00:29,  4.64it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.64it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.66it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.66it/s] 47%|████▋     | 121/256 [00:26<00:29,  4.64it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.64it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.64it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.66it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.67it/s] 49%|████▉     | 126/256 [00:28<00:27,  4.67it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.67it/s] 50%|█████     | 128/256 [00:28<00:27,  4.66it/s] 50%|█████     | 129/256 [00:28<00:27,  4.67it/s] 51%|█████     | 130/256 [00:28<00:26,  4.68it/s] 51%|█████     | 131/256 [00:29<00:26,  4.66it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.67it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.69it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.69it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.66it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.66it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.68it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.66it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.66it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.67it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.68it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.69it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.68it/s] 56%|█████▋    | 144/256 [00:31<00:25,  4.47it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.54it/s] 57%|█████▋    | 146/256 [00:32<00:24,  4.58it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.60it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.64it/s] 58%|█████▊    | 149/256 [00:33<00:24,  4.44it/s] 59%|█████▊    | 150/256 [00:33<00:23,  4.51it/s] 59%|█████▉    | 151/256 [00:33<00:23,  4.56it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.60it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.61it/s] 60%|██████    | 154/256 [00:34<00:22,  4.63it/s] 61%|██████    | 155/256 [00:34<00:21,  4.65it/s] 61%|██████    | 156/256 [00:34<00:21,  4.66it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.67it/s] 62%|██████▏   | 158/256 [00:34<00:20,  4.67it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.69it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.69it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.69it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.68it/s] 64%|██████▎   | 163/256 [00:36<00:19,  4.69it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.69it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.69it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.69it/s] 65%|██████▌   | 167/256 [00:36<00:18,  4.70it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.69it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.69it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.66it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.67it/s] 67%|██████▋   | 172/256 [00:37<00:17,  4.68it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.67it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.68it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 177/256 [00:39<00:18,  4.29it/s] 70%|██████▉   | 178/256 [00:39<00:18,  4.15it/s] 70%|██████▉   | 179/256 [00:39<00:18,  4.12it/s] 70%|███████   | 180/256 [00:39<00:17,  4.27it/s] 71%|███████   | 181/256 [00:40<00:17,  4.39it/s] 71%|███████   | 182/256 [00:40<00:16,  4.48it/s] 71%|███████▏  | 183/256 [00:40<00:16,  4.53it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.56it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.58it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.59it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.63it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.59it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.61it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.36it/s] 75%|███████▌  | 192/256 [00:42<00:14,  4.46it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.52it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.54it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.56it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.59it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.63it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.65it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.66it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.68it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.68it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.68it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.69it/s] 80%|████████  | 205/256 [00:45<00:10,  4.70it/s] 80%|████████  | 206/256 [00:45<00:10,  4.68it/s] 81%|████████  | 207/256 [00:45<00:10,  4.69it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.70it/s] 82%|████████▏ | 209/256 [00:46<00:09,  4.70it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.60it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.61it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.63it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.64it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.61it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.62it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.65it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.65it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.65it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.65it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.66it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.68it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.68it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.68it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.69it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.69it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.68it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.69it/s] 89%|████████▉ | 228/256 [00:50<00:05,  4.70it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.68it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.68it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.68it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.67it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.67it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.68it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.69it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.68it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.66it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.66it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.67it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.67it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.66it/s] 95%|█████████▍| 242/256 [00:53<00:02,  4.67it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.68it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.68it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.65it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.65it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.66it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.63it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.32it/s]100%|██████████| 256/256 [00:56<00:00,  4.43it/s]100%|██████████| 256/256 [00:56<00:00,  4.54it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [40.51, 47.31]
Multiscale SSIM on Highres [0.99, 0.996]
Range Invariant Multiscale SSIM on Highres [0.99, 0.996]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/stats_disentangle_2405_D18-M3-S0-L8_11.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/12
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode15
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/12


Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 399
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:17,  1.01s/it]  1%|          | 2/256 [00:01<02:45,  1.53it/s]  1%|          | 3/256 [00:01<01:54,  2.21it/s]  2%|▏         | 4/256 [00:01<01:30,  2.79it/s]  2%|▏         | 5/256 [00:02<01:16,  3.26it/s]  2%|▏         | 6/256 [00:02<01:08,  3.64it/s]  3%|▎         | 7/256 [00:02<01:21,  3.05it/s]  3%|▎         | 8/256 [00:02<01:12,  3.42it/s]  4%|▎         | 9/256 [00:03<01:06,  3.73it/s]  4%|▍         | 10/256 [00:03<01:02,  3.96it/s]  4%|▍         | 11/256 [00:03<00:59,  4.15it/s]  5%|▍         | 12/256 [00:03<00:57,  4.28it/s]  5%|▌         | 13/256 [00:04<00:55,  4.39it/s]  5%|▌         | 14/256 [00:04<00:54,  4.46it/s]  6%|▌         | 15/256 [00:04<00:53,  4.51it/s]  6%|▋         | 16/256 [00:04<00:52,  4.54it/s]  7%|▋         | 17/256 [00:04<00:52,  4.58it/s]  7%|▋         | 18/256 [00:05<00:51,  4.61it/s]  7%|▋         | 19/256 [00:05<00:51,  4.62it/s]  8%|▊         | 20/256 [00:05<00:50,  4.63it/s]  8%|▊         | 21/256 [00:05<00:50,  4.63it/s]  9%|▊         | 22/256 [00:05<00:50,  4.64it/s]  9%|▉         | 23/256 [00:06<00:50,  4.63it/s]  9%|▉         | 24/256 [00:06<00:49,  4.64it/s] 10%|▉         | 25/256 [00:06<00:56,  4.11it/s] 10%|█         | 26/256 [00:06<00:53,  4.26it/s] 11%|█         | 27/256 [00:07<00:52,  4.36it/s] 11%|█         | 28/256 [00:07<00:51,  4.44it/s] 11%|█▏        | 29/256 [00:07<00:50,  4.51it/s] 12%|█▏        | 30/256 [00:07<00:52,  4.29it/s] 12%|█▏        | 31/256 [00:08<00:53,  4.19it/s] 12%|█▎        | 32/256 [00:08<00:51,  4.32it/s] 13%|█▎        | 33/256 [00:08<00:50,  4.43it/s] 13%|█▎        | 34/256 [00:08<00:49,  4.50it/s] 14%|█▎        | 35/256 [00:08<00:48,  4.56it/s] 14%|█▍        | 36/256 [00:09<00:47,  4.60it/s] 14%|█▍        | 37/256 [00:09<00:47,  4.63it/s] 15%|█▍        | 38/256 [00:09<00:46,  4.65it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 41/256 [00:10<00:46,  4.65it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.65it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.67it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.66it/s] 18%|█▊        | 45/256 [00:11<00:45,  4.65it/s] 18%|█▊        | 46/256 [00:11<00:45,  4.66it/s] 18%|█▊        | 47/256 [00:11<00:44,  4.66it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.66it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 50/256 [00:12<00:44,  4.67it/s] 20%|█▉        | 51/256 [00:12<00:43,  4.67it/s] 20%|██        | 52/256 [00:12<00:43,  4.67it/s] 21%|██        | 53/256 [00:12<00:43,  4.66it/s] 21%|██        | 54/256 [00:12<00:43,  4.65it/s] 21%|██▏       | 55/256 [00:13<00:43,  4.66it/s] 22%|██▏       | 56/256 [00:13<00:42,  4.66it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.68it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.69it/s] 23%|██▎       | 59/256 [00:14<00:41,  4.70it/s] 23%|██▎       | 60/256 [00:14<00:41,  4.70it/s] 24%|██▍       | 61/256 [00:14<00:41,  4.68it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.68it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.68it/s] 25%|██▌       | 64/256 [00:15<00:41,  4.68it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.64it/s] 26%|██▌       | 66/256 [00:15<00:48,  3.88it/s] 26%|██▌       | 67/256 [00:15<00:46,  4.09it/s] 27%|██▋       | 68/256 [00:16<00:44,  4.26it/s] 27%|██▋       | 69/256 [00:16<00:42,  4.37it/s] 27%|██▋       | 70/256 [00:16<00:41,  4.46it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.52it/s] 28%|██▊       | 72/256 [00:16<00:40,  4.58it/s] 29%|██▊       | 73/256 [00:17<00:39,  4.61it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.64it/s] 29%|██▉       | 75/256 [00:17<00:38,  4.65it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.67it/s] 30%|███       | 77/256 [00:18<00:38,  4.66it/s] 30%|███       | 78/256 [00:18<00:38,  4.65it/s] 31%|███       | 79/256 [00:18<00:38,  4.64it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 82/256 [00:19<00:37,  4.66it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.67it/s] 33%|███▎      | 84/256 [00:19<00:36,  4.66it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.67it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.67it/s] 34%|███▍      | 87/256 [00:20<00:36,  4.68it/s] 34%|███▍      | 88/256 [00:20<00:35,  4.67it/s] 35%|███▍      | 89/256 [00:20<00:35,  4.68it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.69it/s] 36%|███▌      | 91/256 [00:21<00:36,  4.53it/s] 36%|███▌      | 92/256 [00:21<00:35,  4.56it/s] 36%|███▋      | 93/256 [00:21<00:36,  4.52it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.57it/s] 37%|███▋      | 95/256 [00:21<00:35,  4.59it/s] 38%|███▊      | 96/256 [00:22<00:34,  4.62it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.64it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.64it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.64it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.64it/s] 39%|███▉      | 101/256 [00:23<00:33,  4.64it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.66it/s] 40%|████      | 103/256 [00:23<00:32,  4.65it/s] 41%|████      | 104/256 [00:23<00:32,  4.64it/s] 41%|████      | 105/256 [00:24<00:32,  4.65it/s] 41%|████▏     | 106/256 [00:24<00:32,  4.64it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.65it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.66it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.66it/s] 43%|████▎     | 110/256 [00:25<00:31,  4.67it/s] 43%|████▎     | 111/256 [00:25<00:43,  3.31it/s] 44%|████▍     | 112/256 [00:25<00:39,  3.63it/s] 44%|████▍     | 113/256 [00:26<00:36,  3.89it/s] 45%|████▍     | 114/256 [00:26<00:34,  4.09it/s] 45%|████▍     | 115/256 [00:26<00:33,  4.25it/s] 45%|████▌     | 116/256 [00:26<00:31,  4.38it/s] 46%|████▌     | 117/256 [00:26<00:31,  4.47it/s] 46%|████▌     | 118/256 [00:27<00:30,  4.53it/s] 46%|████▋     | 119/256 [00:27<00:30,  4.56it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.60it/s] 47%|████▋     | 121/256 [00:27<00:32,  4.17it/s] 48%|████▊     | 122/256 [00:28<00:31,  4.32it/s] 48%|████▊     | 123/256 [00:28<00:30,  4.42it/s] 48%|████▊     | 124/256 [00:28<00:29,  4.50it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.56it/s] 49%|████▉     | 126/256 [00:29<00:32,  3.94it/s] 50%|████▉     | 127/256 [00:29<00:31,  4.15it/s] 50%|█████     | 128/256 [00:29<00:29,  4.29it/s] 50%|█████     | 129/256 [00:29<00:28,  4.40it/s] 51%|█████     | 130/256 [00:29<00:28,  4.49it/s] 51%|█████     | 131/256 [00:30<00:48,  2.58it/s] 52%|█████▏    | 132/256 [00:30<00:41,  2.99it/s] 52%|█████▏    | 133/256 [00:31<00:36,  3.35it/s] 52%|█████▏    | 134/256 [00:31<00:33,  3.66it/s] 53%|█████▎    | 135/256 [00:31<00:30,  3.92it/s] 53%|█████▎    | 136/256 [00:31<00:31,  3.81it/s] 54%|█████▎    | 137/256 [00:32<00:29,  4.03it/s] 54%|█████▍    | 138/256 [00:32<00:27,  4.21it/s] 54%|█████▍    | 139/256 [00:32<00:26,  4.35it/s] 55%|█████▍    | 140/256 [00:32<00:26,  4.44it/s] 55%|█████▌    | 141/256 [00:32<00:25,  4.49it/s] 55%|█████▌    | 142/256 [00:33<00:25,  4.56it/s] 56%|█████▌    | 143/256 [00:33<00:24,  4.58it/s] 56%|█████▋    | 144/256 [00:33<00:24,  4.61it/s] 57%|█████▋    | 145/256 [00:33<00:24,  4.57it/s] 57%|█████▋    | 146/256 [00:33<00:23,  4.61it/s] 57%|█████▋    | 147/256 [00:34<00:23,  4.64it/s] 58%|█████▊    | 148/256 [00:34<00:23,  4.65it/s] 58%|█████▊    | 149/256 [00:34<00:23,  4.65it/s] 59%|█████▊    | 150/256 [00:34<00:22,  4.65it/s] 59%|█████▉    | 151/256 [00:35<00:24,  4.31it/s] 59%|█████▉    | 152/256 [00:35<00:23,  4.42it/s] 60%|█████▉    | 153/256 [00:35<00:22,  4.49it/s] 60%|██████    | 154/256 [00:35<00:22,  4.56it/s] 61%|██████    | 155/256 [00:35<00:21,  4.60it/s] 61%|██████    | 156/256 [00:36<00:21,  4.63it/s] 61%|██████▏   | 157/256 [00:36<00:21,  4.65it/s] 62%|██████▏   | 158/256 [00:36<00:21,  4.65it/s] 62%|██████▏   | 159/256 [00:36<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:37<00:20,  4.65it/s] 63%|██████▎   | 161/256 [00:37<00:22,  4.27it/s] 63%|██████▎   | 162/256 [00:37<00:21,  4.37it/s] 64%|██████▎   | 163/256 [00:37<00:21,  4.23it/s] 64%|██████▍   | 164/256 [00:38<00:22,  4.13it/s] 64%|██████▍   | 165/256 [00:38<00:21,  4.29it/s] 65%|██████▍   | 166/256 [00:38<00:20,  4.40it/s] 65%|██████▌   | 167/256 [00:38<00:19,  4.48it/s] 66%|██████▌   | 168/256 [00:38<00:19,  4.43it/s] 66%|██████▌   | 169/256 [00:39<00:19,  4.50it/s] 66%|██████▋   | 170/256 [00:39<00:18,  4.55it/s] 67%|██████▋   | 171/256 [00:39<00:18,  4.53it/s] 67%|██████▋   | 172/256 [00:39<00:18,  4.56it/s] 68%|██████▊   | 173/256 [00:39<00:18,  4.60it/s] 68%|██████▊   | 174/256 [00:40<00:17,  4.63it/s] 68%|██████▊   | 175/256 [00:40<00:17,  4.65it/s] 69%|██████▉   | 176/256 [00:40<00:17,  4.65it/s] 69%|██████▉   | 177/256 [00:40<00:17,  4.60it/s] 70%|██████▉   | 178/256 [00:41<00:16,  4.63it/s] 70%|██████▉   | 179/256 [00:41<00:16,  4.64it/s] 70%|███████   | 180/256 [00:41<00:16,  4.66it/s] 71%|███████   | 181/256 [00:41<00:16,  4.66it/s] 71%|███████   | 182/256 [00:41<00:15,  4.68it/s] 71%|███████▏  | 183/256 [00:42<00:15,  4.67it/s] 72%|███████▏  | 184/256 [00:42<00:15,  4.68it/s] 72%|███████▏  | 185/256 [00:42<00:15,  4.67it/s] 73%|███████▎  | 186/256 [00:43<00:20,  3.44it/s] 73%|███████▎  | 187/256 [00:43<00:18,  3.75it/s] 73%|███████▎  | 188/256 [00:43<00:17,  3.98it/s] 74%|███████▍  | 189/256 [00:43<00:16,  4.17it/s] 74%|███████▍  | 190/256 [00:43<00:15,  4.32it/s] 75%|███████▍  | 191/256 [00:44<00:15,  4.12it/s] 75%|███████▌  | 192/256 [00:44<00:15,  4.27it/s] 75%|███████▌  | 193/256 [00:44<00:14,  4.38it/s] 76%|███████▌  | 194/256 [00:44<00:13,  4.47it/s] 76%|███████▌  | 195/256 [00:44<00:13,  4.53it/s] 77%|███████▋  | 196/256 [00:45<00:13,  4.58it/s] 77%|███████▋  | 197/256 [00:45<00:12,  4.61it/s] 77%|███████▋  | 198/256 [00:45<00:12,  4.62it/s] 78%|███████▊  | 199/256 [00:45<00:12,  4.61it/s] 78%|███████▊  | 200/256 [00:46<00:12,  4.62it/s] 79%|███████▊  | 201/256 [00:46<00:11,  4.63it/s] 79%|███████▉  | 202/256 [00:46<00:11,  4.65it/s] 79%|███████▉  | 203/256 [00:46<00:11,  4.66it/s] 80%|███████▉  | 204/256 [00:46<00:11,  4.66it/s] 80%|████████  | 205/256 [00:47<00:10,  4.66it/s] 80%|████████  | 206/256 [00:47<00:10,  4.67it/s] 81%|████████  | 207/256 [00:47<00:10,  4.68it/s] 81%|████████▏ | 208/256 [00:47<00:10,  4.67it/s] 82%|████████▏ | 209/256 [00:47<00:10,  4.68it/s] 82%|████████▏ | 210/256 [00:48<00:09,  4.69it/s] 82%|████████▏ | 211/256 [00:48<00:11,  3.87it/s] 83%|████████▎ | 212/256 [00:48<00:10,  4.08it/s] 83%|████████▎ | 213/256 [00:48<00:10,  4.24it/s] 84%|████████▎ | 214/256 [00:49<00:09,  4.36it/s] 84%|████████▍ | 215/256 [00:49<00:09,  4.46it/s] 84%|████████▍ | 216/256 [00:49<00:09,  4.27it/s] 85%|████████▍ | 217/256 [00:49<00:08,  4.37it/s] 85%|████████▌ | 218/256 [00:50<00:08,  4.45it/s] 86%|████████▌ | 219/256 [00:50<00:08,  4.52it/s] 86%|████████▌ | 220/256 [00:50<00:07,  4.57it/s] 86%|████████▋ | 221/256 [00:50<00:07,  4.52it/s] 87%|████████▋ | 222/256 [00:50<00:07,  4.56it/s] 87%|████████▋ | 223/256 [00:51<00:07,  4.59it/s] 88%|████████▊ | 224/256 [00:51<00:06,  4.62it/s] 88%|████████▊ | 225/256 [00:51<00:06,  4.61it/s] 88%|████████▊ | 226/256 [00:51<00:07,  4.18it/s] 89%|████████▊ | 227/256 [00:52<00:06,  4.31it/s] 89%|████████▉ | 228/256 [00:52<00:06,  4.43it/s] 89%|████████▉ | 229/256 [00:52<00:05,  4.51it/s] 90%|████████▉ | 230/256 [00:52<00:05,  4.57it/s] 90%|█████████ | 231/256 [00:53<00:05,  4.20it/s] 91%|█████████ | 232/256 [00:53<00:05,  4.33it/s] 91%|█████████ | 233/256 [00:53<00:05,  4.43it/s] 91%|█████████▏| 234/256 [00:53<00:04,  4.49it/s] 92%|█████████▏| 235/256 [00:53<00:04,  4.54it/s] 92%|█████████▏| 236/256 [00:54<00:04,  4.60it/s] 93%|█████████▎| 237/256 [00:54<00:04,  4.03it/s] 93%|█████████▎| 238/256 [00:54<00:04,  4.21it/s] 93%|█████████▎| 239/256 [00:54<00:03,  4.35it/s] 94%|█████████▍| 240/256 [00:55<00:04,  3.90it/s] 94%|█████████▍| 241/256 [00:55<00:03,  4.11it/s] 95%|█████████▍| 242/256 [00:55<00:03,  4.26it/s] 95%|█████████▍| 243/256 [00:55<00:02,  4.37it/s] 95%|█████████▌| 244/256 [00:56<00:02,  4.47it/s] 96%|█████████▌| 245/256 [00:56<00:02,  3.94it/s] 96%|█████████▌| 246/256 [00:56<00:02,  4.14it/s] 96%|█████████▋| 247/256 [00:56<00:02,  4.29it/s] 97%|█████████▋| 248/256 [00:56<00:01,  4.40it/s] 97%|█████████▋| 249/256 [00:57<00:01,  4.48it/s] 98%|█████████▊| 250/256 [00:57<00:01,  4.53it/s] 98%|█████████▊| 251/256 [00:57<00:01,  4.57it/s] 98%|█████████▊| 252/256 [00:57<00:00,  4.60it/s] 99%|█████████▉| 253/256 [00:58<00:00,  4.62it/s] 99%|█████████▉| 254/256 [00:58<00:00,  4.64it/s]100%|█████████▉| 255/256 [00:58<00:00,  4.66it/s]100%|██████████| 256/256 [00:58<00:00,  4.65it/s]100%|██████████| 256/256 [00:58<00:00,  4.35it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [37.29, 47.32]
Multiscale SSIM on Highres [0.967, 0.995]
Range Invariant Multiscale SSIM on Highres [0.969, 0.996]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/stats_disentangle_2405_D18-M3-S0-L8_12.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F11.46/kth_0/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif
data:
  background_quantile: 0.0
  channel_idx_list:
  - GT_Cy5
  - GT_TRITC
  - 555-647
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/6
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: caa1d41d654fb423a7c3abc700486f87d132a2f7
  untracked_files: []
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/6

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Train

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Test

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 93
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:35,  1.09it/s]  5%|▌         | 2/40 [00:01<00:19,  1.98it/s]  8%|▊         | 3/40 [00:01<00:13,  2.67it/s] 10%|█         | 4/40 [00:01<00:11,  3.21it/s] 12%|█▎        | 5/40 [00:01<00:09,  3.54it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.84it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.06it/s] 20%|██        | 8/40 [00:02<00:07,  4.23it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.33it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.42it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.49it/s] 30%|███       | 12/40 [00:03<00:06,  4.52it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.55it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:03<00:05,  4.57it/s] 40%|████      | 16/40 [00:04<00:05,  4.59it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.60it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.61it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.62it/s] 50%|█████     | 20/40 [00:05<00:04,  4.62it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.62it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:05<00:03,  4.61it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.62it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.62it/s] 70%|███████   | 28/40 [00:06<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:06<00:02,  4.63it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.60it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.62it/s] 80%|████████  | 32/40 [00:07<00:01,  4.61it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.62it/s] 95%|█████████▌| 38/40 [00:08<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.27it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [42.94, 31.24]
Multiscale SSIM on Highres [0.987, 0.956]
Range Invariant Multiscale SSIM on Highres [0.988, 0.957]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/stats_disentangle_2404_D21-M3-S0-L8_6.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  - 9
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/120
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/120

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.04s/it]  5%|▌         | 2/40 [00:01<00:21,  1.80it/s]  8%|▊         | 3/40 [00:01<00:14,  2.50it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.48it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.78it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.02it/s] 20%|██        | 8/40 [00:02<00:07,  4.20it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.34it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.36it/s] 28%|██▊       | 11/40 [00:03<00:07,  4.06it/s] 30%|███       | 12/40 [00:03<00:06,  4.03it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.18it/s] 35%|███▌      | 14/40 [00:03<00:06,  4.32it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.42it/s] 40%|████      | 16/40 [00:04<00:05,  4.48it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.51it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.54it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.57it/s] 50%|█████     | 20/40 [00:05<00:04,  4.60it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.62it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:06<00:03,  4.62it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.61it/s] 70%|███████   | 28/40 [00:06<00:02,  4.61it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.53it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.55it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.57it/s] 80%|████████  | 32/40 [00:07<00:01,  4.58it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.59it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.63it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.62it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.17it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.22, 33.72]
Multiscale SSIM on Highres [0.847, 0.951]
Range Invariant Multiscale SSIM on Highres [0.848, 0.951]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/stats_disentangle_2404_D25-M3-S0-L8_120.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  - 10
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/111
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/111

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 334
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:39,  1.01s/it]  5%|▌         | 2/40 [00:01<00:20,  1.84it/s]  8%|▊         | 3/40 [00:01<00:14,  2.54it/s] 10%|█         | 4/40 [00:01<00:11,  3.09it/s] 12%|█▎        | 5/40 [00:01<00:09,  3.51it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.82it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.07it/s] 20%|██        | 8/40 [00:02<00:07,  4.25it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.35it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.42it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.50it/s] 30%|███       | 12/40 [00:03<00:06,  4.54it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.55it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.56it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.60it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.61it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.63it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.65it/s] 50%|█████     | 20/40 [00:05<00:04,  4.64it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.63it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.64it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.65it/s] 60%|██████    | 24/40 [00:05<00:03,  4.64it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.63it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.63it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.62it/s] 70%|███████   | 28/40 [00:06<00:02,  4.61it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.60it/s] 80%|████████  | 32/40 [00:07<00:01,  4.59it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.58it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.59it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.62it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.63it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.24it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.23, 35.33]
Multiscale SSIM on Highres [0.848, 0.963]
Range Invariant Multiscale SSIM on Highres [0.848, 0.964]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/stats_disentangle_2404_D25-M3-S0-L8_111.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  - 11
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/125
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/125

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 279
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]  5%|▌         | 2/40 [00:01<00:21,  1.78it/s]  8%|▊         | 3/40 [00:01<00:14,  2.47it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.48it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.81it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.05it/s] 20%|██        | 8/40 [00:02<00:07,  4.15it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.30it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.41it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.40it/s] 30%|███       | 12/40 [00:03<00:06,  4.46it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.49it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.52it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.55it/s] 40%|████      | 16/40 [00:04<00:05,  4.58it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.61it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.61it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.61it/s] 50%|█████     | 20/40 [00:05<00:04,  4.61it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.61it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.62it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.61it/s] 60%|██████    | 24/40 [00:06<00:03,  4.64it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.63it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.63it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.65it/s] 70%|███████   | 28/40 [00:06<00:02,  4.62it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.63it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.64it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.63it/s] 80%|████████  | 32/40 [00:07<00:01,  4.64it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.61it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.59it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.59it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.62it/s]100%|██████████| 40/40 [00:09<00:00,  4.22it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [34.93, 33.66]
Multiscale SSIM on Highres [0.96, 0.95]
Range Invariant Multiscale SSIM on Highres [0.96, 0.951]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/stats_disentangle_2404_D25-M3-S0-L8_125.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  - 12
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/139
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/139

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 375
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]  5%|▌         | 2/40 [00:01<00:21,  1.76it/s]  8%|▊         | 3/40 [00:01<00:15,  2.46it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.45it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.78it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.03it/s] 20%|██        | 8/40 [00:02<00:07,  4.20it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.34it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.43it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.48it/s] 30%|███       | 12/40 [00:03<00:06,  4.52it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.54it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.61it/s] 40%|████      | 16/40 [00:04<00:05,  4.61it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.62it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.62it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.62it/s] 50%|█████     | 20/40 [00:05<00:04,  4.63it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.64it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.66it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.64it/s] 60%|██████    | 24/40 [00:06<00:03,  4.62it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.63it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.64it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.63it/s] 70%|███████   | 28/40 [00:06<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.63it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.62it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.62it/s] 80%|████████  | 32/40 [00:07<00:01,  4.63it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.63it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.62it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.62it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.61it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.62it/s]100%|██████████| 40/40 [00:09<00:00,  4.22it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [34.99, 35.18]
Multiscale SSIM on Highres [0.961, 0.962]
Range Invariant Multiscale SSIM on Highres [0.961, 0.962]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/stats_disentangle_2404_D25-M3-S0-L8_139.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  - 13
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/143
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/143

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 223
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.03s/it]  5%|▌         | 2/40 [00:01<00:20,  1.81it/s]  8%|▊         | 3/40 [00:01<00:14,  2.47it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.44it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.77it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.01it/s] 20%|██        | 8/40 [00:02<00:07,  4.20it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.41it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.53it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.56it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.58it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.59it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.59it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.61it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.62it/s] 50%|█████     | 20/40 [00:05<00:04,  4.57it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.30it/s] 55%|█████▌    | 22/40 [00:05<00:04,  4.19it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.31it/s] 60%|██████    | 24/40 [00:06<00:03,  4.40it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.37it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.44it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.50it/s] 70%|███████   | 28/40 [00:06<00:02,  4.53it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.57it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.58it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.59it/s] 80%|████████  | 32/40 [00:07<00:01,  4.58it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.59it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.59it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.62it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.61it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.63it/s]100%|██████████| 40/40 [00:09<00:00,  4.18it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [33.72, 35.29]
Multiscale SSIM on Highres [0.951, 0.963]
Range Invariant Multiscale SSIM on Highres [0.951, 0.964]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/stats_disentangle_2404_D25-M3-S0-L8_143.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F11.46/kth_0/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif

##################################
Predicting 1th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.05s/it]  5%|▌         | 2/40 [00:01<00:21,  1.78it/s]  8%|▊         | 3/40 [00:01<00:14,  2.47it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.47it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.80it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.04it/s] 20%|██        | 8/40 [00:02<00:07,  4.21it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.34it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.43it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.51it/s] 30%|███       | 12/40 [00:03<00:06,  4.55it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.56it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.58it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.61it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.62it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.64it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.63it/s] 50%|█████     | 20/40 [00:05<00:04,  4.62it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.61it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.59it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.57it/s] 60%|██████    | 24/40 [00:06<00:03,  4.59it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.60it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.60it/s] 70%|███████   | 28/40 [00:06<00:02,  4.60it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.60it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.60it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.59it/s] 80%|████████  | 32/40 [00:07<00:01,  4.58it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.58it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.59it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.61it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.62it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.63it/s]100%|██████████| 40/40 [00:09<00:00,  4.23it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_1/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [44.75, 34.8]
Multiscale SSIM on Highres [0.989, 0.975]
Range Invariant Multiscale SSIM on Highres [0.99, 0.976]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_1/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_1/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s] 12%|█▎        | 2/16 [00:01<00:07,  1.87it/s] 19%|█▉        | 3/16 [00:01<00:05,  2.57it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.12it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.54it/s] 38%|███▊      | 6/16 [00:02<00:02,  3.85it/s] 44%|████▍     | 7/16 [00:02<00:02,  4.08it/s] 50%|█████     | 8/16 [00:02<00:01,  4.24it/s] 56%|█████▋    | 9/16 [00:02<00:01,  4.35it/s] 62%|██████▎   | 10/16 [00:02<00:01,  4.43it/s] 69%|██████▉   | 11/16 [00:03<00:01,  4.48it/s] 75%|███████▌  | 12/16 [00:03<00:00,  4.53it/s] 81%|████████▏ | 13/16 [00:03<00:00,  4.57it/s] 88%|████████▊ | 14/16 [00:03<00:00,  4.59it/s] 94%|█████████▍| 15/16 [00:04<00:00,  4.60it/s]100%|██████████| 16/16 [00:04<00:00,  4.61it/s]100%|██████████| 16/16 [00:04<00:00,  3.66it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [33.11, 33.39]
Multiscale SSIM on Highres [0.842, 0.835]
Range Invariant Multiscale SSIM on Highres [0.925, 0.872]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:01<00:38,  1.04s/it]  5%|▌         | 2/38 [00:01<00:20,  1.79it/s]  8%|▊         | 3/38 [00:01<00:14,  2.45it/s] 11%|█         | 4/38 [00:01<00:11,  3.00it/s] 13%|█▎        | 5/38 [00:01<00:09,  3.44it/s] 16%|█▌        | 6/38 [00:02<00:08,  3.78it/s] 18%|█▊        | 7/38 [00:02<00:07,  4.00it/s] 21%|██        | 8/38 [00:02<00:07,  4.17it/s] 24%|██▎       | 9/38 [00:02<00:06,  4.31it/s] 26%|██▋       | 10/38 [00:03<00:06,  4.40it/s] 29%|██▉       | 11/38 [00:03<00:06,  4.45it/s] 32%|███▏      | 12/38 [00:03<00:05,  4.49it/s] 34%|███▍      | 13/38 [00:03<00:05,  4.53it/s] 37%|███▋      | 14/38 [00:03<00:05,  4.56it/s] 39%|███▉      | 15/38 [00:04<00:05,  4.58it/s] 42%|████▏     | 16/38 [00:04<00:04,  4.59it/s] 45%|████▍     | 17/38 [00:04<00:04,  4.60it/s] 47%|████▋     | 18/38 [00:04<00:04,  4.62it/s] 50%|█████     | 19/38 [00:04<00:04,  4.58it/s] 53%|█████▎    | 20/38 [00:05<00:03,  4.60it/s] 55%|█████▌    | 21/38 [00:05<00:03,  4.62it/s] 58%|█████▊    | 22/38 [00:05<00:03,  4.63it/s] 61%|██████    | 23/38 [00:05<00:03,  4.61it/s] 63%|██████▎   | 24/38 [00:06<00:03,  4.61it/s] 66%|██████▌   | 25/38 [00:06<00:02,  4.59it/s] 68%|██████▊   | 26/38 [00:06<00:02,  4.60it/s] 71%|███████   | 27/38 [00:06<00:02,  4.60it/s] 74%|███████▎  | 28/38 [00:06<00:02,  4.61it/s] 76%|███████▋  | 29/38 [00:07<00:01,  4.60it/s] 79%|███████▉  | 30/38 [00:07<00:01,  4.62it/s] 82%|████████▏ | 31/38 [00:07<00:01,  4.62it/s] 84%|████████▍ | 32/38 [00:07<00:01,  4.62it/s] 87%|████████▋ | 33/38 [00:07<00:01,  4.63it/s] 89%|████████▉ | 34/38 [00:08<00:00,  4.61it/s] 92%|█████████▏| 35/38 [00:08<00:00,  4.61it/s] 95%|█████████▍| 36/38 [00:08<00:00,  4.63it/s] 97%|█████████▋| 37/38 [00:08<00:00,  4.62it/s]100%|██████████| 38/38 [00:08<00:00,  5.35it/s]100%|██████████| 38/38 [00:09<00:00,  4.15it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F12.55/kth_1/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [28.73, 25.41]
Multiscale SSIM on Highres [0.763, 0.806]
Range Invariant Multiscale SSIM on Highres [0.907, 0.81]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F12.55/kth_1/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F12.55/kth_1/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.06s/it]  5%|▌         | 2/40 [00:01<00:21,  1.77it/s]  8%|▊         | 3/40 [00:01<00:15,  2.44it/s] 10%|█         | 4/40 [00:01<00:11,  3.01it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.45it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.80it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.04it/s] 20%|██        | 8/40 [00:02<00:07,  4.21it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.33it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.32it/s] 28%|██▊       | 11/40 [00:03<00:07,  4.13it/s] 30%|███       | 12/40 [00:03<00:06,  4.08it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.23it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.36it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.43it/s] 40%|████      | 16/40 [00:04<00:05,  4.50it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.55it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.58it/s] 50%|█████     | 20/40 [00:05<00:04,  4.59it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.62it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.60it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.60it/s] 60%|██████    | 24/40 [00:06<00:03,  4.59it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.60it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.61it/s] 70%|███████   | 28/40 [00:07<00:02,  4.62it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.63it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.64it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.63it/s] 80%|████████  | 32/40 [00:07<00:01,  4.61it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.59it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.61it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.62it/s]100%|██████████| 40/40 [00:09<00:00,  4.17it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [25.82, 28.5]
Multiscale SSIM on Highres [0.747, 0.868]
Range Invariant Multiscale SSIM on Highres [0.758, 0.879]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:25,  1.04s/it]  1%|          | 2/256 [00:01<02:22,  1.79it/s]  1%|          | 3/256 [00:01<01:41,  2.49it/s]  2%|▏         | 4/256 [00:01<01:22,  3.05it/s]  2%|▏         | 5/256 [00:01<01:12,  3.47it/s]  2%|▏         | 6/256 [00:02<01:06,  3.78it/s]  3%|▎         | 7/256 [00:02<01:02,  4.01it/s]  3%|▎         | 8/256 [00:02<00:59,  4.20it/s]  4%|▎         | 9/256 [00:02<00:56,  4.33it/s]  4%|▍         | 10/256 [00:02<00:55,  4.40it/s]  4%|▍         | 11/256 [00:03<00:55,  4.45it/s]  5%|▍         | 12/256 [00:03<00:54,  4.50it/s]  5%|▌         | 13/256 [00:03<00:53,  4.54it/s]  5%|▌         | 14/256 [00:03<00:53,  4.56it/s]  6%|▌         | 15/256 [00:04<00:52,  4.59it/s]  6%|▋         | 16/256 [00:04<00:52,  4.59it/s]  7%|▋         | 17/256 [00:04<00:51,  4.60it/s]  7%|▋         | 18/256 [00:04<00:51,  4.62it/s]  7%|▋         | 19/256 [00:04<00:51,  4.62it/s]  8%|▊         | 20/256 [00:05<00:51,  4.60it/s]  8%|▊         | 21/256 [00:05<00:51,  4.60it/s]  9%|▊         | 22/256 [00:05<00:50,  4.61it/s]  9%|▉         | 23/256 [00:05<00:50,  4.62it/s]  9%|▉         | 24/256 [00:06<00:50,  4.63it/s] 10%|▉         | 25/256 [00:06<00:49,  4.64it/s] 10%|█         | 26/256 [00:06<00:49,  4.62it/s] 11%|█         | 27/256 [00:06<00:49,  4.61it/s] 11%|█         | 28/256 [00:06<00:49,  4.61it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.61it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.61it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 33/256 [00:07<00:48,  4.63it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.62it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.64it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.65it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.65it/s] 15%|█▍        | 38/256 [00:09<00:46,  4.66it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.65it/s] 16%|█▋        | 42/256 [00:09<00:45,  4.66it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.67it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.67it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.66it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.66it/s] 18%|█▊        | 47/256 [00:10<00:44,  4.65it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.66it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.66it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.66it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.66it/s] 20%|██        | 52/256 [00:12<00:43,  4.65it/s] 21%|██        | 53/256 [00:12<00:43,  4.66it/s] 21%|██        | 54/256 [00:12<00:43,  4.65it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.66it/s] 22%|██▏       | 56/256 [00:12<00:43,  4.65it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.65it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.66it/s] 24%|██▍       | 61/256 [00:13<00:41,  4.67it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.67it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.68it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.68it/s] 25%|██▌       | 65/256 [00:14<00:40,  4.67it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.67it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.67it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.66it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.66it/s] 27%|██▋       | 70/256 [00:15<00:40,  4.64it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.63it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.63it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.64it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.65it/s] 29%|██▉       | 75/256 [00:16<00:38,  4.65it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.61it/s] 30%|███       | 77/256 [00:17<00:38,  4.59it/s] 30%|███       | 78/256 [00:17<00:38,  4.61it/s] 31%|███       | 79/256 [00:17<00:38,  4.59it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.58it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.56it/s] 32%|███▏      | 82/256 [00:18<00:38,  4.58it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.57it/s] 33%|███▎      | 84/256 [00:18<00:37,  4.60it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.60it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.60it/s] 34%|███▍      | 88/256 [00:19<00:36,  4.59it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.60it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.62it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.64it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.65it/s] 36%|███▋      | 93/256 [00:20<00:35,  4.63it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.65it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 98/256 [00:21<00:34,  4.63it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.63it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.63it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.65it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.66it/s] 40%|████      | 103/256 [00:23<00:32,  4.67it/s] 41%|████      | 104/256 [00:23<00:32,  4.66it/s] 41%|████      | 105/256 [00:23<00:32,  4.66it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.65it/s] 42%|████▏     | 107/256 [00:23<00:32,  4.64it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.64it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.65it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.65it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.65it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.66it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.67it/s] 45%|████▌     | 116/256 [00:25<00:29,  4.67it/s] 46%|████▌     | 117/256 [00:26<00:29,  4.68it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.67it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 120/256 [00:26<00:30,  4.43it/s] 47%|████▋     | 121/256 [00:26<00:31,  4.25it/s] 48%|████▊     | 122/256 [00:27<00:30,  4.37it/s] 48%|████▊     | 123/256 [00:27<00:29,  4.45it/s] 48%|████▊     | 124/256 [00:27<00:29,  4.51it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.56it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.60it/s] 50%|████▉     | 127/256 [00:28<00:28,  4.60it/s] 50%|█████     | 128/256 [00:28<00:27,  4.62it/s] 50%|█████     | 129/256 [00:28<00:27,  4.63it/s] 51%|█████     | 130/256 [00:28<00:27,  4.65it/s] 51%|█████     | 131/256 [00:29<00:26,  4.67it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.66it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.67it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.66it/s] 53%|█████▎    | 135/256 [00:30<00:25,  4.66it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.67it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.64it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.64it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.66it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.65it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.65it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.66it/s] 56%|█████▋    | 144/256 [00:31<00:23,  4.67it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.68it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.68it/s] 58%|█████▊    | 149/256 [00:33<00:22,  4.67it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.68it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.68it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.67it/s] 60%|██████    | 154/256 [00:34<00:21,  4.67it/s] 61%|██████    | 155/256 [00:34<00:21,  4.67it/s] 61%|██████    | 156/256 [00:34<00:21,  4.66it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.66it/s] 62%|██████▏   | 158/256 [00:34<00:20,  4.67it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.68it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.67it/s] 64%|██████▎   | 163/256 [00:36<00:19,  4.67it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.66it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.66it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.65it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.65it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.65it/s] 66%|██████▌   | 169/256 [00:37<00:19,  4.51it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.56it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.58it/s] 67%|██████▋   | 172/256 [00:37<00:18,  4.59it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.62it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.64it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.64it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 177/256 [00:39<00:16,  4.66it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.68it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.68it/s] 70%|███████   | 180/256 [00:39<00:16,  4.67it/s] 71%|███████   | 181/256 [00:39<00:16,  4.66it/s] 71%|███████   | 182/256 [00:40<00:15,  4.67it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.66it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.66it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.66it/s] 73%|███████▎  | 186/256 [00:40<00:14,  4.67it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.66it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.67it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.68it/s] 75%|███████▍  | 191/256 [00:42<00:13,  4.67it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.66it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.67it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.67it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.67it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.67it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.68it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.67it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.67it/s] 78%|███████▊  | 200/256 [00:43<00:11,  4.67it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.66it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.66it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.67it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.67it/s] 80%|████████  | 205/256 [00:45<00:10,  4.65it/s] 80%|████████  | 206/256 [00:45<00:10,  4.67it/s] 81%|████████  | 207/256 [00:45<00:10,  4.66it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.65it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.65it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.66it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.66it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.64it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.66it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.63it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.63it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.63it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.64it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.64it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.64it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.64it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.64it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.65it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.67it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.67it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.66it/s] 89%|████████▉ | 228/256 [00:49<00:06,  4.66it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.66it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.66it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.68it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.68it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.68it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.69it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.66it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.67it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.68it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.68it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.67it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.67it/s] 95%|█████████▍| 242/256 [00:52<00:03,  4.66it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.66it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.66it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.66it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.67it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.66it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.66it/s]100%|██████████| 256/256 [00:55<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.56it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [42.57, 38.33]
Multiscale SSIM on Highres [0.991, 0.985]
Range Invariant Multiscale SSIM on Highres [0.992, 0.986]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:52,  1.15s/it]  1%|          | 2/256 [00:01<02:32,  1.67it/s]  1%|          | 3/256 [00:01<01:47,  2.36it/s]  2%|▏         | 4/256 [00:01<01:26,  2.93it/s]  2%|▏         | 5/256 [00:02<01:14,  3.39it/s]  2%|▏         | 6/256 [00:02<01:07,  3.73it/s]  3%|▎         | 7/256 [00:02<01:02,  3.99it/s]  3%|▎         | 8/256 [00:02<00:59,  4.16it/s]  4%|▎         | 9/256 [00:02<00:57,  4.30it/s]  4%|▍         | 10/256 [00:03<00:55,  4.41it/s]  4%|▍         | 11/256 [00:03<00:54,  4.48it/s]  5%|▍         | 12/256 [00:03<00:53,  4.52it/s]  5%|▌         | 13/256 [00:03<00:53,  4.50it/s]  5%|▌         | 14/256 [00:04<00:57,  4.22it/s]  6%|▌         | 15/256 [00:04<00:58,  4.13it/s]  6%|▋         | 16/256 [00:04<00:56,  4.26it/s]  7%|▋         | 17/256 [00:04<00:54,  4.36it/s]  7%|▋         | 18/256 [00:04<00:53,  4.44it/s]  7%|▋         | 19/256 [00:05<00:52,  4.51it/s]  8%|▊         | 20/256 [00:05<00:52,  4.53it/s]  8%|▊         | 21/256 [00:05<00:51,  4.56it/s]  9%|▊         | 22/256 [00:05<00:51,  4.56it/s]  9%|▉         | 23/256 [00:06<00:51,  4.56it/s]  9%|▉         | 24/256 [00:06<00:51,  4.53it/s] 10%|▉         | 25/256 [00:06<00:50,  4.56it/s] 10%|█         | 26/256 [00:06<00:50,  4.58it/s] 11%|█         | 27/256 [00:06<00:49,  4.59it/s] 11%|█         | 28/256 [00:07<00:49,  4.61it/s] 11%|█▏        | 29/256 [00:07<00:48,  4.63it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.64it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.65it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.66it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.64it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.57it/s] 14%|█▎        | 35/256 [00:08<00:48,  4.60it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.61it/s] 14%|█▍        | 37/256 [00:09<00:47,  4.63it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.63it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.63it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.65it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.65it/s] 16%|█▋        | 42/256 [00:10<00:45,  4.66it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.65it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.64it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.64it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.63it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.62it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.62it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.61it/s] 20%|██        | 52/256 [00:12<00:44,  4.61it/s] 21%|██        | 53/256 [00:12<00:44,  4.59it/s] 21%|██        | 54/256 [00:12<00:43,  4.60it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.60it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.61it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.62it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.62it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.61it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.60it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.60it/s] 25%|██▍       | 63/256 [00:14<00:42,  4.59it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.61it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.58it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.60it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.60it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.60it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.60it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.60it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.60it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.61it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.60it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.62it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.60it/s] 30%|███       | 77/256 [00:17<00:38,  4.60it/s] 30%|███       | 78/256 [00:17<00:38,  4.60it/s] 31%|███       | 79/256 [00:18<00:38,  4.60it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.59it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.59it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.59it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.58it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.59it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.60it/s] 34%|███▎      | 86/256 [00:19<00:37,  4.59it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.59it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.60it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.59it/s] 35%|███▌      | 90/256 [00:20<00:36,  4.60it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.60it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.61it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 95/256 [00:21<00:35,  4.59it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.58it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.59it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.59it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.59it/s] 39%|███▉      | 100/256 [00:22<00:34,  4.58it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.58it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.60it/s] 40%|████      | 103/256 [00:23<00:33,  4.60it/s] 41%|████      | 104/256 [00:23<00:33,  4.60it/s] 41%|████      | 105/256 [00:23<00:32,  4.60it/s] 41%|████▏     | 106/256 [00:24<00:32,  4.60it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.61it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.60it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.60it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.60it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.61it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.62it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.59it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.60it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.60it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.62it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.62it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.61it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.61it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.60it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.61it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.62it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.62it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.61it/s] 50%|█████     | 128/256 [00:28<00:27,  4.61it/s] 50%|█████     | 129/256 [00:29<00:27,  4.60it/s] 51%|█████     | 130/256 [00:29<00:27,  4.62it/s] 51%|█████     | 131/256 [00:29<00:27,  4.59it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.61it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.61it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 136/256 [00:30<00:26,  4.61it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.60it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.61it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.61it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.61it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.61it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.61it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.62it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.62it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.62it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.63it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.63it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.61it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.61it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.62it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.61it/s] 59%|█████▉    | 152/256 [00:34<00:24,  4.32it/s] 60%|█████▉    | 153/256 [00:34<00:24,  4.19it/s] 60%|██████    | 154/256 [00:34<00:23,  4.30it/s] 61%|██████    | 155/256 [00:34<00:23,  4.39it/s] 61%|██████    | 156/256 [00:34<00:22,  4.45it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.50it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.53it/s] 62%|██████▏   | 159/256 [00:35<00:21,  4.55it/s] 62%|██████▎   | 160/256 [00:35<00:21,  4.57it/s] 63%|██████▎   | 161/256 [00:36<00:20,  4.57it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.59it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.60it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.61it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.61it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.59it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.59it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.59it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.60it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.58it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.59it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.59it/s] 68%|██████▊   | 173/256 [00:38<00:18,  4.59it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.58it/s] 68%|██████▊   | 175/256 [00:39<00:17,  4.58it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.58it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.58it/s] 70%|██████▉   | 178/256 [00:39<00:17,  4.58it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.59it/s] 70%|███████   | 180/256 [00:40<00:16,  4.61it/s] 71%|███████   | 181/256 [00:40<00:16,  4.62it/s] 71%|███████   | 182/256 [00:40<00:16,  4.62it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.61it/s] 72%|███████▏  | 184/256 [00:41<00:15,  4.61it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.61it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.61it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.61it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.62it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.62it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.62it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.62it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.60it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.60it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.59it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.60it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.60it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.60it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.62it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.62it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.61it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.59it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.61it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.63it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.60it/s] 80%|████████  | 205/256 [00:45<00:11,  4.61it/s] 80%|████████  | 206/256 [00:45<00:10,  4.60it/s] 81%|████████  | 207/256 [00:46<00:10,  4.61it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.61it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.62it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.62it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.60it/s] 83%|████████▎ | 212/256 [00:47<00:09,  4.58it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.60it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.60it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.59it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.59it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.59it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.60it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.58it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.59it/s] 86%|████████▋ | 221/256 [00:49<00:07,  4.60it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.56it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.58it/s] 88%|████████▊ | 224/256 [00:49<00:07,  4.56it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.55it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.56it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.56it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.56it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.56it/s] 90%|████████▉ | 230/256 [00:51<00:05,  4.57it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.60it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.61it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.61it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.60it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.62it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.62it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.62it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.61it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.62it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.64it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.67it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.65it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.63it/s] 95%|█████████▌| 244/256 [00:54<00:02,  4.63it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.63it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.61it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.63it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.63it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.63it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.63it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.63it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.64it/s] 99%|█████████▉| 253/256 [00:56<00:00,  4.64it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.64it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.65it/s]100%|██████████| 256/256 [00:56<00:00,  4.65it/s]100%|██████████| 256/256 [00:56<00:00,  4.50it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [57.01, 43.53]
Multiscale SSIM on Highres [0.999, 0.981]
Range Invariant Multiscale SSIM on Highres [1.0, 0.994]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/stats_disentangle_2405_D18-M3-S0-L8_14.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/15
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/15


Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 111
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:47,  1.13s/it]  1%|          | 2/256 [00:01<02:31,  1.67it/s]  1%|          | 3/256 [00:01<01:48,  2.34it/s]  2%|▏         | 4/256 [00:01<01:26,  2.92it/s]  2%|▏         | 5/256 [00:02<01:14,  3.38it/s]  2%|▏         | 6/256 [00:02<01:07,  3.73it/s]  3%|▎         | 7/256 [00:02<01:02,  3.99it/s]  3%|▎         | 8/256 [00:02<00:59,  4.18it/s]  4%|▎         | 9/256 [00:02<01:05,  3.79it/s]  4%|▍         | 10/256 [00:03<01:01,  4.03it/s]  4%|▍         | 11/256 [00:03<00:58,  4.20it/s]  5%|▍         | 12/256 [00:03<00:56,  4.33it/s]  5%|▌         | 13/256 [00:03<00:55,  4.40it/s]  5%|▌         | 14/256 [00:04<00:54,  4.47it/s]  6%|▌         | 15/256 [00:04<00:53,  4.50it/s]  6%|▋         | 16/256 [00:04<00:52,  4.54it/s]  7%|▋         | 17/256 [00:04<00:52,  4.57it/s]  7%|▋         | 18/256 [00:04<00:51,  4.60it/s]  7%|▋         | 19/256 [00:05<00:52,  4.54it/s]  8%|▊         | 20/256 [00:05<00:51,  4.57it/s]  8%|▊         | 21/256 [00:05<00:51,  4.58it/s]  9%|▊         | 22/256 [00:05<00:50,  4.59it/s]  9%|▉         | 23/256 [00:06<00:50,  4.59it/s]  9%|▉         | 24/256 [00:06<00:50,  4.59it/s] 10%|▉         | 25/256 [00:06<00:50,  4.60it/s] 10%|█         | 26/256 [00:06<00:49,  4.61it/s] 11%|█         | 27/256 [00:06<00:49,  4.60it/s] 11%|█         | 28/256 [00:07<00:49,  4.61it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.61it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.63it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.63it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.63it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 37/256 [00:09<00:47,  4.63it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.63it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.64it/s] 16%|█▌        | 40/256 [00:09<00:49,  4.38it/s] 16%|█▌        | 41/256 [00:09<00:50,  4.23it/s] 16%|█▋        | 42/256 [00:10<00:51,  4.16it/s] 17%|█▋        | 43/256 [00:10<00:49,  4.30it/s] 17%|█▋        | 44/256 [00:10<00:48,  4.40it/s] 18%|█▊        | 45/256 [00:10<00:47,  4.47it/s] 18%|█▊        | 46/256 [00:11<00:47,  4.42it/s] 18%|█▊        | 47/256 [00:11<00:46,  4.48it/s] 19%|█▉        | 48/256 [00:11<00:46,  4.52it/s] 19%|█▉        | 49/256 [00:11<00:45,  4.55it/s] 20%|█▉        | 50/256 [00:11<00:45,  4.58it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.60it/s] 20%|██        | 52/256 [00:12<00:44,  4.59it/s] 21%|██        | 53/256 [00:12<00:44,  4.61it/s] 21%|██        | 54/256 [00:12<00:43,  4.61it/s] 21%|██▏       | 55/256 [00:13<00:43,  4.62it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.63it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.62it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.62it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.63it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.63it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.62it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.63it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.65it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.65it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.64it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.66it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.67it/s] 27%|██▋       | 69/256 [00:16<00:40,  4.67it/s] 27%|██▋       | 70/256 [00:16<00:39,  4.67it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.68it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.68it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.68it/s] 29%|██▉       | 74/256 [00:17<00:38,  4.67it/s] 29%|██▉       | 75/256 [00:17<00:38,  4.67it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.67it/s] 30%|███       | 77/256 [00:17<00:38,  4.66it/s] 30%|███       | 78/256 [00:17<00:38,  4.64it/s] 31%|███       | 79/256 [00:18<00:38,  4.63it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.64it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.63it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.64it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.65it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.66it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.67it/s] 34%|███▍      | 88/256 [00:20<00:35,  4.67it/s] 35%|███▍      | 89/256 [00:20<00:35,  4.66it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.65it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.66it/s] 36%|███▋      | 93/256 [00:21<00:34,  4.67it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.65it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.65it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.66it/s] 38%|███▊      | 98/256 [00:22<00:33,  4.65it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.64it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.66it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.65it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.64it/s] 40%|████      | 103/256 [00:23<00:32,  4.64it/s] 41%|████      | 104/256 [00:23<00:32,  4.65it/s] 41%|████      | 105/256 [00:23<00:32,  4.66it/s] 41%|████▏     | 106/256 [00:24<00:32,  4.67it/s] 42%|████▏     | 107/256 [00:24<00:31,  4.67it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.67it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.68it/s] 44%|████▍     | 112/256 [00:25<00:30,  4.67it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.65it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.63it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.63it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.63it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.63it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.64it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.64it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.65it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.65it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.65it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.65it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.66it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.65it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.63it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.63it/s] 50%|█████     | 128/256 [00:28<00:27,  4.63it/s] 50%|█████     | 129/256 [00:28<00:27,  4.63it/s] 51%|█████     | 130/256 [00:29<00:27,  4.64it/s] 51%|█████     | 131/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.62it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.66it/s] 53%|█████▎    | 135/256 [00:30<00:25,  4.66it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.64it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.66it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.66it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.66it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.64it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.64it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.65it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.66it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.66it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.66it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.65it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.65it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.66it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.60it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.63it/s] 60%|██████    | 154/256 [00:34<00:21,  4.65it/s] 61%|██████    | 155/256 [00:34<00:21,  4.66it/s] 61%|██████    | 156/256 [00:34<00:21,  4.67it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.67it/s] 62%|██████▏   | 158/256 [00:35<00:20,  4.67it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.68it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.66it/s] 64%|██████▎   | 163/256 [00:36<00:19,  4.66it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.67it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.67it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.68it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.67it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.67it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.67it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.66it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.67it/s] 67%|██████▋   | 172/256 [00:38<00:17,  4.68it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.68it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.63it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.65it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.65it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.63it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.63it/s] 70%|██████▉   | 179/256 [00:39<00:17,  4.41it/s] 70%|███████   | 180/256 [00:40<00:18,  4.16it/s] 71%|███████   | 181/256 [00:40<00:18,  4.08it/s] 71%|███████   | 182/256 [00:40<00:17,  4.25it/s] 71%|███████▏  | 183/256 [00:40<00:16,  4.38it/s] 72%|███████▏  | 184/256 [00:40<00:16,  4.46it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.52it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.49it/s] 73%|███████▎  | 187/256 [00:41<00:15,  4.55it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.58it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.61it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.62it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.64it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.65it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.66it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.66it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.56it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.59it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.61it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.63it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.63it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.65it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.61it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.63it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.63it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.64it/s] 80%|████████  | 205/256 [00:45<00:10,  4.65it/s] 80%|████████  | 206/256 [00:45<00:10,  4.66it/s] 81%|████████  | 207/256 [00:45<00:10,  4.67it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.66it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.67it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.66it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.65it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.66it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.67it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.67it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.66it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.66it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.66it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.66it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.66it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.64it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.65it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.67it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.68it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.68it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.69it/s] 89%|████████▉ | 228/256 [00:50<00:05,  4.69it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.63it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.62it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.63it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.63it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.63it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.64it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.65it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.60it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.62it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.64it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.64it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.65it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.66it/s] 95%|█████████▍| 242/256 [00:53<00:02,  4.67it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.66it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.67it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.65it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.63it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.64it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.65it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.66it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.66it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.67it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.52it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [58.76, 41.18]
Multiscale SSIM on Highres [1.0, 0.982]
Range Invariant Multiscale SSIM on Highres [1.0, 0.991]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/stats_disentangle_2405_D18-M3-S0-L8_15.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/10
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/10


Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 357
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:34,  1.08s/it]  1%|          | 2/256 [00:01<02:25,  1.75it/s]  1%|          | 3/256 [00:01<01:43,  2.45it/s]  2%|▏         | 4/256 [00:01<01:23,  3.02it/s]  2%|▏         | 5/256 [00:01<01:12,  3.45it/s]  2%|▏         | 6/256 [00:02<01:05,  3.79it/s]  3%|▎         | 7/256 [00:02<01:01,  4.05it/s]  3%|▎         | 8/256 [00:02<00:58,  4.20it/s]  4%|▎         | 9/256 [00:02<00:57,  4.33it/s]  4%|▍         | 10/256 [00:03<00:55,  4.42it/s]  4%|▍         | 11/256 [00:03<00:54,  4.50it/s]  5%|▍         | 12/256 [00:03<00:53,  4.53it/s]  5%|▌         | 13/256 [00:03<00:53,  4.57it/s]  5%|▌         | 14/256 [00:03<00:52,  4.60it/s]  6%|▌         | 15/256 [00:04<00:52,  4.61it/s]  6%|▋         | 16/256 [00:04<00:52,  4.61it/s]  7%|▋         | 17/256 [00:04<00:51,  4.63it/s]  7%|▋         | 18/256 [00:04<00:51,  4.64it/s]  7%|▋         | 19/256 [00:04<00:51,  4.63it/s]  8%|▊         | 20/256 [00:05<00:50,  4.64it/s]  8%|▊         | 21/256 [00:05<00:50,  4.65it/s]  9%|▊         | 22/256 [00:05<00:50,  4.65it/s]  9%|▉         | 23/256 [00:05<00:50,  4.64it/s]  9%|▉         | 24/256 [00:06<00:50,  4.63it/s] 10%|▉         | 25/256 [00:06<00:49,  4.65it/s] 10%|█         | 26/256 [00:06<00:49,  4.63it/s] 11%|█         | 27/256 [00:06<00:49,  4.64it/s] 11%|█         | 28/256 [00:06<00:49,  4.63it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.63it/s] 12%|█▏        | 30/256 [00:07<00:49,  4.60it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.61it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.61it/s] 13%|█▎        | 33/256 [00:07<00:48,  4.63it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.64it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.61it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.62it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.62it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.63it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.61it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.61it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 44/256 [00:10<00:46,  4.61it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.62it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.62it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.61it/s] 20%|██        | 52/256 [00:12<00:44,  4.60it/s] 21%|██        | 53/256 [00:12<00:43,  4.62it/s] 21%|██        | 54/256 [00:12<00:43,  4.62it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.63it/s] 22%|██▏       | 56/256 [00:12<00:43,  4.64it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.55it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.55it/s] 23%|██▎       | 59/256 [00:13<00:43,  4.58it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.58it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.60it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.58it/s] 25%|██▍       | 63/256 [00:14<00:42,  4.59it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.60it/s] 25%|██▌       | 65/256 [00:14<00:41,  4.61it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.62it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.61it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.62it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.64it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.63it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.62it/s] 30%|███       | 77/256 [00:17<00:38,  4.62it/s] 30%|███       | 78/256 [00:17<00:38,  4.60it/s] 31%|███       | 79/256 [00:17<00:38,  4.62it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.63it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.63it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.62it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.62it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.62it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.63it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:19<00:36,  4.59it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.58it/s] 35%|███▌      | 90/256 [00:20<00:36,  4.58it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.60it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.61it/s] 36%|███▋      | 93/256 [00:20<00:35,  4.62it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.62it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.62it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.62it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.63it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.61it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.61it/s] 40%|████      | 103/256 [00:23<00:33,  4.63it/s] 41%|████      | 104/256 [00:23<00:34,  4.37it/s] 41%|████      | 105/256 [00:23<00:35,  4.23it/s] 41%|████▏     | 106/256 [00:23<00:36,  4.13it/s] 42%|████▏     | 107/256 [00:24<00:34,  4.26it/s] 42%|████▏     | 108/256 [00:24<00:33,  4.36it/s] 43%|████▎     | 109/256 [00:24<00:33,  4.38it/s] 43%|████▎     | 110/256 [00:24<00:32,  4.45it/s] 43%|████▎     | 111/256 [00:25<00:32,  4.51it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.52it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.56it/s] 45%|████▍     | 114/256 [00:25<00:31,  4.57it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.58it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.59it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.62it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.65it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.58it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.61it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.63it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.61it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.62it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.63it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.63it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.63it/s] 50%|█████     | 128/256 [00:28<00:27,  4.63it/s] 50%|█████     | 129/256 [00:28<00:27,  4.63it/s] 51%|█████     | 130/256 [00:29<00:27,  4.63it/s] 51%|█████     | 131/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.63it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.63it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.63it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 136/256 [00:30<00:26,  4.59it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.58it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.61it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.55it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.53it/s] 55%|█████▌    | 141/256 [00:31<00:25,  4.52it/s] 55%|█████▌    | 142/256 [00:31<00:25,  4.52it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.53it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.56it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.57it/s] 57%|█████▋    | 146/256 [00:32<00:24,  4.57it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.60it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.61it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.63it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.64it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.64it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.65it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.63it/s] 60%|██████    | 154/256 [00:34<00:22,  4.61it/s] 61%|██████    | 155/256 [00:34<00:21,  4.62it/s] 61%|██████    | 156/256 [00:34<00:21,  4.62it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.62it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.63it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.62it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.60it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.60it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.60it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.62it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.63it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.64it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.64it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.63it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.61it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.62it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.62it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.63it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.63it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.63it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.62it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.63it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.63it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.63it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.63it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.61it/s] 70%|███████   | 180/256 [00:39<00:16,  4.61it/s] 71%|███████   | 181/256 [00:40<00:16,  4.62it/s] 71%|███████   | 182/256 [00:40<00:16,  4.62it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.62it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.61it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.62it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.63it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.63it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.63it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.63it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.64it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.62it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.61it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.63it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.63it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.62it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.63it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.62it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.63it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.63it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.62it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.64it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.63it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.61it/s] 80%|████████  | 205/256 [00:45<00:11,  4.61it/s] 80%|████████  | 206/256 [00:45<00:10,  4.62it/s] 81%|████████  | 207/256 [00:45<00:10,  4.62it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.60it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.60it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.60it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.60it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.60it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.59it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.60it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.62it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.60it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.60it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.61it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.62it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.60it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.59it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.57it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.59it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.60it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.61it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.62it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.63it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.62it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.62it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.60it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.61it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.61it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.62it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.63it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.63it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.63it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.61it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.59it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.60it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.63it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.65it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.15it/s] 95%|█████████▍| 243/256 [00:53<00:03,  4.09it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.07it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.23it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.35it/s] 96%|█████████▋| 247/256 [00:54<00:02,  4.44it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.50it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.56it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.59it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.62it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.67it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.67it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.51it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [56.01, 39.8]
Multiscale SSIM on Highres [0.999, 0.975]
Range Invariant Multiscale SSIM on Highres [1.0, 0.988]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/stats_disentangle_2405_D18-M3-S0-L8_10.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/11
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode12
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/11


Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 366
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:46,  1.12s/it]  1%|          | 2/256 [00:01<02:30,  1.69it/s]  1%|          | 3/256 [00:01<01:46,  2.38it/s]  2%|▏         | 4/256 [00:01<01:25,  2.95it/s]  2%|▏         | 5/256 [00:01<01:13,  3.41it/s]  2%|▏         | 6/256 [00:02<01:06,  3.75it/s]  3%|▎         | 7/256 [00:02<01:02,  4.00it/s]  3%|▎         | 8/256 [00:02<00:59,  4.19it/s]  4%|▎         | 9/256 [00:02<00:57,  4.31it/s]  4%|▍         | 10/256 [00:03<00:55,  4.40it/s]  4%|▍         | 11/256 [00:03<00:54,  4.48it/s]  5%|▍         | 12/256 [00:03<00:53,  4.53it/s]  5%|▌         | 13/256 [00:03<00:56,  4.32it/s]  5%|▌         | 14/256 [00:04<00:57,  4.21it/s]  6%|▌         | 15/256 [00:04<00:58,  4.11it/s]  6%|▋         | 16/256 [00:04<00:56,  4.23it/s]  7%|▋         | 17/256 [00:04<00:54,  4.36it/s]  7%|▋         | 18/256 [00:04<00:53,  4.45it/s]  7%|▋         | 19/256 [00:05<00:52,  4.48it/s]  8%|▊         | 20/256 [00:05<00:51,  4.54it/s]  8%|▊         | 21/256 [00:05<00:51,  4.57it/s]  9%|▊         | 22/256 [00:05<00:50,  4.60it/s]  9%|▉         | 23/256 [00:05<00:50,  4.61it/s]  9%|▉         | 24/256 [00:06<00:50,  4.61it/s] 10%|▉         | 25/256 [00:06<00:50,  4.62it/s] 10%|█         | 26/256 [00:06<00:49,  4.61it/s] 11%|█         | 27/256 [00:06<00:49,  4.61it/s] 11%|█         | 28/256 [00:07<00:49,  4.62it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.62it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.62it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.63it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.63it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.60it/s] 14%|█▍        | 37/256 [00:09<00:47,  4.61it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.62it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.61it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.61it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.62it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.60it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.61it/s] 20%|██        | 52/256 [00:12<00:44,  4.60it/s] 21%|██        | 53/256 [00:12<00:44,  4.60it/s] 21%|██        | 54/256 [00:12<00:44,  4.59it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.59it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.60it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.60it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.60it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.61it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.62it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.61it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.62it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.61it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.61it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.62it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.60it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.58it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.59it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.60it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.62it/s] 30%|███       | 77/256 [00:17<00:38,  4.61it/s] 30%|███       | 78/256 [00:17<00:38,  4.62it/s] 31%|███       | 79/256 [00:18<00:38,  4.60it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.60it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.60it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.60it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.61it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.61it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.59it/s] 34%|███▎      | 86/256 [00:19<00:37,  4.58it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.59it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.60it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.60it/s] 35%|███▌      | 90/256 [00:20<00:36,  4.60it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.60it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.61it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.60it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.61it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.62it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.62it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.61it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.62it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.63it/s] 40%|████      | 103/256 [00:23<00:33,  4.62it/s] 41%|████      | 104/256 [00:23<00:32,  4.61it/s] 41%|████      | 105/256 [00:23<00:32,  4.61it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.61it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.62it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.62it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.62it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.61it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.61it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.61it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.62it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.61it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.60it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.61it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.61it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.61it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.61it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.60it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.60it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.60it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.61it/s] 50%|█████     | 128/256 [00:28<00:27,  4.61it/s] 50%|█████     | 129/256 [00:28<00:27,  4.62it/s] 51%|█████     | 130/256 [00:29<00:27,  4.60it/s] 51%|█████     | 131/256 [00:29<00:27,  4.58it/s] 52%|█████▏    | 132/256 [00:29<00:27,  4.59it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.56it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.53it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.54it/s] 53%|█████▎    | 136/256 [00:30<00:26,  4.55it/s] 54%|█████▎    | 137/256 [00:30<00:26,  4.49it/s] 54%|█████▍    | 138/256 [00:30<00:26,  4.51it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.53it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.55it/s] 55%|█████▌    | 141/256 [00:31<00:25,  4.57it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.58it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.59it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.59it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.60it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.60it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.57it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.58it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.59it/s] 59%|█████▊    | 150/256 [00:33<00:23,  4.59it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.57it/s] 59%|█████▉    | 152/256 [00:34<00:23,  4.35it/s] 60%|█████▉    | 153/256 [00:34<00:24,  4.21it/s] 60%|██████    | 154/256 [00:34<00:23,  4.31it/s] 61%|██████    | 155/256 [00:34<00:22,  4.40it/s] 61%|██████    | 156/256 [00:34<00:22,  4.46it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.51it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.54it/s] 62%|██████▏   | 159/256 [00:35<00:21,  4.57it/s] 62%|██████▎   | 160/256 [00:35<00:21,  4.56it/s] 63%|██████▎   | 161/256 [00:36<00:20,  4.57it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.59it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.59it/s] 64%|██████▍   | 164/256 [00:36<00:20,  4.59it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.57it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.58it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.59it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.61it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.59it/s] 66%|██████▋   | 170/256 [00:38<00:18,  4.59it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.60it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.60it/s] 68%|██████▊   | 173/256 [00:38<00:18,  4.60it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.61it/s] 68%|██████▊   | 175/256 [00:39<00:17,  4.61it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.62it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.56it/s] 70%|██████▉   | 178/256 [00:39<00:17,  4.57it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.57it/s] 70%|███████   | 180/256 [00:40<00:16,  4.58it/s] 71%|███████   | 181/256 [00:40<00:16,  4.60it/s] 71%|███████   | 182/256 [00:40<00:16,  4.61it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.62it/s] 72%|███████▏  | 184/256 [00:41<00:15,  4.57it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.59it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.54it/s] 73%|███████▎  | 187/256 [00:41<00:15,  4.55it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.57it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.58it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.56it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.51it/s] 75%|███████▌  | 192/256 [00:42<00:14,  4.56it/s] 75%|███████▌  | 193/256 [00:43<00:13,  4.59it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.59it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.60it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.61it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.62it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.62it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.61it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.61it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.62it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.61it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.59it/s] 80%|████████  | 205/256 [00:45<00:11,  4.60it/s] 80%|████████  | 206/256 [00:45<00:10,  4.60it/s] 81%|████████  | 207/256 [00:46<00:10,  4.60it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.61it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.59it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.59it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.60it/s] 83%|████████▎ | 212/256 [00:47<00:09,  4.60it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.61it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.61it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.62it/s] 84%|████████▍ | 216/256 [00:48<00:08,  4.62it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.63it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.62it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.55it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.56it/s] 86%|████████▋ | 221/256 [00:49<00:07,  4.38it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.44it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.49it/s] 88%|████████▊ | 224/256 [00:49<00:07,  4.49it/s] 88%|████████▊ | 225/256 [00:50<00:06,  4.54it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.56it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.59it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.60it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.58it/s] 90%|████████▉ | 230/256 [00:51<00:05,  4.58it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.58it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.59it/s] 91%|█████████ | 233/256 [00:51<00:05,  4.60it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.61it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.61it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.62it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.63it/s] 93%|█████████▎| 238/256 [00:53<00:05,  3.41it/s] 93%|█████████▎| 239/256 [00:53<00:04,  3.70it/s] 94%|█████████▍| 240/256 [00:53<00:04,  3.94it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.04it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.21it/s] 95%|█████████▍| 243/256 [00:54<00:03,  4.32it/s] 95%|█████████▌| 244/256 [00:54<00:02,  4.40it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.46it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.50it/s] 96%|█████████▋| 247/256 [00:55<00:01,  4.53it/s] 97%|█████████▋| 248/256 [00:55<00:01,  4.55it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.55it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.58it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.57it/s] 98%|█████████▊| 252/256 [00:56<00:00,  4.58it/s] 99%|█████████▉| 253/256 [00:56<00:00,  4.59it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.60it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.61it/s]100%|██████████| 256/256 [00:57<00:00,  4.61it/s]100%|██████████| 256/256 [00:57<00:00,  4.47it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [44.08, 45.49]
Multiscale SSIM on Highres [0.995, 0.995]
Range Invariant Multiscale SSIM on Highres [0.996, 0.995]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/stats_disentangle_2405_D18-M3-S0-L8_11.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/12
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode15
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/12


Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 399
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:44,  1.12s/it]  1%|          | 2/256 [00:01<02:29,  1.70it/s]  1%|          | 3/256 [00:01<01:45,  2.39it/s]  2%|▏         | 4/256 [00:01<01:25,  2.96it/s]  2%|▏         | 5/256 [00:01<01:13,  3.40it/s]  2%|▏         | 6/256 [00:02<01:06,  3.75it/s]  3%|▎         | 7/256 [00:02<01:02,  4.00it/s]  3%|▎         | 8/256 [00:02<00:59,  4.19it/s]  4%|▎         | 9/256 [00:02<00:57,  4.32it/s]  4%|▍         | 10/256 [00:03<00:55,  4.41it/s]  4%|▍         | 11/256 [00:03<00:54,  4.49it/s]  5%|▍         | 12/256 [00:03<00:53,  4.55it/s]  5%|▌         | 13/256 [00:03<00:53,  4.58it/s]  5%|▌         | 14/256 [00:03<00:55,  4.37it/s]  6%|▌         | 15/256 [00:04<00:56,  4.23it/s]  6%|▋         | 16/256 [00:04<00:58,  4.13it/s]  7%|▋         | 17/256 [00:04<00:56,  4.25it/s]  7%|▋         | 18/256 [00:04<00:54,  4.35it/s]  7%|▋         | 19/256 [00:05<00:53,  4.43it/s]  8%|▊         | 20/256 [00:05<00:52,  4.50it/s]  8%|▊         | 21/256 [00:05<00:51,  4.54it/s]  9%|▊         | 22/256 [00:05<00:51,  4.58it/s]  9%|▉         | 23/256 [00:05<00:50,  4.58it/s]  9%|▉         | 24/256 [00:06<00:51,  4.54it/s] 10%|▉         | 25/256 [00:06<00:50,  4.56it/s] 10%|█         | 26/256 [00:06<00:50,  4.59it/s] 11%|█         | 27/256 [00:06<00:49,  4.61it/s] 11%|█         | 28/256 [00:07<00:50,  4.55it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.58it/s] 12%|█▏        | 30/256 [00:07<00:49,  4.59it/s] 12%|█▏        | 31/256 [00:07<00:49,  4.59it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.60it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.59it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.60it/s] 14%|█▎        | 35/256 [00:08<00:48,  4.60it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.60it/s] 14%|█▍        | 37/256 [00:09<00:47,  4.61it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.61it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.60it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.61it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.60it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.60it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.59it/s] 17%|█▋        | 44/256 [00:10<00:46,  4.60it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.60it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.60it/s] 20%|██        | 52/256 [00:12<00:44,  4.60it/s] 21%|██        | 53/256 [00:12<00:44,  4.61it/s] 21%|██        | 54/256 [00:12<00:43,  4.61it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.60it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.60it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.59it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.60it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.59it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.58it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.60it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.59it/s] 25%|██▍       | 63/256 [00:14<00:42,  4.57it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.59it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.60it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.61it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.60it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.59it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.58it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.60it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.60it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.60it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.60it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.61it/s] 30%|███       | 77/256 [00:17<00:38,  4.61it/s] 30%|███       | 78/256 [00:17<00:38,  4.61it/s] 31%|███       | 79/256 [00:18<00:38,  4.62it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.55it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.57it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.58it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.58it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.55it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.56it/s] 34%|███▎      | 86/256 [00:19<00:37,  4.56it/s] 34%|███▍      | 87/256 [00:19<00:37,  4.56it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.57it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.58it/s] 35%|███▌      | 90/256 [00:20<00:36,  4.59it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.59it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.60it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.59it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.60it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.58it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.59it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.59it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.60it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.60it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.61it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.61it/s] 40%|████      | 103/256 [00:23<00:33,  4.61it/s] 41%|████      | 104/256 [00:23<00:32,  4.61it/s] 41%|████      | 105/256 [00:23<00:32,  4.63it/s] 41%|████▏     | 106/256 [00:24<00:32,  4.62it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.61it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.58it/s] 43%|████▎     | 109/256 [00:24<00:32,  4.59it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.61it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.61it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.61it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.59it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.60it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.59it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.59it/s] 46%|████▌     | 118/256 [00:26<00:30,  4.60it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.59it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.60it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.60it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.59it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.59it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.59it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.61it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.60it/s] 50%|████▉     | 127/256 [00:28<00:28,  4.60it/s] 50%|█████     | 128/256 [00:28<00:27,  4.59it/s] 50%|█████     | 129/256 [00:29<00:27,  4.59it/s] 51%|█████     | 130/256 [00:29<00:27,  4.59it/s] 51%|█████     | 131/256 [00:29<00:27,  4.60it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.61it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.59it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.60it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.63it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.66it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.66it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.66it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.67it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.65it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.66it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.66it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.64it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.65it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.64it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.64it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.63it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.64it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.65it/s] 59%|█████▉    | 152/256 [00:34<00:23,  4.34it/s] 60%|█████▉    | 153/256 [00:34<00:24,  4.19it/s] 60%|██████    | 154/256 [00:34<00:24,  4.16it/s] 61%|██████    | 155/256 [00:34<00:23,  4.29it/s] 61%|██████    | 156/256 [00:34<00:22,  4.39it/s] 61%|██████▏   | 157/256 [00:35<00:22,  4.47it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.51it/s] 62%|██████▏   | 159/256 [00:35<00:21,  4.57it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.60it/s] 63%|██████▎   | 161/256 [00:36<00:20,  4.62it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.51it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.54it/s] 64%|██████▍   | 164/256 [00:36<00:20,  4.57it/s] 64%|██████▍   | 165/256 [00:36<00:20,  4.52it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.56it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.59it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.62it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.63it/s] 66%|██████▋   | 170/256 [00:38<00:18,  4.63it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.63it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.61it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.62it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.63it/s] 68%|██████▊   | 175/256 [00:39<00:17,  4.65it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.64it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.64it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.63it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.64it/s] 70%|███████   | 180/256 [00:40<00:16,  4.64it/s] 71%|███████   | 181/256 [00:40<00:16,  4.65it/s] 71%|███████   | 182/256 [00:40<00:15,  4.66it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.65it/s] 72%|███████▏  | 184/256 [00:41<00:15,  4.66it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.65it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.66it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.65it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.64it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.65it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.61it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.62it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.63it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.63it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.63it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.64it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.64it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.65it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.66it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.66it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.67it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.66it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.67it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.66it/s] 80%|████████  | 205/256 [00:45<00:10,  4.66it/s] 80%|████████  | 206/256 [00:45<00:10,  4.67it/s] 81%|████████  | 207/256 [00:45<00:10,  4.66it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.66it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.65it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.65it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 212/256 [00:47<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.66it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.66it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.65it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.65it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.65it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.66it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.65it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.65it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.66it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.64it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.63it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.63it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.64it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.66it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.66it/s] 89%|████████▉ | 228/256 [00:50<00:05,  4.67it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.53it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.55it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.58it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.61it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.61it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.62it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.61it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.64it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.65it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.64it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.65it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.64it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.65it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.65it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.64it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.63it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.63it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.61it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.62it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.62it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.63it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.64it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.64it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.66it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.65it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.66it/s]100%|██████████| 256/256 [00:56<00:00,  4.51it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [40.75, 38.83]
Multiscale SSIM on Highres [0.988, 0.982]
Range Invariant Multiscale SSIM on Highres [0.989, 0.983]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/stats_disentangle_2405_D18-M3-S0-L8_12.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.55/kth_1/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif
data:
  background_quantile: 0.0
  channel_idx_list:
  - GT_Cy5
  - GT_TRITC
  - 555-647
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/6
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: caa1d41d654fb423a7c3abc700486f87d132a2f7
  untracked_files: []
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/6

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Train

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Test

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 93
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.13s/it]  5%|▌         | 2/40 [00:01<00:22,  1.67it/s]  8%|▊         | 3/40 [00:01<00:15,  2.36it/s] 10%|█         | 4/40 [00:01<00:12,  2.92it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.34it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.68it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.95it/s] 20%|██        | 8/40 [00:02<00:07,  4.15it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.29it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.37it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.45it/s] 30%|███       | 12/40 [00:03<00:06,  4.48it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.52it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.54it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.55it/s] 40%|████      | 16/40 [00:04<00:05,  4.56it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.57it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.58it/s] 50%|█████     | 20/40 [00:05<00:04,  4.60it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.59it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.58it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.58it/s] 60%|██████    | 24/40 [00:06<00:03,  4.61it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.59it/s] 70%|███████   | 28/40 [00:07<00:02,  4.59it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.56it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.58it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.60it/s] 80%|████████  | 32/40 [00:07<00:01,  4.60it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.16it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [41.93, 31.23]
Multiscale SSIM on Highres [0.984, 0.953]
Range Invariant Multiscale SSIM on Highres [0.985, 0.955]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/stats_disentangle_2404_D21-M3-S0-L8_6.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  - 9
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/120
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/120

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]  5%|▌         | 2/40 [00:01<00:22,  1.72it/s]  8%|▊         | 3/40 [00:01<00:15,  2.41it/s] 10%|█         | 4/40 [00:01<00:12,  2.97it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.41it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.74it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.00it/s] 20%|██        | 8/40 [00:02<00:07,  4.20it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.42it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.46it/s] 30%|███       | 12/40 [00:03<00:06,  4.51it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.57it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.58it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.60it/s] 40%|████      | 16/40 [00:04<00:05,  4.58it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.36it/s] 45%|████▌     | 18/40 [00:04<00:05,  4.19it/s] 48%|████▊     | 19/40 [00:05<00:05,  4.18it/s] 50%|█████     | 20/40 [00:05<00:04,  4.30it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.39it/s] 55%|█████▌    | 22/40 [00:05<00:04,  4.47it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.52it/s] 60%|██████    | 24/40 [00:06<00:03,  4.55it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.57it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.62it/s] 70%|███████   | 28/40 [00:07<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.63it/s] 80%|████████  | 32/40 [00:07<00:01,  4.64it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.64it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.64it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.62it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.59it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.60it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.15it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.91, 33.62]
Multiscale SSIM on Highres [0.806, 0.949]
Range Invariant Multiscale SSIM on Highres [0.809, 0.949]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/stats_disentangle_2404_D25-M3-S0-L8_120.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  - 10
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/111
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/111

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 334
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]  5%|▌         | 2/40 [00:01<00:22,  1.70it/s]  8%|▊         | 3/40 [00:01<00:15,  2.39it/s] 10%|█         | 4/40 [00:01<00:12,  2.97it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.42it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.76it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.01it/s] 20%|██        | 8/40 [00:02<00:07,  4.19it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.43it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.48it/s] 30%|███       | 12/40 [00:03<00:06,  4.53it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.57it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.59it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.58it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.61it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.61it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.61it/s] 50%|█████     | 20/40 [00:05<00:04,  4.62it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.63it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.63it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.63it/s] 60%|██████    | 24/40 [00:06<00:03,  4.61it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.62it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.62it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.64it/s] 70%|███████   | 28/40 [00:06<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.62it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.61it/s] 80%|████████  | 32/40 [00:07<00:01,  4.63it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.62it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.63it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.62it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.63it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.62it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.63it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.64it/s]100%|██████████| 40/40 [00:09<00:00,  4.19it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.87, 38.98]
Multiscale SSIM on Highres [0.805, 0.982]
Range Invariant Multiscale SSIM on Highres [0.805, 0.982]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/stats_disentangle_2404_D25-M3-S0-L8_111.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  - 11
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/125
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/125

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 279
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:39,  1.01s/it]  5%|▌         | 2/40 [00:01<00:20,  1.85it/s]  8%|▊         | 3/40 [00:01<00:14,  2.51it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.49it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.80it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.03it/s] 20%|██        | 8/40 [00:02<00:07,  4.21it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.42it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.50it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.53it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.60it/s] 40%|████      | 16/40 [00:04<00:05,  4.61it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.60it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.61it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.62it/s] 50%|█████     | 20/40 [00:05<00:04,  4.62it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.61it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.60it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.59it/s] 60%|██████    | 24/40 [00:06<00:03,  4.60it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.60it/s] 70%|███████   | 28/40 [00:06<00:02,  4.60it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.60it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.60it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.59it/s] 80%|████████  | 32/40 [00:07<00:01,  4.60it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.58it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.59it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.58it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.58it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.60it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.23it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.87, 29.78]
Multiscale SSIM on Highres [0.883, 0.886]
Range Invariant Multiscale SSIM on Highres [0.885, 0.886]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/stats_disentangle_2404_D25-M3-S0-L8_125.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  - 12
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/139
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/139

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 375
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.04s/it]  5%|▌         | 2/40 [00:01<00:21,  1.81it/s]  8%|▊         | 3/40 [00:01<00:14,  2.51it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.49it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.81it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.03it/s] 20%|██        | 8/40 [00:02<00:07,  4.19it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.33it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.41it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.53it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.56it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.59it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.38it/s] 40%|████      | 16/40 [00:04<00:05,  4.24it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.33it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.43it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.41it/s] 50%|█████     | 20/40 [00:05<00:04,  4.48it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.52it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.53it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.56it/s] 60%|██████    | 24/40 [00:06<00:03,  4.57it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.59it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.60it/s] 70%|███████   | 28/40 [00:06<00:02,  4.52it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.46it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.50it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.53it/s] 80%|████████  | 32/40 [00:07<00:01,  4.56it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.56it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.56it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.58it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.58it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.59it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.59it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.19it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.15, 37.08]
Multiscale SSIM on Highres [0.849, 0.959]
Range Invariant Multiscale SSIM on Highres [0.858, 0.963]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/stats_disentangle_2404_D25-M3-S0-L8_139.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  - 13
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/143
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/143

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 223
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:38,  1.00it/s]  5%|▌         | 2/40 [00:01<00:20,  1.83it/s]  8%|▊         | 3/40 [00:01<00:14,  2.53it/s] 10%|█         | 4/40 [00:01<00:11,  3.08it/s] 12%|█▎        | 5/40 [00:01<00:09,  3.50it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.83it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.07it/s] 20%|██        | 8/40 [00:02<00:07,  4.23it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.35it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.44it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.50it/s] 30%|███       | 12/40 [00:03<00:06,  4.54it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.58it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.59it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.60it/s] 40%|████      | 16/40 [00:04<00:05,  4.63it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.65it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.65it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.64it/s] 50%|█████     | 20/40 [00:05<00:04,  4.64it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.64it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.63it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:05<00:03,  4.62it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.62it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.63it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.62it/s] 70%|███████   | 28/40 [00:06<00:02,  4.62it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.62it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.62it/s] 80%|████████  | 32/40 [00:07<00:01,  4.64it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.63it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.63it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.62it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:08<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.63it/s]100%|██████████| 40/40 [00:09<00:00,  4.26it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [31.13, 37.83]
Multiscale SSIM on Highres [0.904, 0.97]
Range Invariant Multiscale SSIM on Highres [0.908, 0.97]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/stats_disentangle_2404_D25-M3-S0-L8_143.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.55/kth_1/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif

##################################
Predicting 2th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:39,  1.02s/it]  5%|▌         | 2/40 [00:01<00:21,  1.79it/s]  8%|▊         | 3/40 [00:01<00:14,  2.48it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.47it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.80it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.03it/s] 20%|██        | 8/40 [00:02<00:07,  4.20it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.41it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.45it/s] 30%|███       | 12/40 [00:03<00:06,  4.50it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.53it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.55it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.56it/s] 40%|████      | 16/40 [00:04<00:05,  4.59it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.60it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.61it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.60it/s] 50%|█████     | 20/40 [00:05<00:04,  4.61it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.61it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.61it/s] 60%|██████    | 24/40 [00:06<00:03,  4.61it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.35it/s] 68%|██████▊   | 27/40 [00:06<00:03,  4.20it/s] 70%|███████   | 28/40 [00:07<00:02,  4.13it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.28it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.39it/s] 78%|███████▊  | 31/40 [00:07<00:02,  4.45it/s] 80%|████████  | 32/40 [00:07<00:01,  4.52it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.55it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.57it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.63it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.63it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.64it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.64it/s]100%|██████████| 40/40 [00:09<00:00,  4.19it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_2/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [44.67, 34.44]
Multiscale SSIM on Highres [0.99, 0.972]
Range Invariant Multiscale SSIM on Highres [0.99, 0.973]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_2/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_2/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:01<00:15,  1.01s/it] 12%|█▎        | 2/16 [00:01<00:07,  1.81it/s] 19%|█▉        | 3/16 [00:01<00:05,  2.50it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.05it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.49it/s] 38%|███▊      | 6/16 [00:02<00:02,  3.81it/s] 44%|████▍     | 7/16 [00:02<00:02,  4.04it/s] 50%|█████     | 8/16 [00:02<00:01,  4.20it/s] 56%|█████▋    | 9/16 [00:02<00:01,  4.32it/s] 62%|██████▎   | 10/16 [00:02<00:01,  4.41it/s] 69%|██████▉   | 11/16 [00:03<00:01,  4.48it/s] 75%|███████▌  | 12/16 [00:03<00:00,  4.51it/s] 81%|████████▏ | 13/16 [00:03<00:00,  4.55it/s] 88%|████████▊ | 14/16 [00:03<00:00,  4.56it/s] 94%|█████████▍| 15/16 [00:04<00:00,  4.58it/s]100%|██████████| 16/16 [00:04<00:00,  4.60it/s]100%|██████████| 16/16 [00:04<00:00,  3.62it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [34.62, 34.14]
Multiscale SSIM on Highres [0.886, 0.863]
Range Invariant Multiscale SSIM on Highres [0.946, 0.894]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:32,  1.15it/s]  5%|▌         | 2/38 [00:01<00:17,  2.05it/s]  8%|▊         | 3/38 [00:01<00:12,  2.75it/s] 11%|█         | 4/38 [00:01<00:10,  3.27it/s] 13%|█▎        | 5/38 [00:01<00:09,  3.66it/s] 16%|█▌        | 6/38 [00:01<00:08,  3.94it/s] 18%|█▊        | 7/38 [00:02<00:07,  4.15it/s] 21%|██        | 8/38 [00:02<00:06,  4.29it/s] 24%|██▎       | 9/38 [00:02<00:06,  4.39it/s] 26%|██▋       | 10/38 [00:02<00:06,  4.47it/s] 29%|██▉       | 11/38 [00:03<00:05,  4.50it/s] 32%|███▏      | 12/38 [00:03<00:05,  4.51it/s] 34%|███▍      | 13/38 [00:03<00:05,  4.54it/s] 37%|███▋      | 14/38 [00:03<00:05,  4.53it/s] 39%|███▉      | 15/38 [00:03<00:05,  4.28it/s] 42%|████▏     | 16/38 [00:04<00:05,  4.38it/s] 45%|████▍     | 17/38 [00:04<00:04,  4.45it/s] 47%|████▋     | 18/38 [00:04<00:04,  4.51it/s] 50%|█████     | 19/38 [00:04<00:04,  4.55it/s] 53%|█████▎    | 20/38 [00:05<00:03,  4.57it/s] 55%|█████▌    | 21/38 [00:05<00:03,  4.58it/s] 58%|█████▊    | 22/38 [00:05<00:03,  4.59it/s] 61%|██████    | 23/38 [00:05<00:03,  4.61it/s] 63%|██████▎   | 24/38 [00:05<00:03,  4.61it/s] 66%|██████▌   | 25/38 [00:06<00:02,  4.60it/s] 68%|██████▊   | 26/38 [00:06<00:02,  4.61it/s] 71%|███████   | 27/38 [00:06<00:02,  4.60it/s] 74%|███████▎  | 28/38 [00:06<00:02,  4.61it/s] 76%|███████▋  | 29/38 [00:06<00:01,  4.61it/s] 79%|███████▉  | 30/38 [00:07<00:01,  4.61it/s] 82%|████████▏ | 31/38 [00:07<00:01,  4.60it/s] 84%|████████▍ | 32/38 [00:07<00:01,  4.60it/s] 87%|████████▋ | 33/38 [00:07<00:01,  4.61it/s] 89%|████████▉ | 34/38 [00:08<00:00,  4.60it/s] 92%|█████████▏| 35/38 [00:08<00:00,  4.58it/s] 95%|█████████▍| 36/38 [00:08<00:00,  4.59it/s] 97%|█████████▋| 37/38 [00:08<00:00,  4.61it/s]100%|██████████| 38/38 [00:08<00:00,  5.34it/s]100%|██████████| 38/38 [00:08<00:00,  4.24it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F12.54/kth_2/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [28.41, 25.96]
Multiscale SSIM on Highres [0.755, 0.82]
Range Invariant Multiscale SSIM on Highres [0.903, 0.824]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F12.54/kth_2/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F12.54/kth_2/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:35,  1.09it/s]  5%|▌         | 2/40 [00:01<00:19,  1.97it/s]  8%|▊         | 3/40 [00:01<00:13,  2.66it/s] 10%|█         | 4/40 [00:01<00:11,  3.19it/s] 12%|█▎        | 5/40 [00:01<00:09,  3.59it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.89it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.10it/s] 20%|██        | 8/40 [00:02<00:07,  4.26it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.33it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.39it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.46it/s] 30%|███       | 12/40 [00:03<00:06,  4.48it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.52it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.54it/s] 38%|███▊      | 15/40 [00:03<00:05,  4.55it/s] 40%|████      | 16/40 [00:04<00:05,  4.57it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.59it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.60it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.60it/s] 50%|█████     | 20/40 [00:05<00:04,  4.61it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.61it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.59it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.59it/s] 60%|██████    | 24/40 [00:05<00:03,  4.59it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.58it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.58it/s] 70%|███████   | 28/40 [00:06<00:02,  4.59it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.62it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.64it/s] 80%|████████  | 32/40 [00:07<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.62it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.61it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.62it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.61it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.63it/s] 95%|█████████▌| 38/40 [00:08<00:00,  4.63it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.63it/s]100%|██████████| 40/40 [00:09<00:00,  4.29it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.52, 30.57]
Multiscale SSIM on Highres [0.774, 0.902]
Range Invariant Multiscale SSIM on Highres [0.776, 0.904]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<04:00,  1.06it/s]  1%|          | 2/256 [00:01<02:11,  1.94it/s]  1%|          | 3/256 [00:01<01:35,  2.64it/s]  2%|▏         | 4/256 [00:01<01:18,  3.19it/s]  2%|▏         | 5/256 [00:01<01:09,  3.60it/s]  2%|▏         | 6/256 [00:02<01:04,  3.90it/s]  3%|▎         | 7/256 [00:02<01:00,  4.10it/s]  3%|▎         | 8/256 [00:02<00:58,  4.25it/s]  4%|▎         | 9/256 [00:02<00:56,  4.36it/s]  4%|▍         | 10/256 [00:02<00:55,  4.44it/s]  4%|▍         | 11/256 [00:03<00:54,  4.50it/s]  5%|▍         | 12/256 [00:03<00:53,  4.53it/s]  5%|▌         | 13/256 [00:03<00:53,  4.55it/s]  5%|▌         | 14/256 [00:03<00:52,  4.57it/s]  6%|▌         | 15/256 [00:03<00:52,  4.57it/s]  6%|▋         | 16/256 [00:04<00:52,  4.59it/s]  7%|▋         | 17/256 [00:04<00:51,  4.60it/s]  7%|▋         | 18/256 [00:04<00:51,  4.61it/s]  7%|▋         | 19/256 [00:04<00:51,  4.61it/s]  8%|▊         | 20/256 [00:05<00:50,  4.64it/s]  8%|▊         | 21/256 [00:05<00:50,  4.64it/s]  9%|▊         | 22/256 [00:05<00:50,  4.64it/s]  9%|▉         | 23/256 [00:05<00:50,  4.62it/s]  9%|▉         | 24/256 [00:05<00:50,  4.60it/s] 10%|▉         | 25/256 [00:06<00:50,  4.60it/s] 10%|█         | 26/256 [00:06<00:49,  4.61it/s] 11%|█         | 27/256 [00:06<00:49,  4.62it/s] 11%|█         | 28/256 [00:06<00:49,  4.63it/s] 11%|█▏        | 29/256 [00:06<00:48,  4.66it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.66it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.67it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.66it/s] 13%|█▎        | 33/256 [00:07<00:47,  4.67it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.67it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.66it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.67it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.67it/s] 15%|█▍        | 38/256 [00:08<00:46,  4.66it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.65it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.65it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.64it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.65it/s] 17%|█▋        | 43/256 [00:09<00:45,  4.64it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.66it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.67it/s] 18%|█▊        | 46/256 [00:10<00:44,  4.67it/s] 18%|█▊        | 47/256 [00:10<00:44,  4.66it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.68it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.66it/s] 20%|██        | 52/256 [00:11<00:43,  4.65it/s] 21%|██        | 53/256 [00:12<00:43,  4.64it/s] 21%|██        | 54/256 [00:12<00:43,  4.64it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.65it/s] 22%|██▏       | 56/256 [00:12<00:42,  4.66it/s] 22%|██▏       | 57/256 [00:12<00:42,  4.67it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.67it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.65it/s] 24%|██▍       | 61/256 [00:13<00:42,  4.56it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.54it/s] 25%|██▍       | 63/256 [00:14<00:44,  4.32it/s] 25%|██▌       | 64/256 [00:14<00:43,  4.43it/s] 25%|██▌       | 65/256 [00:14<00:42,  4.51it/s] 26%|██▌       | 66/256 [00:14<00:41,  4.57it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.61it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.56it/s] 27%|██▋       | 70/256 [00:15<00:40,  4.59it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.62it/s] 28%|██▊       | 72/256 [00:16<00:40,  4.58it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.60it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.61it/s] 29%|██▉       | 75/256 [00:16<00:39,  4.62it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.63it/s] 30%|███       | 77/256 [00:17<00:38,  4.64it/s] 30%|███       | 78/256 [00:17<00:38,  4.66it/s] 31%|███       | 79/256 [00:17<00:38,  4.65it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.67it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.67it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.68it/s] 32%|███▏      | 83/256 [00:18<00:36,  4.68it/s] 33%|███▎      | 84/256 [00:18<00:36,  4.67it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.67it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.67it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.66it/s] 34%|███▍      | 88/256 [00:19<00:35,  4.67it/s] 35%|███▍      | 89/256 [00:19<00:35,  4.67it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.67it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.66it/s] 36%|███▋      | 93/256 [00:20<00:34,  4.67it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.67it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.68it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.66it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.67it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.68it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.68it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.66it/s] 40%|████      | 103/256 [00:22<00:32,  4.66it/s] 41%|████      | 104/256 [00:23<00:32,  4.67it/s] 41%|████      | 105/256 [00:23<00:32,  4.67it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.66it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.66it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.68it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.68it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.66it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.68it/s] 45%|████▌     | 116/256 [00:25<00:29,  4.68it/s] 46%|████▌     | 117/256 [00:25<00:29,  4.69it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.68it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.66it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.66it/s] 47%|████▋     | 121/256 [00:26<00:28,  4.67it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.68it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.69it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.68it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.66it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.66it/s] 50%|█████     | 128/256 [00:28<00:27,  4.67it/s] 50%|█████     | 129/256 [00:28<00:27,  4.66it/s] 51%|█████     | 130/256 [00:28<00:27,  4.65it/s] 51%|█████     | 131/256 [00:28<00:26,  4.66it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.67it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.65it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.66it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.68it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.68it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.67it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.66it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.67it/s] 55%|█████▍    | 140/256 [00:30<00:24,  4.66it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.68it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.69it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.69it/s] 56%|█████▋    | 144/256 [00:31<00:23,  4.68it/s] 57%|█████▋    | 145/256 [00:31<00:23,  4.68it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.68it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.68it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 149/256 [00:32<00:22,  4.67it/s] 59%|█████▊    | 150/256 [00:32<00:22,  4.67it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.66it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.66it/s] 60%|██████    | 154/256 [00:33<00:21,  4.66it/s] 61%|██████    | 155/256 [00:34<00:21,  4.67it/s] 61%|██████    | 156/256 [00:34<00:21,  4.65it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.66it/s] 62%|██████▏   | 158/256 [00:34<00:21,  4.66it/s] 62%|██████▏   | 159/256 [00:34<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.67it/s] 64%|██████▎   | 163/256 [00:35<00:19,  4.65it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.66it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.67it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.67it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.67it/s] 66%|██████▌   | 168/256 [00:36<00:18,  4.66it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.67it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.68it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.68it/s] 67%|██████▋   | 172/256 [00:37<00:17,  4.67it/s] 68%|██████▊   | 173/256 [00:37<00:17,  4.66it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.66it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.68it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.67it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.66it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.66it/s] 70%|███████   | 180/256 [00:39<00:16,  4.65it/s] 71%|███████   | 181/256 [00:39<00:16,  4.67it/s] 71%|███████   | 182/256 [00:39<00:15,  4.68it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.68it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.68it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.68it/s] 73%|███████▎  | 186/256 [00:40<00:14,  4.69it/s] 73%|███████▎  | 187/256 [00:40<00:14,  4.68it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.67it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.68it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.68it/s] 75%|███████▍  | 191/256 [00:41<00:13,  4.67it/s] 75%|███████▌  | 192/256 [00:41<00:13,  4.67it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.67it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.67it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.66it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.67it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.67it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.68it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.67it/s] 78%|███████▊  | 200/256 [00:43<00:12,  4.66it/s] 79%|███████▊  | 201/256 [00:43<00:12,  4.27it/s] 79%|███████▉  | 202/256 [00:44<00:12,  4.16it/s] 79%|███████▉  | 203/256 [00:44<00:12,  4.30it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.39it/s] 80%|████████  | 205/256 [00:44<00:11,  4.46it/s] 80%|████████  | 206/256 [00:45<00:11,  4.53it/s] 81%|████████  | 207/256 [00:45<00:10,  4.58it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.61it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.64it/s] 82%|████████▏ | 210/256 [00:45<00:09,  4.66it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.67it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.67it/s] 84%|████████▎ | 214/256 [00:46<00:08,  4.68it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.67it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.60it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.61it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.61it/s] 86%|████████▌ | 219/256 [00:47<00:07,  4.63it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.63it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.63it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.64it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.64it/s] 88%|████████▊ | 224/256 [00:48<00:06,  4.66it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.66it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.65it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.62it/s] 89%|████████▉ | 228/256 [00:49<00:06,  4.63it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.64it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.64it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.64it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.62it/s] 91%|█████████ | 233/256 [00:50<00:04,  4.64it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.65it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.65it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.64it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.64it/s] 93%|█████████▎| 238/256 [00:51<00:03,  4.64it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.65it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.65it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.62it/s] 95%|█████████▍| 242/256 [00:52<00:03,  4.63it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.64it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.64it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.64it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.64it/s] 96%|█████████▋| 247/256 [00:53<00:01,  4.64it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.63it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.62it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.62it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.63it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.64it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.63it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.64it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.65it/s]100%|██████████| 256/256 [00:55<00:00,  4.64it/s]100%|██████████| 256/256 [00:55<00:00,  4.57it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [42.1, 41.43]
Multiscale SSIM on Highres [0.989, 0.994]
Range Invariant Multiscale SSIM on Highres [0.99, 0.994]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<04:02,  1.05it/s]  1%|          | 2/256 [00:01<02:12,  1.92it/s]  1%|          | 3/256 [00:01<01:36,  2.63it/s]  2%|▏         | 4/256 [00:01<01:19,  3.18it/s]  2%|▏         | 5/256 [00:01<01:09,  3.59it/s]  2%|▏         | 6/256 [00:02<01:04,  3.89it/s]  3%|▎         | 7/256 [00:02<01:00,  4.11it/s]  3%|▎         | 8/256 [00:02<00:58,  4.27it/s]  4%|▎         | 9/256 [00:02<00:56,  4.39it/s]  4%|▍         | 10/256 [00:02<00:55,  4.47it/s]  4%|▍         | 11/256 [00:03<00:54,  4.53it/s]  5%|▍         | 12/256 [00:03<00:53,  4.57it/s]  5%|▌         | 13/256 [00:03<00:52,  4.59it/s]  5%|▌         | 14/256 [00:03<00:52,  4.61it/s]  6%|▌         | 15/256 [00:03<00:52,  4.60it/s]  6%|▋         | 16/256 [00:04<00:51,  4.63it/s]  7%|▋         | 17/256 [00:04<00:51,  4.64it/s]  7%|▋         | 18/256 [00:04<00:51,  4.64it/s]  7%|▋         | 19/256 [00:04<00:51,  4.64it/s]  8%|▊         | 20/256 [00:05<00:50,  4.64it/s]  8%|▊         | 21/256 [00:05<00:50,  4.62it/s]  9%|▊         | 22/256 [00:05<00:50,  4.61it/s]  9%|▉         | 23/256 [00:05<00:50,  4.61it/s]  9%|▉         | 24/256 [00:05<00:50,  4.62it/s] 10%|▉         | 25/256 [00:06<00:49,  4.63it/s] 10%|█         | 26/256 [00:06<00:49,  4.62it/s] 11%|█         | 27/256 [00:06<00:49,  4.62it/s] 11%|█         | 28/256 [00:06<00:49,  4.62it/s] 11%|█▏        | 29/256 [00:06<00:48,  4.65it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.65it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.66it/s] 12%|█▎        | 32/256 [00:07<00:47,  4.67it/s] 13%|█▎        | 33/256 [00:07<00:47,  4.66it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.67it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.68it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.68it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.67it/s] 15%|█▍        | 38/256 [00:08<00:46,  4.67it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.67it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.68it/s] 16%|█▌        | 41/256 [00:09<00:45,  4.69it/s] 16%|█▋        | 42/256 [00:09<00:45,  4.69it/s] 17%|█▋        | 43/256 [00:09<00:45,  4.69it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.69it/s] 18%|█▊        | 45/256 [00:10<00:44,  4.69it/s] 18%|█▊        | 46/256 [00:10<00:44,  4.70it/s] 18%|█▊        | 47/256 [00:10<00:44,  4.67it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.67it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.66it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.66it/s] 20%|██        | 52/256 [00:11<00:43,  4.65it/s] 21%|██        | 53/256 [00:12<00:43,  4.66it/s] 21%|██        | 54/256 [00:12<00:43,  4.66it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.64it/s] 22%|██▏       | 56/256 [00:12<00:42,  4.65it/s] 22%|██▏       | 57/256 [00:12<00:42,  4.66it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.67it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.65it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.65it/s] 24%|██▍       | 61/256 [00:13<00:41,  4.67it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.67it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.66it/s] 25%|██▌       | 65/256 [00:14<00:40,  4.67it/s] 26%|██▌       | 66/256 [00:14<00:40,  4.67it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.63it/s] 27%|██▋       | 68/256 [00:15<00:43,  4.35it/s] 27%|██▋       | 69/256 [00:15<00:44,  4.22it/s] 27%|██▋       | 70/256 [00:15<00:42,  4.33it/s] 28%|██▊       | 71/256 [00:16<00:41,  4.43it/s] 28%|██▊       | 72/256 [00:16<00:40,  4.51it/s] 29%|██▊       | 73/256 [00:16<00:40,  4.56it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.59it/s] 29%|██▉       | 75/256 [00:16<00:39,  4.61it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.57it/s] 30%|███       | 77/256 [00:17<00:39,  4.59it/s] 30%|███       | 78/256 [00:17<00:38,  4.62it/s] 31%|███       | 79/256 [00:17<00:38,  4.64it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.66it/s] 33%|███▎      | 84/256 [00:18<00:36,  4.67it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.66it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.67it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.67it/s] 34%|███▍      | 88/256 [00:19<00:35,  4.68it/s] 35%|███▍      | 89/256 [00:19<00:35,  4.66it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.66it/s] 36%|███▋      | 93/256 [00:20<00:34,  4.67it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.67it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.67it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.67it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.67it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.65it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.66it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.65it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.65it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.65it/s] 40%|████      | 103/256 [00:22<00:32,  4.66it/s] 41%|████      | 104/256 [00:23<00:32,  4.66it/s] 41%|████      | 105/256 [00:23<00:32,  4.67it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.66it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.66it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.66it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.66it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.66it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.67it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.67it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.66it/s] 45%|████▌     | 116/256 [00:25<00:30,  4.67it/s] 46%|████▌     | 117/256 [00:25<00:29,  4.67it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.68it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.68it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.68it/s] 47%|████▋     | 121/256 [00:26<00:28,  4.68it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.66it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.67it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.67it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.66it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.67it/s] 50%|█████     | 128/256 [00:28<00:27,  4.67it/s] 50%|█████     | 129/256 [00:28<00:27,  4.67it/s] 51%|█████     | 130/256 [00:28<00:26,  4.68it/s] 51%|█████     | 131/256 [00:28<00:26,  4.69it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.68it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.68it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.68it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.67it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.66it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.67it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.67it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.66it/s] 55%|█████▍    | 140/256 [00:30<00:24,  4.67it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.67it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.67it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.66it/s] 56%|█████▋    | 144/256 [00:31<00:24,  4.66it/s] 57%|█████▋    | 145/256 [00:31<00:23,  4.65it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.64it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 149/256 [00:32<00:22,  4.66it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.65it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.65it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.65it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.65it/s] 60%|██████    | 154/256 [00:33<00:21,  4.65it/s] 61%|██████    | 155/256 [00:34<00:21,  4.65it/s] 61%|██████    | 156/256 [00:34<00:21,  4.65it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.64it/s] 62%|██████▏   | 158/256 [00:34<00:21,  4.66it/s] 62%|██████▏   | 159/256 [00:34<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.63it/s] 64%|██████▎   | 163/256 [00:35<00:20,  4.63it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.64it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.65it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.62it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.62it/s] 66%|██████▌   | 168/256 [00:36<00:18,  4.64it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.63it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.63it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.64it/s] 67%|██████▋   | 172/256 [00:37<00:18,  4.66it/s] 68%|██████▊   | 173/256 [00:37<00:17,  4.66it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.66it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.66it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.66it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.64it/s] 70%|███████   | 180/256 [00:39<00:16,  4.65it/s] 71%|███████   | 181/256 [00:39<00:16,  4.63it/s] 71%|███████   | 182/256 [00:39<00:16,  4.62it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.63it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.64it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.64it/s] 73%|███████▎  | 186/256 [00:40<00:15,  4.63it/s] 73%|███████▎  | 187/256 [00:40<00:14,  4.64it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.66it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.67it/s] 75%|███████▍  | 191/256 [00:41<00:13,  4.66it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.65it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.66it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.66it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.67it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.66it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.66it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.65it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.66it/s] 78%|███████▊  | 200/256 [00:43<00:12,  4.65it/s] 79%|███████▊  | 201/256 [00:43<00:11,  4.64it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.66it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.64it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.63it/s] 80%|████████  | 205/256 [00:44<00:10,  4.65it/s] 80%|████████  | 206/256 [00:45<00:10,  4.65it/s] 81%|████████  | 207/256 [00:45<00:11,  4.21it/s] 81%|████████▏ | 208/256 [00:45<00:11,  4.13it/s] 82%|████████▏ | 209/256 [00:45<00:11,  4.27it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.39it/s] 82%|████████▏ | 211/256 [00:46<00:10,  4.46it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.53it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.56it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.58it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.59it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.62it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.63it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.63it/s] 86%|████████▌ | 219/256 [00:47<00:07,  4.64it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.67it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.66it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.65it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.65it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.65it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.64it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.65it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.66it/s] 89%|████████▉ | 228/256 [00:49<00:05,  4.67it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.67it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.60it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.61it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.62it/s] 91%|█████████ | 233/256 [00:50<00:04,  4.62it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.63it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.63it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.65it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.66it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.66it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.67it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.67it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.67it/s] 95%|█████████▍| 242/256 [00:52<00:02,  4.67it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.68it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.67it/s] 96%|█████████▋| 247/256 [00:53<00:01,  4.65it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.67it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.67it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.69it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.65it/s]100%|██████████| 256/256 [00:55<00:00,  4.66it/s]100%|██████████| 256/256 [00:56<00:00,  4.57it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [52.69, 41.23]
Multiscale SSIM on Highres [0.999, 0.971]
Range Invariant Multiscale SSIM on Highres [1.0, 0.99]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/stats_disentangle_2405_D18-M3-S0-L8_14.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/15
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/15


Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 111
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:23,  1.03s/it]  1%|          | 2/256 [00:01<02:21,  1.80it/s]  1%|          | 3/256 [00:01<01:41,  2.50it/s]  2%|▏         | 4/256 [00:01<01:22,  3.07it/s]  2%|▏         | 5/256 [00:01<01:11,  3.51it/s]  2%|▏         | 6/256 [00:02<01:05,  3.84it/s]  3%|▎         | 7/256 [00:02<01:01,  4.07it/s]  3%|▎         | 8/256 [00:02<00:58,  4.24it/s]  4%|▎         | 9/256 [00:02<00:56,  4.36it/s]  4%|▍         | 10/256 [00:02<00:55,  4.40it/s]  4%|▍         | 11/256 [00:03<00:55,  4.44it/s]  5%|▍         | 12/256 [00:03<00:55,  4.37it/s]  5%|▌         | 13/256 [00:03<00:54,  4.45it/s]  5%|▌         | 14/256 [00:03<00:53,  4.51it/s]  6%|▌         | 15/256 [00:04<00:52,  4.55it/s]  6%|▋         | 16/256 [00:04<00:52,  4.56it/s]  7%|▋         | 17/256 [00:04<00:52,  4.58it/s]  7%|▋         | 18/256 [00:04<00:51,  4.60it/s]  7%|▋         | 19/256 [00:04<00:51,  4.61it/s]  8%|▊         | 20/256 [00:05<00:51,  4.62it/s]  8%|▊         | 21/256 [00:05<00:51,  4.61it/s]  9%|▊         | 22/256 [00:05<00:50,  4.60it/s]  9%|▉         | 23/256 [00:05<00:50,  4.59it/s]  9%|▉         | 24/256 [00:06<00:50,  4.58it/s] 10%|▉         | 25/256 [00:06<00:50,  4.58it/s] 10%|█         | 26/256 [00:06<00:50,  4.57it/s] 11%|█         | 27/256 [00:06<00:50,  4.56it/s] 11%|█         | 28/256 [00:06<00:49,  4.56it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.59it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.61it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.61it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.63it/s] 13%|█▎        | 33/256 [00:07<00:48,  4.64it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.64it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.64it/s] 15%|█▍        | 38/256 [00:09<00:46,  4.65it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.64it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.65it/s] 16%|█▋        | 42/256 [00:09<00:45,  4.65it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.67it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.68it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.68it/s] 18%|█▊        | 46/256 [00:10<00:44,  4.67it/s] 18%|█▊        | 47/256 [00:10<00:44,  4.67it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.67it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.66it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.68it/s] 20%|██        | 52/256 [00:12<00:43,  4.67it/s] 21%|██        | 53/256 [00:12<00:43,  4.65it/s] 21%|██        | 54/256 [00:12<00:43,  4.65it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.66it/s] 22%|██▏       | 56/256 [00:12<00:42,  4.68it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.69it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.67it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.68it/s] 23%|██▎       | 60/256 [00:13<00:41,  4.67it/s] 24%|██▍       | 61/256 [00:13<00:41,  4.68it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.68it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.69it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 65/256 [00:14<00:40,  4.68it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.69it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.69it/s] 27%|██▋       | 68/256 [00:15<00:39,  4.71it/s] 27%|██▋       | 69/256 [00:15<00:39,  4.70it/s] 27%|██▋       | 70/256 [00:15<00:39,  4.68it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.66it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.68it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.67it/s] 29%|██▉       | 74/256 [00:16<00:38,  4.67it/s] 29%|██▉       | 75/256 [00:16<00:38,  4.68it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.70it/s] 30%|███       | 77/256 [00:17<00:38,  4.59it/s] 30%|███       | 78/256 [00:17<00:41,  4.27it/s] 31%|███       | 79/256 [00:17<00:42,  4.18it/s] 31%|███▏      | 80/256 [00:18<00:40,  4.33it/s] 32%|███▏      | 81/256 [00:18<00:39,  4.43it/s] 32%|███▏      | 82/256 [00:18<00:38,  4.51it/s] 32%|███▏      | 83/256 [00:18<00:38,  4.54it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.57it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.60it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.64it/s] 34%|███▍      | 88/256 [00:19<00:36,  4.65it/s] 35%|███▍      | 89/256 [00:20<00:35,  4.67it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.67it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.68it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.69it/s] 36%|███▋      | 93/256 [00:20<00:34,  4.70it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.70it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.69it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.69it/s] 38%|███▊      | 97/256 [00:21<00:33,  4.69it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.70it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.71it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.69it/s] 39%|███▉      | 101/256 [00:22<00:32,  4.70it/s] 40%|███▉      | 102/256 [00:22<00:32,  4.70it/s] 40%|████      | 103/256 [00:23<00:32,  4.70it/s] 41%|████      | 104/256 [00:23<00:32,  4.68it/s] 41%|████      | 105/256 [00:23<00:32,  4.70it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.68it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.69it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.68it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.70it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.69it/s] 43%|████▎     | 111/256 [00:24<00:30,  4.69it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.69it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.70it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.68it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.68it/s] 45%|████▌     | 116/256 [00:25<00:29,  4.67it/s] 46%|████▌     | 117/256 [00:26<00:29,  4.67it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.68it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.69it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 121/256 [00:26<00:28,  4.68it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.68it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.68it/s] 49%|████▉     | 125/256 [00:27<00:27,  4.69it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.69it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.70it/s] 50%|█████     | 128/256 [00:28<00:27,  4.69it/s] 50%|█████     | 129/256 [00:28<00:27,  4.68it/s] 51%|█████     | 130/256 [00:28<00:26,  4.69it/s] 51%|█████     | 131/256 [00:29<00:26,  4.68it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.68it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.69it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.68it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.69it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.69it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.67it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.66it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.64it/s] 55%|█████▍    | 140/256 [00:30<00:24,  4.67it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.68it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.66it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.68it/s] 56%|█████▋    | 144/256 [00:31<00:23,  4.68it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.66it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.68it/s] 58%|█████▊    | 149/256 [00:32<00:22,  4.68it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.69it/s] 60%|█████▉    | 153/256 [00:33<00:21,  4.69it/s] 60%|██████    | 154/256 [00:33<00:21,  4.69it/s] 61%|██████    | 155/256 [00:34<00:21,  4.70it/s] 61%|██████    | 156/256 [00:34<00:21,  4.69it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.70it/s] 62%|██████▏   | 158/256 [00:34<00:20,  4.70it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.69it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.69it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.69it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.67it/s] 64%|██████▎   | 163/256 [00:35<00:19,  4.67it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.66it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.65it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.66it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.67it/s] 66%|██████▌   | 168/256 [00:36<00:18,  4.66it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.65it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.65it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.67it/s] 67%|██████▋   | 172/256 [00:37<00:18,  4.66it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.65it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.65it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.65it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.67it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.67it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.67it/s] 70%|███████   | 180/256 [00:39<00:16,  4.66it/s] 71%|███████   | 181/256 [00:39<00:16,  4.67it/s] 71%|███████   | 182/256 [00:39<00:15,  4.66it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.67it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.65it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.66it/s] 73%|███████▎  | 186/256 [00:40<00:15,  4.66it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.65it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.64it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.65it/s] 75%|███████▍  | 191/256 [00:41<00:13,  4.65it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.64it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.64it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.65it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.65it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.64it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.63it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.64it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.66it/s] 78%|███████▊  | 200/256 [00:43<00:12,  4.65it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.66it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.67it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.68it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.67it/s] 80%|████████  | 205/256 [00:44<00:10,  4.67it/s] 80%|████████  | 206/256 [00:45<00:10,  4.68it/s] 81%|████████  | 207/256 [00:45<00:10,  4.69it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.69it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.68it/s] 82%|████████▏ | 210/256 [00:45<00:09,  4.70it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.68it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.67it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.66it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.66it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.67it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.38it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.23it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.17it/s] 86%|████████▌ | 220/256 [00:48<00:08,  4.31it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.39it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.48it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.53it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.58it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.62it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.64it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.65it/s] 89%|████████▉ | 228/256 [00:49<00:06,  4.66it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.66it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.67it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.67it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.67it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.68it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.69it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.69it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.69it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.69it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.69it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.70it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.69it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.69it/s] 95%|█████████▍| 242/256 [00:52<00:03,  4.66it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.64it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.69it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.64it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.64it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.64it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.57it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.60it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.62it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.65it/s]100%|██████████| 256/256 [00:55<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.56it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [57.06, 39.72]
Multiscale SSIM on Highres [1.0, 0.975]
Range Invariant Multiscale SSIM on Highres [1.0, 0.988]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/stats_disentangle_2405_D18-M3-S0-L8_15.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/10
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/10


Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 357
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:38,  1.09s/it]  1%|          | 2/256 [00:01<02:27,  1.73it/s]  1%|          | 3/256 [00:01<01:44,  2.42it/s]  2%|▏         | 4/256 [00:01<01:24,  2.99it/s]  2%|▏         | 5/256 [00:01<01:13,  3.42it/s]  2%|▏         | 6/256 [00:02<01:06,  3.74it/s]  3%|▎         | 7/256 [00:02<01:02,  4.00it/s]  3%|▎         | 8/256 [00:02<00:59,  4.20it/s]  4%|▎         | 9/256 [00:02<00:59,  4.19it/s]  4%|▍         | 10/256 [00:03<00:57,  4.30it/s]  4%|▍         | 11/256 [00:03<00:55,  4.40it/s]  5%|▍         | 12/256 [00:03<00:54,  4.46it/s]  5%|▌         | 13/256 [00:03<00:53,  4.52it/s]  5%|▌         | 14/256 [00:03<00:53,  4.56it/s]  6%|▌         | 15/256 [00:04<00:52,  4.59it/s]  6%|▋         | 16/256 [00:04<00:52,  4.61it/s]  7%|▋         | 17/256 [00:04<00:51,  4.62it/s]  7%|▋         | 18/256 [00:04<00:51,  4.60it/s]  7%|▋         | 19/256 [00:05<00:51,  4.62it/s]  8%|▊         | 20/256 [00:05<00:51,  4.62it/s]  8%|▊         | 21/256 [00:05<00:50,  4.63it/s]  9%|▊         | 22/256 [00:05<00:50,  4.64it/s]  9%|▉         | 23/256 [00:05<00:51,  4.50it/s]  9%|▉         | 24/256 [00:06<00:51,  4.54it/s] 10%|▉         | 25/256 [00:06<00:50,  4.56it/s] 10%|█         | 26/256 [00:06<00:50,  4.52it/s] 11%|█         | 27/256 [00:06<00:50,  4.56it/s] 11%|█         | 28/256 [00:06<00:49,  4.58it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.61it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.63it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.61it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.63it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.63it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.61it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.64it/s] 15%|█▍        | 38/256 [00:09<00:46,  4.66it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.67it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.68it/s] 16%|█▌        | 41/256 [00:09<00:45,  4.68it/s] 16%|█▋        | 42/256 [00:09<00:45,  4.68it/s] 17%|█▋        | 43/256 [00:10<00:49,  4.28it/s] 17%|█▋        | 44/256 [00:10<00:48,  4.40it/s] 18%|█▊        | 45/256 [00:10<00:47,  4.48it/s] 18%|█▊        | 46/256 [00:10<00:46,  4.53it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.58it/s] 19%|█▉        | 48/256 [00:11<00:47,  4.42it/s] 19%|█▉        | 49/256 [00:11<00:46,  4.49it/s] 20%|█▉        | 50/256 [00:11<00:45,  4.55it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.59it/s] 20%|██        | 52/256 [00:12<00:44,  4.59it/s] 21%|██        | 53/256 [00:12<00:51,  3.94it/s] 21%|██        | 54/256 [00:12<00:48,  4.13it/s] 21%|██▏       | 55/256 [00:12<00:46,  4.28it/s] 22%|██▏       | 56/256 [00:13<00:45,  4.40it/s] 22%|██▏       | 57/256 [00:13<00:44,  4.46it/s] 23%|██▎       | 58/256 [00:13<00:44,  4.49it/s] 23%|██▎       | 59/256 [00:13<00:43,  4.55it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.58it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.63it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.63it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.66it/s] 25%|██▌       | 65/256 [00:15<00:40,  4.67it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.67it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.67it/s] 27%|██▋       | 68/256 [00:15<00:47,  3.98it/s] 27%|██▋       | 69/256 [00:16<00:44,  4.16it/s] 27%|██▋       | 70/256 [00:16<00:43,  4.29it/s] 28%|██▊       | 71/256 [00:16<00:57,  3.21it/s] 28%|██▊       | 72/256 [00:17<00:54,  3.38it/s] 29%|██▊       | 73/256 [00:17<00:49,  3.68it/s] 29%|██▉       | 74/256 [00:17<00:46,  3.93it/s] 29%|██▉       | 75/256 [00:17<00:43,  4.14it/s] 30%|██▉       | 76/256 [00:17<00:42,  4.28it/s] 30%|███       | 77/256 [00:18<00:54,  3.30it/s] 30%|███       | 78/256 [00:18<00:49,  3.61it/s] 31%|███       | 79/256 [00:18<00:45,  3.86it/s] 31%|███▏      | 80/256 [00:19<00:43,  4.01it/s] 32%|███▏      | 81/256 [00:19<00:41,  4.19it/s] 32%|███▏      | 82/256 [00:19<00:54,  3.22it/s] 32%|███▏      | 83/256 [00:19<00:48,  3.55it/s] 33%|███▎      | 84/256 [00:20<00:44,  3.83it/s] 33%|███▎      | 85/256 [00:20<00:42,  4.05it/s] 34%|███▎      | 86/256 [00:20<00:40,  4.21it/s] 34%|███▍      | 87/256 [00:20<00:39,  4.33it/s] 34%|███▍      | 88/256 [00:21<00:37,  4.43it/s] 35%|███▍      | 89/256 [00:21<00:37,  4.51it/s] 35%|███▌      | 90/256 [00:21<00:36,  4.55it/s] 36%|███▌      | 91/256 [00:21<00:35,  4.59it/s] 36%|███▌      | 92/256 [00:21<00:35,  4.63it/s] 36%|███▋      | 93/256 [00:22<00:44,  3.67it/s] 37%|███▋      | 94/256 [00:22<00:41,  3.93it/s] 37%|███▋      | 95/256 [00:22<00:38,  4.13it/s] 38%|███▊      | 96/256 [00:23<00:41,  3.84it/s] 38%|███▊      | 97/256 [00:23<00:39,  4.05it/s] 38%|███▊      | 98/256 [00:23<00:37,  4.22it/s] 39%|███▊      | 99/256 [00:23<00:36,  4.34it/s] 39%|███▉      | 100/256 [00:23<00:35,  4.44it/s] 39%|███▉      | 101/256 [00:24<00:34,  4.50it/s] 40%|███▉      | 102/256 [00:24<00:33,  4.55it/s] 40%|████      | 103/256 [00:24<00:33,  4.60it/s] 41%|████      | 104/256 [00:24<00:32,  4.62it/s] 41%|████      | 105/256 [00:24<00:32,  4.62it/s] 41%|████▏     | 106/256 [00:25<00:32,  4.64it/s] 42%|████▏     | 107/256 [00:25<00:32,  4.65it/s] 42%|████▏     | 108/256 [00:25<00:31,  4.66it/s] 43%|████▎     | 109/256 [00:25<00:31,  4.66it/s] 43%|████▎     | 110/256 [00:26<00:31,  4.68it/s] 43%|████▎     | 111/256 [00:26<00:30,  4.68it/s] 44%|████▍     | 112/256 [00:26<00:30,  4.67it/s] 44%|████▍     | 113/256 [00:26<00:30,  4.68it/s] 45%|████▍     | 114/256 [00:26<00:30,  4.69it/s] 45%|████▍     | 115/256 [00:27<00:30,  4.69it/s] 45%|████▌     | 116/256 [00:27<00:29,  4.70it/s] 46%|████▌     | 117/256 [00:27<00:29,  4.68it/s] 46%|████▌     | 118/256 [00:27<00:29,  4.66it/s] 46%|████▋     | 119/256 [00:27<00:29,  4.67it/s] 47%|████▋     | 120/256 [00:28<00:29,  4.66it/s] 47%|████▋     | 121/256 [00:28<00:33,  4.06it/s] 48%|████▊     | 122/256 [00:28<00:31,  4.23it/s] 48%|████▊     | 123/256 [00:28<00:31,  4.28it/s] 48%|████▊     | 124/256 [00:29<00:29,  4.40it/s] 49%|████▉     | 125/256 [00:29<00:29,  4.48it/s] 49%|████▉     | 126/256 [00:29<00:31,  4.19it/s] 50%|████▉     | 127/256 [00:29<00:29,  4.33it/s] 50%|█████     | 128/256 [00:30<00:28,  4.44it/s] 50%|█████     | 129/256 [00:30<00:28,  4.51it/s] 51%|█████     | 130/256 [00:30<00:27,  4.56it/s] 51%|█████     | 131/256 [00:30<00:27,  4.58it/s] 52%|█████▏    | 132/256 [00:30<00:26,  4.62it/s] 52%|█████▏    | 133/256 [00:31<00:26,  4.63it/s] 52%|█████▏    | 134/256 [00:31<00:26,  4.63it/s] 53%|█████▎    | 135/256 [00:31<00:26,  4.65it/s] 53%|█████▎    | 136/256 [00:31<00:25,  4.66it/s] 54%|█████▎    | 137/256 [00:31<00:25,  4.66it/s] 54%|█████▍    | 138/256 [00:32<00:25,  4.66it/s] 54%|█████▍    | 139/256 [00:32<00:25,  4.66it/s] 55%|█████▍    | 140/256 [00:32<00:24,  4.68it/s] 55%|█████▌    | 141/256 [00:33<00:30,  3.76it/s] 55%|█████▌    | 142/256 [00:33<00:28,  3.99it/s] 56%|█████▌    | 143/256 [00:33<00:27,  4.16it/s] 56%|█████▋    | 144/256 [00:33<00:26,  4.30it/s] 57%|█████▋    | 145/256 [00:33<00:25,  4.39it/s] 57%|█████▋    | 146/256 [00:34<00:26,  4.08it/s] 57%|█████▋    | 147/256 [00:34<00:25,  4.23it/s] 58%|█████▊    | 148/256 [00:34<00:24,  4.36it/s] 58%|█████▊    | 149/256 [00:34<00:24,  4.44it/s] 59%|█████▊    | 150/256 [00:35<00:23,  4.49it/s] 59%|█████▉    | 151/256 [00:35<00:23,  4.55it/s] 59%|█████▉    | 152/256 [00:35<00:22,  4.58it/s] 60%|█████▉    | 153/256 [00:35<00:22,  4.62it/s] 60%|██████    | 154/256 [00:35<00:21,  4.64it/s] 61%|██████    | 155/256 [00:36<00:21,  4.64it/s] 61%|██████    | 156/256 [00:36<00:24,  4.16it/s] 61%|██████▏   | 157/256 [00:36<00:22,  4.31it/s] 62%|██████▏   | 158/256 [00:36<00:22,  4.40it/s] 62%|██████▏   | 159/256 [00:37<00:21,  4.48it/s] 62%|██████▎   | 160/256 [00:37<00:21,  4.51it/s] 63%|██████▎   | 161/256 [00:37<00:24,  3.91it/s] 63%|██████▎   | 162/256 [00:37<00:26,  3.58it/s] 64%|██████▎   | 163/256 [00:38<00:24,  3.84it/s] 64%|██████▍   | 164/256 [00:38<00:22,  4.05it/s] 64%|██████▍   | 165/256 [00:38<00:21,  4.22it/s] 65%|██████▍   | 166/256 [00:38<00:20,  4.35it/s] 65%|██████▌   | 167/256 [00:38<00:19,  4.45it/s] 66%|██████▌   | 168/256 [00:39<00:19,  4.51it/s] 66%|██████▌   | 169/256 [00:39<00:19,  4.55it/s] 66%|██████▋   | 170/256 [00:39<00:18,  4.58it/s] 67%|██████▋   | 171/256 [00:39<00:18,  4.62it/s] 67%|██████▋   | 172/256 [00:40<00:20,  4.15it/s] 68%|██████▊   | 173/256 [00:40<00:19,  4.30it/s] 68%|██████▊   | 174/256 [00:40<00:18,  4.42it/s] 68%|██████▊   | 175/256 [00:40<00:18,  4.48it/s] 69%|██████▉   | 176/256 [00:40<00:17,  4.53it/s] 69%|██████▉   | 177/256 [00:41<00:17,  4.58it/s] 70%|██████▉   | 178/256 [00:41<00:16,  4.62it/s] 70%|██████▉   | 179/256 [00:41<00:16,  4.64it/s] 70%|███████   | 180/256 [00:41<00:16,  4.57it/s] 71%|███████   | 181/256 [00:42<00:16,  4.59it/s] 71%|███████   | 182/256 [00:42<00:18,  4.00it/s] 71%|███████▏  | 183/256 [00:42<00:17,  4.17it/s] 72%|███████▏  | 184/256 [00:42<00:16,  4.29it/s] 72%|███████▏  | 185/256 [00:43<00:16,  4.41it/s] 73%|███████▎  | 186/256 [00:43<00:15,  4.48it/s] 73%|███████▎  | 187/256 [00:43<00:15,  4.47it/s] 73%|███████▎  | 188/256 [00:43<00:15,  4.50it/s] 74%|███████▍  | 189/256 [00:43<00:14,  4.56it/s] 74%|███████▍  | 190/256 [00:44<00:14,  4.58it/s] 75%|███████▍  | 191/256 [00:44<00:14,  4.61it/s] 75%|███████▌  | 192/256 [00:44<00:13,  4.60it/s] 75%|███████▌  | 193/256 [00:44<00:13,  4.60it/s] 76%|███████▌  | 194/256 [00:44<00:13,  4.62it/s] 76%|███████▌  | 195/256 [00:45<00:13,  4.63it/s] 77%|███████▋  | 196/256 [00:45<00:12,  4.64it/s] 77%|███████▋  | 197/256 [00:45<00:12,  4.65it/s] 77%|███████▋  | 198/256 [00:45<00:12,  4.65it/s] 78%|███████▊  | 199/256 [00:46<00:12,  4.65it/s] 78%|███████▊  | 200/256 [00:46<00:12,  4.64it/s] 79%|███████▊  | 201/256 [00:46<00:11,  4.64it/s] 79%|███████▉  | 202/256 [00:46<00:11,  4.64it/s] 79%|███████▉  | 203/256 [00:46<00:11,  4.64it/s] 80%|███████▉  | 204/256 [00:47<00:11,  4.65it/s] 80%|████████  | 205/256 [00:47<00:11,  4.63it/s] 80%|████████  | 206/256 [00:47<00:10,  4.65it/s] 81%|████████  | 207/256 [00:47<00:13,  3.76it/s] 81%|████████▏ | 208/256 [00:48<00:12,  3.99it/s] 82%|████████▏ | 209/256 [00:48<00:11,  4.16it/s] 82%|████████▏ | 210/256 [00:48<00:10,  4.31it/s] 82%|████████▏ | 211/256 [00:48<00:11,  4.01it/s] 83%|████████▎ | 212/256 [00:49<00:10,  4.20it/s] 83%|████████▎ | 213/256 [00:49<00:10,  4.09it/s] 84%|████████▎ | 214/256 [00:49<00:10,  4.00it/s] 84%|████████▍ | 215/256 [00:49<00:10,  3.97it/s] 84%|████████▍ | 216/256 [00:50<00:09,  4.17it/s] 85%|████████▍ | 217/256 [00:50<00:09,  4.31it/s] 85%|████████▌ | 218/256 [00:50<00:08,  4.40it/s] 86%|████████▌ | 219/256 [00:50<00:08,  4.49it/s] 86%|████████▌ | 220/256 [00:50<00:07,  4.54it/s] 86%|████████▋ | 221/256 [00:51<00:07,  4.58it/s] 87%|████████▋ | 222/256 [00:51<00:07,  4.61it/s] 87%|████████▋ | 223/256 [00:51<00:07,  4.63it/s] 88%|████████▊ | 224/256 [00:51<00:06,  4.65it/s] 88%|████████▊ | 225/256 [00:52<00:06,  4.66it/s] 88%|████████▊ | 226/256 [00:52<00:07,  3.76it/s] 89%|████████▊ | 227/256 [00:52<00:07,  3.99it/s] 89%|████████▉ | 228/256 [00:52<00:06,  4.16it/s] 89%|████████▉ | 229/256 [00:53<00:06,  4.26it/s] 90%|████████▉ | 230/256 [00:53<00:05,  4.39it/s] 90%|█████████ | 231/256 [00:53<00:05,  4.46it/s] 91%|█████████ | 232/256 [00:53<00:05,  4.53it/s] 91%|█████████ | 233/256 [00:53<00:05,  4.54it/s] 91%|█████████▏| 234/256 [00:54<00:04,  4.58it/s] 92%|█████████▏| 235/256 [00:54<00:04,  4.60it/s] 92%|█████████▏| 236/256 [00:54<00:04,  4.64it/s] 93%|█████████▎| 237/256 [00:54<00:04,  4.65it/s] 93%|█████████▎| 238/256 [00:54<00:03,  4.65it/s] 93%|█████████▎| 239/256 [00:55<00:03,  4.60it/s] 94%|█████████▍| 240/256 [00:55<00:03,  4.62it/s] 94%|█████████▍| 241/256 [00:55<00:03,  4.64it/s] 95%|█████████▍| 242/256 [00:55<00:03,  4.66it/s] 95%|█████████▍| 243/256 [00:56<00:02,  4.67it/s] 95%|█████████▌| 244/256 [00:56<00:02,  4.67it/s] 96%|█████████▌| 245/256 [00:56<00:02,  4.67it/s] 96%|█████████▌| 246/256 [00:56<00:02,  4.69it/s] 96%|█████████▋| 247/256 [00:56<00:01,  4.70it/s] 97%|█████████▋| 248/256 [00:57<00:01,  4.70it/s] 97%|█████████▋| 249/256 [00:57<00:01,  4.70it/s] 98%|█████████▊| 250/256 [00:57<00:01,  4.68it/s] 98%|█████████▊| 251/256 [00:57<00:01,  4.69it/s] 98%|█████████▊| 252/256 [00:57<00:00,  4.69it/s] 99%|█████████▉| 253/256 [00:58<00:00,  4.68it/s] 99%|█████████▉| 254/256 [00:58<00:00,  4.69it/s]100%|█████████▉| 255/256 [00:58<00:00,  4.69it/s]100%|██████████| 256/256 [00:58<00:00,  4.69it/s]100%|██████████| 256/256 [00:59<00:00,  4.34it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [56.46, 38.76]
Multiscale SSIM on Highres [0.999, 0.967]
Range Invariant Multiscale SSIM on Highres [1.0, 0.984]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/stats_disentangle_2405_D18-M3-S0-L8_10.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/11
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode12
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/11


Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 366
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<05:04,  1.19s/it]  1%|          | 2/256 [00:01<02:36,  1.62it/s]  1%|          | 3/256 [00:01<01:49,  2.31it/s]  2%|▏         | 4/256 [00:01<01:27,  2.88it/s]  2%|▏         | 5/256 [00:02<01:15,  3.34it/s]  2%|▏         | 6/256 [00:02<01:07,  3.70it/s]  3%|▎         | 7/256 [00:02<01:02,  3.96it/s]  3%|▎         | 8/256 [00:02<00:59,  4.16it/s]  4%|▎         | 9/256 [00:02<00:57,  4.29it/s]  4%|▍         | 10/256 [00:03<00:55,  4.41it/s]  4%|▍         | 11/256 [00:03<00:54,  4.46it/s]  5%|▍         | 12/256 [00:03<00:54,  4.51it/s]  5%|▌         | 13/256 [00:03<00:53,  4.53it/s]  5%|▌         | 14/256 [00:03<00:52,  4.58it/s]  6%|▌         | 15/256 [00:04<00:52,  4.60it/s]  6%|▋         | 16/256 [00:04<00:51,  4.62it/s]  7%|▋         | 17/256 [00:04<00:51,  4.61it/s]  7%|▋         | 18/256 [00:04<00:51,  4.63it/s]  7%|▋         | 19/256 [00:05<00:51,  4.63it/s]  8%|▊         | 20/256 [00:05<00:51,  4.62it/s]  8%|▊         | 21/256 [00:05<00:50,  4.61it/s]  9%|▊         | 22/256 [00:05<00:50,  4.62it/s]  9%|▉         | 23/256 [00:05<00:50,  4.62it/s]  9%|▉         | 24/256 [00:06<00:50,  4.63it/s] 10%|▉         | 25/256 [00:06<00:49,  4.64it/s] 10%|█         | 26/256 [00:06<00:49,  4.63it/s] 11%|█         | 27/256 [00:06<00:49,  4.63it/s] 11%|█         | 28/256 [00:07<00:49,  4.65it/s] 11%|█▏        | 29/256 [00:07<00:48,  4.66it/s] 12%|█▏        | 30/256 [00:07<00:49,  4.56it/s] 12%|█▏        | 31/256 [00:07<00:49,  4.58it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.59it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.62it/s] 14%|█▎        | 35/256 [00:08<00:48,  4.59it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.59it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.59it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.60it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.62it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.63it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.64it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.65it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.65it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.66it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.67it/s] 18%|█▊        | 46/256 [00:10<00:44,  4.67it/s] 18%|█▊        | 47/256 [00:11<00:44,  4.68it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.66it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.66it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.67it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.67it/s] 20%|██        | 52/256 [00:12<00:43,  4.67it/s] 21%|██        | 53/256 [00:12<00:43,  4.67it/s] 21%|██        | 54/256 [00:12<00:43,  4.67it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.67it/s] 22%|██▏       | 56/256 [00:13<00:42,  4.67it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.64it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.63it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.63it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.63it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.62it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.62it/s] 25%|██▌       | 65/256 [00:14<00:41,  4.64it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.64it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.65it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.64it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.65it/s] 27%|██▋       | 70/256 [00:16<00:39,  4.66it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.65it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.63it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.65it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.63it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.63it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.64it/s] 30%|███       | 77/256 [00:17<00:38,  4.65it/s] 30%|███       | 78/256 [00:17<00:38,  4.66it/s] 31%|███       | 79/256 [00:18<00:38,  4.65it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.65it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.64it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.64it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.64it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.65it/s] 34%|███▍      | 88/256 [00:19<00:36,  4.65it/s] 35%|███▍      | 89/256 [00:20<00:35,  4.66it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.67it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.64it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.64it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.63it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.63it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.64it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.65it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.63it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.63it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.63it/s] 40%|████      | 103/256 [00:23<00:33,  4.62it/s] 41%|████      | 104/256 [00:23<00:32,  4.65it/s] 41%|████      | 105/256 [00:23<00:32,  4.66it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.64it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.65it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.66it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.65it/s] 44%|████▍     | 112/256 [00:25<00:30,  4.66it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.67it/s] 45%|████▌     | 116/256 [00:25<00:29,  4.68it/s] 46%|████▌     | 117/256 [00:26<00:29,  4.67it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.67it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.65it/s] 47%|████▋     | 121/256 [00:27<00:28,  4.66it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.67it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.65it/s] 49%|████▉     | 126/256 [00:28<00:27,  4.66it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.66it/s] 50%|█████     | 128/256 [00:28<00:27,  4.65it/s] 50%|█████     | 129/256 [00:28<00:27,  4.64it/s] 51%|█████     | 130/256 [00:28<00:27,  4.64it/s] 51%|█████     | 131/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.65it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.66it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.66it/s] 53%|█████▎    | 135/256 [00:30<00:25,  4.66it/s] 53%|█████▎    | 136/256 [00:30<00:27,  4.37it/s] 54%|█████▎    | 137/256 [00:30<00:28,  4.23it/s] 54%|█████▍    | 138/256 [00:30<00:28,  4.17it/s] 54%|█████▍    | 139/256 [00:31<00:27,  4.31it/s] 55%|█████▍    | 140/256 [00:31<00:26,  4.42it/s] 55%|█████▌    | 141/256 [00:31<00:25,  4.47it/s] 55%|█████▌    | 142/256 [00:31<00:25,  4.54it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.56it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.59it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.62it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.64it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.57it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.59it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.61it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.63it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.63it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.65it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.65it/s] 60%|██████    | 154/256 [00:34<00:22,  4.63it/s] 61%|██████    | 155/256 [00:34<00:21,  4.64it/s] 61%|██████    | 156/256 [00:34<00:21,  4.66it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.66it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.64it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.66it/s] 64%|██████▎   | 163/256 [00:36<00:19,  4.66it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.67it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.68it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.67it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.66it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.68it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.67it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.68it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.66it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.66it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.66it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.66it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 177/256 [00:39<00:16,  4.66it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.65it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.66it/s] 70%|███████   | 180/256 [00:39<00:16,  4.67it/s] 71%|███████   | 181/256 [00:40<00:16,  4.66it/s] 71%|███████   | 182/256 [00:40<00:15,  4.66it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.66it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.66it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.66it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.59it/s] 73%|███████▎  | 187/256 [00:41<00:15,  4.45it/s] 73%|███████▎  | 188/256 [00:41<00:15,  4.52it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.57it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.60it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.64it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.63it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.64it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.57it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.60it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.61it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.63it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.64it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.63it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.65it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.65it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.64it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.64it/s] 80%|████████  | 205/256 [00:45<00:11,  4.63it/s] 80%|████████  | 206/256 [00:45<00:12,  4.02it/s] 81%|████████  | 207/256 [00:45<00:11,  4.18it/s] 81%|████████▏ | 208/256 [00:46<00:11,  4.30it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.41it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.47it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.52it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.55it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.59it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.61it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.60it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.61it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.61it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.61it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.63it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.63it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.64it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.64it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.64it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.63it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.63it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.62it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.63it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.64it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.60it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.63it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.61it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.61it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.62it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.63it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.62it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.62it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.64it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.65it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.66it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.63it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.63it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.63it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.64it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.64it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.60it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.62it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.64it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.65it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.66it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.65it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.66it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.65it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.65it/s]100%|██████████| 256/256 [00:56<00:00,  4.65it/s]100%|██████████| 256/256 [00:56<00:00,  4.53it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [41.01, 37.76]
Multiscale SSIM on Highres [0.994, 0.99]
Range Invariant Multiscale SSIM on Highres [0.995, 0.99]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/stats_disentangle_2405_D18-M3-S0-L8_11.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/12
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode15
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/12


Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 399
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:52,  1.15s/it]  1%|          | 2/256 [00:01<02:32,  1.67it/s]  1%|          | 3/256 [00:01<01:47,  2.36it/s]  2%|▏         | 4/256 [00:01<01:27,  2.89it/s]  2%|▏         | 5/256 [00:02<01:14,  3.35it/s]  2%|▏         | 6/256 [00:02<01:07,  3.71it/s]  3%|▎         | 7/256 [00:02<01:02,  3.98it/s]  3%|▎         | 8/256 [00:02<00:59,  4.17it/s]  4%|▎         | 9/256 [00:02<00:57,  4.31it/s]  4%|▍         | 10/256 [00:03<00:55,  4.41it/s]  4%|▍         | 11/256 [00:03<00:54,  4.49it/s]  5%|▍         | 12/256 [00:03<00:53,  4.52it/s]  5%|▌         | 13/256 [00:03<00:53,  4.57it/s]  5%|▌         | 14/256 [00:03<00:52,  4.57it/s]  6%|▌         | 15/256 [00:04<00:52,  4.58it/s]  6%|▋         | 16/256 [00:04<00:52,  4.60it/s]  7%|▋         | 17/256 [00:04<00:51,  4.62it/s]  7%|▋         | 18/256 [00:04<00:51,  4.63it/s]  7%|▋         | 19/256 [00:05<00:51,  4.64it/s]  8%|▊         | 20/256 [00:05<00:50,  4.63it/s]  8%|▊         | 21/256 [00:05<00:50,  4.65it/s]  9%|▊         | 22/256 [00:05<00:50,  4.65it/s]  9%|▉         | 23/256 [00:05<00:50,  4.65it/s]  9%|▉         | 24/256 [00:06<00:49,  4.64it/s] 10%|▉         | 25/256 [00:06<00:49,  4.64it/s] 10%|█         | 26/256 [00:06<00:49,  4.63it/s] 11%|█         | 27/256 [00:06<00:49,  4.64it/s] 11%|█         | 28/256 [00:06<00:49,  4.65it/s] 11%|█▏        | 29/256 [00:07<00:48,  4.64it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.65it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.63it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.63it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.61it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.61it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.61it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.61it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.60it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.62it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.62it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.61it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.59it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.60it/s] 20%|██        | 52/256 [00:12<00:44,  4.59it/s] 21%|██        | 53/256 [00:12<00:44,  4.61it/s] 21%|██        | 54/256 [00:12<00:43,  4.61it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.62it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.63it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.62it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.63it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.61it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.61it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.60it/s] 25%|██▍       | 63/256 [00:14<00:42,  4.57it/s] 25%|██▌       | 64/256 [00:14<00:42,  4.57it/s] 25%|██▌       | 65/256 [00:14<00:41,  4.58it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.53it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.53it/s] 27%|██▋       | 68/256 [00:15<00:41,  4.51it/s] 27%|██▋       | 69/256 [00:15<00:41,  4.52it/s] 27%|██▋       | 70/256 [00:16<00:41,  4.49it/s] 28%|██▊       | 71/256 [00:16<00:41,  4.51it/s] 28%|██▊       | 72/256 [00:16<00:40,  4.51it/s] 29%|██▊       | 73/256 [00:16<00:40,  4.53it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.56it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.57it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.56it/s] 30%|███       | 77/256 [00:17<00:39,  4.58it/s] 30%|███       | 78/256 [00:17<00:38,  4.57it/s] 31%|███       | 79/256 [00:18<00:38,  4.58it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.58it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.59it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.60it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.61it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.61it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.60it/s] 34%|███▎      | 86/256 [00:19<00:37,  4.51it/s] 34%|███▍      | 87/256 [00:19<00:37,  4.53it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.56it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.56it/s] 35%|███▌      | 90/256 [00:20<00:36,  4.58it/s] 36%|███▌      | 91/256 [00:20<00:36,  4.50it/s] 36%|███▌      | 92/256 [00:21<00:40,  4.08it/s] 36%|███▋      | 93/256 [00:21<00:40,  4.03it/s] 37%|███▋      | 94/256 [00:21<00:38,  4.17it/s] 37%|███▋      | 95/256 [00:21<00:37,  4.30it/s] 38%|███▊      | 96/256 [00:21<00:36,  4.39it/s] 38%|███▊      | 97/256 [00:22<00:36,  4.37it/s] 38%|███▊      | 98/256 [00:22<00:35,  4.43it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.50it/s] 39%|███▉      | 100/256 [00:22<00:34,  4.53it/s] 39%|███▉      | 101/256 [00:23<00:33,  4.57it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.58it/s] 40%|████      | 103/256 [00:23<00:33,  4.57it/s] 41%|████      | 104/256 [00:23<00:33,  4.58it/s] 41%|████      | 105/256 [00:23<00:32,  4.58it/s] 41%|████▏     | 106/256 [00:24<00:32,  4.60it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.61it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.61it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.61it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.62it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.61it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.61it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.62it/s] 45%|████▍     | 115/256 [00:26<00:30,  4.63it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.63it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.63it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.62it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.63it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.63it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.62it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.63it/s] 48%|████▊     | 124/256 [00:28<00:28,  4.61it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.61it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.61it/s] 50%|████▉     | 127/256 [00:28<00:28,  4.60it/s] 50%|█████     | 128/256 [00:28<00:27,  4.58it/s] 50%|█████     | 129/256 [00:29<00:27,  4.59it/s] 51%|█████     | 130/256 [00:29<00:27,  4.60it/s] 51%|█████     | 131/256 [00:29<00:27,  4.60it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.60it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.61it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.64it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.63it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.63it/s] 54%|█████▍    | 138/256 [00:31<00:25,  4.64it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.65it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.64it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.64it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.64it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.64it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.63it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.64it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.64it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.64it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.65it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.65it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.63it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.63it/s] 59%|█████▉    | 152/256 [00:34<00:22,  4.63it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.64it/s] 60%|██████    | 154/256 [00:34<00:22,  4.64it/s] 61%|██████    | 155/256 [00:34<00:21,  4.64it/s] 61%|██████    | 156/256 [00:34<00:21,  4.64it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.65it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.65it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.66it/s] 64%|██████▎   | 163/256 [00:36<00:19,  4.66it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.65it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.66it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.66it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.67it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.65it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.65it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.66it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.65it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.65it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.66it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.66it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.65it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.66it/s] 69%|██████▉   | 177/256 [00:39<00:16,  4.67it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.66it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.66it/s] 70%|███████   | 180/256 [00:40<00:16,  4.66it/s] 71%|███████   | 181/256 [00:40<00:16,  4.64it/s] 71%|███████   | 182/256 [00:40<00:15,  4.63it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.64it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.65it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.66it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.66it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.65it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.65it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.65it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.64it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.64it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.65it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.66it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.67it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.68it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.65it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.65it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.65it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.65it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.65it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.64it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.66it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.65it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.63it/s] 80%|████████  | 205/256 [00:45<00:11,  4.64it/s] 80%|████████  | 206/256 [00:45<00:10,  4.63it/s] 81%|████████  | 207/256 [00:45<00:10,  4.64it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.65it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.64it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.63it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.64it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.63it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.62it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.64it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.65it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.63it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.65it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.65it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.67it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.67it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.67it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.67it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.66it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.66it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.65it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.66it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.66it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.60it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.38it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.21it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.13it/s] 91%|█████████ | 233/256 [00:51<00:05,  4.27it/s] 91%|█████████▏| 234/256 [00:51<00:05,  4.38it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.46it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.53it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.57it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.58it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.60it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.61it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.62it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.62it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.64it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.64it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.65it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.64it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.64it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.64it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.65it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.62it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.63it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.64it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.64it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.65it/s]100%|██████████| 256/256 [00:56<00:00,  4.65it/s]100%|██████████| 256/256 [00:56<00:00,  4.51it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [37.56, 34.15]
Multiscale SSIM on Highres [0.971, 0.97]
Range Invariant Multiscale SSIM on Highres [0.973, 0.971]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/stats_disentangle_2405_D18-M3-S0-L8_12.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F12.54/kth_2/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif
data:
  background_quantile: 0.0
  channel_idx_list:
  - GT_Cy5
  - GT_TRITC
  - 555-647
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/6
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: caa1d41d654fb423a7c3abc700486f87d132a2f7
  untracked_files: []
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/6

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Train

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Test

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 93
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:46,  1.19s/it]  5%|▌         | 2/40 [00:01<00:23,  1.60it/s]  8%|▊         | 3/40 [00:01<00:16,  2.28it/s] 10%|█         | 4/40 [00:01<00:12,  2.85it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.31it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.67it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.93it/s] 20%|██        | 8/40 [00:02<00:07,  4.12it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.28it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.36it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.42it/s] 30%|███       | 12/40 [00:03<00:06,  4.48it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.52it/s] 35%|███▌      | 14/40 [00:04<00:05,  4.54it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.55it/s] 40%|████      | 16/40 [00:04<00:05,  4.58it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.58it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.57it/s] 50%|█████     | 20/40 [00:05<00:04,  4.58it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.58it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.60it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.60it/s] 60%|██████    | 24/40 [00:06<00:03,  4.59it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.59it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.60it/s] 70%|███████   | 28/40 [00:07<00:02,  4.60it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.60it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.60it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.60it/s] 80%|████████  | 32/40 [00:07<00:01,  4.60it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.59it/s] 92%|█████████▎| 37/40 [00:09<00:00,  4.61it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.57it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.26it/s]100%|██████████| 40/40 [00:09<00:00,  4.11it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [42.36, 31.43]
Multiscale SSIM on Highres [0.985, 0.95]
Range Invariant Multiscale SSIM on Highres [0.986, 0.952]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/stats_disentangle_2404_D21-M3-S0-L8_6.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  - 9
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/120
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/120

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]  5%|▌         | 2/40 [00:01<00:22,  1.70it/s]  8%|▊         | 3/40 [00:01<00:15,  2.38it/s] 10%|█         | 4/40 [00:01<00:12,  2.94it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.40it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.74it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.99it/s] 20%|██        | 8/40 [00:02<00:07,  4.01it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.18it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.29it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.38it/s] 30%|███       | 12/40 [00:03<00:06,  4.46it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.50it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.52it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.57it/s] 40%|████      | 16/40 [00:04<00:05,  4.60it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.60it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.59it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.59it/s] 50%|█████     | 20/40 [00:05<00:04,  4.62it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.61it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.61it/s] 60%|██████    | 24/40 [00:06<00:03,  4.63it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.62it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.53it/s] 70%|███████   | 28/40 [00:07<00:02,  4.56it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.58it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.60it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.61it/s] 80%|████████  | 32/40 [00:07<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.59it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.58it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.59it/s]100%|██████████| 40/40 [00:09<00:00,  4.15it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [27.56, 32.6]
Multiscale SSIM on Highres [0.825, 0.937]
Range Invariant Multiscale SSIM on Highres [0.826, 0.937]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/stats_disentangle_2404_D25-M3-S0-L8_120.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  - 10
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/111
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/111

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 334
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]  5%|▌         | 2/40 [00:01<00:22,  1.69it/s]  8%|▊         | 3/40 [00:01<00:15,  2.37it/s] 10%|█         | 4/40 [00:01<00:12,  2.94it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.40it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.74it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.99it/s] 20%|██        | 8/40 [00:02<00:07,  4.18it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.43it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.49it/s] 30%|███       | 12/40 [00:03<00:06,  4.52it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.46it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.52it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.56it/s] 40%|████      | 16/40 [00:04<00:05,  4.56it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.58it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.60it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.62it/s] 50%|█████     | 20/40 [00:05<00:04,  4.63it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.63it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.64it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.64it/s] 60%|██████    | 24/40 [00:06<00:03,  4.63it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.63it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.64it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.63it/s] 70%|███████   | 28/40 [00:06<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.61it/s] 80%|████████  | 32/40 [00:07<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.61it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.62it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.62it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.62it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.62it/s]100%|██████████| 40/40 [00:09<00:00,  4.17it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [27.55, 37.48]
Multiscale SSIM on Highres [0.818, 0.974]
Range Invariant Multiscale SSIM on Highres [0.824, 0.975]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/stats_disentangle_2404_D25-M3-S0-L8_111.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  - 11
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/125
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/125

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 279
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]  8%|▊         | 3/40 [00:01<00:15,  2.37it/s] 10%|█         | 4/40 [00:01<00:12,  2.94it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.39it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.74it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.99it/s] 20%|██        | 8/40 [00:02<00:07,  4.17it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.30it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.40it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.51it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.54it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.58it/s] 40%|████      | 16/40 [00:04<00:05,  4.38it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.06it/s] 45%|████▌     | 18/40 [00:04<00:05,  4.00it/s] 48%|████▊     | 19/40 [00:05<00:05,  4.18it/s] 50%|█████     | 20/40 [00:05<00:04,  4.30it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.39it/s] 55%|█████▌    | 22/40 [00:05<00:04,  4.46it/s] 57%|█████▊    | 23/40 [00:06<00:03,  4.50it/s] 60%|██████    | 24/40 [00:06<00:03,  4.53it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.55it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.48it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.53it/s] 70%|███████   | 28/40 [00:07<00:02,  4.46it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.45it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.50it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.53it/s] 80%|████████  | 32/40 [00:08<00:01,  4.56it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.59it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.57it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.58it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.59it/s] 92%|█████████▎| 37/40 [00:09<00:00,  4.58it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.59it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.59it/s]100%|██████████| 40/40 [00:09<00:00,  4.09it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [30.61, 28.91]
Multiscale SSIM on Highres [0.908, 0.864]
Range Invariant Multiscale SSIM on Highres [0.908, 0.864]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/stats_disentangle_2404_D25-M3-S0-L8_125.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  - 12
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/139
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/139

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 375
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]  8%|▊         | 3/40 [00:01<00:15,  2.34it/s] 10%|█         | 4/40 [00:01<00:12,  2.91it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.36it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.71it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.98it/s] 20%|██        | 8/40 [00:02<00:07,  4.19it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.30it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.40it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.51it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.54it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.56it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.60it/s] 40%|████      | 16/40 [00:04<00:05,  4.63it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.62it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.63it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.62it/s] 50%|█████     | 20/40 [00:05<00:04,  4.60it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.62it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.63it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:06<00:03,  4.62it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.64it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.63it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.62it/s] 70%|███████   | 28/40 [00:06<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.63it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.64it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.63it/s] 80%|████████  | 32/40 [00:07<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.63it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.59it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.59it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.17it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [30.56, 35.7]
Multiscale SSIM on Highres [0.891, 0.952]
Range Invariant Multiscale SSIM on Highres [0.895, 0.953]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/stats_disentangle_2404_D25-M3-S0-L8_139.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  - 13
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/143
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/143

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 223
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:46,  1.20s/it]  5%|▌         | 2/40 [00:01<00:23,  1.61it/s]  8%|▊         | 3/40 [00:01<00:16,  2.26it/s] 10%|█         | 4/40 [00:01<00:12,  2.83it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.30it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.65it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.92it/s] 20%|██        | 8/40 [00:02<00:07,  4.12it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.27it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.35it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.44it/s] 30%|███       | 12/40 [00:03<00:06,  4.50it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.54it/s] 35%|███▌      | 14/40 [00:04<00:05,  4.55it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.56it/s] 40%|████      | 16/40 [00:04<00:05,  4.58it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.58it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.59it/s] 50%|█████     | 20/40 [00:05<00:04,  4.57it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.58it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.61it/s] 60%|██████    | 24/40 [00:06<00:03,  4.62it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.59it/s] 70%|███████   | 28/40 [00:07<00:02,  4.60it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.60it/s] 80%|████████  | 32/40 [00:07<00:01,  4.60it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.59it/s] 92%|█████████▎| 37/40 [00:09<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.58it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.15it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [30.16, 36.17]
Multiscale SSIM on Highres [0.886, 0.957]
Range Invariant Multiscale SSIM on Highres [0.89, 0.958]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/stats_disentangle_2404_D25-M3-S0-L8_143.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F12.54/kth_2/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif

##################################
Predicting 3th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:39,  1.02s/it]  5%|▌         | 2/40 [00:01<00:20,  1.82it/s]  8%|▊         | 3/40 [00:01<00:14,  2.52it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.48it/s] 15%|█▌        | 6/40 [00:02<00:08,  3.80it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.02it/s] 20%|██        | 8/40 [00:02<00:07,  4.20it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:02<00:06,  4.39it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.45it/s] 30%|███       | 12/40 [00:03<00:06,  4.51it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.55it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.58it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.61it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.60it/s] 50%|█████     | 20/40 [00:05<00:04,  4.60it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.59it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.59it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.60it/s] 60%|██████    | 24/40 [00:06<00:03,  4.60it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.62it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.62it/s] 70%|███████   | 28/40 [00:06<00:02,  4.64it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.64it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.66it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.65it/s] 80%|████████  | 32/40 [00:07<00:01,  4.65it/s] 82%|████████▎ | 33/40 [00:07<00:01,  4.65it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.64it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.64it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.65it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.67it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.67it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.68it/s]100%|██████████| 40/40 [00:09<00:00,  4.25it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_3/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [43.06, 34.38]
Multiscale SSIM on Highres [0.985, 0.968]
Range Invariant Multiscale SSIM on Highres [0.988, 0.968]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_3/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_3/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s] 12%|█▎        | 2/16 [00:01<00:07,  1.84it/s] 19%|█▉        | 3/16 [00:01<00:05,  2.50it/s] 25%|██▌       | 4/16 [00:01<00:03,  3.06it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.48it/s] 38%|███▊      | 6/16 [00:02<00:02,  3.79it/s] 44%|████▍     | 7/16 [00:02<00:02,  4.04it/s] 50%|█████     | 8/16 [00:02<00:01,  4.21it/s] 56%|█████▋    | 9/16 [00:02<00:01,  4.34it/s] 62%|██████▎   | 10/16 [00:02<00:01,  4.43it/s] 69%|██████▉   | 11/16 [00:03<00:01,  4.49it/s] 75%|███████▌  | 12/16 [00:03<00:00,  4.54it/s] 81%|████████▏ | 13/16 [00:03<00:00,  4.57it/s] 88%|████████▊ | 14/16 [00:03<00:00,  4.61it/s] 94%|█████████▍| 15/16 [00:04<00:00,  4.62it/s]100%|██████████| 16/16 [00:04<00:00,  4.63it/s]100%|██████████| 16/16 [00:04<00:00,  3.64it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [37.21, 38.97]
Multiscale SSIM on Highres [0.95, 0.939]
Range Invariant Multiscale SSIM on Highres [0.972, 0.964]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:01<00:37,  1.02s/it]  5%|▌         | 2/38 [00:01<00:19,  1.82it/s]  8%|▊         | 3/38 [00:01<00:13,  2.52it/s] 11%|█         | 4/38 [00:01<00:11,  3.07it/s] 13%|█▎        | 5/38 [00:01<00:09,  3.49it/s] 16%|█▌        | 6/38 [00:02<00:08,  3.80it/s] 18%|█▊        | 7/38 [00:02<00:07,  4.05it/s] 21%|██        | 8/38 [00:02<00:07,  4.22it/s] 24%|██▎       | 9/38 [00:02<00:06,  4.36it/s] 26%|██▋       | 10/38 [00:02<00:06,  4.44it/s] 29%|██▉       | 11/38 [00:03<00:06,  4.49it/s] 32%|███▏      | 12/38 [00:03<00:05,  4.53it/s] 34%|███▍      | 13/38 [00:03<00:05,  4.57it/s] 37%|███▋      | 14/38 [00:03<00:05,  4.56it/s] 39%|███▉      | 15/38 [00:04<00:05,  4.58it/s] 42%|████▏     | 16/38 [00:04<00:04,  4.59it/s] 45%|████▍     | 17/38 [00:04<00:04,  4.58it/s] 47%|████▋     | 18/38 [00:04<00:04,  4.60it/s] 50%|█████     | 19/38 [00:04<00:04,  4.61it/s] 53%|█████▎    | 20/38 [00:05<00:03,  4.61it/s] 55%|█████▌    | 21/38 [00:05<00:03,  4.61it/s] 58%|█████▊    | 22/38 [00:05<00:03,  4.62it/s] 61%|██████    | 23/38 [00:05<00:03,  4.63it/s] 63%|██████▎   | 24/38 [00:05<00:03,  4.63it/s] 66%|██████▌   | 25/38 [00:06<00:02,  4.63it/s] 68%|██████▊   | 26/38 [00:06<00:02,  4.64it/s] 71%|███████   | 27/38 [00:06<00:02,  4.63it/s] 74%|███████▎  | 28/38 [00:06<00:02,  4.63it/s] 76%|███████▋  | 29/38 [00:07<00:01,  4.64it/s] 79%|███████▉  | 30/38 [00:07<00:01,  4.64it/s] 82%|████████▏ | 31/38 [00:07<00:01,  4.64it/s] 84%|████████▍ | 32/38 [00:07<00:01,  4.64it/s] 87%|████████▋ | 33/38 [00:07<00:01,  4.61it/s] 89%|████████▉ | 34/38 [00:08<00:00,  4.58it/s] 92%|█████████▏| 35/38 [00:08<00:00,  4.60it/s] 95%|█████████▍| 36/38 [00:08<00:00,  4.59it/s] 97%|█████████▋| 37/38 [00:08<00:00,  4.60it/s]100%|██████████| 38/38 [00:08<00:00,  5.35it/s]100%|██████████| 38/38 [00:09<00:00,  4.18it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F18.75/kth_3/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [30.76, 23.77]
Multiscale SSIM on Highres [0.77, 0.78]
Range Invariant Multiscale SSIM on Highres [0.926, 0.786]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F18.75/kth_3/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F18.75/kth_3/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.05s/it]  5%|▌         | 2/40 [00:01<00:21,  1.78it/s]  8%|▊         | 3/40 [00:01<00:14,  2.47it/s] 10%|█         | 4/40 [00:01<00:11,  3.03it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.46it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.77it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.01it/s] 20%|██        | 8/40 [00:02<00:07,  4.19it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.33it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.42it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.48it/s] 30%|███       | 12/40 [00:03<00:06,  4.52it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.56it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.61it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.62it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.62it/s] 48%|████▊     | 19/40 [00:04<00:04,  4.60it/s] 50%|█████     | 20/40 [00:05<00:04,  4.59it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.60it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.61it/s] 60%|██████    | 24/40 [00:06<00:03,  4.61it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.59it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.56it/s] 70%|███████   | 28/40 [00:06<00:02,  4.57it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.57it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.57it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.57it/s] 80%|████████  | 32/40 [00:07<00:01,  4.59it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.60it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.59it/s]100%|██████████| 40/40 [00:09<00:00,  4.21it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.49, 30.99]
Multiscale SSIM on Highres [0.783, 0.918]
Range Invariant Multiscale SSIM on Highres [0.781, 0.92]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<04:11,  1.01it/s]  1%|          | 2/256 [00:01<02:15,  1.87it/s]  1%|          | 3/256 [00:01<01:38,  2.58it/s]  2%|▏         | 4/256 [00:01<01:20,  3.13it/s]  2%|▏         | 5/256 [00:01<01:10,  3.55it/s]  2%|▏         | 6/256 [00:02<01:04,  3.86it/s]  3%|▎         | 7/256 [00:02<01:01,  4.08it/s]  3%|▎         | 8/256 [00:02<00:58,  4.24it/s]  4%|▎         | 9/256 [00:02<00:56,  4.34it/s]  4%|▍         | 10/256 [00:02<00:58,  4.20it/s]  4%|▍         | 11/256 [00:03<00:56,  4.32it/s]  5%|▍         | 12/256 [00:03<00:55,  4.39it/s]  5%|▌         | 13/256 [00:03<00:54,  4.46it/s]  5%|▌         | 14/256 [00:03<00:53,  4.51it/s]  6%|▌         | 15/256 [00:04<00:53,  4.54it/s]  6%|▋         | 16/256 [00:04<00:52,  4.56it/s]  7%|▋         | 17/256 [00:04<00:52,  4.58it/s]  7%|▋         | 18/256 [00:04<00:51,  4.59it/s]  7%|▋         | 19/256 [00:04<00:51,  4.59it/s]  8%|▊         | 20/256 [00:05<00:51,  4.60it/s]  8%|▊         | 21/256 [00:05<00:55,  4.27it/s]  9%|▊         | 22/256 [00:05<00:53,  4.39it/s]  9%|▉         | 23/256 [00:05<00:52,  4.46it/s]  9%|▉         | 24/256 [00:06<00:51,  4.50it/s] 10%|▉         | 25/256 [00:06<00:50,  4.56it/s] 10%|█         | 26/256 [00:06<00:50,  4.59it/s] 11%|█         | 27/256 [00:06<00:49,  4.60it/s] 11%|█         | 28/256 [00:06<00:49,  4.62it/s] 11%|█▏        | 29/256 [00:07<00:48,  4.63it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.64it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.66it/s] 12%|█▎        | 32/256 [00:07<00:47,  4.67it/s] 13%|█▎        | 33/256 [00:07<00:47,  4.65it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.66it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.66it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.66it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.66it/s] 15%|█▍        | 38/256 [00:09<00:46,  4.66it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.67it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.67it/s] 16%|█▋        | 42/256 [00:09<00:45,  4.68it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.69it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.69it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.69it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.66it/s] 18%|█▊        | 47/256 [00:10<00:44,  4.67it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.68it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.69it/s] 20%|█▉        | 50/256 [00:11<00:43,  4.70it/s] 20%|█▉        | 51/256 [00:11<00:43,  4.69it/s] 20%|██        | 52/256 [00:12<00:43,  4.68it/s] 21%|██        | 53/256 [00:12<00:43,  4.68it/s] 21%|██        | 54/256 [00:12<00:43,  4.68it/s] 21%|██▏       | 55/256 [00:12<00:42,  4.69it/s] 22%|██▏       | 56/256 [00:12<00:42,  4.68it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.69it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.67it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.66it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.66it/s] 24%|██▍       | 61/256 [00:13<00:41,  4.67it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.66it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.65it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.67it/s] 25%|██▌       | 65/256 [00:14<00:41,  4.65it/s] 26%|██▌       | 66/256 [00:15<00:43,  4.40it/s] 26%|██▌       | 67/256 [00:15<00:44,  4.22it/s] 27%|██▋       | 68/256 [00:15<00:43,  4.34it/s] 27%|██▋       | 69/256 [00:15<00:42,  4.43it/s] 27%|██▋       | 70/256 [00:16<00:41,  4.45it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.52it/s] 28%|██▊       | 72/256 [00:16<00:40,  4.58it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.61it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.62it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.64it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.65it/s] 30%|███       | 77/256 [00:17<00:38,  4.66it/s] 30%|███       | 78/256 [00:17<00:37,  4.70it/s] 31%|███       | 79/256 [00:17<00:37,  4.70it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.70it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.68it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.67it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.67it/s] 33%|███▎      | 84/256 [00:18<00:36,  4.68it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.69it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.70it/s] 34%|███▍      | 87/256 [00:19<00:35,  4.70it/s] 34%|███▍      | 88/256 [00:19<00:35,  4.69it/s] 35%|███▍      | 89/256 [00:20<00:35,  4.69it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.67it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.65it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.66it/s] 36%|███▋      | 93/256 [00:20<00:34,  4.66it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.64it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.64it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.63it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.65it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.65it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.65it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.67it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.66it/s] 40%|████      | 103/256 [00:23<00:32,  4.67it/s] 41%|████      | 104/256 [00:23<00:32,  4.68it/s] 41%|████      | 105/256 [00:23<00:32,  4.68it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.64it/s] 42%|████▏     | 107/256 [00:23<00:32,  4.63it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.64it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.63it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.65it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.65it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.65it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.66it/s] 45%|████▌     | 116/256 [00:25<00:29,  4.68it/s] 46%|████▌     | 117/256 [00:26<00:29,  4.68it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.67it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.64it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.65it/s] 47%|████▋     | 121/256 [00:26<00:29,  4.63it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.63it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.64it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.65it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.66it/s] 49%|████▉     | 126/256 [00:28<00:27,  4.66it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.66it/s] 50%|█████     | 128/256 [00:28<00:27,  4.66it/s] 50%|█████     | 129/256 [00:28<00:27,  4.67it/s] 51%|█████     | 130/256 [00:28<00:26,  4.67it/s] 51%|█████     | 131/256 [00:29<00:26,  4.69it/s] 52%|█████▏    | 132/256 [00:29<00:27,  4.53it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.59it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.62it/s] 53%|█████▎    | 135/256 [00:29<00:26,  4.65it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.65it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.60it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.63it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.63it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.65it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.65it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.66it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.66it/s] 56%|█████▋    | 144/256 [00:31<00:23,  4.67it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.67it/s] 58%|█████▊    | 149/256 [00:32<00:22,  4.68it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.68it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.69it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.68it/s] 60%|█████▉    | 153/256 [00:33<00:21,  4.69it/s] 60%|██████    | 154/256 [00:34<00:21,  4.70it/s] 61%|██████    | 155/256 [00:34<00:21,  4.70it/s] 61%|██████    | 156/256 [00:34<00:21,  4.71it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.68it/s] 62%|██████▏   | 158/256 [00:34<00:20,  4.69it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.70it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.69it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.69it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.70it/s] 64%|██████▎   | 163/256 [00:35<00:19,  4.69it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.70it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.69it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.71it/s] 65%|██████▌   | 167/256 [00:36<00:18,  4.71it/s] 66%|██████▌   | 168/256 [00:36<00:18,  4.70it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.71it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.69it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.70it/s] 67%|██████▋   | 172/256 [00:37<00:17,  4.68it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.68it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.70it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.70it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.70it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.69it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.69it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.67it/s] 70%|███████   | 180/256 [00:39<00:16,  4.68it/s] 71%|███████   | 181/256 [00:39<00:16,  4.68it/s] 71%|███████   | 182/256 [00:39<00:15,  4.69it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.71it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.70it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.71it/s] 73%|███████▎  | 186/256 [00:40<00:14,  4.71it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.71it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.71it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.72it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.70it/s] 75%|███████▍  | 191/256 [00:41<00:13,  4.70it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.70it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.69it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.69it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.68it/s] 77%|███████▋  | 196/256 [00:42<00:12,  4.68it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.69it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.70it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.70it/s] 78%|███████▊  | 200/256 [00:43<00:11,  4.70it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.71it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.68it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.69it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.69it/s] 80%|████████  | 205/256 [00:44<00:12,  4.15it/s] 80%|████████  | 206/256 [00:45<00:12,  4.09it/s] 81%|████████  | 207/256 [00:45<00:11,  4.16it/s] 81%|████████▏ | 208/256 [00:45<00:11,  4.31it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.41it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.49it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.54it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.58it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.62it/s] 84%|████████▎ | 214/256 [00:46<00:09,  4.64it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.65it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.66it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.66it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.66it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.66it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.68it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.68it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.69it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.69it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.67it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.65it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.65it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.65it/s] 89%|████████▉ | 228/256 [00:49<00:05,  4.67it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.67it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.69it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.68it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.69it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.69it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.70it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.69it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.60it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.61it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.56it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.59it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.61it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.63it/s] 95%|█████████▍| 242/256 [00:52<00:03,  4.65it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.67it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.68it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.67it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.68it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.69it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.70it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.71it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.69it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.68it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.69it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.70it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.70it/s]100%|██████████| 256/256 [00:55<00:00,  4.69it/s]100%|██████████| 256/256 [00:56<00:00,  4.56it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [41.03, 43.91]
Multiscale SSIM on Highres [0.987, 0.995]
Range Invariant Multiscale SSIM on Highres [0.988, 0.996]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:25,  1.04s/it]  1%|          | 2/256 [00:01<02:21,  1.80it/s]  1%|          | 3/256 [00:01<01:41,  2.50it/s]  2%|▏         | 4/256 [00:01<01:22,  3.06it/s]  2%|▏         | 5/256 [00:01<01:11,  3.49it/s]  2%|▏         | 6/256 [00:02<01:05,  3.83it/s]  3%|▎         | 7/256 [00:02<01:01,  4.04it/s]  3%|▎         | 8/256 [00:02<00:58,  4.23it/s]  4%|▎         | 9/256 [00:02<00:56,  4.36it/s]  4%|▍         | 10/256 [00:02<00:55,  4.46it/s]  4%|▍         | 11/256 [00:03<00:54,  4.50it/s]  5%|▍         | 12/256 [00:03<00:53,  4.54it/s]  5%|▌         | 13/256 [00:03<00:53,  4.57it/s]  5%|▌         | 14/256 [00:03<00:52,  4.59it/s]  6%|▌         | 15/256 [00:04<00:52,  4.61it/s]  6%|▋         | 16/256 [00:04<00:51,  4.62it/s]  7%|▋         | 17/256 [00:04<00:51,  4.62it/s]  7%|▋         | 18/256 [00:04<00:51,  4.64it/s]  7%|▋         | 19/256 [00:04<00:51,  4.65it/s]  8%|▊         | 20/256 [00:05<00:50,  4.65it/s]  8%|▊         | 21/256 [00:05<00:50,  4.64it/s]  9%|▊         | 22/256 [00:05<00:50,  4.64it/s]  9%|▉         | 23/256 [00:05<00:50,  4.65it/s]  9%|▉         | 24/256 [00:05<00:50,  4.64it/s] 10%|▉         | 25/256 [00:06<00:49,  4.62it/s] 10%|█         | 26/256 [00:06<00:49,  4.61it/s] 11%|█         | 27/256 [00:06<00:49,  4.60it/s] 11%|█         | 28/256 [00:06<00:49,  4.59it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.61it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.61it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.64it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.66it/s] 13%|█▎        | 33/256 [00:07<00:47,  4.65it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.67it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.70it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.67it/s] 14%|█▍        | 37/256 [00:08<00:46,  4.67it/s] 15%|█▍        | 38/256 [00:09<00:46,  4.68it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.68it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.68it/s] 16%|█▌        | 41/256 [00:09<00:45,  4.68it/s] 16%|█▋        | 42/256 [00:09<00:45,  4.68it/s] 17%|█▋        | 43/256 [00:10<00:45,  4.67it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.68it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.67it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.58it/s] 18%|█▊        | 47/256 [00:10<00:48,  4.35it/s] 19%|█▉        | 48/256 [00:11<00:49,  4.23it/s] 19%|█▉        | 49/256 [00:11<00:47,  4.35it/s] 20%|█▉        | 50/256 [00:11<00:46,  4.44it/s] 20%|█▉        | 51/256 [00:11<00:45,  4.49it/s] 20%|██        | 52/256 [00:12<00:44,  4.54it/s] 21%|██        | 53/256 [00:12<00:44,  4.59it/s] 21%|██        | 54/256 [00:12<00:43,  4.61it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.64it/s] 22%|██▏       | 56/256 [00:12<00:43,  4.59it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.61it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.63it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.64it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.62it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.63it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.63it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.66it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.64it/s] 25%|██▌       | 65/256 [00:14<00:41,  4.57it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.60it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.64it/s] 27%|██▋       | 70/256 [00:15<00:39,  4.65it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.66it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.67it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.68it/s] 29%|██▉       | 74/256 [00:16<00:38,  4.67it/s] 29%|██▉       | 75/256 [00:17<00:38,  4.66it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.66it/s] 30%|███       | 77/256 [00:17<00:38,  4.67it/s] 30%|███       | 78/256 [00:17<00:38,  4.67it/s] 31%|███       | 79/256 [00:17<00:38,  4.66it/s] 31%|███▏      | 80/256 [00:18<00:37,  4.65it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.67it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.66it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.67it/s] 33%|███▎      | 84/256 [00:18<00:36,  4.68it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.67it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.65it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.64it/s] 34%|███▍      | 88/256 [00:19<00:36,  4.64it/s] 35%|███▍      | 89/256 [00:20<00:35,  4.65it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.65it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.65it/s] 36%|███▋      | 93/256 [00:20<00:35,  4.63it/s] 37%|███▋      | 94/256 [00:21<00:34,  4.65it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.67it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.66it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.67it/s] 38%|███▊      | 98/256 [00:21<00:33,  4.66it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.66it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.66it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.65it/s] 40%|███▉      | 102/256 [00:22<00:33,  4.66it/s] 40%|████      | 103/256 [00:23<00:32,  4.66it/s] 41%|████      | 104/256 [00:23<00:32,  4.66it/s] 41%|████      | 105/256 [00:23<00:32,  4.67it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.67it/s] 42%|████▏     | 107/256 [00:23<00:31,  4.67it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.67it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.67it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.66it/s] 44%|████▍     | 112/256 [00:24<00:30,  4.65it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.67it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.65it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.65it/s] 45%|████▌     | 116/256 [00:25<00:30,  4.66it/s] 46%|████▌     | 117/256 [00:26<00:29,  4.65it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.67it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.67it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.64it/s] 47%|████▋     | 121/256 [00:26<00:29,  4.63it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.64it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.65it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.64it/s] 49%|████▉     | 125/256 [00:27<00:28,  4.66it/s] 49%|████▉     | 126/256 [00:27<00:27,  4.66it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.67it/s] 50%|█████     | 128/256 [00:28<00:27,  4.65it/s] 50%|█████     | 129/256 [00:28<00:27,  4.65it/s] 51%|█████     | 130/256 [00:28<00:27,  4.65it/s] 51%|█████     | 131/256 [00:29<00:26,  4.65it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.66it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.66it/s] 53%|█████▎    | 135/256 [00:29<00:25,  4.67it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.67it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 139/256 [00:30<00:25,  4.66it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.67it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.66it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.66it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.67it/s] 56%|█████▋    | 144/256 [00:31<00:23,  4.68it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.66it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.65it/s] 58%|█████▊    | 149/256 [00:32<00:23,  4.64it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.66it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.66it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.67it/s] 60%|█████▉    | 153/256 [00:33<00:22,  4.68it/s] 60%|██████    | 154/256 [00:34<00:21,  4.68it/s] 61%|██████    | 155/256 [00:34<00:21,  4.68it/s] 61%|██████    | 156/256 [00:34<00:21,  4.67it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.67it/s] 62%|██████▏   | 158/256 [00:34<00:20,  4.68it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.66it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.68it/s] 63%|██████▎   | 162/256 [00:35<00:20,  4.67it/s] 64%|██████▎   | 163/256 [00:35<00:19,  4.66it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.67it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.65it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.64it/s] 65%|██████▌   | 167/256 [00:36<00:19,  4.65it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.65it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.66it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.65it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.65it/s] 67%|██████▋   | 172/256 [00:37<00:18,  4.66it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.67it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.67it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.67it/s] 69%|██████▉   | 176/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 177/256 [00:38<00:16,  4.66it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.65it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.65it/s] 70%|███████   | 180/256 [00:39<00:16,  4.65it/s] 71%|███████   | 181/256 [00:39<00:16,  4.65it/s] 71%|███████   | 182/256 [00:40<00:16,  4.62it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.64it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.65it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.65it/s] 73%|███████▎  | 186/256 [00:40<00:15,  4.40it/s] 73%|███████▎  | 187/256 [00:41<00:16,  4.26it/s] 73%|███████▎  | 188/256 [00:41<00:15,  4.37it/s] 74%|███████▍  | 189/256 [00:41<00:15,  4.45it/s] 74%|███████▍  | 190/256 [00:41<00:14,  4.51it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.53it/s] 75%|███████▌  | 192/256 [00:42<00:14,  4.57it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.61it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.62it/s] 76%|███████▌  | 195/256 [00:42<00:13,  4.62it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.64it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.65it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.66it/s] 78%|███████▊  | 199/256 [00:43<00:12,  4.65it/s] 78%|███████▊  | 200/256 [00:43<00:12,  4.62it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.64it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.66it/s] 79%|███████▉  | 203/256 [00:44<00:11,  4.65it/s] 80%|███████▉  | 204/256 [00:44<00:11,  4.67it/s] 80%|████████  | 205/256 [00:45<00:10,  4.66it/s] 80%|████████  | 206/256 [00:45<00:10,  4.67it/s] 81%|████████  | 207/256 [00:45<00:10,  4.66it/s] 81%|████████▏ | 208/256 [00:45<00:10,  4.66it/s] 82%|████████▏ | 209/256 [00:45<00:10,  4.65it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.66it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.68it/s] 83%|████████▎ | 213/256 [00:46<00:09,  4.67it/s] 84%|████████▎ | 214/256 [00:46<00:08,  4.68it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.69it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.68it/s] 85%|████████▍ | 217/256 [00:47<00:08,  4.68it/s] 85%|████████▌ | 218/256 [00:47<00:08,  4.69it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.69it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.70it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.70it/s] 87%|████████▋ | 222/256 [00:48<00:07,  4.69it/s] 87%|████████▋ | 223/256 [00:48<00:07,  4.67it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.67it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.65it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.65it/s] 89%|████████▊ | 227/256 [00:49<00:06,  4.67it/s] 89%|████████▉ | 228/256 [00:49<00:05,  4.67it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.68it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.68it/s] 90%|█████████ | 231/256 [00:50<00:05,  4.67it/s] 91%|█████████ | 232/256 [00:50<00:05,  4.65it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.66it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.66it/s] 92%|█████████▏| 236/256 [00:51<00:04,  4.67it/s] 93%|█████████▎| 237/256 [00:51<00:04,  4.67it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.67it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.68it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.62it/s] 94%|█████████▍| 241/256 [00:52<00:03,  4.63it/s] 95%|█████████▍| 242/256 [00:52<00:03,  4.64it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.65it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.64it/s] 96%|█████████▌| 245/256 [00:53<00:02,  4.40it/s] 96%|█████████▌| 246/256 [00:53<00:02,  4.48it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.54it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.56it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.59it/s] 98%|█████████▊| 250/256 [00:54<00:01,  4.61it/s] 98%|█████████▊| 251/256 [00:54<00:01,  4.62it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.64it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.66it/s]100%|█████████▉| 255/256 [00:55<00:00,  4.66it/s]100%|██████████| 256/256 [00:56<00:00,  4.67it/s]100%|██████████| 256/256 [00:56<00:00,  4.56it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [58.42, 43.29]
Multiscale SSIM on Highres [0.999, 0.962]
Range Invariant Multiscale SSIM on Highres [1.0, 0.992]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/stats_disentangle_2405_D18-M3-S0-L8_14.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/15
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/15


Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 111
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:45,  1.12s/it]  1%|          | 2/256 [00:01<02:29,  1.70it/s]  1%|          | 3/256 [00:01<01:46,  2.38it/s]  2%|▏         | 4/256 [00:01<01:25,  2.95it/s]  2%|▏         | 5/256 [00:01<01:13,  3.40it/s]  2%|▏         | 6/256 [00:02<01:06,  3.75it/s]  3%|▎         | 7/256 [00:02<01:05,  3.81it/s]  3%|▎         | 8/256 [00:02<01:04,  3.83it/s]  4%|▎         | 9/256 [00:02<01:03,  3.89it/s]  4%|▍         | 10/256 [00:03<01:00,  4.08it/s]  4%|▍         | 11/256 [00:03<01:03,  3.85it/s]  5%|▍         | 12/256 [00:04<01:25,  2.85it/s]  5%|▌         | 13/256 [00:04<01:15,  3.23it/s]  5%|▌         | 14/256 [00:04<01:07,  3.57it/s]  6%|▌         | 15/256 [00:04<01:02,  3.83it/s]  6%|▋         | 16/256 [00:04<00:59,  4.04it/s]  7%|▋         | 17/256 [00:05<01:10,  3.40it/s]  7%|▋         | 18/256 [00:05<01:04,  3.70it/s]  7%|▋         | 19/256 [00:05<01:00,  3.94it/s]  8%|▊         | 20/256 [00:05<00:57,  4.08it/s]  8%|▊         | 21/256 [00:06<00:55,  4.23it/s]  9%|▊         | 22/256 [00:06<00:57,  4.09it/s]  9%|▉         | 23/256 [00:06<00:55,  4.23it/s]  9%|▉         | 24/256 [00:06<00:53,  4.35it/s] 10%|▉         | 25/256 [00:07<00:52,  4.44it/s] 10%|█         | 26/256 [00:07<00:51,  4.49it/s] 11%|█         | 27/256 [00:07<00:50,  4.53it/s] 11%|█         | 28/256 [00:07<00:49,  4.57it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.59it/s] 12%|█▏        | 30/256 [00:08<00:49,  4.59it/s] 12%|█▏        | 31/256 [00:08<00:48,  4.59it/s] 12%|█▎        | 32/256 [00:08<00:48,  4.58it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.60it/s] 13%|█▎        | 34/256 [00:09<00:48,  4.60it/s] 14%|█▎        | 35/256 [00:09<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:09<00:47,  4.63it/s] 14%|█▍        | 37/256 [00:09<00:47,  4.63it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.62it/s] 15%|█▌        | 39/256 [00:10<00:46,  4.62it/s] 16%|█▌        | 40/256 [00:10<00:46,  4.61it/s] 16%|█▌        | 41/256 [00:10<00:46,  4.61it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 44/256 [00:11<00:45,  4.62it/s] 18%|█▊        | 45/256 [00:11<00:46,  4.58it/s] 18%|█▊        | 46/256 [00:11<00:45,  4.59it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.60it/s] 19%|█▉        | 48/256 [00:12<00:45,  4.60it/s] 19%|█▉        | 49/256 [00:12<00:44,  4.61it/s] 20%|█▉        | 50/256 [00:12<00:44,  4.60it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.62it/s] 20%|██        | 52/256 [00:13<00:58,  3.47it/s] 21%|██        | 53/256 [00:13<00:54,  3.76it/s] 21%|██        | 54/256 [00:13<00:50,  3.98it/s] 21%|██▏       | 55/256 [00:13<00:48,  4.15it/s] 22%|██▏       | 56/256 [00:14<00:46,  4.27it/s] 22%|██▏       | 57/256 [00:14<00:50,  3.95it/s] 23%|██▎       | 58/256 [00:14<00:47,  4.13it/s] 23%|██▎       | 59/256 [00:14<00:46,  4.27it/s] 23%|██▎       | 60/256 [00:14<00:44,  4.39it/s] 24%|██▍       | 61/256 [00:15<00:43,  4.46it/s] 24%|██▍       | 62/256 [00:15<00:43,  4.49it/s] 25%|██▍       | 63/256 [00:15<00:42,  4.53it/s] 25%|██▌       | 64/256 [00:15<00:42,  4.57it/s] 25%|██▌       | 65/256 [00:16<00:41,  4.59it/s] 26%|██▌       | 66/256 [00:16<00:41,  4.61it/s] 26%|██▌       | 67/256 [00:16<00:40,  4.62it/s] 27%|██▋       | 68/256 [00:16<00:40,  4.62it/s] 27%|██▋       | 69/256 [00:16<00:40,  4.64it/s] 27%|██▋       | 70/256 [00:17<00:40,  4.64it/s] 28%|██▊       | 71/256 [00:17<00:39,  4.64it/s] 28%|██▊       | 72/256 [00:17<00:42,  4.31it/s] 29%|██▊       | 73/256 [00:17<00:41,  4.39it/s] 29%|██▉       | 74/256 [00:18<00:40,  4.45it/s] 29%|██▉       | 75/256 [00:18<00:40,  4.52it/s] 30%|██▉       | 76/256 [00:18<00:39,  4.55it/s] 30%|███       | 77/256 [00:18<00:47,  3.75it/s] 30%|███       | 78/256 [00:19<00:44,  3.97it/s] 31%|███       | 79/256 [00:19<00:42,  4.14it/s] 31%|███▏      | 80/256 [00:19<00:41,  4.29it/s] 32%|███▏      | 81/256 [00:19<00:39,  4.39it/s] 32%|███▏      | 82/256 [00:19<00:39,  4.46it/s] 32%|███▏      | 83/256 [00:20<00:38,  4.51it/s] 33%|███▎      | 84/256 [00:20<00:37,  4.55it/s] 33%|███▎      | 85/256 [00:20<00:37,  4.58it/s] 34%|███▎      | 86/256 [00:20<00:36,  4.61it/s] 34%|███▍      | 87/256 [00:21<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:21<00:36,  4.63it/s] 35%|███▍      | 89/256 [00:21<00:35,  4.64it/s] 35%|███▌      | 90/256 [00:21<00:35,  4.66it/s] 36%|███▌      | 91/256 [00:21<00:35,  4.65it/s] 36%|███▌      | 92/256 [00:22<00:35,  4.66it/s] 36%|███▋      | 93/256 [00:22<00:34,  4.66it/s] 37%|███▋      | 94/256 [00:22<00:34,  4.66it/s] 37%|███▋      | 95/256 [00:22<00:34,  4.64it/s] 38%|███▊      | 96/256 [00:22<00:34,  4.65it/s] 38%|███▊      | 97/256 [00:23<00:34,  4.65it/s] 38%|███▊      | 98/256 [00:23<00:34,  4.64it/s] 39%|███▊      | 99/256 [00:23<00:33,  4.66it/s] 39%|███▉      | 100/256 [00:23<00:33,  4.65it/s] 39%|███▉      | 101/256 [00:24<00:36,  4.30it/s] 40%|███▉      | 102/256 [00:24<00:34,  4.40it/s] 40%|████      | 103/256 [00:24<00:34,  4.48it/s] 41%|████      | 104/256 [00:24<00:33,  4.54it/s] 41%|████      | 105/256 [00:24<00:32,  4.59it/s] 41%|████▏     | 106/256 [00:25<00:32,  4.61it/s] 42%|████▏     | 107/256 [00:25<00:32,  4.64it/s] 42%|████▏     | 108/256 [00:25<00:31,  4.66it/s] 43%|████▎     | 109/256 [00:25<00:31,  4.65it/s] 43%|████▎     | 110/256 [00:26<00:31,  4.66it/s] 43%|████▎     | 111/256 [00:26<00:31,  4.64it/s] 44%|████▍     | 112/256 [00:26<00:30,  4.66it/s] 44%|████▍     | 113/256 [00:26<00:30,  4.66it/s] 45%|████▍     | 114/256 [00:26<00:30,  4.67it/s] 45%|████▍     | 115/256 [00:27<00:30,  4.68it/s] 45%|████▌     | 116/256 [00:27<00:35,  3.93it/s] 46%|████▌     | 117/256 [00:27<00:33,  4.13it/s] 46%|████▌     | 118/256 [00:27<00:32,  4.27it/s] 46%|████▋     | 119/256 [00:28<00:31,  4.38it/s] 47%|████▋     | 120/256 [00:28<00:30,  4.45it/s] 47%|████▋     | 121/256 [00:28<00:36,  3.73it/s] 48%|████▊     | 122/256 [00:28<00:33,  3.98it/s] 48%|████▊     | 123/256 [00:29<00:32,  4.15it/s] 48%|████▊     | 124/256 [00:29<00:30,  4.28it/s] 49%|████▉     | 125/256 [00:29<00:38,  3.41it/s] 49%|████▉     | 126/256 [00:29<00:35,  3.71it/s] 50%|████▉     | 127/256 [00:30<00:32,  3.96it/s] 50%|█████     | 128/256 [00:30<00:30,  4.14it/s] 50%|█████     | 129/256 [00:30<00:29,  4.27it/s] 51%|█████     | 130/256 [00:30<00:28,  4.36it/s] 51%|█████     | 131/256 [00:31<00:28,  4.45it/s] 52%|█████▏    | 132/256 [00:31<00:27,  4.51it/s] 52%|█████▏    | 133/256 [00:31<00:27,  4.55it/s] 52%|█████▏    | 134/256 [00:31<00:26,  4.59it/s] 53%|█████▎    | 135/256 [00:31<00:26,  4.61it/s] 53%|█████▎    | 136/256 [00:32<00:26,  4.56it/s] 54%|█████▎    | 137/256 [00:32<00:29,  4.00it/s] 54%|█████▍    | 138/256 [00:32<00:29,  4.00it/s] 54%|█████▍    | 139/256 [00:32<00:29,  3.99it/s] 55%|█████▍    | 140/256 [00:33<00:27,  4.18it/s] 55%|█████▌    | 141/256 [00:33<00:26,  4.30it/s] 55%|█████▌    | 142/256 [00:33<00:25,  4.39it/s] 56%|█████▌    | 143/256 [00:33<00:29,  3.85it/s] 56%|█████▋    | 144/256 [00:34<00:27,  4.06it/s] 57%|█████▋    | 145/256 [00:34<00:26,  4.22it/s] 57%|█████▋    | 146/256 [00:34<00:25,  4.35it/s] 57%|█████▋    | 147/256 [00:34<00:24,  4.43it/s] 58%|█████▊    | 148/256 [00:34<00:24,  4.48it/s] 58%|█████▊    | 149/256 [00:35<00:23,  4.52it/s] 59%|█████▊    | 150/256 [00:35<00:23,  4.57it/s] 59%|█████▉    | 151/256 [00:35<00:22,  4.58it/s] 59%|█████▉    | 152/256 [00:35<00:22,  4.62it/s] 60%|█████▉    | 153/256 [00:36<00:26,  3.90it/s] 60%|██████    | 154/256 [00:36<00:24,  4.11it/s] 61%|██████    | 155/256 [00:36<00:23,  4.27it/s] 61%|██████    | 156/256 [00:36<00:22,  4.38it/s] 61%|██████▏   | 157/256 [00:37<00:22,  4.46it/s] 62%|██████▏   | 158/256 [00:37<00:22,  4.42it/s] 62%|██████▏   | 159/256 [00:37<00:21,  4.49it/s] 62%|██████▎   | 160/256 [00:37<00:21,  4.54it/s] 63%|██████▎   | 161/256 [00:37<00:20,  4.57it/s] 63%|██████▎   | 162/256 [00:38<00:20,  4.59it/s] 64%|██████▎   | 163/256 [00:38<00:22,  4.15it/s] 64%|██████▍   | 164/256 [00:38<00:21,  4.30it/s] 64%|██████▍   | 165/256 [00:38<00:20,  4.34it/s] 65%|██████▍   | 166/256 [00:39<00:20,  4.43it/s] 65%|██████▌   | 167/256 [00:39<00:19,  4.50it/s] 66%|██████▌   | 168/256 [00:39<00:25,  3.45it/s] 66%|██████▌   | 169/256 [00:39<00:23,  3.75it/s] 66%|██████▋   | 170/256 [00:40<00:21,  3.98it/s] 67%|██████▋   | 171/256 [00:40<00:20,  4.17it/s] 67%|██████▋   | 172/256 [00:40<00:19,  4.31it/s] 68%|██████▊   | 173/256 [00:40<00:18,  4.41it/s] 68%|██████▊   | 174/256 [00:41<00:18,  4.47it/s] 68%|██████▊   | 175/256 [00:41<00:17,  4.52it/s] 69%|██████▉   | 176/256 [00:41<00:17,  4.57it/s] 69%|██████▉   | 177/256 [00:41<00:17,  4.61it/s] 70%|██████▉   | 178/256 [00:42<00:24,  3.19it/s] 70%|██████▉   | 179/256 [00:42<00:21,  3.52it/s] 70%|███████   | 180/256 [00:42<00:20,  3.80it/s] 71%|███████   | 181/256 [00:42<00:18,  4.02it/s] 71%|███████   | 182/256 [00:43<00:17,  4.19it/s] 71%|███████▏  | 183/256 [00:43<00:18,  4.03it/s] 72%|███████▏  | 184/256 [00:43<00:17,  4.21it/s] 72%|███████▏  | 185/256 [00:43<00:16,  4.34it/s] 73%|███████▎  | 186/256 [00:43<00:15,  4.44it/s] 73%|███████▎  | 187/256 [00:44<00:15,  4.51it/s] 73%|███████▎  | 188/256 [00:44<00:14,  4.57it/s] 74%|███████▍  | 189/256 [00:44<00:14,  4.60it/s] 74%|███████▍  | 190/256 [00:44<00:14,  4.62it/s] 75%|███████▍  | 191/256 [00:45<00:14,  4.63it/s] 75%|███████▌  | 192/256 [00:45<00:13,  4.64it/s] 75%|███████▌  | 193/256 [00:45<00:13,  4.65it/s] 76%|███████▌  | 194/256 [00:45<00:13,  4.65it/s] 76%|███████▌  | 195/256 [00:45<00:13,  4.66it/s] 77%|███████▋  | 196/256 [00:46<00:12,  4.66it/s] 77%|███████▋  | 197/256 [00:46<00:12,  4.65it/s] 77%|███████▋  | 198/256 [00:46<00:12,  4.67it/s] 78%|███████▊  | 199/256 [00:46<00:12,  4.68it/s] 78%|███████▊  | 200/256 [00:46<00:11,  4.68it/s] 79%|███████▊  | 201/256 [00:47<00:11,  4.69it/s] 79%|███████▉  | 202/256 [00:47<00:11,  4.69it/s] 79%|███████▉  | 203/256 [00:47<00:11,  4.67it/s] 80%|███████▉  | 204/256 [00:47<00:11,  4.66it/s] 80%|████████  | 205/256 [00:48<00:10,  4.65it/s] 80%|████████  | 206/256 [00:48<00:10,  4.65it/s] 81%|████████  | 207/256 [00:48<00:10,  4.66it/s] 81%|████████▏ | 208/256 [00:48<00:10,  4.67it/s] 82%|████████▏ | 209/256 [00:48<00:10,  4.67it/s] 82%|████████▏ | 210/256 [00:49<00:09,  4.66it/s] 82%|████████▏ | 211/256 [00:49<00:09,  4.66it/s] 83%|████████▎ | 212/256 [00:49<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:49<00:09,  4.65it/s] 84%|████████▎ | 214/256 [00:49<00:09,  4.65it/s] 84%|████████▍ | 215/256 [00:50<00:08,  4.65it/s] 84%|████████▍ | 216/256 [00:50<00:08,  4.65it/s] 85%|████████▍ | 217/256 [00:50<00:08,  4.67it/s] 85%|████████▌ | 218/256 [00:50<00:08,  4.68it/s] 86%|████████▌ | 219/256 [00:51<00:07,  4.66it/s] 86%|████████▌ | 220/256 [00:51<00:07,  4.66it/s] 86%|████████▋ | 221/256 [00:51<00:07,  4.65it/s] 87%|████████▋ | 222/256 [00:51<00:07,  4.65it/s] 87%|████████▋ | 223/256 [00:51<00:07,  4.63it/s] 88%|████████▊ | 224/256 [00:52<00:06,  4.64it/s] 88%|████████▊ | 225/256 [00:52<00:06,  4.65it/s] 88%|████████▊ | 226/256 [00:52<00:06,  4.66it/s] 89%|████████▊ | 227/256 [00:52<00:06,  4.66it/s] 89%|████████▉ | 228/256 [00:52<00:05,  4.68it/s] 89%|████████▉ | 229/256 [00:53<00:05,  4.66it/s] 90%|████████▉ | 230/256 [00:53<00:05,  4.66it/s] 90%|█████████ | 231/256 [00:53<00:05,  4.67it/s] 91%|█████████ | 232/256 [00:53<00:05,  4.67it/s] 91%|█████████ | 233/256 [00:54<00:04,  4.68it/s] 91%|█████████▏| 234/256 [00:54<00:04,  4.68it/s] 92%|█████████▏| 235/256 [00:54<00:04,  4.67it/s] 92%|█████████▏| 236/256 [00:54<00:04,  4.66it/s] 93%|█████████▎| 237/256 [00:54<00:04,  4.65it/s] 93%|█████████▎| 238/256 [00:55<00:03,  4.65it/s] 93%|█████████▎| 239/256 [00:55<00:03,  4.63it/s] 94%|█████████▍| 240/256 [00:55<00:03,  4.61it/s] 94%|█████████▍| 241/256 [00:55<00:03,  4.62it/s] 95%|█████████▍| 242/256 [00:56<00:03,  4.64it/s] 95%|█████████▍| 243/256 [00:56<00:02,  4.64it/s] 95%|█████████▌| 244/256 [00:56<00:02,  4.61it/s] 96%|█████████▌| 245/256 [00:56<00:02,  4.62it/s] 96%|█████████▌| 246/256 [00:56<00:02,  4.63it/s] 96%|█████████▋| 247/256 [00:57<00:01,  4.63it/s] 97%|█████████▋| 248/256 [00:57<00:01,  4.66it/s] 97%|█████████▋| 249/256 [00:57<00:01,  4.64it/s] 98%|█████████▊| 250/256 [00:57<00:01,  4.65it/s] 98%|█████████▊| 251/256 [00:57<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:58<00:00,  4.65it/s] 99%|█████████▉| 253/256 [00:58<00:00,  4.66it/s] 99%|█████████▉| 254/256 [00:58<00:00,  4.65it/s]100%|█████████▉| 255/256 [00:58<00:00,  4.66it/s]100%|██████████| 256/256 [00:59<00:00,  4.68it/s]100%|██████████| 256/256 [00:59<00:00,  4.32it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [61.89, 41.24]
Multiscale SSIM on Highres [1.0, 0.969]
Range Invariant Multiscale SSIM on Highres [1.0, 0.989]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/stats_disentangle_2405_D18-M3-S0-L8_15.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/10
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/10


Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 357
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:53,  1.15s/it]  1%|          | 2/256 [00:01<02:32,  1.67it/s]  1%|          | 3/256 [00:01<01:47,  2.35it/s]  2%|▏         | 4/256 [00:01<01:26,  2.92it/s]  2%|▏         | 5/256 [00:02<01:14,  3.38it/s]  2%|▏         | 6/256 [00:02<01:06,  3.74it/s]  3%|▎         | 7/256 [00:02<01:02,  4.00it/s]  3%|▎         | 8/256 [00:02<00:59,  4.20it/s]  4%|▎         | 9/256 [00:02<00:56,  4.34it/s]  4%|▍         | 10/256 [00:03<00:55,  4.42it/s]  4%|▍         | 11/256 [00:03<00:54,  4.46it/s]  5%|▍         | 12/256 [00:03<00:54,  4.52it/s]  5%|▌         | 13/256 [00:03<00:53,  4.56it/s]  5%|▌         | 14/256 [00:03<00:52,  4.57it/s]  6%|▌         | 15/256 [00:04<00:52,  4.60it/s]  6%|▋         | 16/256 [00:04<00:52,  4.58it/s]  7%|▋         | 17/256 [00:04<00:51,  4.60it/s]  7%|▋         | 18/256 [00:04<00:51,  4.60it/s]  7%|▋         | 19/256 [00:05<00:51,  4.61it/s]  8%|▊         | 20/256 [00:05<00:51,  4.63it/s]  8%|▊         | 21/256 [00:05<00:50,  4.62it/s]  9%|▊         | 22/256 [00:05<00:50,  4.63it/s]  9%|▉         | 23/256 [00:05<00:50,  4.62it/s]  9%|▉         | 24/256 [00:06<00:50,  4.62it/s] 10%|▉         | 25/256 [00:06<00:50,  4.61it/s] 10%|█         | 26/256 [00:06<00:49,  4.62it/s] 11%|█         | 27/256 [00:06<00:49,  4.62it/s] 11%|█         | 28/256 [00:06<00:49,  4.63it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.62it/s] 12%|█▏        | 30/256 [00:07<00:49,  4.53it/s] 12%|█▏        | 31/256 [00:07<00:49,  4.55it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.58it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.59it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.60it/s] 14%|█▎        | 35/256 [00:08<00:48,  4.60it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.62it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.62it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.60it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.60it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.59it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.60it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.60it/s] 17%|█▋        | 44/256 [00:10<00:46,  4.60it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.60it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.60it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.59it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.59it/s] 19%|█▉        | 49/256 [00:11<00:45,  4.59it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.59it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.60it/s] 20%|██        | 52/256 [00:12<00:47,  4.31it/s] 21%|██        | 53/256 [00:12<00:48,  4.19it/s] 21%|██        | 54/256 [00:12<00:46,  4.30it/s] 21%|██▏       | 55/256 [00:12<00:45,  4.39it/s] 22%|██▏       | 56/256 [00:13<00:44,  4.47it/s] 22%|██▏       | 57/256 [00:13<00:44,  4.52it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.52it/s] 23%|██▎       | 59/256 [00:13<00:43,  4.54it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.56it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.57it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.59it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.61it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.60it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.57it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.59it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.60it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.62it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.63it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.63it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.61it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.63it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.63it/s] 30%|███       | 77/256 [00:17<00:38,  4.65it/s] 30%|███       | 78/256 [00:17<00:38,  4.62it/s] 31%|███       | 79/256 [00:18<00:38,  4.62it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.61it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.52it/s] 32%|███▏      | 82/256 [00:18<00:38,  4.56it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.58it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.60it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.61it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.55it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.57it/s] 35%|███▌      | 90/256 [00:20<00:36,  4.60it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.60it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.60it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.63it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.62it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.63it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.63it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.62it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.62it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.62it/s] 40%|████      | 103/256 [00:23<00:33,  4.63it/s] 41%|████      | 104/256 [00:23<00:32,  4.63it/s] 41%|████      | 105/256 [00:23<00:32,  4.64it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.65it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.64it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.63it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.62it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.62it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.64it/s] 44%|████▍     | 112/256 [00:25<00:30,  4.65it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.64it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.63it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.63it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.62it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.62it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.62it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.64it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.66it/s] 47%|████▋     | 121/256 [00:27<00:28,  4.67it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.66it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.66it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.67it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.67it/s] 49%|████▉     | 126/256 [00:28<00:27,  4.66it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.65it/s] 50%|█████     | 128/256 [00:28<00:27,  4.65it/s] 50%|█████     | 129/256 [00:28<00:27,  4.65it/s] 51%|█████     | 130/256 [00:29<00:27,  4.64it/s] 51%|█████     | 131/256 [00:29<00:26,  4.66it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.65it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.66it/s] 53%|█████▎    | 135/256 [00:30<00:25,  4.66it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.66it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.66it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.66it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.63it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.64it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.65it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.65it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.65it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.65it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.65it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.65it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.64it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.64it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.66it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.65it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.66it/s] 60%|██████    | 154/256 [00:34<00:21,  4.66it/s] 61%|██████    | 155/256 [00:34<00:21,  4.65it/s] 61%|██████    | 156/256 [00:34<00:21,  4.65it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.65it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.66it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.66it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.64it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.65it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.64it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.64it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.65it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.64it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.64it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.64it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.63it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.65it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.65it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.64it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.64it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.66it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.67it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.59it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.60it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.62it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.62it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.63it/s] 70%|███████   | 180/256 [00:39<00:16,  4.65it/s] 71%|███████   | 181/256 [00:40<00:16,  4.57it/s] 71%|███████   | 182/256 [00:40<00:16,  4.59it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.62it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.63it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.64it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.62it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.62it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.64it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.59it/s] 74%|███████▍  | 190/256 [00:42<00:15,  4.37it/s] 75%|███████▍  | 191/256 [00:42<00:15,  4.19it/s] 75%|███████▌  | 192/256 [00:42<00:15,  4.14it/s] 75%|███████▌  | 193/256 [00:42<00:14,  4.28it/s] 76%|███████▌  | 194/256 [00:43<00:14,  4.40it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.47it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.52it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.56it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.57it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.59it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.58it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.60it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.62it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.63it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.61it/s] 80%|████████  | 205/256 [00:45<00:11,  4.63it/s] 80%|████████  | 206/256 [00:45<00:10,  4.64it/s] 81%|████████  | 207/256 [00:45<00:10,  4.64it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.61it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.62it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.63it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.62it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.61it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.61it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.62it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.60it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.60it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.57it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.59it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.60it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.59it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.59it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.59it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.60it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.60it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.57it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.58it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.58it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.56it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.54it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.56it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.52it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.55it/s] 91%|█████████ | 233/256 [00:51<00:05,  4.55it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.56it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.57it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.58it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.59it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.60it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.59it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.59it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.59it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.58it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.60it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.59it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.59it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.57it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.57it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.57it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.59it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.59it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.58it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.57it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.58it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.59it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.58it/s]100%|██████████| 256/256 [00:56<00:00,  4.60it/s]100%|██████████| 256/256 [00:56<00:00,  4.51it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [56.26, 40.13]
Multiscale SSIM on Highres [0.998, 0.955]
Range Invariant Multiscale SSIM on Highres [1.0, 0.984]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/stats_disentangle_2405_D18-M3-S0-L8_10.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/11
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode12
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/11


Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 366
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:49,  1.14s/it]  1%|          | 2/256 [00:01<02:31,  1.68it/s]  1%|          | 3/256 [00:01<01:46,  2.37it/s]  2%|▏         | 4/256 [00:01<01:25,  2.94it/s]  2%|▏         | 5/256 [00:01<01:13,  3.40it/s]  2%|▏         | 6/256 [00:02<01:06,  3.74it/s]  3%|▎         | 7/256 [00:02<01:02,  4.01it/s]  3%|▎         | 8/256 [00:02<00:59,  4.20it/s]  4%|▎         | 9/256 [00:02<00:57,  4.32it/s]  4%|▍         | 10/256 [00:03<00:55,  4.42it/s]  4%|▍         | 11/256 [00:03<00:54,  4.50it/s]  5%|▍         | 12/256 [00:03<00:53,  4.54it/s]  5%|▌         | 13/256 [00:03<00:53,  4.56it/s]  5%|▌         | 14/256 [00:03<00:52,  4.59it/s]  6%|▌         | 15/256 [00:04<00:52,  4.62it/s]  6%|▋         | 16/256 [00:04<00:51,  4.62it/s]  7%|▋         | 17/256 [00:04<00:51,  4.62it/s]  7%|▋         | 18/256 [00:04<00:51,  4.64it/s]  7%|▋         | 19/256 [00:05<00:51,  4.63it/s]  8%|▊         | 20/256 [00:05<00:50,  4.63it/s]  8%|▊         | 21/256 [00:05<00:50,  4.63it/s]  9%|▊         | 22/256 [00:05<00:50,  4.65it/s]  9%|▉         | 23/256 [00:05<00:50,  4.63it/s]  9%|▉         | 24/256 [00:06<00:50,  4.62it/s] 10%|▉         | 25/256 [00:06<00:49,  4.63it/s] 10%|█         | 26/256 [00:06<00:49,  4.64it/s] 11%|█         | 27/256 [00:06<00:49,  4.64it/s] 11%|█         | 28/256 [00:06<00:49,  4.65it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.63it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.62it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.61it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.64it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.64it/s] 15%|█▍        | 38/256 [00:09<00:46,  4.65it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.66it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.63it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.63it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.61it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.60it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.60it/s] 20%|██        | 52/256 [00:12<00:44,  4.60it/s] 21%|██        | 53/256 [00:12<00:44,  4.58it/s] 21%|██        | 54/256 [00:12<00:43,  4.61it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.60it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.61it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.61it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.62it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.61it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.60it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.60it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.60it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.61it/s] 25%|██▌       | 65/256 [00:14<00:41,  4.60it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.59it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.60it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.60it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.60it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.62it/s] 29%|██▊       | 73/256 [00:16<00:40,  4.55it/s] 29%|██▉       | 74/256 [00:16<00:41,  4.34it/s] 29%|██▉       | 75/256 [00:17<00:43,  4.21it/s] 30%|██▉       | 76/256 [00:17<00:41,  4.29it/s] 30%|███       | 77/256 [00:17<00:40,  4.39it/s] 30%|███       | 78/256 [00:17<00:39,  4.46it/s] 31%|███       | 79/256 [00:18<00:39,  4.51it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.55it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.58it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.60it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.61it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.61it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.61it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.60it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.61it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.62it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.63it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.63it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.63it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.63it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.62it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.60it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.60it/s] 39%|███▉      | 100/256 [00:22<00:34,  4.58it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.60it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.61it/s] 40%|████      | 103/256 [00:23<00:36,  4.15it/s] 41%|████      | 104/256 [00:23<00:35,  4.29it/s] 41%|████      | 105/256 [00:23<00:34,  4.37it/s] 41%|████▏     | 106/256 [00:24<00:33,  4.44it/s] 42%|████▏     | 107/256 [00:24<00:33,  4.50it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.55it/s] 43%|████▎     | 109/256 [00:24<00:32,  4.58it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.58it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.58it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.53it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.55it/s] 45%|████▍     | 114/256 [00:25<00:31,  4.57it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.57it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.58it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.60it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.61it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.61it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.62it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.63it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.61it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.60it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.61it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.62it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.63it/s] 50%|█████     | 128/256 [00:28<00:27,  4.62it/s] 50%|█████     | 129/256 [00:29<00:27,  4.62it/s] 51%|█████     | 130/256 [00:29<00:27,  4.63it/s] 51%|█████     | 131/256 [00:29<00:27,  4.61it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.62it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.62it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.63it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.61it/s] 53%|█████▎    | 136/256 [00:30<00:26,  4.60it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.61it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.60it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.61it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.62it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.63it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.64it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.65it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.65it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.64it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.64it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.64it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.64it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.62it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.61it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.59it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.59it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.59it/s] 60%|██████    | 154/256 [00:34<00:22,  4.61it/s] 61%|██████    | 155/256 [00:34<00:21,  4.62it/s] 61%|██████    | 156/256 [00:34<00:21,  4.61it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.60it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.61it/s] 62%|██████▏   | 159/256 [00:35<00:21,  4.61it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.61it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.62it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.59it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.59it/s] 64%|██████▍   | 164/256 [00:36<00:20,  4.58it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.58it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.59it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.58it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.58it/s] 66%|██████▌   | 169/256 [00:37<00:19,  4.58it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.58it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.59it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.59it/s] 68%|██████▊   | 173/256 [00:38<00:18,  4.59it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.61it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.58it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.59it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.57it/s] 70%|██████▉   | 178/256 [00:39<00:17,  4.57it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.59it/s] 70%|███████   | 180/256 [00:40<00:16,  4.59it/s] 71%|███████   | 181/256 [00:40<00:16,  4.59it/s] 71%|███████   | 182/256 [00:40<00:16,  4.57it/s] 71%|███████▏  | 183/256 [00:40<00:16,  4.53it/s] 72%|███████▏  | 184/256 [00:40<00:16,  4.47it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.49it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.52it/s] 73%|███████▎  | 187/256 [00:41<00:15,  4.54it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.55it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.55it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.56it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.58it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.57it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.58it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.57it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.57it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.57it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.57it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.56it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.57it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.57it/s] 79%|███████▊  | 201/256 [00:44<00:12,  4.56it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.57it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.57it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.58it/s] 80%|████████  | 205/256 [00:45<00:11,  4.58it/s] 80%|████████  | 206/256 [00:45<00:10,  4.59it/s] 81%|████████  | 207/256 [00:46<00:10,  4.58it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.59it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.60it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.37it/s] 82%|████████▏ | 211/256 [00:46<00:10,  4.15it/s] 83%|████████▎ | 212/256 [00:47<00:10,  4.08it/s] 83%|████████▎ | 213/256 [00:47<00:10,  4.22it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.32it/s] 84%|████████▍ | 215/256 [00:47<00:09,  4.40it/s] 84%|████████▍ | 216/256 [00:48<00:08,  4.46it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.50it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.53it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.56it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.58it/s] 86%|████████▋ | 221/256 [00:49<00:07,  4.59it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.59it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.59it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.61it/s] 88%|████████▊ | 225/256 [00:50<00:06,  4.61it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.61it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.63it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.65it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.64it/s] 90%|████████▉ | 230/256 [00:51<00:05,  4.63it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.65it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.66it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.67it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.67it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.68it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.66it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.65it/s] 93%|█████████▎| 239/256 [00:53<00:03,  4.65it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.64it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.64it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.65it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.66it/s] 95%|█████████▌| 244/256 [00:54<00:02,  4.64it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.64it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.64it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.64it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.64it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.63it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.64it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.64it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.65it/s] 99%|█████████▉| 253/256 [00:56<00:00,  4.65it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.64it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.64it/s]100%|██████████| 256/256 [00:56<00:00,  4.63it/s]100%|██████████| 256/256 [00:56<00:00,  4.50it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [41.01, 42.02]
Multiscale SSIM on Highres [0.993, 0.994]
Range Invariant Multiscale SSIM on Highres [0.994, 0.994]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/stats_disentangle_2405_D18-M3-S0-L8_11.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/12
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode15
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/12


Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 399
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:53,  1.15s/it]  1%|          | 2/256 [00:01<02:34,  1.64it/s]  1%|          | 3/256 [00:01<01:48,  2.33it/s]  2%|▏         | 4/256 [00:01<01:27,  2.90it/s]  2%|▏         | 5/256 [00:02<01:14,  3.35it/s]  2%|▏         | 6/256 [00:02<01:07,  3.70it/s]  3%|▎         | 7/256 [00:02<01:02,  3.98it/s]  3%|▎         | 8/256 [00:02<00:59,  4.18it/s]  4%|▎         | 9/256 [00:02<00:57,  4.32it/s]  4%|▍         | 10/256 [00:03<00:55,  4.42it/s]  4%|▍         | 11/256 [00:03<00:54,  4.48it/s]  5%|▍         | 12/256 [00:03<00:53,  4.53it/s]  5%|▌         | 13/256 [00:03<00:53,  4.56it/s]  5%|▌         | 14/256 [00:03<00:52,  4.58it/s]  6%|▌         | 15/256 [00:04<00:52,  4.58it/s]  6%|▋         | 16/256 [00:04<00:52,  4.60it/s]  7%|▋         | 17/256 [00:04<00:52,  4.59it/s]  7%|▋         | 18/256 [00:04<00:54,  4.37it/s]  7%|▋         | 19/256 [00:05<00:57,  4.12it/s]  8%|▊         | 20/256 [00:05<00:58,  4.06it/s]  8%|▊         | 21/256 [00:05<00:55,  4.21it/s]  9%|▊         | 22/256 [00:05<00:54,  4.32it/s]  9%|▉         | 23/256 [00:06<00:52,  4.41it/s]  9%|▉         | 24/256 [00:06<00:51,  4.47it/s] 10%|▉         | 25/256 [00:06<00:51,  4.51it/s] 10%|█         | 26/256 [00:06<00:50,  4.53it/s] 11%|█         | 27/256 [00:06<00:50,  4.55it/s] 11%|█         | 28/256 [00:07<00:49,  4.57it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.62it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.63it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.65it/s] 13%|█▎        | 33/256 [00:08<00:47,  4.65it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.61it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.60it/s] 14%|█▍        | 37/256 [00:09<00:47,  4.61it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.61it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.61it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.61it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.60it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.60it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 46/256 [00:11<00:45,  4.63it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.64it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.64it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.64it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.65it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.64it/s] 20%|██        | 52/256 [00:12<00:44,  4.64it/s] 21%|██        | 53/256 [00:12<00:43,  4.63it/s] 21%|██        | 54/256 [00:12<00:43,  4.63it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.63it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.63it/s] 22%|██▏       | 57/256 [00:13<00:42,  4.64it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.59it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.59it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.62it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.61it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.61it/s] 25%|██▌       | 65/256 [00:15<00:42,  4.54it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.56it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.58it/s] 27%|██▋       | 68/256 [00:15<00:41,  4.58it/s] 27%|██▋       | 69/256 [00:16<00:40,  4.57it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.58it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.59it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.60it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.60it/s] 29%|██▉       | 74/256 [00:17<00:40,  4.54it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.56it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.58it/s] 30%|███       | 77/256 [00:17<00:38,  4.60it/s] 30%|███       | 78/256 [00:17<00:38,  4.60it/s] 31%|███       | 79/256 [00:18<00:38,  4.59it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.61it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.61it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.61it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.60it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.60it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.61it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.62it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.63it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.63it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.61it/s] 36%|███▌      | 92/256 [00:21<00:35,  4.62it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.62it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.62it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.62it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.63it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.63it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.63it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.63it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.64it/s] 40%|████      | 103/256 [00:23<00:33,  4.63it/s] 41%|████      | 104/256 [00:23<00:32,  4.63it/s] 41%|████      | 105/256 [00:23<00:32,  4.62it/s] 41%|████▏     | 106/256 [00:24<00:32,  4.63it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.63it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.62it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.61it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.62it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.61it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.59it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.61it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.59it/s] 46%|████▌     | 118/256 [00:26<00:30,  4.60it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.59it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.59it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.60it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.60it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.60it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.61it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.63it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.64it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.64it/s] 50%|█████     | 128/256 [00:28<00:27,  4.63it/s] 50%|█████     | 129/256 [00:29<00:27,  4.63it/s] 51%|█████     | 130/256 [00:29<00:27,  4.62it/s] 51%|█████     | 131/256 [00:29<00:26,  4.63it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.62it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.62it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.62it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.60it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.60it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.61it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.61it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.62it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.62it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.63it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.63it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.63it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.62it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.60it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.62it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.62it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.62it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.62it/s] 59%|█████▉    | 152/256 [00:34<00:22,  4.61it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.62it/s] 60%|██████    | 154/256 [00:34<00:22,  4.61it/s] 61%|██████    | 155/256 [00:34<00:21,  4.62it/s] 61%|██████    | 156/256 [00:34<00:22,  4.37it/s] 61%|██████▏   | 157/256 [00:35<00:23,  4.24it/s] 62%|██████▏   | 158/256 [00:35<00:23,  4.14it/s] 62%|██████▏   | 159/256 [00:35<00:22,  4.25it/s] 62%|██████▎   | 160/256 [00:35<00:22,  4.36it/s] 63%|██████▎   | 161/256 [00:36<00:21,  4.43it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.48it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.50it/s] 64%|██████▍   | 164/256 [00:36<00:20,  4.54it/s] 64%|██████▍   | 165/256 [00:36<00:20,  4.55it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.57it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.58it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.58it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.59it/s] 66%|██████▋   | 170/256 [00:38<00:18,  4.59it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.58it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.59it/s] 68%|██████▊   | 173/256 [00:38<00:18,  4.61it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.62it/s] 68%|██████▊   | 175/256 [00:39<00:17,  4.62it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.61it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.61it/s] 70%|██████▉   | 178/256 [00:39<00:17,  4.59it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.60it/s] 70%|███████   | 180/256 [00:40<00:16,  4.60it/s] 71%|███████   | 181/256 [00:40<00:16,  4.63it/s] 71%|███████   | 182/256 [00:40<00:15,  4.63it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.61it/s] 72%|███████▏  | 184/256 [00:41<00:15,  4.61it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.61it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.61it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.61it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.62it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.62it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.61it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.63it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.63it/s] 75%|███████▌  | 193/256 [00:43<00:13,  4.64it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.64it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.64it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.63it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.61it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.60it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.60it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.62it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.61it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.60it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.61it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.62it/s] 80%|████████  | 205/256 [00:45<00:11,  4.62it/s] 80%|████████  | 206/256 [00:45<00:10,  4.61it/s] 81%|████████  | 207/256 [00:46<00:10,  4.59it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.61it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.62it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.63it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.62it/s] 83%|████████▎ | 212/256 [00:47<00:09,  4.62it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.51it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.54it/s] 84%|████████▍ | 215/256 [00:47<00:09,  4.55it/s] 84%|████████▍ | 216/256 [00:48<00:08,  4.57it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.59it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.60it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.60it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.61it/s] 86%|████████▋ | 221/256 [00:49<00:07,  4.61it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.62it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.60it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.60it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.60it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.60it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.57it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.57it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.57it/s] 90%|████████▉ | 230/256 [00:51<00:05,  4.46it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.47it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.52it/s] 91%|█████████ | 233/256 [00:51<00:05,  4.53it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.54it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.55it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.58it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.56it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.58it/s] 93%|█████████▎| 239/256 [00:53<00:03,  4.58it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.58it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.58it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.57it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.56it/s] 95%|█████████▌| 244/256 [00:54<00:02,  4.59it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.58it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.58it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.58it/s] 97%|█████████▋| 248/256 [00:55<00:01,  4.59it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.60it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.60it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.59it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.60it/s] 99%|█████████▉| 253/256 [00:56<00:00,  4.60it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.60it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.60it/s]100%|██████████| 256/256 [00:56<00:00,  4.61it/s]100%|██████████| 256/256 [00:56<00:00,  4.49it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [31.75, 37.83]
Multiscale SSIM on Highres [0.932, 0.98]
Range Invariant Multiscale SSIM on Highres [0.938, 0.979]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/stats_disentangle_2405_D18-M3-S0-L8_12.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F18.75/kth_3/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif
data:
  background_quantile: 0.0
  channel_idx_list:
  - GT_Cy5
  - GT_TRITC
  - 555-647
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/6
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: caa1d41d654fb423a7c3abc700486f87d132a2f7
  untracked_files: []
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/6

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Train

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Test

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 93
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:45,  1.16s/it]  5%|▌         | 2/40 [00:01<00:23,  1.65it/s]  8%|▊         | 3/40 [00:01<00:15,  2.34it/s] 10%|█         | 4/40 [00:01<00:12,  2.90it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.35it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.69it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.95it/s] 20%|██        | 8/40 [00:02<00:07,  4.14it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.28it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s] 28%|██▊       | 11/40 [00:03<00:07,  3.83it/s] 30%|███       | 12/40 [00:03<00:06,  4.06it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.22it/s] 35%|███▌      | 14/40 [00:04<00:05,  4.34it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.36it/s] 40%|████      | 16/40 [00:04<00:05,  4.43it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.49it/s] 45%|████▌     | 18/40 [00:05<00:04,  4.55it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.57it/s] 50%|█████     | 20/40 [00:05<00:04,  4.55it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.58it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.60it/s] 57%|█████▊    | 23/40 [00:06<00:03,  4.60it/s] 60%|██████    | 24/40 [00:06<00:03,  4.59it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.58it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.60it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.51it/s] 70%|███████   | 28/40 [00:07<00:02,  4.55it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.57it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.59it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.61it/s] 80%|████████  | 32/40 [00:08<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.61it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.62it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.62it/s] 92%|█████████▎| 37/40 [00:09<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.62it/s]100%|██████████| 40/40 [00:09<00:00,  5.13it/s]100%|██████████| 40/40 [00:09<00:00,  4.02it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [41.37, 32.89]
Multiscale SSIM on Highres [0.983, 0.951]
Range Invariant Multiscale SSIM on Highres [0.984, 0.952]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/stats_disentangle_2404_D21-M3-S0-L8_6.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  - 9
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/120
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/120

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]  5%|▌         | 2/40 [00:01<00:23,  1.65it/s]  8%|▊         | 3/40 [00:01<00:16,  2.31it/s] 10%|█         | 4/40 [00:01<00:12,  2.88it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.33it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.69it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.96it/s] 20%|██        | 8/40 [00:02<00:07,  4.14it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s] 25%|██▌       | 10/40 [00:04<00:14,  2.07it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.49it/s] 30%|███       | 12/40 [00:04<00:09,  2.90it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.27it/s] 35%|███▌      | 14/40 [00:04<00:07,  3.58it/s] 38%|███▊      | 15/40 [00:05<00:07,  3.26it/s] 40%|████      | 16/40 [00:05<00:06,  3.44it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.57it/s] 45%|████▌     | 18/40 [00:06<00:05,  3.83it/s] 48%|████▊     | 19/40 [00:06<00:05,  4.02it/s] 50%|█████     | 20/40 [00:06<00:05,  3.69it/s] 52%|█████▎    | 21/40 [00:06<00:04,  3.92it/s] 55%|█████▌    | 22/40 [00:07<00:04,  4.10it/s] 57%|█████▊    | 23/40 [00:07<00:04,  4.23it/s] 60%|██████    | 24/40 [00:07<00:03,  4.33it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.74it/s] 65%|██████▌   | 26/40 [00:08<00:03,  3.96it/s] 68%|██████▊   | 27/40 [00:08<00:03,  4.12it/s] 70%|███████   | 28/40 [00:08<00:02,  4.26it/s] 72%|███████▎  | 29/40 [00:08<00:02,  4.35it/s] 75%|███████▌  | 30/40 [00:08<00:02,  4.41it/s] 78%|███████▊  | 31/40 [00:09<00:02,  4.46it/s] 80%|████████  | 32/40 [00:09<00:01,  4.50it/s] 82%|████████▎ | 33/40 [00:09<00:01,  4.54it/s] 85%|████████▌ | 34/40 [00:09<00:01,  4.56it/s] 88%|████████▊ | 35/40 [00:09<00:01,  4.58it/s] 90%|█████████ | 36/40 [00:10<00:00,  4.58it/s] 92%|█████████▎| 37/40 [00:10<00:00,  4.58it/s] 95%|█████████▌| 38/40 [00:10<00:00,  4.58it/s] 98%|█████████▊| 39/40 [00:10<00:00,  4.59it/s]100%|██████████| 40/40 [00:11<00:00,  3.61it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.16, 33.92]
Multiscale SSIM on Highres [0.844, 0.954]
Range Invariant Multiscale SSIM on Highres [0.847, 0.954]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/stats_disentangle_2404_D25-M3-S0-L8_120.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  - 10
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/111
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/111

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 334
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:45,  1.17s/it]  5%|▌         | 2/40 [00:01<00:23,  1.65it/s]  8%|▊         | 3/40 [00:01<00:15,  2.33it/s] 10%|█         | 4/40 [00:01<00:12,  2.90it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.36it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.71it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.96it/s] 20%|██        | 8/40 [00:02<00:07,  4.15it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.30it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.41it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.53it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.57it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.59it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.60it/s] 40%|████      | 16/40 [00:04<00:05,  4.60it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.59it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.64it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.64it/s] 50%|█████     | 20/40 [00:05<00:04,  4.64it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.64it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.64it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:06<00:03,  4.61it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.62it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.63it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.63it/s] 70%|███████   | 28/40 [00:06<00:02,  4.62it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.62it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.63it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.64it/s] 80%|████████  | 32/40 [00:07<00:01,  4.64it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.62it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.63it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.63it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.62it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.63it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.63it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.62it/s]100%|██████████| 40/40 [00:09<00:00,  4.02it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.17, 35.95]
Multiscale SSIM on Highres [0.843, 0.967]
Range Invariant Multiscale SSIM on Highres [0.845, 0.967]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/stats_disentangle_2404_D25-M3-S0-L8_111.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  - 11
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/125
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/125

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 279
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]  5%|▌         | 2/40 [00:01<00:22,  1.69it/s]  8%|▊         | 3/40 [00:01<00:15,  2.38it/s] 10%|█         | 4/40 [00:01<00:12,  2.96it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.41it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.75it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.00it/s] 20%|██        | 8/40 [00:02<00:07,  4.17it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.30it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.40it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.49it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.54it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.60it/s] 40%|████      | 16/40 [00:04<00:05,  4.61it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.61it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.61it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.61it/s] 50%|█████     | 20/40 [00:05<00:04,  4.61it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.64it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.63it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.63it/s] 60%|██████    | 24/40 [00:06<00:03,  4.63it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.63it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.59it/s] 70%|███████   | 28/40 [00:06<00:02,  4.59it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.59it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.29it/s] 78%|███████▊  | 31/40 [00:07<00:02,  4.37it/s] 80%|████████  | 32/40 [00:07<00:01,  4.40it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.44it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.48it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.52it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.56it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.59it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.58it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.16it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [30.47, 29.97]
Multiscale SSIM on Highres [0.919, 0.882]
Range Invariant Multiscale SSIM on Highres [0.919, 0.883]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/stats_disentangle_2404_D25-M3-S0-L8_125.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  - 12
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/139
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/139

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 375
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]  5%|▌         | 2/40 [00:01<00:23,  1.64it/s]  8%|▊         | 3/40 [00:01<00:15,  2.33it/s] 10%|█         | 4/40 [00:01<00:13,  2.75it/s] 12%|█▎        | 5/40 [00:02<00:11,  3.07it/s] 15%|█▌        | 6/40 [00:02<00:10,  3.31it/s] 18%|█▊        | 7/40 [00:02<00:09,  3.30it/s] 20%|██        | 8/40 [00:02<00:08,  3.63it/s] 22%|██▎       | 9/40 [00:03<00:07,  3.89it/s] 25%|██▌       | 10/40 [00:03<00:07,  4.10it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.23it/s] 30%|███       | 12/40 [00:03<00:06,  4.34it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.41it/s] 35%|███▌      | 14/40 [00:04<00:05,  4.46it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.52it/s] 40%|████      | 16/40 [00:04<00:05,  4.56it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.59it/s] 45%|████▌     | 18/40 [00:05<00:04,  4.57it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.58it/s] 50%|█████     | 20/40 [00:05<00:04,  4.59it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.60it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.62it/s] 57%|█████▊    | 23/40 [00:06<00:03,  4.62it/s] 60%|██████    | 24/40 [00:06<00:03,  4.63it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.62it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.63it/s] 68%|██████▊   | 27/40 [00:07<00:02,  4.63it/s] 70%|███████   | 28/40 [00:07<00:02,  4.64it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.63it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.63it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.61it/s] 80%|████████  | 32/40 [00:08<00:01,  4.61it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.61it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.61it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.62it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:09<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.07it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [31.3, 33.8]
Multiscale SSIM on Highres [0.914, 0.935]
Range Invariant Multiscale SSIM on Highres [0.916, 0.939]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/stats_disentangle_2404_D25-M3-S0-L8_139.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  - 13
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/143
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/143

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 223
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]  8%|▊         | 3/40 [00:01<00:15,  2.36it/s] 10%|█         | 4/40 [00:01<00:12,  2.92it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.38it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.72it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.97it/s] 20%|██        | 8/40 [00:02<00:07,  4.17it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.29it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.40it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.44it/s] 30%|███       | 12/40 [00:03<00:06,  4.50it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.55it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.58it/s] 40%|████      | 16/40 [00:04<00:05,  4.59it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.62it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.63it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.65it/s] 50%|█████     | 20/40 [00:05<00:04,  4.63it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.63it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.59it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.60it/s] 60%|██████    | 24/40 [00:06<00:03,  4.62it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.62it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.62it/s] 70%|███████   | 28/40 [00:06<00:02,  4.62it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.62it/s] 80%|████████  | 32/40 [00:07<00:01,  4.61it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.60it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.62it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.59it/s]100%|██████████| 40/40 [00:09<00:00,  4.17it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [31.63, 34.56]
Multiscale SSIM on Highres [0.908, 0.947]
Range Invariant Multiscale SSIM on Highres [0.913, 0.946]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/stats_disentangle_2404_D25-M3-S0-L8_143.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F18.75/kth_3/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif

##################################
Predicting 4th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]  5%|▌         | 2/40 [00:01<00:22,  1.70it/s]  8%|▊         | 3/40 [00:01<00:15,  2.38it/s] 10%|█         | 4/40 [00:01<00:12,  2.95it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.38it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.72it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.98it/s] 20%|██        | 8/40 [00:02<00:07,  4.16it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.27it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.36it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.44it/s] 30%|███       | 12/40 [00:03<00:06,  4.47it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.50it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.52it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.28it/s] 40%|████      | 16/40 [00:04<00:05,  4.17it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.11it/s] 45%|████▌     | 18/40 [00:04<00:05,  4.25it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.35it/s] 50%|█████     | 20/40 [00:05<00:04,  4.42it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.48it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.51it/s] 57%|█████▊    | 23/40 [00:06<00:03,  4.54it/s] 60%|██████    | 24/40 [00:06<00:03,  4.54it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.55it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.58it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.58it/s] 70%|███████   | 28/40 [00:07<00:02,  4.61it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.62it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.63it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.62it/s] 80%|████████  | 32/40 [00:07<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.61it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.61it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.61it/s] 92%|█████████▎| 37/40 [00:09<00:00,  4.61it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.59it/s]100%|██████████| 40/40 [00:09<00:00,  4.11it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_4/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [41.11, 33.75]
Multiscale SSIM on Highres [0.979, 0.964]
Range Invariant Multiscale SSIM on Highres [0.982, 0.965]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_4/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F-1.00/kth_4/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:01<00:16,  1.13s/it] 12%|█▎        | 2/16 [00:01<00:08,  1.69it/s] 19%|█▉        | 3/16 [00:01<00:05,  2.37it/s] 25%|██▌       | 4/16 [00:01<00:04,  2.93it/s] 31%|███▏      | 5/16 [00:01<00:03,  3.38it/s] 38%|███▊      | 6/16 [00:02<00:02,  3.73it/s] 44%|████▍     | 7/16 [00:02<00:02,  3.96it/s] 50%|█████     | 8/16 [00:02<00:01,  4.13it/s] 56%|█████▋    | 9/16 [00:02<00:01,  4.26it/s] 62%|██████▎   | 10/16 [00:03<00:01,  4.34it/s] 69%|██████▉   | 11/16 [00:03<00:01,  4.41it/s] 75%|███████▌  | 12/16 [00:03<00:00,  4.45it/s] 81%|████████▏ | 13/16 [00:03<00:00,  4.50it/s] 88%|████████▊ | 14/16 [00:03<00:00,  4.53it/s] 94%|█████████▍| 15/16 [00:04<00:00,  4.55it/s]100%|██████████| 16/16 [00:04<00:00,  4.56it/s]100%|██████████| 16/16 [00:04<00:00,  3.48it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [36.85, 38.32]
Multiscale SSIM on Highres [0.953, 0.938]
Range Invariant Multiscale SSIM on Highres [0.971, 0.962]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:01<00:41,  1.13s/it]  5%|▌         | 2/38 [00:01<00:21,  1.69it/s]  8%|▊         | 3/38 [00:01<00:14,  2.36it/s] 11%|█         | 4/38 [00:01<00:11,  2.90it/s] 13%|█▎        | 5/38 [00:02<00:10,  3.19it/s] 16%|█▌        | 6/38 [00:02<00:09,  3.41it/s] 18%|█▊        | 7/38 [00:02<00:08,  3.58it/s] 21%|██        | 8/38 [00:02<00:07,  3.87it/s] 24%|██▎       | 9/38 [00:02<00:07,  4.06it/s] 26%|██▋       | 10/38 [00:03<00:06,  4.21it/s] 29%|██▉       | 11/38 [00:03<00:06,  4.33it/s] 32%|███▏      | 12/38 [00:03<00:05,  4.40it/s] 34%|███▍      | 13/38 [00:03<00:05,  4.46it/s] 37%|███▋      | 14/38 [00:04<00:05,  4.50it/s] 39%|███▉      | 15/38 [00:04<00:05,  4.54it/s] 42%|████▏     | 16/38 [00:04<00:04,  4.56it/s] 45%|████▍     | 17/38 [00:04<00:04,  4.59it/s] 47%|████▋     | 18/38 [00:04<00:04,  4.61it/s] 50%|█████     | 19/38 [00:05<00:04,  4.62it/s] 53%|█████▎    | 20/38 [00:05<00:03,  4.63it/s] 55%|█████▌    | 21/38 [00:05<00:03,  4.63it/s] 58%|█████▊    | 22/38 [00:05<00:03,  4.61it/s] 61%|██████    | 23/38 [00:06<00:03,  4.62it/s] 63%|██████▎   | 24/38 [00:06<00:03,  4.61it/s] 66%|██████▌   | 25/38 [00:06<00:02,  4.62it/s] 68%|██████▊   | 26/38 [00:06<00:02,  4.61it/s] 71%|███████   | 27/38 [00:06<00:02,  4.63it/s] 74%|███████▎  | 28/38 [00:07<00:02,  4.63it/s] 76%|███████▋  | 29/38 [00:07<00:01,  4.63it/s] 79%|███████▉  | 30/38 [00:07<00:01,  4.62it/s] 82%|████████▏ | 31/38 [00:07<00:01,  4.62it/s] 84%|████████▍ | 32/38 [00:07<00:01,  4.62it/s] 87%|████████▋ | 33/38 [00:08<00:01,  4.61it/s] 89%|████████▉ | 34/38 [00:08<00:00,  4.63it/s] 92%|█████████▏| 35/38 [00:08<00:00,  4.62it/s] 95%|█████████▍| 36/38 [00:08<00:00,  4.61it/s] 97%|█████████▋| 37/38 [00:09<00:00,  4.62it/s]100%|██████████| 38/38 [00:09<00:00,  5.34it/s]100%|██████████| 38/38 [00:09<00:00,  4.06it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F25.26/kth_4/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [29.32, 25.37]
Multiscale SSIM on Highres [0.749, 0.812]
Range Invariant Multiscale SSIM on Highres [0.91, 0.817]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F25.26/kth_4/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk16_F25.26/kth_4/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]  8%|▊         | 3/40 [00:01<00:15,  2.38it/s] 10%|█         | 4/40 [00:01<00:12,  2.94it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.38it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.72it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.98it/s] 20%|██        | 8/40 [00:02<00:07,  4.16it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.30it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.38it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.45it/s] 30%|███       | 12/40 [00:03<00:06,  4.50it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.53it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.55it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.57it/s] 40%|████      | 16/40 [00:04<00:05,  4.58it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.59it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.61it/s] 50%|█████     | 20/40 [00:05<00:04,  4.63it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.63it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.62it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:06<00:03,  4.62it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.63it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.60it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.60it/s] 70%|███████   | 28/40 [00:06<00:02,  4.60it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.62it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.62it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.61it/s] 80%|████████  | 32/40 [00:07<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.63it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.63it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.62it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.62it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.63it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.63it/s]100%|██████████| 40/40 [00:09<00:00,  4.18it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.18, 33.24]
Multiscale SSIM on Highres [0.746, 0.937]
Range Invariant Multiscale SSIM on Highres [0.765, 0.94]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:51,  1.14s/it]  1%|          | 2/256 [00:01<02:32,  1.67it/s]  1%|          | 3/256 [00:01<01:47,  2.34it/s]  2%|▏         | 4/256 [00:01<01:27,  2.88it/s]  2%|▏         | 5/256 [00:02<01:15,  3.34it/s]  2%|▏         | 6/256 [00:02<01:07,  3.70it/s]  3%|▎         | 7/256 [00:02<01:02,  3.97it/s]  3%|▎         | 8/256 [00:02<00:59,  4.14it/s]  4%|▎         | 9/256 [00:02<00:57,  4.29it/s]  4%|▍         | 10/256 [00:03<00:56,  4.39it/s]  4%|▍         | 11/256 [00:03<00:55,  4.45it/s]  5%|▍         | 12/256 [00:03<00:54,  4.50it/s]  5%|▌         | 13/256 [00:03<00:53,  4.54it/s]  5%|▌         | 14/256 [00:03<00:53,  4.56it/s]  6%|▌         | 15/256 [00:04<00:52,  4.57it/s]  6%|▋         | 16/256 [00:04<00:52,  4.58it/s]  7%|▋         | 17/256 [00:04<00:52,  4.57it/s]  7%|▋         | 18/256 [00:04<00:51,  4.60it/s]  7%|▋         | 19/256 [00:05<00:51,  4.61it/s]  8%|▊         | 20/256 [00:05<00:51,  4.61it/s]  8%|▊         | 21/256 [00:05<00:51,  4.60it/s]  9%|▊         | 22/256 [00:05<00:50,  4.60it/s]  9%|▉         | 23/256 [00:05<00:50,  4.60it/s]  9%|▉         | 24/256 [00:06<00:50,  4.62it/s] 10%|▉         | 25/256 [00:06<00:49,  4.62it/s] 10%|█         | 26/256 [00:06<00:49,  4.62it/s] 11%|█         | 27/256 [00:06<00:49,  4.61it/s] 11%|█         | 28/256 [00:07<00:49,  4.59it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.61it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.63it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.61it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.63it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.61it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.61it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.62it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.63it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.62it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.63it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.64it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 43/256 [00:10<00:48,  4.40it/s] 17%|█▋        | 44/256 [00:10<00:51,  4.09it/s] 18%|█▊        | 45/256 [00:10<00:52,  4.03it/s] 18%|█▊        | 46/256 [00:11<00:50,  4.19it/s] 18%|█▊        | 47/256 [00:11<00:48,  4.32it/s] 19%|█▉        | 48/256 [00:11<00:47,  4.42it/s] 19%|█▉        | 49/256 [00:11<00:46,  4.48it/s] 20%|█▉        | 50/256 [00:11<00:45,  4.53it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.56it/s] 20%|██        | 52/256 [00:12<00:44,  4.57it/s] 21%|██        | 53/256 [00:12<00:44,  4.57it/s] 21%|██        | 54/256 [00:12<00:44,  4.59it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.59it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.61it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.61it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.63it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.61it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.62it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.61it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.61it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.62it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 69/256 [00:16<00:40,  4.63it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.64it/s] 28%|██▊       | 71/256 [00:16<00:39,  4.65it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.63it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.63it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.60it/s] 29%|██▉       | 75/256 [00:17<00:40,  4.48it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.53it/s] 30%|███       | 77/256 [00:17<00:39,  4.54it/s] 30%|███       | 78/256 [00:17<00:38,  4.58it/s] 31%|███       | 79/256 [00:18<00:38,  4.58it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.59it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.61it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.62it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.62it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.62it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.62it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.62it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.62it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.61it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.61it/s] 36%|███▌      | 92/256 [00:21<00:35,  4.62it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.62it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.63it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.62it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.61it/s] 39%|███▊      | 99/256 [00:22<00:33,  4.62it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.62it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.61it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.60it/s] 40%|████      | 103/256 [00:23<00:33,  4.58it/s] 41%|████      | 104/256 [00:23<00:32,  4.61it/s] 41%|████      | 105/256 [00:23<00:32,  4.61it/s] 41%|████▏     | 106/256 [00:24<00:32,  4.61it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.62it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.61it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.61it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.61it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.63it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.61it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.62it/s] 45%|████▍     | 115/256 [00:26<00:30,  4.61it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.62it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.60it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.59it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.59it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.59it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.59it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.59it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.58it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.60it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.60it/s] 50%|████▉     | 127/256 [00:28<00:28,  4.59it/s] 50%|█████     | 128/256 [00:28<00:27,  4.58it/s] 50%|█████     | 129/256 [00:29<00:27,  4.58it/s] 51%|█████     | 130/256 [00:29<00:27,  4.58it/s] 51%|█████     | 131/256 [00:29<00:27,  4.59it/s] 52%|█████▏    | 132/256 [00:29<00:27,  4.58it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.58it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.57it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.59it/s] 53%|█████▎    | 136/256 [00:30<00:26,  4.60it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.60it/s] 54%|█████▍    | 138/256 [00:31<00:25,  4.61it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.59it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.59it/s] 55%|█████▌    | 141/256 [00:31<00:25,  4.59it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.59it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.59it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.60it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.61it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.63it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.64it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.64it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.64it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.66it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.67it/s] 59%|█████▉    | 152/256 [00:34<00:22,  4.66it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.66it/s] 60%|██████    | 154/256 [00:34<00:21,  4.64it/s] 61%|██████    | 155/256 [00:34<00:21,  4.66it/s] 61%|██████    | 156/256 [00:34<00:21,  4.65it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.66it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.65it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.67it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.66it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.64it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.65it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.66it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.67it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.66it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.66it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.67it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.66it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.66it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.65it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.65it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.65it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.66it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.67it/s] 69%|██████▉   | 177/256 [00:39<00:16,  4.68it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.69it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.69it/s] 70%|███████   | 180/256 [00:40<00:16,  4.69it/s] 71%|███████   | 181/256 [00:40<00:16,  4.46it/s] 71%|███████   | 182/256 [00:40<00:17,  4.15it/s] 71%|███████▏  | 183/256 [00:40<00:17,  4.09it/s] 72%|███████▏  | 184/256 [00:41<00:17,  4.23it/s] 72%|███████▏  | 185/256 [00:41<00:16,  4.35it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.41it/s] 73%|███████▎  | 187/256 [00:41<00:15,  4.49it/s] 73%|███████▎  | 188/256 [00:41<00:15,  4.49it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.54it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.52it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.53it/s] 75%|███████▌  | 192/256 [00:42<00:14,  4.57it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.60it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.63it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.63it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.55it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.58it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.60it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.62it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.63it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.63it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.64it/s] 80%|████████  | 205/256 [00:45<00:10,  4.64it/s] 80%|████████  | 206/256 [00:45<00:10,  4.64it/s] 81%|████████  | 207/256 [00:46<00:10,  4.66it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.63it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.64it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.64it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 212/256 [00:47<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.67it/s] 84%|████████▎ | 214/256 [00:47<00:08,  4.68it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.67it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.66it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.65it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.63it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.64it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.65it/s] 86%|████████▋ | 221/256 [00:49<00:07,  4.66it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.67it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.66it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.68it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.68it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.68it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.68it/s] 89%|████████▉ | 228/256 [00:50<00:05,  4.67it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.66it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.67it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.65it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.66it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.65it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.63it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.63it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.65it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.66it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.66it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.66it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.66it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.66it/s] 95%|█████████▍| 242/256 [00:53<00:02,  4.67it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.66it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.67it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.68it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.68it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.67it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.67it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.64it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.63it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.63it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.63it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.64it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.64it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.66it/s]100%|██████████| 256/256 [00:56<00:00,  4.66it/s]100%|██████████| 256/256 [00:56<00:00,  4.51it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [36.32, 38.35]
Multiscale SSIM on Highres [0.973, 0.983]
Range Invariant Multiscale SSIM on Highres [0.974, 0.984]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:50,  1.14s/it]  1%|          | 2/256 [00:01<02:31,  1.68it/s]  1%|          | 3/256 [00:01<01:47,  2.36it/s]  2%|▏         | 4/256 [00:01<01:26,  2.92it/s]  2%|▏         | 5/256 [00:02<01:14,  3.38it/s]  2%|▏         | 6/256 [00:02<01:07,  3.73it/s]  3%|▎         | 7/256 [00:02<01:02,  3.98it/s]  3%|▎         | 8/256 [00:02<00:59,  4.18it/s]  4%|▎         | 9/256 [00:02<00:57,  4.31it/s]  4%|▍         | 10/256 [00:03<00:55,  4.41it/s]  4%|▍         | 11/256 [00:03<00:54,  4.47it/s]  5%|▍         | 12/256 [00:03<00:53,  4.52it/s]  5%|▌         | 13/256 [00:03<00:53,  4.54it/s]  5%|▌         | 14/256 [00:03<00:53,  4.56it/s]  6%|▌         | 15/256 [00:04<00:52,  4.55it/s]  6%|▋         | 16/256 [00:04<00:52,  4.57it/s]  7%|▋         | 17/256 [00:04<00:52,  4.58it/s]  7%|▋         | 18/256 [00:04<00:51,  4.59it/s]  7%|▋         | 19/256 [00:05<00:51,  4.59it/s]  8%|▊         | 20/256 [00:05<00:51,  4.59it/s]  8%|▊         | 21/256 [00:05<00:51,  4.60it/s]  9%|▊         | 22/256 [00:05<00:51,  4.59it/s]  9%|▉         | 23/256 [00:05<00:50,  4.58it/s]  9%|▉         | 24/256 [00:06<00:50,  4.59it/s] 10%|▉         | 25/256 [00:06<00:50,  4.59it/s] 10%|█         | 26/256 [00:06<00:49,  4.61it/s] 11%|█         | 27/256 [00:06<00:49,  4.61it/s] 11%|█         | 28/256 [00:06<00:49,  4.61it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.60it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.62it/s] 12%|█▏        | 31/256 [00:07<00:51,  4.37it/s] 12%|█▎        | 32/256 [00:07<00:53,  4.20it/s] 13%|█▎        | 33/256 [00:08<00:54,  4.13it/s] 13%|█▎        | 34/256 [00:08<00:51,  4.27it/s] 14%|█▎        | 35/256 [00:08<00:50,  4.38it/s] 14%|█▍        | 36/256 [00:08<00:49,  4.46it/s] 14%|█▍        | 37/256 [00:09<00:48,  4.52it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.55it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.56it/s] 16%|█▌        | 40/256 [00:09<00:47,  4.58it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.60it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.63it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.63it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.63it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.64it/s] 20%|██        | 52/256 [00:12<00:43,  4.64it/s] 21%|██        | 53/256 [00:12<00:43,  4.64it/s] 21%|██        | 54/256 [00:12<00:43,  4.63it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.61it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.62it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.61it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.62it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.62it/s] 23%|██▎       | 60/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.62it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.63it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.63it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.64it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.60it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.60it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.62it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.62it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.63it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.62it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.62it/s] 30%|███       | 77/256 [00:17<00:38,  4.63it/s] 30%|███       | 78/256 [00:17<00:38,  4.60it/s] 31%|███       | 79/256 [00:18<00:38,  4.62it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.60it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.62it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.60it/s] 32%|███▏      | 83/256 [00:19<00:37,  4.61it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.61it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.61it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.63it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.62it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.63it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.62it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.62it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.62it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.63it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.63it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.61it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.62it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.61it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.61it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.61it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.57it/s] 40%|████      | 103/256 [00:23<00:33,  4.60it/s] 41%|████      | 104/256 [00:23<00:33,  4.58it/s] 41%|████      | 105/256 [00:23<00:32,  4.60it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.61it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.60it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.60it/s] 43%|████▎     | 109/256 [00:24<00:32,  4.59it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.60it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.61it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.62it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.62it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.62it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.61it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.62it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.60it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.59it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.59it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.55it/s] 48%|████▊     | 123/256 [00:27<00:29,  4.58it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.58it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.57it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.57it/s] 50%|████▉     | 127/256 [00:28<00:28,  4.58it/s] 50%|█████     | 128/256 [00:28<00:27,  4.58it/s] 50%|█████     | 129/256 [00:29<00:27,  4.58it/s] 51%|█████     | 130/256 [00:29<00:27,  4.60it/s] 51%|█████     | 131/256 [00:29<00:27,  4.62it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.63it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.62it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.64it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.65it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.65it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.65it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.67it/s] 55%|█████▍    | 140/256 [00:31<00:24,  4.67it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.66it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.67it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.67it/s] 56%|█████▋    | 144/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.67it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.66it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.65it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.64it/s] 58%|█████▊    | 149/256 [00:33<00:22,  4.66it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.66it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.66it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.66it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.67it/s] 60%|██████    | 154/256 [00:34<00:21,  4.68it/s] 61%|██████    | 155/256 [00:34<00:21,  4.68it/s] 61%|██████    | 156/256 [00:34<00:21,  4.67it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.67it/s] 62%|██████▏   | 158/256 [00:35<00:20,  4.68it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.69it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.68it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.67it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.68it/s] 64%|██████▎   | 163/256 [00:36<00:19,  4.67it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.64it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.63it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.64it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.64it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.64it/s] 66%|██████▌   | 169/256 [00:37<00:19,  4.41it/s] 66%|██████▋   | 170/256 [00:37<00:20,  4.13it/s] 67%|██████▋   | 171/256 [00:38<00:20,  4.09it/s] 67%|██████▋   | 172/256 [00:38<00:19,  4.25it/s] 68%|██████▊   | 173/256 [00:38<00:18,  4.37it/s] 68%|██████▊   | 174/256 [00:38<00:18,  4.46it/s] 68%|██████▊   | 175/256 [00:39<00:17,  4.52it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.56it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.59it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.60it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.62it/s] 70%|███████   | 180/256 [00:40<00:16,  4.64it/s] 71%|███████   | 181/256 [00:40<00:16,  4.65it/s] 71%|███████   | 182/256 [00:40<00:15,  4.66it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.65it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.64it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.63it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.65it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.65it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.64it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.61it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.63it/s] 75%|███████▍  | 191/256 [00:42<00:13,  4.64it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.65it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.65it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.66it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.65it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.66it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.66it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.66it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.66it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.66it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.65it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.58it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.62it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.63it/s] 80%|████████  | 205/256 [00:45<00:10,  4.64it/s] 80%|████████  | 206/256 [00:45<00:10,  4.66it/s] 81%|████████  | 207/256 [00:45<00:10,  4.67it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.61it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.62it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.64it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.65it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.66it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.66it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.66it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.65it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.66it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.67it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.66it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.67it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.68it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.67it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.67it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.68it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.68it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.67it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.67it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.68it/s] 89%|████████▉ | 228/256 [00:50<00:05,  4.69it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.68it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.68it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.67it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.68it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.68it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.68it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.67it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.66it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.66it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.66it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.65it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.66it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.65it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.66it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.66it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.65it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.65it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.66it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.66it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.67it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.67it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.68it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.68it/s]100%|██████████| 256/256 [00:56<00:00,  4.68it/s]100%|██████████| 256/256 [00:56<00:00,  4.52it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [55.84, 39.27]
Multiscale SSIM on Highres [0.998, 0.945]
Range Invariant Multiscale SSIM on Highres [1.0, 0.98]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/stats_disentangle_2405_D18-M3-S0-L8_14.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/15
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/15


Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 111
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:35,  1.08s/it]  1%|          | 2/256 [00:01<02:25,  1.75it/s]  1%|          | 3/256 [00:01<01:43,  2.45it/s]  2%|▏         | 4/256 [00:01<01:23,  3.01it/s]  2%|▏         | 5/256 [00:01<01:12,  3.45it/s]  2%|▏         | 6/256 [00:02<01:05,  3.79it/s]  3%|▎         | 7/256 [00:02<01:01,  4.04it/s]  3%|▎         | 8/256 [00:02<00:58,  4.21it/s]  4%|▎         | 9/256 [00:02<00:56,  4.35it/s]  4%|▍         | 10/256 [00:03<00:55,  4.45it/s]  4%|▍         | 11/256 [00:03<00:54,  4.51it/s]  5%|▍         | 12/256 [00:03<00:53,  4.52it/s]  5%|▌         | 13/256 [00:03<00:53,  4.56it/s]  5%|▌         | 14/256 [00:03<00:52,  4.58it/s]  6%|▌         | 15/256 [00:04<00:52,  4.58it/s]  6%|▋         | 16/256 [00:04<00:52,  4.59it/s]  7%|▋         | 17/256 [00:04<00:52,  4.59it/s]  7%|▋         | 18/256 [00:04<00:51,  4.60it/s]  7%|▋         | 19/256 [00:04<00:51,  4.60it/s]  8%|▊         | 20/256 [00:05<00:51,  4.60it/s]  8%|▊         | 21/256 [00:05<00:50,  4.61it/s]  9%|▊         | 22/256 [00:05<00:50,  4.61it/s]  9%|▉         | 23/256 [00:05<00:50,  4.62it/s]  9%|▉         | 24/256 [00:06<00:50,  4.63it/s] 10%|▉         | 25/256 [00:06<00:49,  4.63it/s] 10%|█         | 26/256 [00:06<00:49,  4.60it/s] 11%|█         | 27/256 [00:06<00:49,  4.59it/s] 11%|█         | 28/256 [00:06<00:49,  4.61it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.61it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.61it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.62it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 33/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.62it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.64it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.63it/s] 15%|█▌        | 39/256 [00:09<00:46,  4.64it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.63it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.62it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.62it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.63it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.63it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.63it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:44,  4.64it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.63it/s] 20%|█▉        | 50/256 [00:11<00:46,  4.39it/s] 20%|█▉        | 51/256 [00:11<00:48,  4.24it/s] 20%|██        | 52/256 [00:12<00:49,  4.13it/s] 21%|██        | 53/256 [00:12<00:47,  4.27it/s] 21%|██        | 54/256 [00:12<00:46,  4.38it/s] 21%|██▏       | 55/256 [00:12<00:45,  4.45it/s] 22%|██▏       | 56/256 [00:13<00:44,  4.49it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.54it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.57it/s] 23%|██▎       | 59/256 [00:13<00:43,  4.58it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.58it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.61it/s] 24%|██▍       | 62/256 [00:14<00:41,  4.62it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.62it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.63it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.63it/s] 26%|██▌       | 66/256 [00:15<00:40,  4.63it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.63it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.63it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.65it/s] 27%|██▋       | 70/256 [00:16<00:39,  4.65it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.62it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.63it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.63it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.63it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.60it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.61it/s] 30%|███       | 77/256 [00:17<00:38,  4.62it/s] 30%|███       | 78/256 [00:17<00:38,  4.61it/s] 31%|███       | 79/256 [00:18<00:38,  4.60it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.60it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.61it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.60it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.59it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.60it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.61it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.60it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.61it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.61it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.61it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.62it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.62it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.61it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.60it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.61it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.60it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.61it/s] 40%|████      | 103/256 [00:23<00:33,  4.60it/s] 41%|████      | 104/256 [00:23<00:33,  4.60it/s] 41%|████      | 105/256 [00:23<00:32,  4.61it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.61it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.60it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.59it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.61it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.60it/s] 43%|████▎     | 111/256 [00:24<00:31,  4.62it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.63it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.63it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.62it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.61it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.61it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.61it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.61it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.62it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.62it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.62it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.62it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.62it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.63it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.63it/s] 50%|█████     | 128/256 [00:28<00:27,  4.61it/s] 50%|█████     | 129/256 [00:28<00:27,  4.61it/s] 51%|█████     | 130/256 [00:29<00:27,  4.62it/s] 51%|█████     | 131/256 [00:29<00:27,  4.63it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.65it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.65it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.65it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.64it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.64it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.63it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.64it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.63it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.62it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.62it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.62it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.62it/s] 57%|█████▋    | 145/256 [00:32<00:23,  4.63it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.61it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.61it/s] 58%|█████▊    | 148/256 [00:32<00:23,  4.62it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.61it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.62it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.63it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.64it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.62it/s] 60%|██████    | 154/256 [00:34<00:22,  4.62it/s] 61%|██████    | 155/256 [00:34<00:21,  4.62it/s] 61%|██████    | 156/256 [00:34<00:21,  4.62it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.62it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.63it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.62it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.64it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.63it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.64it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.63it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.64it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.63it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.63it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.62it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.61it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.61it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.62it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.61it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.62it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.63it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.64it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.65it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.65it/s] 69%|██████▉   | 177/256 [00:39<00:16,  4.65it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.65it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.66it/s] 70%|███████   | 180/256 [00:39<00:16,  4.62it/s] 71%|███████   | 181/256 [00:40<00:16,  4.62it/s] 71%|███████   | 182/256 [00:40<00:15,  4.63it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.62it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.62it/s] 72%|███████▏  | 185/256 [00:40<00:15,  4.62it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.62it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.63it/s] 73%|███████▎  | 188/256 [00:41<00:15,  4.40it/s] 74%|███████▍  | 189/256 [00:41<00:15,  4.25it/s] 74%|███████▍  | 190/256 [00:42<00:15,  4.15it/s] 75%|███████▍  | 191/256 [00:42<00:15,  4.29it/s] 75%|███████▌  | 192/256 [00:42<00:14,  4.38it/s] 75%|███████▌  | 193/256 [00:42<00:14,  4.45it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.51it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.55it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.56it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.57it/s] 77%|███████▋  | 198/256 [00:43<00:12,  4.59it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.53it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.55it/s] 79%|███████▊  | 201/256 [00:44<00:12,  4.56it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.57it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.56it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.57it/s] 80%|████████  | 205/256 [00:45<00:11,  4.57it/s] 80%|████████  | 206/256 [00:45<00:10,  4.58it/s] 81%|████████  | 207/256 [00:45<00:10,  4.60it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.61it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.62it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.59it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.60it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.60it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.60it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.59it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.58it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.60it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.63it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.64it/s] 86%|████████▌ | 219/256 [00:48<00:07,  4.66it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.66it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.67it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.67it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.67it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.68it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.68it/s] 88%|████████▊ | 226/256 [00:49<00:06,  4.68it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.66it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.66it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.67it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.67it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.68it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.67it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.68it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.68it/s] 92%|█████████▏| 235/256 [00:51<00:04,  4.67it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.68it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.68it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.68it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.69it/s] 94%|█████████▍| 240/256 [00:52<00:03,  4.68it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.68it/s] 95%|█████████▍| 242/256 [00:53<00:02,  4.67it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.67it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.66it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.66it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.67it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.65it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.66it/s] 97%|█████████▋| 249/256 [00:54<00:01,  4.67it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.68it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.65it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.64it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.66it/s] 99%|█████████▉| 254/256 [00:55<00:00,  4.64it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.59it/s]100%|██████████| 256/256 [00:56<00:00,  4.62it/s]100%|██████████| 256/256 [00:56<00:00,  4.52it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [63.1, 42.12]
Multiscale SSIM on Highres [1.0, 0.958]
Range Invariant Multiscale SSIM on Highres [1.0, 0.99]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/stats_disentangle_2405_D18-M3-S0-L8_15.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/10
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/10


Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 357
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:36,  1.09s/it]  1%|          | 2/256 [00:01<02:26,  1.74it/s]  1%|          | 3/256 [00:01<01:43,  2.44it/s]  2%|▏         | 4/256 [00:01<01:24,  3.00it/s]  2%|▏         | 5/256 [00:01<01:13,  3.43it/s]  2%|▏         | 6/256 [00:02<01:06,  3.77it/s]  3%|▎         | 7/256 [00:02<01:01,  4.02it/s]  3%|▎         | 8/256 [00:02<00:59,  4.18it/s]  4%|▎         | 9/256 [00:02<00:57,  4.32it/s]  4%|▍         | 10/256 [00:03<00:55,  4.43it/s]  4%|▍         | 11/256 [00:03<00:54,  4.50it/s]  5%|▍         | 12/256 [00:03<00:53,  4.52it/s]  5%|▌         | 13/256 [00:03<00:53,  4.54it/s]  5%|▌         | 14/256 [00:03<00:52,  4.57it/s]  6%|▌         | 15/256 [00:04<00:52,  4.59it/s]  6%|▋         | 16/256 [00:04<00:52,  4.61it/s]  7%|▋         | 17/256 [00:04<00:51,  4.62it/s]  7%|▋         | 18/256 [00:04<00:51,  4.61it/s]  7%|▋         | 19/256 [00:04<00:51,  4.61it/s]  8%|▊         | 20/256 [00:05<00:51,  4.60it/s]  8%|▊         | 21/256 [00:05<00:50,  4.62it/s]  9%|▊         | 22/256 [00:05<00:50,  4.66it/s]  9%|▉         | 23/256 [00:05<00:50,  4.65it/s]  9%|▉         | 24/256 [00:06<00:49,  4.64it/s] 10%|▉         | 25/256 [00:06<00:49,  4.63it/s] 10%|█         | 26/256 [00:06<00:49,  4.61it/s] 11%|█         | 27/256 [00:06<00:49,  4.60it/s] 11%|█         | 28/256 [00:06<00:49,  4.62it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.63it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.63it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.63it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.63it/s] 13%|█▎        | 33/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:47,  4.63it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.62it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.63it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.62it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.64it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.60it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.62it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.61it/s] 16%|█▋        | 42/256 [00:09<00:46,  4.60it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.63it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.63it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.63it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.62it/s] 20%|██        | 52/256 [00:12<00:44,  4.63it/s] 21%|██        | 53/256 [00:12<00:43,  4.63it/s] 21%|██        | 54/256 [00:12<00:43,  4.63it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.62it/s] 22%|██▏       | 56/256 [00:12<00:43,  4.64it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.63it/s] 23%|██▎       | 58/256 [00:13<00:42,  4.62it/s] 23%|██▎       | 59/256 [00:13<00:43,  4.54it/s] 23%|██▎       | 60/256 [00:13<00:45,  4.34it/s] 24%|██▍       | 61/256 [00:14<00:46,  4.20it/s] 24%|██▍       | 62/256 [00:14<00:44,  4.33it/s] 25%|██▍       | 63/256 [00:14<00:43,  4.42it/s] 25%|██▌       | 64/256 [00:14<00:42,  4.48it/s] 25%|██▌       | 65/256 [00:15<00:42,  4.53it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.56it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.58it/s] 27%|██▋       | 68/256 [00:15<00:41,  4.58it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.57it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.58it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.57it/s] 28%|██▊       | 72/256 [00:16<00:40,  4.58it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.60it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.60it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.60it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.61it/s] 30%|███       | 77/256 [00:17<00:38,  4.61it/s] 30%|███       | 78/256 [00:17<00:38,  4.61it/s] 31%|███       | 79/256 [00:18<00:38,  4.61it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.60it/s] 32%|███▏      | 81/256 [00:18<00:38,  4.60it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.60it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.59it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.57it/s] 33%|███▎      | 85/256 [00:19<00:37,  4.58it/s] 34%|███▎      | 86/256 [00:19<00:37,  4.58it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.58it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.58it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.60it/s] 35%|███▌      | 90/256 [00:20<00:36,  4.61it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.62it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.61it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.59it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.60it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.60it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.59it/s] 39%|███▉      | 100/256 [00:22<00:34,  4.59it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.57it/s] 40%|███▉      | 102/256 [00:23<00:33,  4.57it/s] 40%|████      | 103/256 [00:23<00:33,  4.59it/s] 41%|████      | 104/256 [00:23<00:32,  4.61it/s] 41%|████      | 105/256 [00:23<00:32,  4.60it/s] 41%|████▏     | 106/256 [00:23<00:32,  4.61it/s] 42%|████▏     | 107/256 [00:24<00:32,  4.61it/s] 42%|████▏     | 108/256 [00:24<00:31,  4.63it/s] 43%|████▎     | 109/256 [00:24<00:31,  4.64it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.65it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.64it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.63it/s] 44%|████▍     | 113/256 [00:25<00:30,  4.63it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.61it/s] 45%|████▍     | 115/256 [00:25<00:30,  4.63it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.64it/s] 46%|████▌     | 117/256 [00:26<00:29,  4.64it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.64it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.64it/s] 47%|████▋     | 120/256 [00:26<00:29,  4.65it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.65it/s] 48%|████▊     | 122/256 [00:27<00:28,  4.64it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.63it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.61it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.61it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.61it/s] 50%|████▉     | 127/256 [00:28<00:27,  4.62it/s] 50%|█████     | 128/256 [00:28<00:27,  4.62it/s] 50%|█████     | 129/256 [00:28<00:27,  4.64it/s] 51%|█████     | 130/256 [00:29<00:27,  4.64it/s] 51%|█████     | 131/256 [00:29<00:26,  4.64it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.63it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.61it/s] 52%|█████▏    | 134/256 [00:29<00:26,  4.62it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.63it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.64it/s] 54%|█████▍    | 138/256 [00:30<00:25,  4.64it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.61it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.62it/s] 55%|█████▌    | 141/256 [00:31<00:24,  4.62it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.61it/s] 56%|█████▌    | 143/256 [00:31<00:24,  4.62it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.60it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.60it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.61it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.62it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.61it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.63it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.64it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.64it/s] 59%|█████▉    | 152/256 [00:33<00:22,  4.63it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.62it/s] 60%|██████    | 154/256 [00:34<00:22,  4.62it/s] 61%|██████    | 155/256 [00:34<00:21,  4.61it/s] 61%|██████    | 156/256 [00:34<00:21,  4.62it/s] 61%|██████▏   | 157/256 [00:34<00:21,  4.63it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.64it/s] 62%|██████▏   | 159/256 [00:35<00:20,  4.64it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.62it/s] 63%|██████▎   | 161/256 [00:35<00:20,  4.59it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.60it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.60it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.61it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.62it/s] 65%|██████▍   | 166/256 [00:36<00:19,  4.63it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.62it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.62it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.62it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.62it/s] 67%|██████▋   | 171/256 [00:37<00:18,  4.62it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.63it/s] 68%|██████▊   | 173/256 [00:38<00:17,  4.64it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.62it/s] 68%|██████▊   | 175/256 [00:38<00:17,  4.64it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.63it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.62it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.63it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.63it/s] 70%|███████   | 180/256 [00:39<00:16,  4.62it/s] 71%|███████   | 181/256 [00:40<00:16,  4.61it/s] 71%|███████   | 182/256 [00:40<00:16,  4.62it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.63it/s] 72%|███████▏  | 184/256 [00:40<00:15,  4.61it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.61it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.61it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.63it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.62it/s] 74%|███████▍  | 189/256 [00:41<00:14,  4.61it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.62it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.61it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.61it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.61it/s] 76%|███████▌  | 194/256 [00:42<00:13,  4.61it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.62it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 197/256 [00:43<00:13,  4.38it/s] 77%|███████▋  | 198/256 [00:43<00:13,  4.23it/s] 78%|███████▊  | 199/256 [00:44<00:13,  4.14it/s] 78%|███████▊  | 200/256 [00:44<00:13,  4.29it/s] 79%|███████▊  | 201/256 [00:44<00:12,  4.40it/s] 79%|███████▉  | 202/256 [00:44<00:12,  4.45it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.50it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.55it/s] 80%|████████  | 205/256 [00:45<00:11,  4.48it/s] 80%|████████  | 206/256 [00:45<00:11,  4.53it/s] 81%|████████  | 207/256 [00:45<00:10,  4.55it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.58it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.57it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.58it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.56it/s] 83%|████████▎ | 212/256 [00:46<00:09,  4.55it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.56it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.58it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.57it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.59it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.59it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.60it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.58it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.59it/s] 86%|████████▋ | 221/256 [00:48<00:07,  4.59it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.59it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.60it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.60it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.60it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.61it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.61it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.60it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.60it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.60it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.59it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.58it/s] 91%|█████████ | 233/256 [00:51<00:05,  4.59it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.60it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.53it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.55it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.55it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.52it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.56it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.57it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.59it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.60it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.60it/s] 95%|█████████▌| 244/256 [00:53<00:02,  4.60it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.59it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.59it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.60it/s] 97%|█████████▋| 248/256 [00:54<00:01,  4.61it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.61it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.60it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.59it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.60it/s] 99%|█████████▉| 253/256 [00:55<00:00,  4.61it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.61it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.61it/s]100%|██████████| 256/256 [00:56<00:00,  4.61it/s]100%|██████████| 256/256 [00:56<00:00,  4.51it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [55.52, 37.27]
Multiscale SSIM on Highres [0.999, 0.936]
Range Invariant Multiscale SSIM on Highres [0.999, 0.972]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/stats_disentangle_2405_D18-M3-S0-L8_10.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/11
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode12
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/11


Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 366
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<04:59,  1.18s/it]  1%|          | 2/256 [00:01<02:35,  1.63it/s]  1%|          | 3/256 [00:01<01:48,  2.32it/s]  2%|▏         | 4/256 [00:01<01:27,  2.89it/s]  2%|▏         | 5/256 [00:02<01:15,  3.34it/s]  2%|▏         | 6/256 [00:02<01:07,  3.68it/s]  3%|▎         | 7/256 [00:02<01:03,  3.94it/s]  3%|▎         | 8/256 [00:02<00:59,  4.15it/s]  4%|▎         | 9/256 [00:02<00:57,  4.28it/s]  4%|▍         | 10/256 [00:03<00:56,  4.39it/s]  4%|▍         | 11/256 [00:03<00:54,  4.48it/s]  5%|▍         | 12/256 [00:03<00:53,  4.53it/s]  5%|▌         | 13/256 [00:03<00:53,  4.55it/s]  5%|▌         | 14/256 [00:03<00:52,  4.58it/s]  6%|▌         | 15/256 [00:04<00:52,  4.59it/s]  6%|▋         | 16/256 [00:04<00:51,  4.62it/s]  7%|▋         | 17/256 [00:04<00:51,  4.61it/s]  7%|▋         | 18/256 [00:04<00:51,  4.62it/s]  7%|▋         | 19/256 [00:05<00:51,  4.62it/s]  8%|▊         | 20/256 [00:05<00:50,  4.64it/s]  8%|▊         | 21/256 [00:05<00:50,  4.64it/s]  9%|▊         | 22/256 [00:05<00:50,  4.65it/s]  9%|▉         | 23/256 [00:05<00:50,  4.63it/s]  9%|▉         | 24/256 [00:06<00:49,  4.64it/s] 10%|▉         | 25/256 [00:06<00:49,  4.63it/s] 10%|█         | 26/256 [00:06<00:49,  4.62it/s] 11%|█         | 27/256 [00:06<00:49,  4.62it/s] 11%|█         | 28/256 [00:07<00:49,  4.62it/s] 11%|█▏        | 29/256 [00:07<00:49,  4.60it/s] 12%|█▏        | 30/256 [00:07<00:49,  4.61it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.59it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.61it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.61it/s] 14%|█▎        | 35/256 [00:08<00:48,  4.60it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.61it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.61it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.62it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.62it/s] 16%|█▌        | 40/256 [00:09<00:46,  4.62it/s] 16%|█▌        | 41/256 [00:09<00:46,  4.62it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.62it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.61it/s] 17%|█▋        | 44/256 [00:10<00:45,  4.61it/s] 18%|█▊        | 45/256 [00:10<00:45,  4.60it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.62it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.62it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.61it/s] 19%|█▉        | 49/256 [00:11<00:44,  4.62it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.61it/s] 20%|█▉        | 51/256 [00:11<00:44,  4.60it/s] 20%|██        | 52/256 [00:12<00:44,  4.60it/s] 21%|██        | 53/256 [00:12<00:43,  4.61it/s] 21%|██        | 54/256 [00:12<00:43,  4.63it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.63it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.62it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.62it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.60it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.61it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.60it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.62it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.61it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.60it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.60it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.61it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.62it/s] 26%|██▌       | 67/256 [00:15<00:40,  4.63it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.63it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.64it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.62it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.64it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.63it/s] 29%|██▉       | 74/256 [00:16<00:39,  4.63it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.63it/s] 30%|██▉       | 76/256 [00:17<00:38,  4.63it/s] 30%|███       | 77/256 [00:17<00:38,  4.60it/s] 30%|███       | 78/256 [00:17<00:38,  4.60it/s] 31%|███       | 79/256 [00:18<00:38,  4.61it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.63it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.63it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.61it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.62it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.63it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.63it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.62it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.61it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.63it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.63it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.63it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.62it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.60it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.61it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 97/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.60it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.60it/s] 39%|███▉      | 100/256 [00:22<00:33,  4.60it/s] 39%|███▉      | 101/256 [00:22<00:33,  4.59it/s] 40%|███▉      | 102/256 [00:23<00:36,  4.19it/s] 40%|████      | 103/256 [00:23<00:37,  4.03it/s] 41%|████      | 104/256 [00:23<00:36,  4.20it/s] 41%|████      | 105/256 [00:23<00:35,  4.31it/s] 41%|████▏     | 106/256 [00:24<00:34,  4.31it/s] 42%|████▏     | 107/256 [00:24<00:33,  4.41it/s] 42%|████▏     | 108/256 [00:24<00:33,  4.47it/s] 43%|████▎     | 109/256 [00:24<00:32,  4.50it/s] 43%|████▎     | 110/256 [00:24<00:32,  4.53it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.56it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.58it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.59it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.59it/s] 45%|████▍     | 115/256 [00:26<00:30,  4.60it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.61it/s] 46%|████▌     | 118/256 [00:26<00:29,  4.60it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.59it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.58it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.59it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.58it/s] 48%|████▊     | 123/256 [00:27<00:29,  4.58it/s] 48%|████▊     | 124/256 [00:27<00:28,  4.60it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.59it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.60it/s] 50%|████▉     | 127/256 [00:28<00:28,  4.60it/s] 50%|█████     | 128/256 [00:28<00:27,  4.59it/s] 50%|█████     | 129/256 [00:29<00:27,  4.56it/s] 51%|█████     | 130/256 [00:29<00:27,  4.56it/s] 51%|█████     | 131/256 [00:29<00:27,  4.59it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.60it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.60it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.60it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 136/256 [00:30<00:26,  4.61it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.61it/s] 54%|█████▍    | 138/256 [00:31<00:25,  4.60it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.60it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.61it/s] 55%|█████▌    | 141/256 [00:31<00:25,  4.59it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.60it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.59it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.60it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.61it/s] 57%|█████▋    | 146/256 [00:32<00:23,  4.60it/s] 57%|█████▋    | 147/256 [00:32<00:23,  4.59it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.59it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.57it/s] 59%|█████▊    | 150/256 [00:33<00:23,  4.58it/s] 59%|█████▉    | 151/256 [00:33<00:22,  4.58it/s] 59%|█████▉    | 152/256 [00:34<00:22,  4.59it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.60it/s] 60%|██████    | 154/256 [00:34<00:22,  4.59it/s] 61%|██████    | 155/256 [00:34<00:22,  4.54it/s] 61%|██████    | 156/256 [00:34<00:21,  4.56it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.58it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.59it/s] 62%|██████▏   | 159/256 [00:35<00:21,  4.58it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.60it/s] 63%|██████▎   | 161/256 [00:36<00:20,  4.60it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.60it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.61it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.60it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.61it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.63it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.63it/s] 66%|██████▌   | 168/256 [00:37<00:18,  4.64it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.62it/s] 66%|██████▋   | 170/256 [00:37<00:18,  4.62it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.63it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.63it/s] 68%|██████▊   | 173/256 [00:38<00:18,  4.54it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.56it/s] 68%|██████▊   | 175/256 [00:39<00:17,  4.54it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.56it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.58it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.59it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.61it/s] 70%|███████   | 180/256 [00:40<00:16,  4.62it/s] 71%|███████   | 181/256 [00:40<00:16,  4.61it/s] 71%|███████   | 182/256 [00:40<00:16,  4.60it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.60it/s] 72%|███████▏  | 184/256 [00:41<00:15,  4.61it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.62it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.63it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.62it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.62it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.62it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.63it/s] 75%|███████▍  | 191/256 [00:42<00:14,  4.64it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.64it/s] 75%|███████▌  | 193/256 [00:42<00:13,  4.63it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.61it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.60it/s] 77%|███████▋  | 196/256 [00:43<00:13,  4.61it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.62it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.63it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.63it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.63it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.61it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.61it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.63it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.62it/s] 80%|████████  | 205/256 [00:45<00:11,  4.62it/s] 80%|████████  | 206/256 [00:45<00:10,  4.63it/s] 81%|████████  | 207/256 [00:45<00:10,  4.63it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.63it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.65it/s] 82%|████████▏ | 210/256 [00:46<00:09,  4.64it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.63it/s] 83%|████████▎ | 212/256 [00:47<00:09,  4.64it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.62it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.62it/s] 84%|████████▍ | 215/256 [00:47<00:08,  4.62it/s] 84%|████████▍ | 216/256 [00:47<00:08,  4.62it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.61it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.61it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.62it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.62it/s] 86%|████████▋ | 221/256 [00:49<00:07,  4.61it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.61it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.61it/s] 88%|████████▊ | 224/256 [00:49<00:06,  4.61it/s] 88%|████████▊ | 225/256 [00:49<00:06,  4.59it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.60it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.60it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.60it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.60it/s] 90%|████████▉ | 230/256 [00:50<00:05,  4.60it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.60it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.61it/s] 91%|█████████ | 233/256 [00:51<00:04,  4.61it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.60it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.61it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.61it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.61it/s] 93%|█████████▎| 238/256 [00:52<00:03,  4.62it/s] 93%|█████████▎| 239/256 [00:52<00:03,  4.37it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.20it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.11it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.26it/s] 95%|█████████▍| 243/256 [00:53<00:02,  4.37it/s] 95%|█████████▌| 244/256 [00:54<00:02,  4.43it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.48it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.53it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.54it/s] 97%|█████████▋| 248/256 [00:55<00:01,  4.56it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.57it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.58it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.59it/s] 98%|█████████▊| 252/256 [00:55<00:00,  4.58it/s] 99%|█████████▉| 253/256 [00:56<00:00,  4.60it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.60it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.61it/s]100%|██████████| 256/256 [00:56<00:00,  4.60it/s]100%|██████████| 256/256 [00:56<00:00,  4.49it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [41.57, 43.32]
Multiscale SSIM on Highres [0.992, 0.995]
Range Invariant Multiscale SSIM on Highres [0.993, 0.995]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/stats_disentangle_2405_D18-M3-S0-L8_11.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/12
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode15
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/12


Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 399
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:01<05:06,  1.20s/it]  1%|          | 2/256 [00:01<02:38,  1.61it/s]  1%|          | 3/256 [00:01<01:50,  2.28it/s]  2%|▏         | 4/256 [00:01<01:28,  2.85it/s]  2%|▏         | 5/256 [00:02<01:16,  3.28it/s]  2%|▏         | 6/256 [00:02<01:08,  3.66it/s]  3%|▎         | 7/256 [00:02<01:03,  3.94it/s]  3%|▎         | 8/256 [00:02<00:59,  4.15it/s]  4%|▎         | 9/256 [00:02<00:57,  4.30it/s]  4%|▍         | 10/256 [00:03<00:55,  4.40it/s]  4%|▍         | 11/256 [00:03<00:54,  4.46it/s]  5%|▍         | 12/256 [00:03<00:54,  4.51it/s]  5%|▌         | 13/256 [00:03<00:53,  4.56it/s]  5%|▌         | 14/256 [00:04<00:52,  4.58it/s]  6%|▌         | 15/256 [00:04<00:52,  4.59it/s]  6%|▋         | 16/256 [00:04<00:52,  4.60it/s]  7%|▋         | 17/256 [00:04<00:51,  4.62it/s]  7%|▋         | 18/256 [00:04<00:51,  4.63it/s]  7%|▋         | 19/256 [00:05<00:51,  4.63it/s]  8%|▊         | 20/256 [00:05<00:50,  4.65it/s]  8%|▊         | 21/256 [00:05<00:50,  4.63it/s]  9%|▊         | 22/256 [00:05<00:50,  4.64it/s]  9%|▉         | 23/256 [00:05<00:50,  4.64it/s]  9%|▉         | 24/256 [00:06<00:49,  4.66it/s] 10%|▉         | 25/256 [00:06<00:49,  4.65it/s] 10%|█         | 26/256 [00:06<00:49,  4.65it/s] 11%|█         | 27/256 [00:06<00:49,  4.65it/s] 11%|█         | 28/256 [00:07<00:48,  4.65it/s] 11%|█▏        | 29/256 [00:07<00:48,  4.65it/s] 12%|█▏        | 30/256 [00:07<00:48,  4.65it/s] 12%|█▏        | 31/256 [00:07<00:48,  4.62it/s] 12%|█▎        | 32/256 [00:07<00:48,  4.62it/s] 13%|█▎        | 33/256 [00:08<00:48,  4.62it/s] 13%|█▎        | 34/256 [00:08<00:48,  4.61it/s] 14%|█▎        | 35/256 [00:08<00:47,  4.61it/s] 14%|█▍        | 36/256 [00:08<00:47,  4.59it/s] 14%|█▍        | 37/256 [00:08<00:47,  4.58it/s] 15%|█▍        | 38/256 [00:09<00:47,  4.59it/s] 15%|█▌        | 39/256 [00:09<00:47,  4.59it/s] 16%|█▌        | 40/256 [00:09<00:47,  4.59it/s] 16%|█▌        | 41/256 [00:09<00:47,  4.56it/s] 16%|█▋        | 42/256 [00:10<00:46,  4.56it/s] 17%|█▋        | 43/256 [00:10<00:46,  4.55it/s] 17%|█▋        | 44/256 [00:10<00:46,  4.55it/s] 18%|█▊        | 45/256 [00:10<00:46,  4.57it/s] 18%|█▊        | 46/256 [00:10<00:45,  4.57it/s] 18%|█▊        | 47/256 [00:11<00:45,  4.59it/s] 19%|█▉        | 48/256 [00:11<00:45,  4.59it/s] 19%|█▉        | 49/256 [00:11<00:45,  4.59it/s] 20%|█▉        | 50/256 [00:11<00:44,  4.59it/s] 20%|█▉        | 51/256 [00:12<00:44,  4.59it/s] 20%|██        | 52/256 [00:12<00:44,  4.60it/s] 21%|██        | 53/256 [00:12<00:44,  4.61it/s] 21%|██        | 54/256 [00:12<00:43,  4.61it/s] 21%|██▏       | 55/256 [00:12<00:43,  4.60it/s] 22%|██▏       | 56/256 [00:13<00:43,  4.60it/s] 22%|██▏       | 57/256 [00:13<00:43,  4.60it/s] 23%|██▎       | 58/256 [00:13<00:43,  4.59it/s] 23%|██▎       | 59/256 [00:13<00:42,  4.60it/s] 23%|██▎       | 60/256 [00:13<00:42,  4.60it/s] 24%|██▍       | 61/256 [00:14<00:42,  4.62it/s] 24%|██▍       | 62/256 [00:14<00:42,  4.61it/s] 25%|██▍       | 63/256 [00:14<00:41,  4.60it/s] 25%|██▌       | 64/256 [00:14<00:41,  4.59it/s] 25%|██▌       | 65/256 [00:15<00:41,  4.60it/s] 26%|██▌       | 66/256 [00:15<00:41,  4.60it/s] 26%|██▌       | 67/256 [00:15<00:41,  4.61it/s] 27%|██▋       | 68/256 [00:15<00:40,  4.61it/s] 27%|██▋       | 69/256 [00:15<00:40,  4.62it/s] 27%|██▋       | 70/256 [00:16<00:40,  4.63it/s] 28%|██▊       | 71/256 [00:16<00:40,  4.61it/s] 28%|██▊       | 72/256 [00:16<00:39,  4.62it/s] 29%|██▊       | 73/256 [00:16<00:39,  4.62it/s] 29%|██▉       | 74/256 [00:17<00:39,  4.61it/s] 29%|██▉       | 75/256 [00:17<00:39,  4.61it/s] 30%|██▉       | 76/256 [00:17<00:39,  4.60it/s] 30%|███       | 77/256 [00:17<00:38,  4.61it/s] 30%|███       | 78/256 [00:17<00:38,  4.60it/s] 31%|███       | 79/256 [00:18<00:38,  4.61it/s] 31%|███▏      | 80/256 [00:18<00:38,  4.61it/s] 32%|███▏      | 81/256 [00:18<00:37,  4.62it/s] 32%|███▏      | 82/256 [00:18<00:37,  4.62it/s] 32%|███▏      | 83/256 [00:18<00:37,  4.61it/s] 33%|███▎      | 84/256 [00:19<00:37,  4.62it/s] 33%|███▎      | 85/256 [00:19<00:36,  4.62it/s] 34%|███▎      | 86/256 [00:19<00:36,  4.63it/s] 34%|███▍      | 87/256 [00:19<00:36,  4.61it/s] 34%|███▍      | 88/256 [00:20<00:36,  4.60it/s] 35%|███▍      | 89/256 [00:20<00:36,  4.61it/s] 35%|███▌      | 90/256 [00:20<00:35,  4.61it/s] 36%|███▌      | 91/256 [00:20<00:35,  4.59it/s] 36%|███▌      | 92/256 [00:20<00:35,  4.60it/s] 36%|███▋      | 93/256 [00:21<00:35,  4.62it/s] 37%|███▋      | 94/256 [00:21<00:35,  4.61it/s] 37%|███▋      | 95/256 [00:21<00:34,  4.60it/s] 38%|███▊      | 96/256 [00:21<00:34,  4.59it/s] 38%|███▊      | 97/256 [00:22<00:34,  4.61it/s] 38%|███▊      | 98/256 [00:22<00:34,  4.61it/s] 39%|███▊      | 99/256 [00:22<00:34,  4.60it/s] 39%|███▉      | 100/256 [00:22<00:35,  4.37it/s] 39%|███▉      | 101/256 [00:22<00:36,  4.24it/s] 40%|███▉      | 102/256 [00:23<00:37,  4.07it/s] 40%|████      | 103/256 [00:23<00:36,  4.21it/s] 41%|████      | 104/256 [00:23<00:35,  4.26it/s] 41%|████      | 105/256 [00:23<00:34,  4.36it/s] 41%|████▏     | 106/256 [00:24<00:33,  4.44it/s] 42%|████▏     | 107/256 [00:24<00:33,  4.50it/s] 42%|████▏     | 108/256 [00:24<00:32,  4.54it/s] 43%|████▎     | 109/256 [00:24<00:32,  4.55it/s] 43%|████▎     | 110/256 [00:24<00:31,  4.56it/s] 43%|████▎     | 111/256 [00:25<00:31,  4.59it/s] 44%|████▍     | 112/256 [00:25<00:31,  4.60it/s] 44%|████▍     | 113/256 [00:25<00:31,  4.60it/s] 45%|████▍     | 114/256 [00:25<00:30,  4.60it/s] 45%|████▍     | 115/256 [00:26<00:30,  4.60it/s] 45%|████▌     | 116/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 117/256 [00:26<00:30,  4.60it/s] 46%|████▌     | 118/256 [00:26<00:30,  4.55it/s] 46%|████▋     | 119/256 [00:26<00:29,  4.57it/s] 47%|████▋     | 120/256 [00:27<00:29,  4.59it/s] 47%|████▋     | 121/256 [00:27<00:29,  4.60it/s] 48%|████▊     | 122/256 [00:27<00:29,  4.61it/s] 48%|████▊     | 123/256 [00:27<00:28,  4.61it/s] 48%|████▊     | 124/256 [00:28<00:28,  4.62it/s] 49%|████▉     | 125/256 [00:28<00:28,  4.62it/s] 49%|████▉     | 126/256 [00:28<00:28,  4.62it/s] 50%|████▉     | 127/256 [00:28<00:28,  4.60it/s] 50%|█████     | 128/256 [00:28<00:27,  4.61it/s] 50%|█████     | 129/256 [00:29<00:27,  4.61it/s] 51%|█████     | 130/256 [00:29<00:27,  4.62it/s] 51%|█████     | 131/256 [00:29<00:27,  4.63it/s] 52%|█████▏    | 132/256 [00:29<00:26,  4.63it/s] 52%|█████▏    | 133/256 [00:29<00:26,  4.63it/s] 52%|█████▏    | 134/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 135/256 [00:30<00:26,  4.62it/s] 53%|█████▎    | 136/256 [00:30<00:25,  4.63it/s] 54%|█████▎    | 137/256 [00:30<00:25,  4.62it/s] 54%|█████▍    | 138/256 [00:31<00:25,  4.61it/s] 54%|█████▍    | 139/256 [00:31<00:25,  4.61it/s] 55%|█████▍    | 140/256 [00:31<00:25,  4.59it/s] 55%|█████▌    | 141/256 [00:31<00:25,  4.59it/s] 55%|█████▌    | 142/256 [00:31<00:24,  4.60it/s] 56%|█████▌    | 143/256 [00:32<00:24,  4.59it/s] 56%|█████▋    | 144/256 [00:32<00:24,  4.51it/s] 57%|█████▋    | 145/256 [00:32<00:24,  4.55it/s] 57%|█████▋    | 146/256 [00:32<00:24,  4.58it/s] 57%|█████▋    | 147/256 [00:33<00:23,  4.60it/s] 58%|█████▊    | 148/256 [00:33<00:23,  4.60it/s] 58%|█████▊    | 149/256 [00:33<00:23,  4.61it/s] 59%|█████▊    | 150/256 [00:33<00:22,  4.62it/s] 59%|█████▉    | 151/256 [00:33<00:23,  4.54it/s] 59%|█████▉    | 152/256 [00:34<00:22,  4.55it/s] 60%|█████▉    | 153/256 [00:34<00:22,  4.58it/s] 60%|██████    | 154/256 [00:34<00:22,  4.59it/s] 61%|██████    | 155/256 [00:34<00:22,  4.59it/s] 61%|██████    | 156/256 [00:34<00:22,  4.51it/s] 61%|██████▏   | 157/256 [00:35<00:21,  4.54it/s] 62%|██████▏   | 158/256 [00:35<00:21,  4.56it/s] 62%|██████▏   | 159/256 [00:35<00:21,  4.57it/s] 62%|██████▎   | 160/256 [00:35<00:20,  4.59it/s] 63%|██████▎   | 161/256 [00:36<00:20,  4.61it/s] 63%|██████▎   | 162/256 [00:36<00:20,  4.61it/s] 64%|██████▎   | 163/256 [00:36<00:20,  4.62it/s] 64%|██████▍   | 164/256 [00:36<00:19,  4.61it/s] 64%|██████▍   | 165/256 [00:36<00:19,  4.61it/s] 65%|██████▍   | 166/256 [00:37<00:19,  4.59it/s] 65%|██████▌   | 167/256 [00:37<00:19,  4.61it/s] 66%|██████▌   | 168/256 [00:37<00:19,  4.61it/s] 66%|██████▌   | 169/256 [00:37<00:18,  4.60it/s] 66%|██████▋   | 170/256 [00:38<00:18,  4.55it/s] 67%|██████▋   | 171/256 [00:38<00:18,  4.57it/s] 67%|██████▋   | 172/256 [00:38<00:18,  4.57it/s] 68%|██████▊   | 173/256 [00:38<00:18,  4.57it/s] 68%|██████▊   | 174/256 [00:38<00:17,  4.58it/s] 68%|██████▊   | 175/256 [00:39<00:17,  4.58it/s] 69%|██████▉   | 176/256 [00:39<00:17,  4.59it/s] 69%|██████▉   | 177/256 [00:39<00:17,  4.59it/s] 70%|██████▉   | 178/256 [00:39<00:16,  4.59it/s] 70%|██████▉   | 179/256 [00:39<00:16,  4.60it/s] 70%|███████   | 180/256 [00:40<00:16,  4.60it/s] 71%|███████   | 181/256 [00:40<00:16,  4.61it/s] 71%|███████   | 182/256 [00:40<00:16,  4.61it/s] 71%|███████▏  | 183/256 [00:40<00:15,  4.60it/s] 72%|███████▏  | 184/256 [00:41<00:15,  4.61it/s] 72%|███████▏  | 185/256 [00:41<00:15,  4.63it/s] 73%|███████▎  | 186/256 [00:41<00:15,  4.62it/s] 73%|███████▎  | 187/256 [00:41<00:14,  4.63it/s] 73%|███████▎  | 188/256 [00:41<00:14,  4.63it/s] 74%|███████▍  | 189/256 [00:42<00:14,  4.62it/s] 74%|███████▍  | 190/256 [00:42<00:14,  4.63it/s] 75%|███████▍  | 191/256 [00:42<00:13,  4.64it/s] 75%|███████▌  | 192/256 [00:42<00:13,  4.64it/s] 75%|███████▌  | 193/256 [00:43<00:13,  4.64it/s] 76%|███████▌  | 194/256 [00:43<00:13,  4.63it/s] 76%|███████▌  | 195/256 [00:43<00:13,  4.64it/s] 77%|███████▋  | 196/256 [00:43<00:12,  4.64it/s] 77%|███████▋  | 197/256 [00:43<00:12,  4.64it/s] 77%|███████▋  | 198/256 [00:44<00:12,  4.64it/s] 78%|███████▊  | 199/256 [00:44<00:12,  4.63it/s] 78%|███████▊  | 200/256 [00:44<00:12,  4.62it/s] 79%|███████▊  | 201/256 [00:44<00:11,  4.63it/s] 79%|███████▉  | 202/256 [00:44<00:11,  4.64it/s] 79%|███████▉  | 203/256 [00:45<00:11,  4.63it/s] 80%|███████▉  | 204/256 [00:45<00:11,  4.62it/s] 80%|████████  | 205/256 [00:45<00:11,  4.62it/s] 80%|████████  | 206/256 [00:45<00:10,  4.63it/s] 81%|████████  | 207/256 [00:46<00:10,  4.58it/s] 81%|████████▏ | 208/256 [00:46<00:10,  4.56it/s] 82%|████████▏ | 209/256 [00:46<00:10,  4.56it/s] 82%|████████▏ | 210/256 [00:46<00:10,  4.51it/s] 82%|████████▏ | 211/256 [00:46<00:09,  4.51it/s] 83%|████████▎ | 212/256 [00:47<00:09,  4.50it/s] 83%|████████▎ | 213/256 [00:47<00:09,  4.51it/s] 84%|████████▎ | 214/256 [00:47<00:09,  4.52it/s] 84%|████████▍ | 215/256 [00:47<00:09,  4.54it/s] 84%|████████▍ | 216/256 [00:48<00:08,  4.54it/s] 85%|████████▍ | 217/256 [00:48<00:08,  4.55it/s] 85%|████████▌ | 218/256 [00:48<00:08,  4.58it/s] 86%|████████▌ | 219/256 [00:48<00:08,  4.59it/s] 86%|████████▌ | 220/256 [00:48<00:07,  4.59it/s] 86%|████████▋ | 221/256 [00:49<00:07,  4.60it/s] 87%|████████▋ | 222/256 [00:49<00:07,  4.59it/s] 87%|████████▋ | 223/256 [00:49<00:07,  4.60it/s] 88%|████████▊ | 224/256 [00:49<00:07,  4.57it/s] 88%|████████▊ | 225/256 [00:50<00:06,  4.58it/s] 88%|████████▊ | 226/256 [00:50<00:06,  4.59it/s] 89%|████████▊ | 227/256 [00:50<00:06,  4.58it/s] 89%|████████▉ | 228/256 [00:50<00:06,  4.58it/s] 89%|████████▉ | 229/256 [00:50<00:05,  4.58it/s] 90%|████████▉ | 230/256 [00:51<00:05,  4.58it/s] 90%|█████████ | 231/256 [00:51<00:05,  4.59it/s] 91%|█████████ | 232/256 [00:51<00:05,  4.59it/s] 91%|█████████ | 233/256 [00:51<00:05,  4.58it/s] 91%|█████████▏| 234/256 [00:51<00:04,  4.58it/s] 92%|█████████▏| 235/256 [00:52<00:04,  4.59it/s] 92%|█████████▏| 236/256 [00:52<00:04,  4.57it/s] 93%|█████████▎| 237/256 [00:52<00:04,  4.49it/s] 93%|█████████▎| 238/256 [00:52<00:04,  3.82it/s] 93%|█████████▎| 239/256 [00:53<00:04,  3.83it/s] 94%|█████████▍| 240/256 [00:53<00:03,  4.03it/s] 94%|█████████▍| 241/256 [00:53<00:03,  4.19it/s] 95%|█████████▍| 242/256 [00:53<00:03,  4.31it/s] 95%|█████████▍| 243/256 [00:54<00:02,  4.40it/s] 95%|█████████▌| 244/256 [00:54<00:02,  4.45it/s] 96%|█████████▌| 245/256 [00:54<00:02,  4.50it/s] 96%|█████████▌| 246/256 [00:54<00:02,  4.54it/s] 96%|█████████▋| 247/256 [00:54<00:01,  4.57it/s] 97%|█████████▋| 248/256 [00:55<00:01,  4.57it/s] 97%|█████████▋| 249/256 [00:55<00:01,  4.57it/s] 98%|█████████▊| 250/256 [00:55<00:01,  4.56it/s] 98%|█████████▊| 251/256 [00:55<00:01,  4.58it/s] 98%|█████████▊| 252/256 [00:56<00:00,  4.60it/s] 99%|█████████▉| 253/256 [00:56<00:00,  4.60it/s] 99%|█████████▉| 254/256 [00:56<00:00,  4.61it/s]100%|█████████▉| 255/256 [00:56<00:00,  4.62it/s]100%|██████████| 256/256 [00:56<00:00,  4.61it/s]100%|██████████| 256/256 [00:57<00:00,  4.48it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [39.35, 43.54]
Multiscale SSIM on Highres [0.981, 0.994]
Range Invariant Multiscale SSIM on Highres [0.981, 0.993]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/stats_disentangle_2405_D18-M3-S0-L8_12.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk0_F25.26/kth_4/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif
data:
  background_quantile: 0.0
  channel_idx_list:
  - GT_Cy5
  - GT_TRITC
  - 555-647
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/6
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: caa1d41d654fb423a7c3abc700486f87d132a2f7
  untracked_files: []
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/6

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Train

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Test

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 93
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]  8%|▊         | 3/40 [00:01<00:15,  2.36it/s] 10%|█         | 4/40 [00:01<00:12,  2.93it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.37it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.71it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.95it/s] 20%|██        | 8/40 [00:02<00:07,  4.14it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.28it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.38it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.45it/s] 30%|███       | 12/40 [00:03<00:06,  4.50it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.52it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.55it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.57it/s] 40%|████      | 16/40 [00:04<00:05,  4.56it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.57it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.59it/s] 50%|█████     | 20/40 [00:05<00:04,  4.58it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.58it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.57it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.56it/s] 60%|██████    | 24/40 [00:06<00:03,  4.57it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.58it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.59it/s] 70%|███████   | 28/40 [00:07<00:02,  4.60it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.59it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.58it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.59it/s] 80%|████████  | 32/40 [00:07<00:01,  4.60it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.57it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.58it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.59it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.61it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.59it/s]100%|██████████| 40/40 [00:09<00:00,  4.14it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [39.63, 32.54]
Multiscale SSIM on Highres [0.976, 0.948]
Range Invariant Multiscale SSIM on Highres [0.977, 0.95]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/stats_disentangle_2404_D21-M3-S0-L8_6.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  - 9
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/120
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/120

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]  5%|▌         | 2/40 [00:01<00:23,  1.65it/s]  8%|▊         | 3/40 [00:01<00:15,  2.34it/s] 10%|█         | 4/40 [00:01<00:12,  2.89it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.36it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.71it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.96it/s] 20%|██        | 8/40 [00:02<00:07,  4.14it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.29it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.38it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.45it/s] 30%|███       | 12/40 [00:03<00:06,  4.49it/s] 32%|███▎      | 13/40 [00:03<00:06,  4.50it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.53it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.57it/s] 40%|████      | 16/40 [00:04<00:05,  4.59it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.60it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.58it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.60it/s] 50%|█████     | 20/40 [00:05<00:04,  4.59it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.60it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.59it/s] 60%|██████    | 24/40 [00:06<00:03,  4.60it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.60it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.59it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.59it/s] 70%|███████   | 28/40 [00:07<00:02,  4.59it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.58it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.57it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.59it/s] 80%|████████  | 32/40 [00:07<00:01,  4.59it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.59it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.59it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.59it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.58it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.59it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.57it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.57it/s]100%|██████████| 40/40 [00:09<00:00,  4.15it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [27.25, 33.36]
Multiscale SSIM on Highres [0.8, 0.947]
Range Invariant Multiscale SSIM on Highres [0.817, 0.948]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/stats_disentangle_2404_D25-M3-S0-L8_120.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  - 10
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/111
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/111

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 334
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]  8%|▊         | 3/40 [00:01<00:15,  2.38it/s] 10%|█         | 4/40 [00:01<00:12,  2.95it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.39it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.72it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.99it/s] 20%|██        | 8/40 [00:02<00:07,  4.19it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.42it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.50it/s] 30%|███       | 12/40 [00:03<00:06,  4.52it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.55it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.57it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.60it/s] 40%|████      | 16/40 [00:04<00:05,  4.62it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.63it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.63it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.63it/s] 50%|█████     | 20/40 [00:05<00:04,  4.62it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.61it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.62it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:06<00:03,  4.60it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.62it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.62it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.63it/s] 70%|███████   | 28/40 [00:06<00:02,  4.63it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.61it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.60it/s] 80%|████████  | 32/40 [00:07<00:01,  4.61it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.60it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.60it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.60it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.61it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.60it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.61it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.18it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [27.24, 37.12]
Multiscale SSIM on Highres [0.779, 0.974]
Range Invariant Multiscale SSIM on Highres [0.816, 0.975]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/stats_disentangle_2404_D25-M3-S0-L8_111.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  - 11
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/125
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/125

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 279
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.13s/it]  5%|▌         | 2/40 [00:01<00:22,  1.69it/s]  8%|▊         | 3/40 [00:01<00:15,  2.38it/s] 10%|█         | 4/40 [00:01<00:12,  2.94it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.38it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.73it/s] 18%|█▊        | 7/40 [00:02<00:08,  4.00it/s] 20%|██        | 8/40 [00:02<00:07,  4.17it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.32it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.39it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.51it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.56it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.59it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.61it/s] 40%|████      | 16/40 [00:04<00:05,  4.62it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.62it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.63it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.64it/s] 50%|█████     | 20/40 [00:05<00:04,  4.62it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.62it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.61it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.62it/s] 60%|██████    | 24/40 [00:06<00:03,  4.61it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.61it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.62it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.61it/s] 70%|███████   | 28/40 [00:06<00:02,  4.62it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.62it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.63it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.62it/s] 80%|████████  | 32/40 [00:07<00:01,  4.54it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.55it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.55it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.23it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.08it/s] 92%|█████████▎| 37/40 [00:09<00:00,  3.95it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.08it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.23it/s]100%|██████████| 40/40 [00:09<00:00,  4.08it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [32.99, 29.69]
Multiscale SSIM on Highres [0.94, 0.877]
Range Invariant Multiscale SSIM on Highres [0.941, 0.88]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/stats_disentangle_2404_D25-M3-S0-L8_125.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  - 12
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/139
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/139

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 375
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:01<00:22,  1.67it/s]  8%|▊         | 3/40 [00:01<00:15,  2.35it/s] 10%|█         | 4/40 [00:01<00:12,  2.92it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.37it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.72it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.98it/s] 20%|██        | 8/40 [00:02<00:07,  4.17it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.31it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.39it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.46it/s] 30%|███       | 12/40 [00:03<00:06,  4.51it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.54it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.58it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.60it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.61it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.63it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.61it/s] 50%|█████     | 20/40 [00:05<00:04,  4.61it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.59it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.60it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.60it/s] 60%|██████    | 24/40 [00:06<00:03,  4.52it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.53it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.54it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.57it/s] 70%|███████   | 28/40 [00:07<00:02,  4.56it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.57it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.58it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.60it/s] 80%|████████  | 32/40 [00:07<00:01,  4.60it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.61it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.61it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.61it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.63it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.62it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.62it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.16it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [33.69, 34.9]
Multiscale SSIM on Highres [0.937, 0.949]
Range Invariant Multiscale SSIM on Highres [0.938, 0.949]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/stats_disentangle_2404_D25-M3-S0-L8_139.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  - 13
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/143
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/143

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 223
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:45,  1.17s/it]  5%|▌         | 2/40 [00:01<00:23,  1.65it/s]  8%|▊         | 3/40 [00:01<00:15,  2.33it/s] 10%|█         | 4/40 [00:01<00:12,  2.90it/s] 12%|█▎        | 5/40 [00:02<00:10,  3.36it/s] 15%|█▌        | 6/40 [00:02<00:09,  3.72it/s] 18%|█▊        | 7/40 [00:02<00:08,  3.98it/s] 20%|██        | 8/40 [00:02<00:07,  4.17it/s] 22%|██▎       | 9/40 [00:02<00:07,  4.31it/s] 25%|██▌       | 10/40 [00:03<00:06,  4.40it/s] 28%|██▊       | 11/40 [00:03<00:06,  4.47it/s] 30%|███       | 12/40 [00:03<00:06,  4.51it/s] 32%|███▎      | 13/40 [00:03<00:05,  4.55it/s] 35%|███▌      | 14/40 [00:03<00:05,  4.59it/s] 38%|███▊      | 15/40 [00:04<00:05,  4.59it/s] 40%|████      | 16/40 [00:04<00:05,  4.61it/s] 42%|████▎     | 17/40 [00:04<00:04,  4.62it/s] 45%|████▌     | 18/40 [00:04<00:04,  4.62it/s] 48%|████▊     | 19/40 [00:05<00:04,  4.64it/s] 50%|█████     | 20/40 [00:05<00:04,  4.63it/s] 52%|█████▎    | 21/40 [00:05<00:04,  4.63it/s] 55%|█████▌    | 22/40 [00:05<00:03,  4.60it/s] 57%|█████▊    | 23/40 [00:05<00:03,  4.60it/s] 60%|██████    | 24/40 [00:06<00:03,  4.60it/s] 62%|██████▎   | 25/40 [00:06<00:03,  4.59it/s] 65%|██████▌   | 26/40 [00:06<00:03,  4.61it/s] 68%|██████▊   | 27/40 [00:06<00:02,  4.59it/s] 70%|███████   | 28/40 [00:07<00:02,  4.60it/s] 72%|███████▎  | 29/40 [00:07<00:02,  4.59it/s] 75%|███████▌  | 30/40 [00:07<00:02,  4.61it/s] 78%|███████▊  | 31/40 [00:07<00:01,  4.61it/s] 80%|████████  | 32/40 [00:07<00:01,  4.62it/s] 82%|████████▎ | 33/40 [00:08<00:01,  4.61it/s] 85%|████████▌ | 34/40 [00:08<00:01,  4.63it/s] 88%|████████▊ | 35/40 [00:08<00:01,  4.64it/s] 90%|█████████ | 36/40 [00:08<00:00,  4.64it/s] 92%|█████████▎| 37/40 [00:08<00:00,  4.63it/s] 95%|█████████▌| 38/40 [00:09<00:00,  4.63it/s] 98%|█████████▊| 39/40 [00:09<00:00,  4.61it/s]100%|██████████| 40/40 [00:09<00:00,  4.16it/s]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [31.18, 35.67]
Multiscale SSIM on Highres [0.896, 0.955]
Range Invariant Multiscale SSIM on Highres [0.906, 0.955]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/stats_disentangle_2404_D25-M3-S0-L8_143.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M1_Sk8_F25.26/kth_4/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif
