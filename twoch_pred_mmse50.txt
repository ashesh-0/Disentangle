Evaluating between 0 5

##################################
Predicting 0th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:10<06:55, 10.67s/it]  5%|▌         | 2/40 [00:17<05:28,  8.65s/it]  8%|▊         | 3/40 [00:25<04:56,  8.00s/it] 10%|█         | 4/40 [00:32<04:37,  7.70s/it] 12%|█▎        | 5/40 [00:39<04:23,  7.53s/it] 15%|█▌        | 6/40 [00:46<04:12,  7.42s/it] 18%|█▊        | 7/40 [00:54<04:02,  7.36s/it] 20%|██        | 8/40 [01:01<03:54,  7.32s/it] 22%|██▎       | 9/40 [01:08<03:46,  7.29s/it] 25%|██▌       | 10/40 [01:15<03:38,  7.28s/it] 28%|██▊       | 11/40 [01:23<03:30,  7.27s/it] 30%|███       | 12/40 [01:30<03:23,  7.26s/it] 32%|███▎      | 13/40 [01:37<03:15,  7.25s/it] 35%|███▌      | 14/40 [01:44<03:08,  7.25s/it] 38%|███▊      | 15/40 [01:51<03:01,  7.25s/it] 40%|████      | 16/40 [01:59<02:53,  7.25s/it] 42%|████▎     | 17/40 [02:06<02:46,  7.25s/it] 45%|████▌     | 18/40 [02:13<02:39,  7.24s/it] 48%|████▊     | 19/40 [02:20<02:32,  7.24s/it] 50%|█████     | 20/40 [02:28<02:24,  7.24s/it] 52%|█████▎    | 21/40 [02:35<02:17,  7.24s/it] 55%|█████▌    | 22/40 [02:42<02:10,  7.24s/it] 57%|█████▊    | 23/40 [02:49<02:03,  7.24s/it] 60%|██████    | 24/40 [02:57<01:55,  7.24s/it] 62%|██████▎   | 25/40 [03:04<01:48,  7.24s/it] 65%|██████▌   | 26/40 [03:11<01:41,  7.23s/it] 68%|██████▊   | 27/40 [03:18<01:34,  7.24s/it] 70%|███████   | 28/40 [03:26<01:26,  7.24s/it] 72%|███████▎  | 29/40 [03:33<01:19,  7.24s/it] 75%|███████▌  | 30/40 [03:40<01:12,  7.23s/it] 78%|███████▊  | 31/40 [03:47<01:05,  7.23s/it] 80%|████████  | 32/40 [03:54<00:57,  7.23s/it] 82%|████████▎ | 33/40 [04:02<00:50,  7.23s/it] 85%|████████▌ | 34/40 [04:09<00:43,  7.23s/it] 88%|████████▊ | 35/40 [04:16<00:36,  7.23s/it] 90%|█████████ | 36/40 [04:23<00:28,  7.23s/it] 92%|█████████▎| 37/40 [04:31<00:21,  7.24s/it] 95%|█████████▌| 38/40 [04:38<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:45<00:07,  7.23s/it]100%|██████████| 40/40 [04:46<00:00,  5.33s/it]100%|██████████| 40/40 [04:46<00:00,  7.16s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_0/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [45.93, 35.68]
Multiscale SSIM on Highres [0.991, 0.98]
Range Invariant Multiscale SSIM on Highres [0.992, 0.981]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_0/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_0/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:07<01:57,  7.81s/it] 12%|█▎        | 2/16 [00:15<01:44,  7.47s/it] 19%|█▉        | 3/16 [00:22<01:35,  7.36s/it] 25%|██▌       | 4/16 [00:29<01:27,  7.32s/it] 31%|███▏      | 5/16 [00:36<01:20,  7.29s/it] 38%|███▊      | 6/16 [00:43<01:12,  7.27s/it] 44%|████▍     | 7/16 [00:51<01:05,  7.26s/it] 50%|█████     | 8/16 [00:58<00:57,  7.25s/it] 56%|█████▋    | 9/16 [01:05<00:50,  7.24s/it] 62%|██████▎   | 10/16 [01:12<00:43,  7.24s/it] 69%|██████▉   | 11/16 [01:20<00:36,  7.25s/it] 75%|███████▌  | 12/16 [01:27<00:28,  7.25s/it] 81%|████████▏ | 13/16 [01:34<00:21,  7.24s/it] 88%|████████▊ | 14/16 [01:41<00:14,  7.24s/it] 94%|█████████▍| 15/16 [01:49<00:07,  7.24s/it]100%|██████████| 16/16 [01:56<00:00,  7.24s/it]100%|██████████| 16/16 [01:56<00:00,  7.28s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [32.07, 32.16]
Multiscale SSIM on Highres [0.795, 0.775]
Range Invariant Multiscale SSIM on Highres [0.899, 0.831]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:07<04:51,  7.87s/it]  5%|▌         | 2/38 [00:15<04:30,  7.50s/it]  8%|▊         | 3/38 [00:22<04:18,  7.39s/it] 11%|█         | 4/38 [00:29<04:09,  7.33s/it] 13%|█▎        | 5/38 [00:36<04:00,  7.28s/it] 16%|█▌        | 6/38 [00:44<03:52,  7.26s/it] 18%|█▊        | 7/38 [00:51<03:44,  7.24s/it] 21%|██        | 8/38 [00:58<03:36,  7.23s/it] 24%|██▎       | 9/38 [01:05<03:29,  7.22s/it] 26%|██▋       | 10/38 [01:12<03:22,  7.22s/it] 29%|██▉       | 11/38 [01:20<03:14,  7.21s/it] 32%|███▏      | 12/38 [01:27<03:07,  7.21s/it] 34%|███▍      | 13/38 [01:34<03:00,  7.21s/it] 37%|███▋      | 14/38 [01:41<02:53,  7.21s/it] 39%|███▉      | 15/38 [01:48<02:45,  7.21s/it] 42%|████▏     | 16/38 [01:56<02:38,  7.21s/it] 45%|████▍     | 17/38 [02:03<02:31,  7.22s/it] 47%|████▋     | 18/38 [02:10<02:24,  7.23s/it] 50%|█████     | 19/38 [02:17<02:17,  7.22s/it] 53%|█████▎    | 20/38 [02:25<02:10,  7.23s/it] 55%|█████▌    | 21/38 [02:32<02:02,  7.23s/it] 58%|█████▊    | 22/38 [02:39<01:55,  7.23s/it] 61%|██████    | 23/38 [02:46<01:48,  7.23s/it] 63%|██████▎   | 24/38 [02:53<01:41,  7.23s/it] 66%|██████▌   | 25/38 [03:01<01:33,  7.22s/it] 68%|██████▊   | 26/38 [03:08<01:26,  7.22s/it] 71%|███████   | 27/38 [03:15<01:19,  7.22s/it] 74%|███████▎  | 28/38 [03:22<01:12,  7.23s/it] 76%|███████▋  | 29/38 [03:30<01:05,  7.23s/it] 79%|███████▉  | 30/38 [03:37<00:57,  7.23s/it] 82%|████████▏ | 31/38 [03:44<00:50,  7.23s/it] 84%|████████▍ | 32/38 [03:51<00:43,  7.23s/it] 87%|████████▋ | 33/38 [03:58<00:36,  7.23s/it] 89%|████████▉ | 34/38 [04:06<00:28,  7.23s/it] 92%|█████████▏| 35/38 [04:13<00:21,  7.23s/it] 95%|█████████▍| 36/38 [04:20<00:14,  7.23s/it] 97%|█████████▋| 37/38 [04:27<00:07,  7.23s/it]100%|██████████| 38/38 [04:31<00:00,  6.27s/it]100%|██████████| 38/38 [04:31<00:00,  7.16s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F11.43/kth_0/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [29.21, 27.11]
Multiscale SSIM on Highres [0.772, 0.842]
Range Invariant Multiscale SSIM on Highres [0.912, 0.846]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F11.43/kth_0/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F11.43/kth_0/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:07<05:07,  7.89s/it]  5%|▌         | 2/40 [00:15<04:45,  7.51s/it]  8%|▊         | 3/40 [00:22<04:33,  7.39s/it] 10%|█         | 4/40 [00:29<04:24,  7.34s/it] 12%|█▎        | 5/40 [00:36<04:15,  7.29s/it] 15%|█▌        | 6/40 [00:44<04:06,  7.26s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.25s/it] 20%|██        | 8/40 [00:58<03:51,  7.23s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.23s/it] 25%|██▌       | 10/40 [01:12<03:36,  7.23s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.22s/it] 30%|███       | 12/40 [01:27<03:22,  7.22s/it] 32%|███▎      | 13/40 [01:34<03:14,  7.22s/it] 35%|███▌      | 14/40 [01:41<03:07,  7.22s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.22s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.22s/it] 45%|████▌     | 18/40 [02:10<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:17<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:39<02:10,  7.22s/it] 57%|█████▊    | 23/40 [02:46<02:02,  7.22s/it] 60%|██████    | 24/40 [02:54<01:55,  7.22s/it] 62%|██████▎   | 25/40 [03:01<01:49,  7.30s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.28s/it] 68%|██████▊   | 27/40 [03:15<01:34,  7.26s/it] 70%|███████   | 28/40 [03:23<01:27,  7.25s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.25s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.24s/it] 78%|███████▊  | 31/40 [03:44<01:05,  7.24s/it] 80%|████████  | 32/40 [03:52<00:57,  7.24s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.24s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.24s/it] 88%|████████▊ | 35/40 [04:13<00:36,  7.23s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.23s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.23s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.23s/it]100%|██████████| 40/40 [04:43<00:00,  5.35s/it]100%|██████████| 40/40 [04:43<00:00,  7.09s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.2, 34.89]
Multiscale SSIM on Highres [0.846, 0.959]
Range Invariant Multiscale SSIM on Highres [0.848, 0.959]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:07<33:36,  7.91s/it]  1%|          | 2/256 [00:15<31:46,  7.50s/it]  1%|          | 3/256 [00:22<31:06,  7.38s/it]  2%|▏         | 4/256 [00:29<30:44,  7.32s/it]  2%|▏         | 5/256 [00:36<30:29,  7.29s/it]  2%|▏         | 6/256 [00:44<30:17,  7.27s/it]  3%|▎         | 7/256 [00:51<30:14,  7.29s/it]  3%|▎         | 8/256 [00:58<30:03,  7.27s/it]  4%|▎         | 9/256 [01:05<29:53,  7.26s/it]  4%|▍         | 10/256 [01:13<29:45,  7.26s/it]  4%|▍         | 11/256 [01:20<29:37,  7.25s/it]  5%|▍         | 12/256 [01:27<29:28,  7.25s/it]  5%|▌         | 13/256 [01:34<29:20,  7.25s/it]  5%|▌         | 14/256 [01:42<29:13,  7.25s/it]  6%|▌         | 15/256 [01:49<29:05,  7.24s/it]  6%|▋         | 16/256 [01:56<28:58,  7.24s/it]  7%|▋         | 17/256 [02:03<28:50,  7.24s/it]  7%|▋         | 18/256 [02:11<28:43,  7.24s/it]  7%|▋         | 19/256 [02:18<28:36,  7.24s/it]  8%|▊         | 20/256 [02:25<28:29,  7.24s/it]  8%|▊         | 21/256 [02:32<28:21,  7.24s/it]  9%|▊         | 22/256 [02:39<28:13,  7.24s/it]  9%|▉         | 23/256 [02:47<28:06,  7.24s/it]  9%|▉         | 24/256 [02:54<27:59,  7.24s/it] 10%|▉         | 25/256 [03:01<27:51,  7.24s/it] 10%|█         | 26/256 [03:08<27:44,  7.24s/it] 11%|█         | 27/256 [03:16<27:37,  7.24s/it] 11%|█         | 28/256 [03:23<27:29,  7.23s/it] 11%|█▏        | 29/256 [03:30<27:22,  7.23s/it] 12%|█▏        | 30/256 [03:37<27:15,  7.24s/it] 12%|█▏        | 31/256 [03:45<27:07,  7.24s/it] 12%|█▎        | 32/256 [03:52<27:00,  7.24s/it] 13%|█▎        | 33/256 [03:59<26:53,  7.24s/it] 13%|█▎        | 34/256 [04:06<26:46,  7.24s/it] 14%|█▎        | 35/256 [04:14<26:39,  7.24s/it] 14%|█▍        | 36/256 [04:21<26:44,  7.29s/it] 14%|█▍        | 37/256 [04:28<26:33,  7.28s/it] 15%|█▍        | 38/256 [04:35<26:23,  7.26s/it] 15%|█▌        | 39/256 [04:43<26:14,  7.26s/it] 16%|█▌        | 40/256 [04:50<26:06,  7.25s/it] 16%|█▌        | 41/256 [04:57<25:58,  7.25s/it] 16%|█▋        | 42/256 [05:04<25:50,  7.24s/it] 17%|█▋        | 43/256 [05:12<25:42,  7.24s/it] 17%|█▋        | 44/256 [05:19<25:35,  7.24s/it] 18%|█▊        | 45/256 [05:26<25:27,  7.24s/it] 18%|█▊        | 46/256 [05:33<25:20,  7.24s/it] 18%|█▊        | 47/256 [05:41<25:13,  7.24s/it] 19%|█▉        | 48/256 [05:48<25:05,  7.24s/it] 19%|█▉        | 49/256 [05:55<24:58,  7.24s/it] 20%|█▉        | 50/256 [06:02<24:50,  7.24s/it] 20%|█▉        | 51/256 [06:10<24:43,  7.23s/it] 20%|██        | 52/256 [06:17<24:35,  7.23s/it] 21%|██        | 53/256 [06:24<24:28,  7.24s/it] 21%|██        | 54/256 [06:31<24:21,  7.23s/it] 21%|██▏       | 55/256 [06:38<24:13,  7.23s/it] 22%|██▏       | 56/256 [06:46<24:06,  7.23s/it] 22%|██▏       | 57/256 [06:53<23:59,  7.24s/it] 23%|██▎       | 58/256 [07:00<23:52,  7.24s/it] 23%|██▎       | 59/256 [07:07<23:45,  7.24s/it] 23%|██▎       | 60/256 [07:15<23:38,  7.24s/it] 24%|██▍       | 61/256 [07:22<23:30,  7.23s/it] 24%|██▍       | 62/256 [07:29<23:23,  7.23s/it] 25%|██▍       | 63/256 [07:36<23:16,  7.23s/it] 25%|██▌       | 64/256 [07:44<23:08,  7.23s/it] 25%|██▌       | 65/256 [07:51<23:05,  7.26s/it] 26%|██▌       | 66/256 [07:58<22:57,  7.25s/it] 26%|██▌       | 67/256 [08:05<22:49,  7.24s/it] 27%|██▋       | 68/256 [08:13<22:41,  7.24s/it] 27%|██▋       | 69/256 [08:20<22:33,  7.24s/it] 27%|██▋       | 70/256 [08:27<22:26,  7.24s/it] 28%|██▊       | 71/256 [08:34<22:18,  7.24s/it] 28%|██▊       | 72/256 [08:42<22:11,  7.23s/it] 29%|██▊       | 73/256 [08:49<22:04,  7.24s/it] 29%|██▉       | 74/256 [08:56<21:56,  7.23s/it] 29%|██▉       | 75/256 [09:03<21:49,  7.24s/it] 30%|██▉       | 76/256 [09:10<21:42,  7.24s/it] 30%|███       | 77/256 [09:18<21:35,  7.24s/it] 30%|███       | 78/256 [09:25<21:27,  7.24s/it] 31%|███       | 79/256 [09:32<21:20,  7.24s/it] 31%|███▏      | 80/256 [09:39<21:13,  7.24s/it] 32%|███▏      | 81/256 [09:47<21:06,  7.24s/it] 32%|███▏      | 82/256 [09:54<20:58,  7.23s/it] 32%|███▏      | 83/256 [10:01<20:51,  7.23s/it] 33%|███▎      | 84/256 [10:08<20:44,  7.24s/it] 33%|███▎      | 85/256 [10:16<20:37,  7.23s/it] 34%|███▎      | 86/256 [10:23<20:29,  7.23s/it] 34%|███▍      | 87/256 [10:30<20:22,  7.23s/it] 34%|███▍      | 88/256 [10:37<20:15,  7.23s/it] 35%|███▍      | 89/256 [10:45<20:08,  7.23s/it] 35%|███▌      | 90/256 [10:52<20:00,  7.23s/it] 36%|███▌      | 91/256 [10:59<19:53,  7.23s/it] 36%|███▌      | 92/256 [11:06<19:46,  7.23s/it] 36%|███▋      | 93/256 [11:13<19:39,  7.23s/it] 37%|███▋      | 94/256 [11:21<19:35,  7.26s/it] 37%|███▋      | 95/256 [11:28<19:27,  7.25s/it] 38%|███▊      | 96/256 [11:35<19:20,  7.25s/it] 38%|███▊      | 97/256 [11:42<19:12,  7.25s/it] 38%|███▊      | 98/256 [11:50<19:05,  7.25s/it] 39%|███▊      | 99/256 [11:57<18:58,  7.25s/it] 39%|███▉      | 100/256 [12:04<18:51,  7.25s/it] 39%|███▉      | 101/256 [12:12<18:43,  7.25s/it] 40%|███▉      | 102/256 [12:19<18:36,  7.25s/it] 40%|████      | 103/256 [12:26<18:29,  7.25s/it] 41%|████      | 104/256 [12:33<18:22,  7.25s/it] 41%|████      | 105/256 [12:40<18:14,  7.25s/it] 41%|████▏     | 106/256 [12:48<18:07,  7.25s/it] 42%|████▏     | 107/256 [12:55<18:00,  7.25s/it] 42%|████▏     | 108/256 [13:02<17:52,  7.25s/it] 43%|████▎     | 109/256 [13:10<17:46,  7.25s/it] 43%|████▎     | 110/256 [13:17<17:38,  7.25s/it] 43%|████▎     | 111/256 [13:24<17:31,  7.25s/it] 44%|████▍     | 112/256 [13:31<17:24,  7.25s/it] 44%|████▍     | 113/256 [13:39<17:17,  7.25s/it] 45%|████▍     | 114/256 [13:46<17:09,  7.25s/it] 45%|████▍     | 115/256 [13:53<17:02,  7.25s/it] 45%|████▌     | 116/256 [14:00<16:55,  7.25s/it] 46%|████▌     | 117/256 [14:08<16:48,  7.25s/it] 46%|████▌     | 118/256 [14:15<16:40,  7.25s/it] 46%|████▋     | 119/256 [14:22<16:33,  7.25s/it] 47%|████▋     | 120/256 [14:29<16:26,  7.25s/it] 47%|████▋     | 121/256 [14:37<16:19,  7.25s/it] 48%|████▊     | 122/256 [14:44<16:11,  7.25s/it] 48%|████▊     | 123/256 [14:51<16:04,  7.25s/it] 48%|████▊     | 124/256 [14:58<15:57,  7.25s/it] 49%|████▉     | 125/256 [15:06<15:49,  7.25s/it] 49%|████▉     | 126/256 [15:13<15:42,  7.25s/it] 50%|████▉     | 127/256 [15:20<15:35,  7.25s/it] 50%|█████     | 128/256 [15:27<15:28,  7.25s/it] 50%|█████     | 129/256 [15:35<15:20,  7.25s/it] 51%|█████     | 130/256 [15:42<15:13,  7.25s/it] 51%|█████     | 131/256 [15:49<15:06,  7.25s/it] 52%|█████▏    | 132/256 [15:56<14:59,  7.25s/it] 52%|█████▏    | 133/256 [16:04<14:51,  7.25s/it] 52%|█████▏    | 134/256 [16:11<14:44,  7.25s/it] 53%|█████▎    | 135/256 [16:18<14:37,  7.25s/it] 53%|█████▎    | 136/256 [16:25<14:30,  7.25s/it] 54%|█████▎    | 137/256 [16:33<14:22,  7.25s/it] 54%|█████▍    | 138/256 [16:40<14:15,  7.25s/it] 54%|█████▍    | 139/256 [16:47<14:08,  7.25s/it] 55%|█████▍    | 140/256 [16:54<14:00,  7.25s/it] 55%|█████▌    | 141/256 [17:02<13:53,  7.25s/it] 55%|█████▌    | 142/256 [17:09<13:47,  7.26s/it] 56%|█████▌    | 143/256 [17:16<13:39,  7.26s/it] 56%|█████▋    | 144/256 [17:23<13:32,  7.25s/it] 57%|█████▋    | 145/256 [17:31<13:25,  7.25s/it] 57%|█████▋    | 146/256 [17:38<13:17,  7.25s/it] 57%|█████▋    | 147/256 [17:45<13:10,  7.25s/it] 58%|█████▊    | 148/256 [17:52<13:03,  7.25s/it] 58%|█████▊    | 149/256 [18:00<12:55,  7.25s/it] 59%|█████▊    | 150/256 [18:07<12:48,  7.25s/it] 59%|█████▉    | 151/256 [18:14<12:41,  7.25s/it] 59%|█████▉    | 152/256 [18:21<12:34,  7.25s/it] 60%|█████▉    | 153/256 [18:29<12:26,  7.25s/it] 60%|██████    | 154/256 [18:36<12:19,  7.25s/it] 61%|██████    | 155/256 [18:43<12:12,  7.25s/it] 61%|██████    | 156/256 [18:50<12:05,  7.25s/it] 61%|██████▏   | 157/256 [18:58<11:57,  7.25s/it] 62%|██████▏   | 158/256 [19:05<11:50,  7.25s/it] 62%|██████▏   | 159/256 [19:12<11:43,  7.25s/it] 62%|██████▎   | 160/256 [19:19<11:36,  7.25s/it] 63%|██████▎   | 161/256 [19:27<11:28,  7.25s/it] 63%|██████▎   | 162/256 [19:34<11:21,  7.25s/it] 64%|██████▎   | 163/256 [19:41<11:14,  7.25s/it] 64%|██████▍   | 164/256 [19:48<11:06,  7.25s/it] 64%|██████▍   | 165/256 [19:56<10:59,  7.25s/it] 65%|██████▍   | 166/256 [20:03<10:52,  7.25s/it] 65%|██████▌   | 167/256 [20:10<10:44,  7.24s/it] 66%|██████▌   | 168/256 [20:17<10:37,  7.24s/it] 66%|██████▌   | 169/256 [20:25<10:29,  7.24s/it] 66%|██████▋   | 170/256 [20:32<10:22,  7.24s/it] 67%|██████▋   | 171/256 [20:39<10:15,  7.24s/it] 67%|██████▋   | 172/256 [20:46<10:07,  7.24s/it] 68%|██████▊   | 173/256 [20:53<10:00,  7.24s/it] 68%|██████▊   | 174/256 [21:01<09:53,  7.23s/it] 68%|██████▊   | 175/256 [21:08<09:45,  7.23s/it] 69%|██████▉   | 176/256 [21:15<09:38,  7.23s/it] 69%|██████▉   | 177/256 [21:22<09:31,  7.24s/it] 70%|██████▉   | 178/256 [21:30<09:24,  7.24s/it] 70%|██████▉   | 179/256 [21:37<09:17,  7.24s/it] 70%|███████   | 180/256 [21:44<09:09,  7.23s/it] 71%|███████   | 181/256 [21:51<09:02,  7.23s/it] 71%|███████   | 182/256 [21:59<08:55,  7.24s/it] 71%|███████▏  | 183/256 [22:06<08:48,  7.24s/it] 72%|███████▏  | 184/256 [22:13<08:40,  7.24s/it] 72%|███████▏  | 185/256 [22:20<08:33,  7.24s/it] 73%|███████▎  | 186/256 [22:28<08:26,  7.23s/it] 73%|███████▎  | 187/256 [22:35<08:19,  7.23s/it] 73%|███████▎  | 188/256 [22:42<08:11,  7.23s/it] 74%|███████▍  | 189/256 [22:49<08:04,  7.23s/it] 74%|███████▍  | 190/256 [22:56<07:57,  7.23s/it] 75%|███████▍  | 191/256 [23:04<07:50,  7.23s/it] 75%|███████▌  | 192/256 [23:11<07:43,  7.23s/it] 75%|███████▌  | 193/256 [23:18<07:35,  7.24s/it] 76%|███████▌  | 194/256 [23:25<07:28,  7.23s/it] 76%|███████▌  | 195/256 [23:33<07:21,  7.23s/it] 77%|███████▋  | 196/256 [23:40<07:14,  7.24s/it] 77%|███████▋  | 197/256 [23:47<07:06,  7.24s/it] 77%|███████▋  | 198/256 [23:54<06:59,  7.24s/it] 78%|███████▊  | 199/256 [24:02<06:52,  7.23s/it] 78%|███████▊  | 200/256 [24:09<06:45,  7.23s/it] 79%|███████▊  | 201/256 [24:16<06:37,  7.23s/it] 79%|███████▉  | 202/256 [24:23<06:30,  7.23s/it] 79%|███████▉  | 203/256 [24:31<06:23,  7.23s/it] 80%|███████▉  | 204/256 [24:38<06:16,  7.23s/it] 80%|████████  | 205/256 [24:45<06:08,  7.23s/it] 80%|████████  | 206/256 [24:52<06:01,  7.23s/it] 81%|████████  | 207/256 [24:59<05:54,  7.23s/it] 81%|████████▏ | 208/256 [25:07<05:47,  7.23s/it] 82%|████████▏ | 209/256 [25:14<05:39,  7.23s/it] 82%|████████▏ | 210/256 [25:21<05:32,  7.23s/it] 82%|████████▏ | 211/256 [25:28<05:25,  7.23s/it] 83%|████████▎ | 212/256 [25:36<05:18,  7.23s/it] 83%|████████▎ | 213/256 [25:43<05:10,  7.23s/it] 84%|████████▎ | 214/256 [25:50<05:03,  7.23s/it] 84%|████████▍ | 215/256 [25:57<04:56,  7.23s/it] 84%|████████▍ | 216/256 [26:05<04:49,  7.23s/it] 85%|████████▍ | 217/256 [26:12<04:42,  7.23s/it] 85%|████████▌ | 218/256 [26:19<04:34,  7.23s/it] 86%|████████▌ | 219/256 [26:26<04:27,  7.23s/it] 86%|████████▌ | 220/256 [26:33<04:20,  7.23s/it] 86%|████████▋ | 221/256 [26:41<04:13,  7.23s/it] 87%|████████▋ | 222/256 [26:48<04:05,  7.23s/it] 87%|████████▋ | 223/256 [26:55<03:58,  7.23s/it] 88%|████████▊ | 224/256 [27:02<03:51,  7.23s/it] 88%|████████▊ | 225/256 [27:10<03:44,  7.23s/it] 88%|████████▊ | 226/256 [27:17<03:36,  7.23s/it] 89%|████████▊ | 227/256 [27:24<03:29,  7.23s/it] 89%|████████▉ | 228/256 [27:31<03:22,  7.23s/it] 89%|████████▉ | 229/256 [27:39<03:15,  7.23s/it] 90%|████████▉ | 230/256 [27:46<03:08,  7.23s/it] 90%|█████████ | 231/256 [27:53<03:00,  7.23s/it] 91%|█████████ | 232/256 [28:00<02:53,  7.23s/it] 91%|█████████ | 233/256 [28:07<02:46,  7.23s/it] 91%|█████████▏| 234/256 [28:15<02:39,  7.23s/it] 92%|█████████▏| 235/256 [28:22<02:31,  7.23s/it] 92%|█████████▏| 236/256 [28:29<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:36<02:17,  7.23s/it] 93%|█████████▎| 238/256 [28:44<02:10,  7.23s/it] 93%|█████████▎| 239/256 [28:51<02:03,  7.25s/it] 94%|█████████▍| 240/256 [28:58<01:55,  7.25s/it] 94%|█████████▍| 241/256 [29:05<01:48,  7.24s/it] 95%|█████████▍| 242/256 [29:13<01:41,  7.24s/it] 95%|█████████▍| 243/256 [29:20<01:34,  7.24s/it] 95%|█████████▌| 244/256 [29:27<01:26,  7.24s/it] 96%|█████████▌| 245/256 [29:34<01:19,  7.24s/it] 96%|█████████▌| 246/256 [29:42<01:12,  7.23s/it] 96%|█████████▋| 247/256 [29:49<01:05,  7.23s/it] 97%|█████████▋| 248/256 [29:56<00:57,  7.23s/it] 97%|█████████▋| 249/256 [30:03<00:50,  7.23s/it] 98%|█████████▊| 250/256 [30:10<00:43,  7.23s/it] 98%|█████████▊| 251/256 [30:18<00:36,  7.23s/it] 98%|█████████▊| 252/256 [30:25<00:28,  7.23s/it] 99%|█████████▉| 253/256 [30:32<00:21,  7.23s/it] 99%|█████████▉| 254/256 [30:39<00:14,  7.23s/it]100%|█████████▉| 255/256 [30:47<00:07,  7.23s/it]100%|██████████| 256/256 [30:54<00:00,  7.23s/it]100%|██████████| 256/256 [30:54<00:00,  7.24s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [38.69, 40.5]
Multiscale SSIM on Highres [0.978, 0.987]
Range Invariant Multiscale SSIM on Highres [0.98, 0.988]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:07<33:51,  7.97s/it]  1%|          | 2/256 [00:15<31:52,  7.53s/it]  1%|          | 3/256 [00:22<31:10,  7.39s/it]  2%|▏         | 4/256 [00:29<30:47,  7.33s/it]  2%|▏         | 5/256 [00:36<30:31,  7.30s/it]  2%|▏         | 6/256 [00:44<30:18,  7.27s/it]  3%|▎         | 7/256 [00:51<30:08,  7.26s/it]  3%|▎         | 8/256 [00:58<29:59,  7.26s/it]  4%|▎         | 9/256 [01:05<29:50,  7.25s/it]  4%|▍         | 10/256 [01:13<29:42,  7.25s/it]  4%|▍         | 11/256 [01:20<29:34,  7.24s/it]  5%|▍         | 12/256 [01:27<29:27,  7.24s/it]  5%|▌         | 13/256 [01:34<29:20,  7.24s/it]  5%|▌         | 14/256 [01:42<29:12,  7.24s/it]  6%|▌         | 15/256 [01:49<29:05,  7.24s/it]  6%|▋         | 16/256 [01:56<28:57,  7.24s/it]  7%|▋         | 17/256 [02:03<28:50,  7.24s/it]  7%|▋         | 18/256 [02:11<28:43,  7.24s/it]  7%|▋         | 19/256 [02:18<28:36,  7.24s/it]  8%|▊         | 20/256 [02:25<28:28,  7.24s/it]  8%|▊         | 21/256 [02:32<28:21,  7.24s/it]  9%|▊         | 22/256 [02:39<28:14,  7.24s/it]  9%|▉         | 23/256 [02:47<28:07,  7.24s/it]  9%|▉         | 24/256 [02:54<27:59,  7.24s/it] 10%|▉         | 25/256 [03:01<27:52,  7.24s/it] 10%|█         | 26/256 [03:08<27:45,  7.24s/it] 11%|█         | 27/256 [03:16<27:44,  7.27s/it] 11%|█         | 28/256 [03:23<27:34,  7.26s/it] 11%|█▏        | 29/256 [03:30<27:26,  7.25s/it] 12%|█▏        | 30/256 [03:37<27:18,  7.25s/it] 12%|█▏        | 31/256 [03:45<27:10,  7.25s/it] 12%|█▎        | 32/256 [03:52<27:02,  7.25s/it] 13%|█▎        | 33/256 [03:59<26:55,  7.24s/it] 13%|█▎        | 34/256 [04:06<26:47,  7.24s/it] 14%|█▎        | 35/256 [04:14<26:40,  7.24s/it] 14%|█▍        | 36/256 [04:21<26:32,  7.24s/it] 14%|█▍        | 37/256 [04:28<26:25,  7.24s/it] 15%|█▍        | 38/256 [04:35<26:18,  7.24s/it] 15%|█▌        | 39/256 [04:43<26:10,  7.24s/it] 16%|█▌        | 40/256 [04:50<26:03,  7.24s/it] 16%|█▌        | 41/256 [04:57<25:56,  7.24s/it] 16%|█▋        | 42/256 [05:04<25:48,  7.24s/it] 17%|█▋        | 43/256 [05:12<25:41,  7.24s/it] 17%|█▋        | 44/256 [05:19<25:34,  7.24s/it] 18%|█▊        | 45/256 [05:26<25:27,  7.24s/it] 18%|█▊        | 46/256 [05:33<25:20,  7.24s/it] 18%|█▊        | 47/256 [05:41<25:12,  7.24s/it] 19%|█▉        | 48/256 [05:48<25:05,  7.24s/it] 19%|█▉        | 49/256 [05:55<24:58,  7.24s/it] 20%|█▉        | 50/256 [06:02<24:51,  7.24s/it] 20%|█▉        | 51/256 [06:09<24:43,  7.24s/it] 20%|██        | 52/256 [06:17<24:36,  7.24s/it] 21%|██        | 53/256 [06:24<24:29,  7.24s/it] 21%|██        | 54/256 [06:31<24:21,  7.24s/it] 21%|██▏       | 55/256 [06:38<24:14,  7.24s/it] 22%|██▏       | 56/256 [06:46<24:12,  7.26s/it] 22%|██▏       | 57/256 [06:53<24:04,  7.26s/it] 23%|██▎       | 58/256 [07:00<23:56,  7.26s/it] 23%|██▎       | 59/256 [07:07<23:49,  7.25s/it] 23%|██▎       | 60/256 [07:15<23:41,  7.25s/it] 24%|██▍       | 61/256 [07:22<23:34,  7.25s/it] 24%|██▍       | 62/256 [07:29<23:26,  7.25s/it] 25%|██▍       | 63/256 [07:36<23:19,  7.25s/it] 25%|██▌       | 64/256 [07:44<23:12,  7.25s/it] 25%|██▌       | 65/256 [07:51<23:05,  7.25s/it] 26%|██▌       | 66/256 [07:58<22:57,  7.25s/it] 26%|██▌       | 67/256 [08:06<22:51,  7.25s/it] 27%|██▋       | 68/256 [08:13<22:43,  7.25s/it] 27%|██▋       | 69/256 [08:20<22:36,  7.25s/it] 27%|██▋       | 70/256 [08:27<22:29,  7.25s/it] 28%|██▊       | 71/256 [08:35<22:21,  7.25s/it] 28%|██▊       | 72/256 [08:42<22:14,  7.25s/it] 29%|██▊       | 73/256 [08:49<22:07,  7.25s/it] 29%|██▉       | 74/256 [08:56<22:00,  7.25s/it] 29%|██▉       | 75/256 [09:04<21:52,  7.25s/it] 30%|██▉       | 76/256 [09:11<21:45,  7.25s/it] 30%|███       | 77/256 [09:18<21:38,  7.25s/it] 30%|███       | 78/256 [09:25<21:31,  7.25s/it] 31%|███       | 79/256 [09:33<21:23,  7.25s/it] 31%|███▏      | 80/256 [09:40<21:16,  7.25s/it] 32%|███▏      | 81/256 [09:47<21:09,  7.25s/it] 32%|███▏      | 82/256 [09:54<21:02,  7.25s/it] 32%|███▏      | 83/256 [10:02<20:54,  7.25s/it] 33%|███▎      | 84/256 [10:09<20:47,  7.25s/it] 33%|███▎      | 85/256 [10:16<20:40,  7.25s/it] 34%|███▎      | 86/256 [10:23<20:33,  7.25s/it] 34%|███▍      | 87/256 [10:31<20:25,  7.25s/it] 34%|███▍      | 88/256 [10:38<20:18,  7.25s/it] 35%|███▍      | 89/256 [10:45<20:11,  7.25s/it] 35%|███▌      | 90/256 [10:52<20:03,  7.25s/it] 36%|███▌      | 91/256 [11:00<19:56,  7.25s/it] 36%|███▌      | 92/256 [11:07<19:49,  7.25s/it] 36%|███▋      | 93/256 [11:14<19:41,  7.25s/it] 37%|███▋      | 94/256 [11:21<19:34,  7.25s/it] 37%|███▋      | 95/256 [11:29<19:27,  7.25s/it] 38%|███▊      | 96/256 [11:36<19:20,  7.25s/it] 38%|███▊      | 97/256 [11:43<19:13,  7.25s/it] 38%|███▊      | 98/256 [11:50<19:05,  7.25s/it] 39%|███▊      | 99/256 [11:58<18:58,  7.25s/it] 39%|███▉      | 100/256 [12:05<18:51,  7.25s/it] 39%|███▉      | 101/256 [12:12<18:43,  7.25s/it] 40%|███▉      | 102/256 [12:19<18:36,  7.25s/it] 40%|████      | 103/256 [12:27<18:29,  7.25s/it] 41%|████      | 104/256 [12:34<18:22,  7.25s/it] 41%|████      | 105/256 [12:41<18:15,  7.25s/it] 41%|████▏     | 106/256 [12:48<18:07,  7.25s/it] 42%|████▏     | 107/256 [12:56<18:00,  7.25s/it] 42%|████▏     | 108/256 [13:03<17:53,  7.25s/it] 43%|████▎     | 109/256 [13:10<17:46,  7.25s/it] 43%|████▎     | 110/256 [13:17<17:38,  7.25s/it] 43%|████▎     | 111/256 [13:25<17:31,  7.25s/it] 44%|████▍     | 112/256 [13:32<17:24,  7.25s/it] 44%|████▍     | 113/256 [13:39<17:17,  7.26s/it] 45%|████▍     | 114/256 [13:46<17:10,  7.26s/it] 45%|████▍     | 115/256 [13:54<17:02,  7.26s/it] 45%|████▌     | 116/256 [14:01<16:55,  7.25s/it] 46%|████▌     | 117/256 [14:08<16:48,  7.25s/it] 46%|████▌     | 118/256 [14:16<16:59,  7.39s/it] 46%|████▋     | 119/256 [14:23<16:45,  7.34s/it] 47%|████▋     | 120/256 [14:30<16:33,  7.31s/it] 47%|████▋     | 121/256 [14:38<16:23,  7.29s/it] 48%|████▊     | 122/256 [14:45<16:14,  7.27s/it] 48%|████▊     | 123/256 [14:52<16:05,  7.26s/it] 48%|████▊     | 124/256 [14:59<15:57,  7.25s/it] 49%|████▉     | 125/256 [15:06<15:49,  7.25s/it] 49%|████▉     | 126/256 [15:14<15:41,  7.24s/it] 50%|████▉     | 127/256 [15:21<15:34,  7.24s/it] 50%|█████     | 128/256 [15:28<15:26,  7.24s/it] 50%|█████     | 129/256 [15:35<15:19,  7.24s/it] 51%|█████     | 130/256 [15:43<15:11,  7.24s/it] 51%|█████     | 131/256 [15:50<15:04,  7.24s/it] 52%|█████▏    | 132/256 [15:57<14:57,  7.23s/it] 52%|█████▏    | 133/256 [16:04<14:49,  7.23s/it] 52%|█████▏    | 134/256 [16:12<14:42,  7.23s/it] 53%|█████▎    | 135/256 [16:19<14:35,  7.24s/it] 53%|█████▎    | 136/256 [16:26<14:28,  7.23s/it] 54%|█████▎    | 137/256 [16:33<14:20,  7.23s/it] 54%|█████▍    | 138/256 [16:41<14:13,  7.23s/it] 54%|█████▍    | 139/256 [16:48<14:06,  7.24s/it] 55%|█████▍    | 140/256 [16:55<13:59,  7.24s/it] 55%|█████▌    | 141/256 [17:02<13:52,  7.24s/it] 55%|█████▌    | 142/256 [17:09<13:44,  7.24s/it] 56%|█████▌    | 143/256 [17:17<13:37,  7.24s/it] 56%|█████▋    | 144/256 [17:24<13:30,  7.24s/it] 57%|█████▋    | 145/256 [17:31<13:23,  7.24s/it] 57%|█████▋    | 146/256 [17:38<13:16,  7.24s/it] 57%|█████▋    | 147/256 [17:46<13:16,  7.30s/it] 58%|█████▊    | 148/256 [17:53<13:06,  7.28s/it] 58%|█████▊    | 149/256 [18:00<12:57,  7.27s/it] 59%|█████▊    | 150/256 [18:08<12:49,  7.26s/it] 59%|█████▉    | 151/256 [18:15<12:41,  7.25s/it] 59%|█████▉    | 152/256 [18:22<12:33,  7.25s/it] 60%|█████▉    | 153/256 [18:29<12:26,  7.25s/it] 60%|██████    | 154/256 [18:37<12:18,  7.24s/it] 61%|██████    | 155/256 [18:44<12:11,  7.24s/it] 61%|██████    | 156/256 [18:51<12:04,  7.24s/it] 61%|██████▏   | 157/256 [18:58<11:56,  7.24s/it] 62%|██████▏   | 158/256 [19:06<11:49,  7.24s/it] 62%|██████▏   | 159/256 [19:13<11:42,  7.24s/it] 62%|██████▎   | 160/256 [19:20<11:34,  7.24s/it] 63%|██████▎   | 161/256 [19:27<11:27,  7.24s/it] 63%|██████▎   | 162/256 [19:34<11:20,  7.24s/it] 64%|██████▎   | 163/256 [19:42<11:12,  7.24s/it] 64%|██████▍   | 164/256 [19:49<11:05,  7.23s/it] 64%|██████▍   | 165/256 [19:56<10:58,  7.23s/it] 65%|██████▍   | 166/256 [20:03<10:51,  7.24s/it] 65%|██████▌   | 167/256 [20:11<10:44,  7.24s/it] 66%|██████▌   | 168/256 [20:18<10:36,  7.24s/it] 66%|██████▌   | 169/256 [20:25<10:29,  7.24s/it] 66%|██████▋   | 170/256 [20:32<10:22,  7.24s/it] 67%|██████▋   | 171/256 [20:40<10:15,  7.24s/it] 67%|██████▋   | 172/256 [20:47<10:07,  7.24s/it] 68%|██████▊   | 173/256 [20:54<10:00,  7.24s/it] 68%|██████▊   | 174/256 [21:01<09:53,  7.24s/it] 68%|██████▊   | 175/256 [21:09<09:45,  7.23s/it] 69%|██████▉   | 176/256 [21:16<09:42,  7.28s/it] 69%|██████▉   | 177/256 [21:23<09:33,  7.26s/it] 70%|██████▉   | 178/256 [21:30<09:25,  7.25s/it] 70%|██████▉   | 179/256 [21:38<09:18,  7.25s/it] 70%|███████   | 180/256 [21:45<09:10,  7.24s/it] 71%|███████   | 181/256 [21:52<09:03,  7.24s/it] 71%|███████   | 182/256 [21:59<08:55,  7.24s/it] 71%|███████▏  | 183/256 [22:07<08:48,  7.24s/it] 72%|███████▏  | 184/256 [22:14<08:41,  7.24s/it] 72%|███████▏  | 185/256 [22:21<08:34,  7.24s/it] 73%|███████▎  | 186/256 [22:28<08:26,  7.24s/it] 73%|███████▎  | 187/256 [22:35<08:19,  7.24s/it] 73%|███████▎  | 188/256 [22:43<08:12,  7.24s/it] 74%|███████▍  | 189/256 [22:50<08:04,  7.23s/it] 74%|███████▍  | 190/256 [22:57<07:57,  7.23s/it] 75%|███████▍  | 191/256 [23:04<07:50,  7.23s/it] 75%|███████▌  | 192/256 [23:12<07:42,  7.23s/it] 75%|███████▌  | 193/256 [23:19<07:35,  7.23s/it] 76%|███████▌  | 194/256 [23:26<07:28,  7.23s/it] 76%|███████▌  | 195/256 [23:33<07:21,  7.23s/it] 77%|███████▋  | 196/256 [23:41<07:14,  7.23s/it] 77%|███████▋  | 197/256 [23:48<07:06,  7.23s/it] 77%|███████▋  | 198/256 [23:55<06:59,  7.23s/it] 78%|███████▊  | 199/256 [24:02<06:52,  7.23s/it] 78%|███████▊  | 200/256 [24:10<06:45,  7.23s/it] 79%|███████▊  | 201/256 [24:17<06:37,  7.24s/it] 79%|███████▉  | 202/256 [24:24<06:30,  7.23s/it] 79%|███████▉  | 203/256 [24:31<06:23,  7.23s/it] 80%|███████▉  | 204/256 [24:38<06:16,  7.23s/it] 80%|████████  | 205/256 [24:46<06:12,  7.30s/it] 80%|████████  | 206/256 [24:53<06:03,  7.28s/it] 81%|████████  | 207/256 [25:00<05:55,  7.26s/it] 81%|████████▏ | 208/256 [25:08<05:48,  7.26s/it] 82%|████████▏ | 209/256 [25:15<05:40,  7.25s/it] 82%|████████▏ | 210/256 [25:22<05:33,  7.25s/it] 82%|████████▏ | 211/256 [25:29<05:25,  7.24s/it] 83%|████████▎ | 212/256 [25:37<05:18,  7.24s/it] 83%|████████▎ | 213/256 [25:44<05:11,  7.24s/it] 84%|████████▎ | 214/256 [25:51<05:03,  7.24s/it] 84%|████████▍ | 215/256 [25:58<04:56,  7.23s/it] 84%|████████▍ | 216/256 [26:05<04:49,  7.23s/it] 85%|████████▍ | 217/256 [26:13<04:42,  7.23s/it] 85%|████████▌ | 218/256 [26:20<04:34,  7.23s/it] 86%|████████▌ | 219/256 [26:27<04:27,  7.23s/it] 86%|████████▌ | 220/256 [26:34<04:20,  7.23s/it] 86%|████████▋ | 221/256 [26:42<04:13,  7.23s/it] 87%|████████▋ | 222/256 [26:49<04:05,  7.23s/it] 87%|████████▋ | 223/256 [26:56<03:58,  7.23s/it] 88%|████████▊ | 224/256 [27:03<03:51,  7.23s/it] 88%|████████▊ | 225/256 [27:11<03:44,  7.23s/it] 88%|████████▊ | 226/256 [27:18<03:36,  7.23s/it] 89%|████████▊ | 227/256 [27:25<03:29,  7.23s/it] 89%|████████▉ | 228/256 [27:32<03:22,  7.23s/it] 89%|████████▉ | 229/256 [27:39<03:15,  7.23s/it] 90%|████████▉ | 230/256 [27:47<03:08,  7.23s/it] 90%|█████████ | 231/256 [27:54<03:00,  7.23s/it] 91%|█████████ | 232/256 [28:01<02:53,  7.23s/it] 91%|█████████ | 233/256 [28:08<02:46,  7.23s/it] 91%|█████████▏| 234/256 [28:16<02:40,  7.30s/it] 92%|█████████▏| 235/256 [28:23<02:32,  7.29s/it] 92%|█████████▏| 236/256 [28:30<02:25,  7.27s/it] 93%|█████████▎| 237/256 [28:38<02:18,  7.26s/it] 93%|█████████▎| 238/256 [28:45<02:10,  7.26s/it] 93%|█████████▎| 239/256 [28:52<02:03,  7.26s/it] 94%|█████████▍| 240/256 [28:59<01:56,  7.25s/it] 94%|█████████▍| 241/256 [29:07<01:48,  7.25s/it] 95%|█████████▍| 242/256 [29:14<01:41,  7.25s/it] 95%|█████████▍| 243/256 [29:21<01:34,  7.25s/it] 95%|█████████▌| 244/256 [29:28<01:26,  7.25s/it] 96%|█████████▌| 245/256 [29:36<01:19,  7.25s/it] 96%|█████████▌| 246/256 [29:43<01:12,  7.25s/it] 96%|█████████▋| 247/256 [29:50<01:05,  7.25s/it] 97%|█████████▋| 248/256 [29:57<00:57,  7.24s/it] 97%|█████████▋| 249/256 [30:05<00:50,  7.25s/it] 98%|█████████▊| 250/256 [30:12<00:43,  7.25s/it] 98%|█████████▊| 251/256 [30:19<00:36,  7.25s/it] 98%|█████████▊| 252/256 [30:26<00:28,  7.25s/it] 99%|█████████▉| 253/256 [30:34<00:21,  7.24s/it] 99%|█████████▉| 254/256 [30:41<00:14,  7.25s/it]100%|█████████▉| 255/256 [30:48<00:07,  7.25s/it]100%|██████████| 256/256 [30:55<00:00,  7.25s/it]100%|██████████| 256/256 [30:55<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [54.32, 40.56]
Multiscale SSIM on Highres [0.999, 0.97]
Range Invariant Multiscale SSIM on Highres [1.0, 0.989]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/stats_disentangle_2405_D18-M3-S0-L8_14.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/15
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/15


Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 111
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:07<33:54,  7.98s/it]  1%|          | 2/256 [00:15<31:54,  7.54s/it]  1%|          | 3/256 [00:22<31:11,  7.40s/it]  2%|▏         | 4/256 [00:29<30:47,  7.33s/it]  2%|▏         | 5/256 [00:37<30:54,  7.39s/it]  2%|▏         | 6/256 [00:44<30:35,  7.34s/it]  3%|▎         | 7/256 [00:51<30:21,  7.31s/it]  3%|▎         | 8/256 [00:58<30:09,  7.29s/it]  4%|▎         | 9/256 [01:06<29:58,  7.28s/it]  4%|▍         | 10/256 [01:13<29:49,  7.27s/it]  4%|▍         | 11/256 [01:20<29:40,  7.27s/it]  5%|▍         | 12/256 [01:27<29:33,  7.27s/it]  5%|▌         | 13/256 [01:35<29:24,  7.26s/it]  5%|▌         | 14/256 [01:42<29:17,  7.26s/it]  6%|▌         | 15/256 [01:49<29:09,  7.26s/it]  6%|▋         | 16/256 [01:56<29:02,  7.26s/it]  7%|▋         | 17/256 [02:04<28:55,  7.26s/it]  7%|▋         | 18/256 [02:11<28:47,  7.26s/it]  7%|▋         | 19/256 [02:18<28:40,  7.26s/it]  8%|▊         | 20/256 [02:26<28:32,  7.26s/it]  8%|▊         | 21/256 [02:33<28:25,  7.26s/it]  9%|▊         | 22/256 [02:40<28:18,  7.26s/it]  9%|▉         | 23/256 [02:47<28:10,  7.26s/it]  9%|▉         | 24/256 [02:55<28:03,  7.26s/it] 10%|▉         | 25/256 [03:02<27:55,  7.25s/it] 10%|█         | 26/256 [03:09<27:48,  7.25s/it] 11%|█         | 27/256 [03:16<27:41,  7.25s/it] 11%|█         | 28/256 [03:24<27:33,  7.25s/it] 11%|█▏        | 29/256 [03:31<27:26,  7.25s/it] 12%|█▏        | 30/256 [03:38<27:19,  7.25s/it] 12%|█▏        | 31/256 [03:45<27:12,  7.26s/it] 12%|█▎        | 32/256 [03:53<27:04,  7.25s/it] 13%|█▎        | 33/256 [04:00<26:57,  7.25s/it] 13%|█▎        | 34/256 [04:07<26:50,  7.25s/it] 14%|█▎        | 35/256 [04:14<26:43,  7.25s/it] 14%|█▍        | 36/256 [04:22<26:35,  7.25s/it] 14%|█▍        | 37/256 [04:29<26:28,  7.25s/it] 15%|█▍        | 38/256 [04:36<26:21,  7.25s/it] 15%|█▌        | 39/256 [04:43<26:14,  7.26s/it] 16%|█▌        | 40/256 [04:51<26:07,  7.26s/it] 16%|█▌        | 41/256 [04:58<26:00,  7.26s/it] 16%|█▋        | 42/256 [05:05<25:52,  7.25s/it] 17%|█▋        | 43/256 [05:12<25:45,  7.25s/it] 17%|█▋        | 44/256 [05:20<25:37,  7.25s/it] 18%|█▊        | 45/256 [05:27<25:29,  7.25s/it] 18%|█▊        | 46/256 [05:34<25:22,  7.25s/it] 18%|█▊        | 47/256 [05:41<25:15,  7.25s/it] 19%|█▉        | 48/256 [05:49<25:07,  7.25s/it] 19%|█▉        | 49/256 [05:56<25:00,  7.25s/it] 20%|█▉        | 50/256 [06:03<24:53,  7.25s/it] 20%|█▉        | 51/256 [06:10<24:46,  7.25s/it] 20%|██        | 52/256 [06:18<24:38,  7.25s/it] 21%|██        | 53/256 [06:25<24:31,  7.25s/it] 21%|██        | 54/256 [06:32<24:24,  7.25s/it] 21%|██▏       | 55/256 [06:39<24:17,  7.25s/it] 22%|██▏       | 56/256 [06:47<24:10,  7.25s/it] 22%|██▏       | 57/256 [06:54<24:03,  7.25s/it] 23%|██▎       | 58/256 [07:01<23:56,  7.25s/it] 23%|██▎       | 59/256 [07:08<23:49,  7.25s/it] 23%|██▎       | 60/256 [07:16<23:41,  7.25s/it] 24%|██▍       | 61/256 [07:23<23:34,  7.26s/it] 24%|██▍       | 62/256 [07:30<23:27,  7.25s/it] 25%|██▍       | 63/256 [07:37<23:19,  7.25s/it] 25%|██▌       | 64/256 [07:45<23:12,  7.25s/it] 25%|██▌       | 65/256 [07:52<23:05,  7.25s/it] 26%|██▌       | 66/256 [07:59<22:58,  7.25s/it] 26%|██▌       | 67/256 [08:07<23:12,  7.37s/it] 27%|██▋       | 68/256 [08:14<22:58,  7.33s/it] 27%|██▋       | 69/256 [08:21<22:45,  7.30s/it] 27%|██▋       | 70/256 [08:28<22:34,  7.28s/it] 28%|██▊       | 71/256 [08:36<22:24,  7.27s/it] 28%|██▊       | 72/256 [08:43<22:15,  7.26s/it] 29%|██▊       | 73/256 [08:50<22:07,  7.25s/it] 29%|██▉       | 74/256 [08:57<21:58,  7.25s/it] 29%|██▉       | 75/256 [09:05<21:51,  7.25s/it] 30%|██▉       | 76/256 [09:12<21:43,  7.24s/it] 30%|███       | 77/256 [09:19<21:36,  7.24s/it] 30%|███       | 78/256 [09:26<21:28,  7.24s/it] 31%|███       | 79/256 [09:34<21:21,  7.24s/it] 31%|███▏      | 80/256 [09:41<21:13,  7.24s/it] 32%|███▏      | 81/256 [09:48<21:06,  7.24s/it] 32%|███▏      | 82/256 [09:55<20:58,  7.24s/it] 32%|███▏      | 83/256 [10:03<20:51,  7.24s/it] 33%|███▎      | 84/256 [10:10<20:44,  7.24s/it] 33%|███▎      | 85/256 [10:17<20:37,  7.23s/it] 34%|███▎      | 86/256 [10:24<20:29,  7.23s/it] 34%|███▍      | 87/256 [10:32<20:22,  7.24s/it] 34%|███▍      | 88/256 [10:39<20:15,  7.24s/it] 35%|███▍      | 89/256 [10:46<20:08,  7.24s/it] 35%|███▌      | 90/256 [10:53<20:00,  7.23s/it] 36%|███▌      | 91/256 [11:00<19:53,  7.23s/it] 36%|███▌      | 92/256 [11:08<19:46,  7.24s/it] 36%|███▋      | 93/256 [11:15<19:39,  7.24s/it] 37%|███▋      | 94/256 [11:22<19:32,  7.24s/it] 37%|███▋      | 95/256 [11:29<19:24,  7.24s/it] 38%|███▊      | 96/256 [11:37<19:25,  7.28s/it] 38%|███▊      | 97/256 [11:44<19:16,  7.28s/it] 38%|███▊      | 98/256 [11:51<19:08,  7.27s/it] 39%|███▊      | 99/256 [11:59<19:00,  7.26s/it] 39%|███▉      | 100/256 [12:06<18:52,  7.26s/it] 39%|███▉      | 101/256 [12:13<18:44,  7.26s/it] 40%|███▉      | 102/256 [12:20<18:37,  7.26s/it] 40%|████      | 103/256 [12:28<18:29,  7.25s/it] 41%|████      | 104/256 [12:35<18:22,  7.25s/it] 41%|████      | 105/256 [12:42<18:15,  7.25s/it] 41%|████▏     | 106/256 [12:49<18:07,  7.25s/it] 42%|████▏     | 107/256 [12:57<18:00,  7.25s/it] 42%|████▏     | 108/256 [13:04<17:53,  7.25s/it] 43%|████▎     | 109/256 [13:11<17:45,  7.25s/it] 43%|████▎     | 110/256 [13:18<17:38,  7.25s/it] 43%|████▎     | 111/256 [13:26<17:31,  7.25s/it] 44%|████▍     | 112/256 [13:33<17:24,  7.25s/it] 44%|████▍     | 113/256 [13:40<17:17,  7.25s/it] 45%|████▍     | 114/256 [13:47<17:09,  7.25s/it] 45%|████▍     | 115/256 [13:55<17:03,  7.26s/it] 45%|████▌     | 116/256 [14:02<16:55,  7.26s/it] 46%|████▌     | 117/256 [14:09<16:48,  7.26s/it] 46%|████▌     | 118/256 [14:16<16:41,  7.25s/it] 46%|████▋     | 119/256 [14:24<16:33,  7.25s/it] 47%|████▋     | 120/256 [14:31<16:26,  7.25s/it] 47%|████▋     | 121/256 [14:38<16:18,  7.25s/it] 48%|████▊     | 122/256 [14:45<16:11,  7.25s/it] 48%|████▊     | 123/256 [14:53<16:04,  7.25s/it] 48%|████▊     | 124/256 [15:00<15:56,  7.25s/it] 49%|████▉     | 125/256 [15:07<15:49,  7.25s/it] 49%|████▉     | 126/256 [15:14<15:42,  7.25s/it] 50%|████▉     | 127/256 [15:22<15:35,  7.25s/it] 50%|█████     | 128/256 [15:29<15:28,  7.25s/it] 50%|█████     | 129/256 [15:36<15:20,  7.25s/it] 51%|█████     | 130/256 [15:43<15:13,  7.25s/it] 51%|█████     | 131/256 [15:51<15:06,  7.25s/it] 52%|█████▏    | 132/256 [15:58<14:59,  7.25s/it] 52%|█████▏    | 133/256 [16:05<14:52,  7.25s/it] 52%|█████▏    | 134/256 [16:12<14:45,  7.25s/it] 53%|█████▎    | 135/256 [16:20<14:37,  7.25s/it] 53%|█████▎    | 136/256 [16:27<14:30,  7.25s/it] 54%|█████▎    | 137/256 [16:34<14:23,  7.25s/it] 54%|█████▍    | 138/256 [16:41<14:15,  7.25s/it] 54%|█████▍    | 139/256 [16:49<14:08,  7.25s/it] 55%|█████▍    | 140/256 [16:56<14:01,  7.25s/it] 55%|█████▌    | 141/256 [17:03<13:54,  7.25s/it] 55%|█████▌    | 142/256 [17:10<13:46,  7.25s/it] 56%|█████▌    | 143/256 [17:18<13:39,  7.25s/it] 56%|█████▋    | 144/256 [17:25<13:32,  7.25s/it] 57%|█████▋    | 145/256 [17:32<13:24,  7.25s/it] 57%|█████▋    | 146/256 [17:39<13:17,  7.25s/it] 57%|█████▋    | 147/256 [17:47<13:10,  7.25s/it] 58%|█████▊    | 148/256 [17:54<13:02,  7.25s/it] 58%|█████▊    | 149/256 [18:01<12:55,  7.25s/it] 59%|█████▊    | 150/256 [18:08<12:48,  7.25s/it] 59%|█████▉    | 151/256 [18:16<12:41,  7.25s/it] 59%|█████▉    | 152/256 [18:23<12:34,  7.25s/it] 60%|█████▉    | 153/256 [18:30<12:26,  7.25s/it] 60%|██████    | 154/256 [18:37<12:19,  7.25s/it] 61%|██████    | 155/256 [18:45<12:12,  7.25s/it] 61%|██████    | 156/256 [18:52<12:05,  7.25s/it] 61%|██████▏   | 157/256 [18:59<11:57,  7.25s/it] 62%|██████▏   | 158/256 [19:07<12:01,  7.36s/it] 62%|██████▏   | 159/256 [19:14<11:51,  7.33s/it] 62%|██████▎   | 160/256 [19:21<11:41,  7.31s/it] 63%|██████▎   | 161/256 [19:29<11:32,  7.29s/it] 63%|██████▎   | 162/256 [19:36<11:24,  7.28s/it] 64%|██████▎   | 163/256 [19:43<11:16,  7.27s/it] 64%|██████▍   | 164/256 [19:50<11:08,  7.27s/it] 64%|██████▍   | 165/256 [19:58<11:00,  7.26s/it] 65%|██████▍   | 166/256 [20:05<10:53,  7.26s/it] 65%|██████▌   | 167/256 [20:12<10:46,  7.26s/it] 66%|██████▌   | 168/256 [20:19<10:38,  7.26s/it] 66%|██████▌   | 169/256 [20:27<10:31,  7.26s/it] 66%|██████▋   | 170/256 [20:34<10:24,  7.26s/it] 67%|██████▋   | 171/256 [20:41<10:16,  7.26s/it] 67%|██████▋   | 172/256 [20:48<10:09,  7.25s/it] 68%|██████▊   | 173/256 [20:56<10:02,  7.26s/it] 68%|██████▊   | 174/256 [21:03<09:55,  7.26s/it] 68%|██████▊   | 175/256 [21:10<09:47,  7.26s/it] 69%|██████▉   | 176/256 [21:17<09:40,  7.25s/it] 69%|██████▉   | 177/256 [21:25<09:32,  7.25s/it] 70%|██████▉   | 178/256 [21:32<09:25,  7.25s/it] 70%|██████▉   | 179/256 [21:39<09:18,  7.25s/it] 70%|███████   | 180/256 [21:46<09:11,  7.25s/it] 71%|███████   | 181/256 [21:54<09:03,  7.25s/it] 71%|███████   | 182/256 [22:01<08:56,  7.25s/it] 71%|███████▏  | 183/256 [22:08<08:49,  7.25s/it] 72%|███████▏  | 184/256 [22:15<08:42,  7.25s/it] 72%|███████▏  | 185/256 [22:23<08:34,  7.25s/it] 73%|███████▎  | 186/256 [22:30<08:27,  7.25s/it] 73%|███████▎  | 187/256 [22:37<08:20,  7.25s/it] 73%|███████▎  | 188/256 [22:44<08:13,  7.25s/it] 74%|███████▍  | 189/256 [22:52<08:05,  7.25s/it] 74%|███████▍  | 190/256 [22:59<07:58,  7.25s/it] 75%|███████▍  | 191/256 [23:06<07:51,  7.26s/it] 75%|███████▌  | 192/256 [23:13<07:44,  7.26s/it] 75%|███████▌  | 193/256 [23:21<07:37,  7.26s/it] 76%|███████▌  | 194/256 [23:28<07:29,  7.25s/it] 76%|███████▌  | 195/256 [23:35<07:22,  7.25s/it] 77%|███████▋  | 196/256 [23:42<07:15,  7.25s/it] 77%|███████▋  | 197/256 [23:50<07:07,  7.25s/it] 77%|███████▋  | 198/256 [23:57<07:00,  7.25s/it] 78%|███████▊  | 199/256 [24:04<06:53,  7.25s/it] 78%|███████▊  | 200/256 [24:11<06:46,  7.25s/it] 79%|███████▊  | 201/256 [24:19<06:38,  7.25s/it] 79%|███████▉  | 202/256 [24:26<06:31,  7.25s/it] 79%|███████▉  | 203/256 [24:33<06:24,  7.25s/it] 80%|███████▉  | 204/256 [24:40<06:16,  7.25s/it] 80%|████████  | 205/256 [24:48<06:09,  7.25s/it] 80%|████████  | 206/256 [24:55<06:02,  7.25s/it] 81%|████████  | 207/256 [25:02<05:55,  7.25s/it] 81%|████████▏ | 208/256 [25:09<05:48,  7.25s/it] 82%|████████▏ | 209/256 [25:17<05:40,  7.25s/it] 82%|████████▏ | 210/256 [25:24<05:33,  7.25s/it] 82%|████████▏ | 211/256 [25:31<05:26,  7.25s/it] 83%|████████▎ | 212/256 [25:38<05:19,  7.25s/it] 83%|████████▎ | 213/256 [25:46<05:11,  7.25s/it] 84%|████████▎ | 214/256 [25:53<05:04,  7.25s/it] 84%|████████▍ | 215/256 [26:00<04:57,  7.25s/it] 84%|████████▍ | 216/256 [26:07<04:50,  7.25s/it] 85%|████████▍ | 217/256 [26:15<04:42,  7.25s/it] 85%|████████▌ | 218/256 [26:22<04:35,  7.25s/it] 86%|████████▌ | 219/256 [26:29<04:28,  7.25s/it] 86%|████████▌ | 220/256 [26:37<04:21,  7.27s/it] 86%|████████▋ | 221/256 [26:44<04:14,  7.27s/it] 87%|████████▋ | 222/256 [26:51<04:06,  7.26s/it] 87%|████████▋ | 223/256 [26:58<03:59,  7.26s/it] 88%|████████▊ | 224/256 [27:06<03:52,  7.26s/it] 88%|████████▊ | 225/256 [27:13<03:44,  7.25s/it] 88%|████████▊ | 226/256 [27:20<03:37,  7.25s/it] 89%|████████▊ | 227/256 [27:27<03:30,  7.25s/it] 89%|████████▉ | 228/256 [27:35<03:23,  7.25s/it] 89%|████████▉ | 229/256 [27:42<03:15,  7.25s/it] 90%|████████▉ | 230/256 [27:49<03:08,  7.25s/it] 90%|█████████ | 231/256 [27:56<03:01,  7.25s/it] 91%|█████████ | 232/256 [28:04<02:53,  7.25s/it] 91%|█████████ | 233/256 [28:11<02:46,  7.25s/it] 91%|█████████▏| 234/256 [28:18<02:39,  7.25s/it] 92%|█████████▏| 235/256 [28:25<02:32,  7.25s/it] 92%|█████████▏| 236/256 [28:33<02:25,  7.25s/it] 93%|█████████▎| 237/256 [28:40<02:17,  7.25s/it] 93%|█████████▎| 238/256 [28:47<02:10,  7.25s/it] 93%|█████████▎| 239/256 [28:54<02:03,  7.25s/it] 94%|█████████▍| 240/256 [29:02<01:55,  7.25s/it] 94%|█████████▍| 241/256 [29:09<01:48,  7.25s/it] 95%|█████████▍| 242/256 [29:16<01:41,  7.25s/it] 95%|█████████▍| 243/256 [29:23<01:34,  7.25s/it] 95%|█████████▌| 244/256 [29:31<01:26,  7.25s/it] 96%|█████████▌| 245/256 [29:38<01:19,  7.25s/it] 96%|█████████▌| 246/256 [29:45<01:12,  7.25s/it] 96%|█████████▋| 247/256 [29:52<01:05,  7.25s/it] 97%|█████████▋| 248/256 [30:00<00:58,  7.25s/it] 97%|█████████▋| 249/256 [30:07<00:50,  7.26s/it] 98%|█████████▊| 250/256 [30:14<00:43,  7.26s/it] 98%|█████████▊| 251/256 [30:21<00:36,  7.26s/it] 98%|█████████▊| 252/256 [30:29<00:29,  7.25s/it] 99%|█████████▉| 253/256 [30:36<00:21,  7.25s/it] 99%|█████████▉| 254/256 [30:43<00:14,  7.25s/it]100%|█████████▉| 255/256 [30:50<00:07,  7.25s/it]100%|██████████| 256/256 [30:58<00:00,  7.25s/it]100%|██████████| 256/256 [30:58<00:00,  7.26s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [65.33, 40.13]
Multiscale SSIM on Highres [1.0, 0.976]
Range Invariant Multiscale SSIM on Highres [1.0, 0.99]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/stats_disentangle_2405_D18-M3-S0-L8_15.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/10
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/10


Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 357
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<34:57,  8.22s/it]  1%|          | 2/256 [00:15<32:19,  7.64s/it]  1%|          | 3/256 [00:22<31:24,  7.45s/it]  2%|▏         | 4/256 [00:29<30:55,  7.36s/it]  2%|▏         | 5/256 [00:37<30:51,  7.38s/it]  2%|▏         | 6/256 [00:44<30:32,  7.33s/it]  3%|▎         | 7/256 [00:51<30:17,  7.30s/it]  3%|▎         | 8/256 [00:59<30:06,  7.28s/it]  4%|▎         | 9/256 [01:06<29:55,  7.27s/it]  4%|▍         | 10/256 [01:13<29:46,  7.26s/it]  4%|▍         | 11/256 [01:20<29:37,  7.25s/it]  5%|▍         | 12/256 [01:27<29:29,  7.25s/it]  5%|▌         | 13/256 [01:35<29:21,  7.25s/it]  5%|▌         | 14/256 [01:42<29:13,  7.25s/it]  6%|▌         | 15/256 [01:49<29:06,  7.25s/it]  6%|▋         | 16/256 [01:56<28:59,  7.25s/it]  7%|▋         | 17/256 [02:04<28:51,  7.25s/it]  7%|▋         | 18/256 [02:11<28:44,  7.25s/it]  7%|▋         | 19/256 [02:18<28:37,  7.25s/it]  8%|▊         | 20/256 [02:25<28:29,  7.24s/it]  8%|▊         | 21/256 [02:33<28:21,  7.24s/it]  9%|▊         | 22/256 [02:40<28:14,  7.24s/it]  9%|▉         | 23/256 [02:47<28:05,  7.24s/it]  9%|▉         | 24/256 [02:54<27:58,  7.23s/it] 10%|▉         | 25/256 [03:02<27:54,  7.25s/it] 10%|█         | 26/256 [03:09<27:47,  7.25s/it] 11%|█         | 27/256 [03:16<27:38,  7.24s/it] 11%|█         | 28/256 [03:23<27:30,  7.24s/it] 11%|█▏        | 29/256 [03:31<27:22,  7.24s/it] 12%|█▏        | 30/256 [03:38<27:14,  7.23s/it] 12%|█▏        | 31/256 [03:45<27:07,  7.23s/it] 12%|█▎        | 32/256 [03:52<26:59,  7.23s/it] 13%|█▎        | 33/256 [04:00<26:52,  7.23s/it] 13%|█▎        | 34/256 [04:07<26:45,  7.23s/it] 14%|█▎        | 35/256 [04:14<26:38,  7.23s/it] 14%|█▍        | 36/256 [04:21<26:31,  7.23s/it] 14%|█▍        | 37/256 [04:28<26:23,  7.23s/it] 15%|█▍        | 38/256 [04:36<26:17,  7.23s/it] 15%|█▌        | 39/256 [04:43<26:10,  7.24s/it] 16%|█▌        | 40/256 [04:50<26:02,  7.23s/it] 16%|█▌        | 41/256 [04:57<25:54,  7.23s/it] 16%|█▋        | 42/256 [05:05<25:47,  7.23s/it] 17%|█▋        | 43/256 [05:12<25:39,  7.23s/it] 17%|█▋        | 44/256 [05:19<25:33,  7.23s/it] 18%|█▊        | 45/256 [05:26<25:25,  7.23s/it] 18%|█▊        | 46/256 [05:34<25:18,  7.23s/it] 18%|█▊        | 47/256 [05:41<25:11,  7.23s/it] 19%|█▉        | 48/256 [05:48<25:03,  7.23s/it] 19%|█▉        | 49/256 [05:55<24:56,  7.23s/it] 20%|█▉        | 50/256 [06:02<24:48,  7.23s/it] 20%|█▉        | 51/256 [06:10<24:42,  7.23s/it] 20%|██        | 52/256 [06:17<24:34,  7.23s/it] 21%|██        | 53/256 [06:24<24:27,  7.23s/it] 21%|██        | 54/256 [06:31<24:19,  7.23s/it] 21%|██▏       | 55/256 [06:39<24:12,  7.23s/it] 22%|██▏       | 56/256 [06:46<24:05,  7.23s/it] 22%|██▏       | 57/256 [06:53<23:58,  7.23s/it] 23%|██▎       | 58/256 [07:00<23:50,  7.23s/it] 23%|██▎       | 59/256 [07:07<23:43,  7.23s/it] 23%|██▎       | 60/256 [07:15<23:36,  7.23s/it] 24%|██▍       | 61/256 [07:22<23:29,  7.23s/it] 24%|██▍       | 62/256 [07:29<23:22,  7.23s/it] 25%|██▍       | 63/256 [07:36<23:14,  7.23s/it] 25%|██▌       | 64/256 [07:44<23:07,  7.23s/it] 25%|██▌       | 65/256 [07:51<23:01,  7.23s/it] 26%|██▌       | 66/256 [07:58<22:53,  7.23s/it] 26%|██▌       | 67/256 [08:05<22:46,  7.23s/it] 27%|██▋       | 68/256 [08:13<22:39,  7.23s/it] 27%|██▋       | 69/256 [08:20<22:31,  7.23s/it] 27%|██▋       | 70/256 [08:27<22:24,  7.23s/it] 28%|██▊       | 71/256 [08:34<22:17,  7.23s/it] 28%|██▊       | 72/256 [08:41<22:09,  7.23s/it] 29%|██▊       | 73/256 [08:49<22:02,  7.23s/it] 29%|██▉       | 74/256 [08:56<21:55,  7.23s/it] 29%|██▉       | 75/256 [09:03<21:48,  7.23s/it] 30%|██▉       | 76/256 [09:10<21:41,  7.23s/it] 30%|███       | 77/256 [09:18<21:33,  7.23s/it] 30%|███       | 78/256 [09:25<21:26,  7.23s/it] 31%|███       | 79/256 [09:32<21:32,  7.30s/it] 31%|███▏      | 80/256 [09:40<21:21,  7.28s/it] 32%|███▏      | 81/256 [09:47<21:12,  7.27s/it] 32%|███▏      | 82/256 [09:54<21:03,  7.26s/it] 32%|███▏      | 83/256 [10:01<20:54,  7.25s/it] 33%|███▎      | 84/256 [10:08<20:46,  7.25s/it] 33%|███▎      | 85/256 [10:16<20:38,  7.24s/it] 34%|███▎      | 86/256 [10:23<20:31,  7.24s/it] 34%|███▍      | 87/256 [10:30<20:23,  7.24s/it] 34%|███▍      | 88/256 [10:37<20:16,  7.24s/it] 35%|███▍      | 89/256 [10:45<20:08,  7.24s/it] 35%|███▌      | 90/256 [10:52<20:01,  7.24s/it] 36%|███▌      | 91/256 [10:59<19:54,  7.24s/it] 36%|███▌      | 92/256 [11:06<19:46,  7.24s/it] 36%|███▋      | 93/256 [11:14<19:39,  7.24s/it] 37%|███▋      | 94/256 [11:21<19:32,  7.24s/it] 37%|███▋      | 95/256 [11:28<19:24,  7.24s/it] 38%|███▊      | 96/256 [11:35<19:17,  7.24s/it] 38%|███▊      | 97/256 [11:43<19:10,  7.24s/it] 38%|███▊      | 98/256 [11:50<19:03,  7.24s/it] 39%|███▊      | 99/256 [11:57<18:56,  7.24s/it] 39%|███▉      | 100/256 [12:04<18:48,  7.24s/it] 39%|███▉      | 101/256 [12:12<18:41,  7.24s/it] 40%|███▉      | 102/256 [12:19<18:34,  7.24s/it] 40%|████      | 103/256 [12:26<18:27,  7.24s/it] 41%|████      | 104/256 [12:33<18:19,  7.24s/it] 41%|████      | 105/256 [12:40<18:12,  7.24s/it] 41%|████▏     | 106/256 [12:48<18:05,  7.24s/it] 42%|████▏     | 107/256 [12:55<17:58,  7.24s/it] 42%|████▏     | 108/256 [13:02<17:57,  7.28s/it] 43%|████▎     | 109/256 [13:10<17:47,  7.26s/it] 43%|████▎     | 110/256 [13:17<17:39,  7.25s/it] 43%|████▎     | 111/256 [13:24<17:30,  7.25s/it] 44%|████▍     | 112/256 [13:31<17:22,  7.24s/it] 44%|████▍     | 113/256 [13:38<17:15,  7.24s/it] 45%|████▍     | 114/256 [13:46<17:07,  7.24s/it] 45%|████▍     | 115/256 [13:53<16:59,  7.23s/it] 45%|████▌     | 116/256 [14:00<16:52,  7.23s/it] 46%|████▌     | 117/256 [14:07<16:45,  7.23s/it] 46%|████▌     | 118/256 [14:15<16:38,  7.23s/it] 46%|████▋     | 119/256 [14:22<16:30,  7.23s/it] 47%|████▋     | 120/256 [14:29<16:23,  7.23s/it] 47%|████▋     | 121/256 [14:36<16:16,  7.23s/it] 48%|████▊     | 122/256 [14:44<16:08,  7.23s/it] 48%|████▊     | 123/256 [14:51<16:02,  7.23s/it] 48%|████▊     | 124/256 [14:58<15:54,  7.23s/it] 49%|████▉     | 125/256 [15:05<15:47,  7.23s/it] 49%|████▉     | 126/256 [15:12<15:40,  7.23s/it] 50%|████▉     | 127/256 [15:20<15:32,  7.23s/it] 50%|█████     | 128/256 [15:27<15:25,  7.23s/it] 50%|█████     | 129/256 [15:34<15:18,  7.23s/it] 51%|█████     | 130/256 [15:41<15:11,  7.23s/it] 51%|█████     | 131/256 [15:49<15:04,  7.23s/it] 52%|█████▏    | 132/256 [15:56<14:56,  7.23s/it] 52%|█████▏    | 133/256 [16:03<14:49,  7.23s/it] 52%|█████▏    | 134/256 [16:10<14:42,  7.23s/it] 53%|█████▎    | 135/256 [16:18<14:35,  7.24s/it] 53%|█████▎    | 136/256 [16:25<14:28,  7.23s/it] 54%|█████▎    | 137/256 [16:32<14:28,  7.30s/it] 54%|█████▍    | 138/256 [16:39<14:19,  7.28s/it] 54%|█████▍    | 139/256 [16:47<14:10,  7.27s/it] 55%|█████▍    | 140/256 [16:54<14:01,  7.26s/it] 55%|█████▌    | 141/256 [17:01<13:54,  7.25s/it] 55%|█████▌    | 142/256 [17:08<13:46,  7.25s/it] 56%|█████▌    | 143/256 [17:16<13:38,  7.24s/it] 56%|█████▋    | 144/256 [17:23<13:30,  7.24s/it] 57%|█████▋    | 145/256 [17:30<13:23,  7.24s/it] 57%|█████▋    | 146/256 [17:37<13:16,  7.24s/it] 57%|█████▋    | 147/256 [17:45<13:08,  7.24s/it] 58%|█████▊    | 148/256 [17:52<13:01,  7.23s/it] 58%|█████▊    | 149/256 [17:59<12:54,  7.23s/it] 59%|█████▊    | 150/256 [18:06<12:47,  7.24s/it] 59%|█████▉    | 151/256 [18:14<12:39,  7.24s/it] 59%|█████▉    | 152/256 [18:21<12:32,  7.23s/it] 60%|█████▉    | 153/256 [18:28<12:25,  7.23s/it] 60%|██████    | 154/256 [18:35<12:18,  7.24s/it] 61%|██████    | 155/256 [18:42<12:10,  7.24s/it] 61%|██████    | 156/256 [18:50<12:03,  7.23s/it] 61%|██████▏   | 157/256 [18:57<11:56,  7.23s/it] 62%|██████▏   | 158/256 [19:04<11:49,  7.24s/it] 62%|██████▏   | 159/256 [19:11<11:41,  7.24s/it] 62%|██████▎   | 160/256 [19:19<11:34,  7.24s/it] 63%|██████▎   | 161/256 [19:26<11:27,  7.24s/it] 63%|██████▎   | 162/256 [19:33<11:20,  7.24s/it] 64%|██████▎   | 163/256 [19:40<11:12,  7.23s/it] 64%|██████▍   | 164/256 [19:48<11:05,  7.23s/it] 64%|██████▍   | 165/256 [19:55<10:58,  7.24s/it] 65%|██████▍   | 166/256 [20:02<10:57,  7.30s/it] 65%|██████▌   | 167/256 [20:10<10:47,  7.28s/it] 66%|██████▌   | 168/256 [20:17<10:39,  7.27s/it] 66%|██████▌   | 169/256 [20:24<10:31,  7.26s/it] 66%|██████▋   | 170/256 [20:31<10:23,  7.25s/it] 67%|██████▋   | 171/256 [20:38<10:15,  7.24s/it] 67%|██████▋   | 172/256 [20:46<10:08,  7.24s/it] 68%|██████▊   | 173/256 [20:53<10:00,  7.24s/it] 68%|██████▊   | 174/256 [21:00<09:53,  7.24s/it] 68%|██████▊   | 175/256 [21:07<09:46,  7.24s/it] 69%|██████▉   | 176/256 [21:15<09:38,  7.24s/it] 69%|██████▉   | 177/256 [21:22<09:31,  7.24s/it] 70%|██████▉   | 178/256 [21:29<09:24,  7.24s/it] 70%|██████▉   | 179/256 [21:36<09:17,  7.24s/it] 70%|███████   | 180/256 [21:44<09:09,  7.24s/it] 71%|███████   | 181/256 [21:51<09:02,  7.23s/it] 71%|███████   | 182/256 [21:58<08:55,  7.23s/it] 71%|███████▏  | 183/256 [22:05<08:48,  7.23s/it] 72%|███████▏  | 184/256 [22:13<08:40,  7.23s/it] 72%|███████▏  | 185/256 [22:20<08:33,  7.24s/it] 73%|███████▎  | 186/256 [22:27<08:26,  7.24s/it] 73%|███████▎  | 187/256 [22:34<08:19,  7.24s/it] 73%|███████▎  | 188/256 [22:41<08:12,  7.24s/it] 74%|███████▍  | 189/256 [22:49<08:04,  7.24s/it] 74%|███████▍  | 190/256 [22:56<07:57,  7.24s/it] 75%|███████▍  | 191/256 [23:03<07:50,  7.24s/it] 75%|███████▌  | 192/256 [23:10<07:43,  7.24s/it] 75%|███████▌  | 193/256 [23:18<07:35,  7.23s/it] 76%|███████▌  | 194/256 [23:25<07:28,  7.24s/it] 76%|███████▌  | 195/256 [23:32<07:25,  7.30s/it] 77%|███████▋  | 196/256 [23:40<07:16,  7.28s/it] 77%|███████▋  | 197/256 [23:47<07:08,  7.27s/it] 77%|███████▋  | 198/256 [23:54<07:00,  7.26s/it] 78%|███████▊  | 199/256 [24:01<06:53,  7.25s/it] 78%|███████▊  | 200/256 [24:09<06:45,  7.25s/it] 79%|███████▊  | 201/256 [24:16<06:38,  7.24s/it] 79%|███████▉  | 202/256 [24:23<06:31,  7.24s/it] 79%|███████▉  | 203/256 [24:30<06:23,  7.24s/it] 80%|███████▉  | 204/256 [24:37<06:16,  7.24s/it] 80%|████████  | 205/256 [24:45<06:09,  7.24s/it] 80%|████████  | 206/256 [24:52<06:01,  7.24s/it] 81%|████████  | 207/256 [24:59<05:54,  7.23s/it] 81%|████████▏ | 208/256 [25:06<05:47,  7.23s/it] 82%|████████▏ | 209/256 [25:14<05:39,  7.23s/it] 82%|████████▏ | 210/256 [25:21<05:32,  7.23s/it] 82%|████████▏ | 211/256 [25:28<05:25,  7.23s/it] 83%|████████▎ | 212/256 [25:35<05:18,  7.23s/it] 83%|████████▎ | 213/256 [25:43<05:10,  7.23s/it] 84%|████████▎ | 214/256 [25:50<05:03,  7.23s/it] 84%|████████▍ | 215/256 [25:57<04:56,  7.23s/it] 84%|████████▍ | 216/256 [26:04<04:49,  7.23s/it] 85%|████████▍ | 217/256 [26:11<04:42,  7.23s/it] 85%|████████▌ | 218/256 [26:19<04:34,  7.23s/it] 86%|████████▌ | 219/256 [26:26<04:27,  7.23s/it] 86%|████████▌ | 220/256 [26:33<04:20,  7.23s/it] 86%|████████▋ | 221/256 [26:40<04:13,  7.23s/it] 87%|████████▋ | 222/256 [26:48<04:05,  7.23s/it] 87%|████████▋ | 223/256 [26:55<03:58,  7.23s/it] 88%|████████▊ | 224/256 [27:02<03:53,  7.30s/it] 88%|████████▊ | 225/256 [27:10<03:45,  7.28s/it] 88%|████████▊ | 226/256 [27:17<03:37,  7.26s/it] 89%|████████▊ | 227/256 [27:24<03:30,  7.25s/it] 89%|████████▉ | 228/256 [27:31<03:22,  7.25s/it] 89%|████████▉ | 229/256 [27:38<03:15,  7.25s/it] 90%|████████▉ | 230/256 [27:46<03:08,  7.24s/it] 90%|█████████ | 231/256 [27:53<03:00,  7.24s/it] 91%|█████████ | 232/256 [28:00<02:53,  7.24s/it] 91%|█████████ | 233/256 [28:07<02:46,  7.24s/it] 91%|█████████▏| 234/256 [28:15<02:39,  7.24s/it] 92%|█████████▏| 235/256 [28:22<02:31,  7.24s/it] 92%|█████████▏| 236/256 [28:29<02:24,  7.24s/it] 93%|█████████▎| 237/256 [28:36<02:17,  7.24s/it] 93%|█████████▎| 238/256 [28:44<02:10,  7.24s/it] 93%|█████████▎| 239/256 [28:51<02:02,  7.24s/it] 94%|█████████▍| 240/256 [28:58<01:55,  7.24s/it] 94%|█████████▍| 241/256 [29:05<01:48,  7.23s/it] 95%|█████████▍| 242/256 [29:13<01:41,  7.23s/it] 95%|█████████▍| 243/256 [29:20<01:34,  7.23s/it] 95%|█████████▌| 244/256 [29:27<01:26,  7.24s/it] 96%|█████████▌| 245/256 [29:34<01:19,  7.24s/it] 96%|█████████▌| 246/256 [29:41<01:12,  7.23s/it] 96%|█████████▋| 247/256 [29:49<01:05,  7.23s/it] 97%|█████████▋| 248/256 [29:56<00:57,  7.23s/it] 97%|█████████▋| 249/256 [30:03<00:50,  7.23s/it] 98%|█████████▊| 250/256 [30:10<00:43,  7.23s/it] 98%|█████████▊| 251/256 [30:18<00:36,  7.23s/it] 98%|█████████▊| 252/256 [30:25<00:28,  7.23s/it] 99%|█████████▉| 253/256 [30:32<00:21,  7.30s/it] 99%|█████████▉| 254/256 [30:40<00:14,  7.28s/it]100%|█████████▉| 255/256 [30:47<00:07,  7.26s/it]100%|██████████| 256/256 [30:54<00:00,  7.25s/it]100%|██████████| 256/256 [30:54<00:00,  7.24s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [54.97, 39.51]
Multiscale SSIM on Highres [0.999, 0.968]
Range Invariant Multiscale SSIM on Highres [1.0, 0.987]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/stats_disentangle_2405_D18-M3-S0-L8_10.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/11
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode12
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/11


Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 366
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<34:28,  8.11s/it]  1%|          | 2/256 [00:15<32:08,  7.59s/it]  1%|          | 3/256 [00:22<31:18,  7.42s/it]  2%|▏         | 4/256 [00:29<30:51,  7.35s/it]  2%|▏         | 5/256 [00:37<30:33,  7.30s/it]  2%|▏         | 6/256 [00:44<30:21,  7.28s/it]  3%|▎         | 7/256 [00:51<30:09,  7.27s/it]  3%|▎         | 8/256 [00:58<30:00,  7.26s/it]  4%|▎         | 9/256 [01:05<29:51,  7.25s/it]  4%|▍         | 10/256 [01:13<29:42,  7.25s/it]  4%|▍         | 11/256 [01:20<29:36,  7.25s/it]  5%|▍         | 12/256 [01:27<29:27,  7.25s/it]  5%|▌         | 13/256 [01:34<29:20,  7.25s/it]  5%|▌         | 14/256 [01:42<29:12,  7.24s/it]  6%|▌         | 15/256 [01:49<29:05,  7.24s/it]  6%|▋         | 16/256 [01:57<29:35,  7.40s/it]  7%|▋         | 17/256 [02:04<29:16,  7.35s/it]  7%|▋         | 18/256 [02:11<29:01,  7.32s/it]  7%|▋         | 19/256 [02:18<28:48,  7.29s/it]  8%|▊         | 20/256 [02:26<28:37,  7.28s/it]  8%|▊         | 21/256 [02:33<28:27,  7.27s/it]  9%|▊         | 22/256 [02:40<28:19,  7.26s/it]  9%|▉         | 23/256 [02:47<28:10,  7.26s/it]  9%|▉         | 24/256 [02:55<28:02,  7.25s/it] 10%|▉         | 25/256 [03:02<27:55,  7.25s/it] 10%|█         | 26/256 [03:09<27:47,  7.25s/it] 11%|█         | 27/256 [03:16<27:39,  7.25s/it] 11%|█         | 28/256 [03:24<27:31,  7.24s/it] 11%|█▏        | 29/256 [03:31<27:23,  7.24s/it] 12%|█▏        | 30/256 [03:38<27:16,  7.24s/it] 12%|█▏        | 31/256 [03:45<27:10,  7.25s/it] 12%|█▎        | 32/256 [03:53<27:02,  7.24s/it] 13%|█▎        | 33/256 [04:00<26:54,  7.24s/it] 13%|█▎        | 34/256 [04:07<26:48,  7.24s/it] 14%|█▎        | 35/256 [04:14<26:40,  7.24s/it] 14%|█▍        | 36/256 [04:22<26:32,  7.24s/it] 14%|█▍        | 37/256 [04:29<26:25,  7.24s/it] 15%|█▍        | 38/256 [04:36<26:17,  7.24s/it] 15%|█▌        | 39/256 [04:43<26:11,  7.24s/it] 16%|█▌        | 40/256 [04:50<26:03,  7.24s/it] 16%|█▌        | 41/256 [04:58<25:56,  7.24s/it] 16%|█▋        | 42/256 [05:05<25:49,  7.24s/it] 17%|█▋        | 43/256 [05:12<25:41,  7.24s/it] 17%|█▋        | 44/256 [05:19<25:34,  7.24s/it] 18%|█▊        | 45/256 [05:27<25:35,  7.28s/it] 18%|█▊        | 46/256 [05:34<25:25,  7.27s/it] 18%|█▊        | 47/256 [05:41<25:16,  7.26s/it] 19%|█▉        | 48/256 [05:49<25:07,  7.25s/it] 19%|█▉        | 49/256 [05:56<24:59,  7.24s/it] 20%|█▉        | 50/256 [06:03<24:52,  7.24s/it] 20%|█▉        | 51/256 [06:10<24:44,  7.24s/it] 20%|██        | 52/256 [06:17<24:36,  7.24s/it] 21%|██        | 53/256 [06:25<24:29,  7.24s/it] 21%|██        | 54/256 [06:32<24:21,  7.24s/it] 21%|██▏       | 55/256 [06:39<24:14,  7.24s/it] 22%|██▏       | 56/256 [06:46<24:07,  7.24s/it] 22%|██▏       | 57/256 [06:54<23:59,  7.24s/it] 23%|██▎       | 58/256 [07:01<23:52,  7.24s/it] 23%|██▎       | 59/256 [07:08<23:45,  7.24s/it] 23%|██▎       | 60/256 [07:15<23:38,  7.24s/it] 24%|██▍       | 61/256 [07:23<23:31,  7.24s/it] 24%|██▍       | 62/256 [07:30<23:23,  7.24s/it] 25%|██▍       | 63/256 [07:37<23:16,  7.24s/it] 25%|██▌       | 64/256 [07:44<23:09,  7.24s/it] 25%|██▌       | 65/256 [07:52<23:01,  7.23s/it] 26%|██▌       | 66/256 [07:59<22:54,  7.23s/it] 26%|██▌       | 67/256 [08:06<22:47,  7.24s/it] 27%|██▋       | 68/256 [08:13<22:40,  7.24s/it] 27%|██▋       | 69/256 [08:20<22:33,  7.24s/it] 27%|██▋       | 70/256 [08:28<22:26,  7.24s/it] 28%|██▊       | 71/256 [08:35<22:18,  7.24s/it] 28%|██▊       | 72/256 [08:42<22:11,  7.24s/it] 29%|██▊       | 73/256 [08:49<22:04,  7.24s/it] 29%|██▉       | 74/256 [08:57<22:02,  7.26s/it] 29%|██▉       | 75/256 [09:04<21:53,  7.25s/it] 30%|██▉       | 76/256 [09:11<21:44,  7.25s/it] 30%|███       | 77/256 [09:18<21:36,  7.24s/it] 30%|███       | 78/256 [09:26<21:29,  7.24s/it] 31%|███       | 79/256 [09:33<21:21,  7.24s/it] 31%|███▏      | 80/256 [09:40<21:13,  7.24s/it] 32%|███▏      | 81/256 [09:47<21:06,  7.24s/it] 32%|███▏      | 82/256 [09:55<20:58,  7.23s/it] 32%|███▏      | 83/256 [10:02<20:51,  7.23s/it] 33%|███▎      | 84/256 [10:09<20:44,  7.23s/it] 33%|███▎      | 85/256 [10:16<20:36,  7.23s/it] 34%|███▎      | 86/256 [10:24<20:29,  7.23s/it] 34%|███▍      | 87/256 [10:31<20:22,  7.23s/it] 34%|███▍      | 88/256 [10:38<20:15,  7.23s/it] 35%|███▍      | 89/256 [10:45<20:07,  7.23s/it] 35%|███▌      | 90/256 [10:52<20:00,  7.23s/it] 36%|███▌      | 91/256 [11:00<19:53,  7.23s/it] 36%|███▌      | 92/256 [11:07<19:46,  7.23s/it] 36%|███▋      | 93/256 [11:14<19:39,  7.24s/it] 37%|███▋      | 94/256 [11:21<19:32,  7.23s/it] 37%|███▋      | 95/256 [11:29<19:24,  7.23s/it] 38%|███▊      | 96/256 [11:36<19:18,  7.24s/it] 38%|███▊      | 97/256 [11:43<19:10,  7.24s/it] 38%|███▊      | 98/256 [11:50<19:03,  7.24s/it] 39%|███▊      | 99/256 [11:58<18:56,  7.24s/it] 39%|███▉      | 100/256 [12:05<18:49,  7.24s/it] 39%|███▉      | 101/256 [12:12<18:41,  7.24s/it] 40%|███▉      | 102/256 [12:19<18:34,  7.24s/it] 40%|████      | 103/256 [12:27<18:36,  7.30s/it] 41%|████      | 104/256 [12:34<18:26,  7.28s/it] 41%|████      | 105/256 [12:41<18:16,  7.26s/it] 41%|████▏     | 106/256 [12:48<18:08,  7.26s/it] 42%|████▏     | 107/256 [12:56<17:59,  7.25s/it] 42%|████▏     | 108/256 [13:03<17:51,  7.24s/it] 43%|████▎     | 109/256 [13:10<17:44,  7.24s/it] 43%|████▎     | 110/256 [13:17<17:36,  7.24s/it] 43%|████▎     | 111/256 [13:25<17:28,  7.23s/it] 44%|████▍     | 112/256 [13:32<17:21,  7.23s/it] 44%|████▍     | 113/256 [13:39<17:14,  7.23s/it] 45%|████▍     | 114/256 [13:46<17:07,  7.23s/it] 45%|████▍     | 115/256 [13:54<16:59,  7.23s/it] 45%|████▌     | 116/256 [14:01<16:52,  7.23s/it] 46%|████▌     | 117/256 [14:08<16:45,  7.23s/it] 46%|████▌     | 118/256 [14:15<16:37,  7.23s/it] 46%|████▋     | 119/256 [14:22<16:30,  7.23s/it] 47%|████▋     | 120/256 [14:30<16:23,  7.23s/it] 47%|████▋     | 121/256 [14:37<16:16,  7.23s/it] 48%|████▊     | 122/256 [14:44<16:09,  7.23s/it] 48%|████▊     | 123/256 [14:51<16:02,  7.24s/it] 48%|████▊     | 124/256 [14:59<15:54,  7.23s/it] 49%|████▉     | 125/256 [15:06<15:47,  7.24s/it] 49%|████▉     | 126/256 [15:13<15:40,  7.24s/it] 50%|████▉     | 127/256 [15:20<15:33,  7.24s/it] 50%|█████     | 128/256 [15:28<15:25,  7.23s/it] 50%|█████     | 129/256 [15:35<15:18,  7.23s/it] 51%|█████     | 130/256 [15:42<15:11,  7.23s/it] 51%|█████     | 131/256 [15:49<15:04,  7.23s/it] 52%|█████▏    | 132/256 [15:57<15:05,  7.31s/it] 52%|█████▏    | 133/256 [16:04<14:55,  7.28s/it] 52%|█████▏    | 134/256 [16:11<14:46,  7.27s/it] 53%|█████▎    | 135/256 [16:18<14:38,  7.26s/it] 53%|█████▎    | 136/256 [16:26<14:30,  7.25s/it] 54%|█████▎    | 137/256 [16:33<14:22,  7.25s/it] 54%|█████▍    | 138/256 [16:40<14:14,  7.24s/it] 54%|█████▍    | 139/256 [16:47<14:07,  7.24s/it] 55%|█████▍    | 140/256 [16:55<13:59,  7.24s/it] 55%|█████▌    | 141/256 [17:02<13:52,  7.24s/it] 55%|█████▌    | 142/256 [17:09<13:44,  7.24s/it] 56%|█████▌    | 143/256 [17:16<13:37,  7.23s/it] 56%|█████▋    | 144/256 [17:24<13:30,  7.23s/it] 57%|█████▋    | 145/256 [17:31<13:23,  7.23s/it] 57%|█████▋    | 146/256 [17:38<13:15,  7.23s/it] 57%|█████▋    | 147/256 [17:45<13:08,  7.23s/it] 58%|█████▊    | 148/256 [17:52<13:01,  7.23s/it] 58%|█████▊    | 149/256 [18:00<12:54,  7.23s/it] 59%|█████▊    | 150/256 [18:07<12:46,  7.23s/it] 59%|█████▉    | 151/256 [18:14<12:39,  7.23s/it] 59%|█████▉    | 152/256 [18:21<12:32,  7.23s/it] 60%|█████▉    | 153/256 [18:29<12:25,  7.23s/it] 60%|██████    | 154/256 [18:36<12:17,  7.23s/it] 61%|██████    | 155/256 [18:43<12:10,  7.23s/it] 61%|██████    | 156/256 [18:50<12:03,  7.23s/it] 61%|██████▏   | 157/256 [18:58<11:55,  7.23s/it] 62%|██████▏   | 158/256 [19:05<11:48,  7.23s/it] 62%|██████▏   | 159/256 [19:12<11:41,  7.23s/it] 62%|██████▎   | 160/256 [19:19<11:34,  7.23s/it] 63%|██████▎   | 161/256 [19:27<11:35,  7.32s/it] 63%|██████▎   | 162/256 [19:34<11:25,  7.29s/it] 64%|██████▎   | 163/256 [19:41<11:16,  7.27s/it] 64%|██████▍   | 164/256 [19:48<11:08,  7.26s/it] 64%|██████▍   | 165/256 [19:56<11:00,  7.25s/it] 65%|██████▍   | 166/256 [20:03<10:52,  7.25s/it] 65%|██████▌   | 167/256 [20:10<10:44,  7.24s/it] 66%|██████▌   | 168/256 [20:17<10:37,  7.24s/it] 66%|██████▌   | 169/256 [20:25<10:29,  7.24s/it] 66%|██████▋   | 170/256 [20:32<10:22,  7.24s/it] 67%|██████▋   | 171/256 [20:39<10:14,  7.23s/it] 67%|██████▋   | 172/256 [20:46<10:07,  7.24s/it] 68%|██████▊   | 173/256 [20:54<10:00,  7.24s/it] 68%|██████▊   | 174/256 [21:01<09:53,  7.24s/it] 68%|██████▊   | 175/256 [21:08<09:45,  7.23s/it] 69%|██████▉   | 176/256 [21:15<09:38,  7.23s/it] 69%|██████▉   | 177/256 [21:23<09:31,  7.23s/it] 70%|██████▉   | 178/256 [21:30<09:24,  7.24s/it] 70%|██████▉   | 179/256 [21:37<09:17,  7.24s/it] 70%|███████   | 180/256 [21:44<09:09,  7.24s/it] 71%|███████   | 181/256 [21:51<09:02,  7.23s/it] 71%|███████   | 182/256 [21:59<08:55,  7.23s/it] 71%|███████▏  | 183/256 [22:06<08:48,  7.23s/it] 72%|███████▏  | 184/256 [22:13<08:40,  7.24s/it] 72%|███████▏  | 185/256 [22:20<08:33,  7.24s/it] 73%|███████▎  | 186/256 [22:28<08:26,  7.24s/it] 73%|███████▎  | 187/256 [22:35<08:19,  7.24s/it] 73%|███████▎  | 188/256 [22:42<08:11,  7.23s/it] 74%|███████▍  | 189/256 [22:49<08:04,  7.23s/it] 74%|███████▍  | 190/256 [22:57<08:02,  7.31s/it] 75%|███████▍  | 191/256 [23:04<07:53,  7.28s/it] 75%|███████▌  | 192/256 [23:11<07:45,  7.27s/it] 75%|███████▌  | 193/256 [23:19<07:37,  7.26s/it] 76%|███████▌  | 194/256 [23:26<07:29,  7.25s/it] 76%|███████▌  | 195/256 [23:33<07:21,  7.24s/it] 77%|███████▋  | 196/256 [23:40<07:14,  7.24s/it] 77%|███████▋  | 197/256 [23:47<07:07,  7.24s/it] 77%|███████▋  | 198/256 [23:55<06:59,  7.24s/it] 78%|███████▊  | 199/256 [24:02<06:52,  7.24s/it] 78%|███████▊  | 200/256 [24:09<06:45,  7.24s/it] 79%|███████▊  | 201/256 [24:16<06:37,  7.23s/it] 79%|███████▉  | 202/256 [24:24<06:30,  7.23s/it] 79%|███████▉  | 203/256 [24:31<06:23,  7.23s/it] 80%|███████▉  | 204/256 [24:38<06:16,  7.23s/it] 80%|████████  | 205/256 [24:45<06:08,  7.23s/it] 80%|████████  | 206/256 [24:53<06:01,  7.23s/it] 81%|████████  | 207/256 [25:00<05:54,  7.23s/it] 81%|████████▏ | 208/256 [25:07<05:47,  7.23s/it] 82%|████████▏ | 209/256 [25:14<05:39,  7.23s/it] 82%|████████▏ | 210/256 [25:21<05:32,  7.23s/it] 82%|████████▏ | 211/256 [25:29<05:25,  7.23s/it] 83%|████████▎ | 212/256 [25:36<05:18,  7.24s/it] 83%|████████▎ | 213/256 [25:43<05:11,  7.24s/it] 84%|████████▎ | 214/256 [25:50<05:04,  7.24s/it] 84%|████████▍ | 215/256 [25:58<04:57,  7.24s/it] 84%|████████▍ | 216/256 [26:05<04:49,  7.25s/it] 85%|████████▍ | 217/256 [26:12<04:42,  7.25s/it] 85%|████████▌ | 218/256 [26:19<04:35,  7.25s/it] 86%|████████▌ | 219/256 [26:27<04:29,  7.29s/it] 86%|████████▌ | 220/256 [26:34<04:21,  7.27s/it] 86%|████████▋ | 221/256 [26:41<04:14,  7.26s/it] 87%|████████▋ | 222/256 [26:49<04:06,  7.25s/it] 87%|████████▋ | 223/256 [26:56<03:59,  7.25s/it] 88%|████████▊ | 224/256 [27:03<03:51,  7.24s/it] 88%|████████▊ | 225/256 [27:10<03:44,  7.24s/it] 88%|████████▊ | 226/256 [27:17<03:37,  7.24s/it] 89%|████████▊ | 227/256 [27:25<03:29,  7.24s/it] 89%|████████▉ | 228/256 [27:32<03:22,  7.23s/it] 89%|████████▉ | 229/256 [27:39<03:15,  7.23s/it] 90%|████████▉ | 230/256 [27:46<03:08,  7.23s/it] 90%|█████████ | 231/256 [27:54<03:00,  7.23s/it] 91%|█████████ | 232/256 [28:01<02:53,  7.23s/it] 91%|█████████ | 233/256 [28:08<02:46,  7.23s/it] 91%|█████████▏| 234/256 [28:15<02:39,  7.23s/it] 92%|█████████▏| 235/256 [28:23<02:31,  7.23s/it] 92%|█████████▏| 236/256 [28:30<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:37<02:17,  7.23s/it] 93%|█████████▎| 238/256 [28:44<02:10,  7.23s/it] 93%|█████████▎| 239/256 [28:51<02:02,  7.23s/it] 94%|█████████▍| 240/256 [28:59<01:55,  7.23s/it] 94%|█████████▍| 241/256 [29:06<01:48,  7.23s/it] 95%|█████████▍| 242/256 [29:13<01:41,  7.23s/it] 95%|█████████▍| 243/256 [29:20<01:33,  7.23s/it] 95%|█████████▌| 244/256 [29:28<01:26,  7.23s/it] 96%|█████████▌| 245/256 [29:35<01:19,  7.23s/it] 96%|█████████▌| 246/256 [29:42<01:12,  7.23s/it] 96%|█████████▋| 247/256 [29:49<01:05,  7.23s/it] 97%|█████████▋| 248/256 [29:57<00:58,  7.30s/it] 97%|█████████▋| 249/256 [30:04<00:51,  7.29s/it] 98%|█████████▊| 250/256 [30:11<00:43,  7.28s/it] 98%|█████████▊| 251/256 [30:19<00:36,  7.27s/it] 98%|█████████▊| 252/256 [30:26<00:29,  7.26s/it] 99%|█████████▉| 253/256 [30:33<00:21,  7.26s/it] 99%|█████████▉| 254/256 [30:40<00:14,  7.26s/it]100%|█████████▉| 255/256 [30:48<00:07,  7.26s/it]100%|██████████| 256/256 [30:55<00:00,  7.26s/it]100%|██████████| 256/256 [30:55<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [40.6, 47.37]
Multiscale SSIM on Highres [0.99, 0.996]
Range Invariant Multiscale SSIM on Highres [0.99, 0.996]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/stats_disentangle_2405_D18-M3-S0-L8_11.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/12
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode15
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/12


Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 399
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<34:32,  8.13s/it]  1%|          | 2/256 [00:15<32:09,  7.60s/it]  1%|          | 3/256 [00:22<31:18,  7.43s/it]  2%|▏         | 4/256 [00:29<30:52,  7.35s/it]  2%|▏         | 5/256 [00:37<30:34,  7.31s/it]  2%|▏         | 6/256 [00:44<30:20,  7.28s/it]  3%|▎         | 7/256 [00:51<30:09,  7.27s/it]  3%|▎         | 8/256 [00:58<29:59,  7.26s/it]  4%|▎         | 9/256 [01:05<29:51,  7.25s/it]  4%|▍         | 10/256 [01:13<29:42,  7.25s/it]  4%|▍         | 11/256 [01:20<29:35,  7.25s/it]  5%|▍         | 12/256 [01:27<29:27,  7.24s/it]  5%|▌         | 13/256 [01:34<29:20,  7.25s/it]  5%|▌         | 14/256 [01:42<29:13,  7.24s/it]  6%|▌         | 15/256 [01:49<29:05,  7.24s/it]  6%|▋         | 16/256 [01:56<28:58,  7.24s/it]  7%|▋         | 17/256 [02:03<28:50,  7.24s/it]  7%|▋         | 18/256 [02:11<28:43,  7.24s/it]  7%|▋         | 19/256 [02:18<28:36,  7.24s/it]  8%|▊         | 20/256 [02:25<28:29,  7.24s/it]  8%|▊         | 21/256 [02:32<28:22,  7.24s/it]  9%|▊         | 22/256 [02:40<28:14,  7.24s/it]  9%|▉         | 23/256 [02:47<28:07,  7.24s/it]  9%|▉         | 24/256 [02:54<28:00,  7.24s/it] 10%|▉         | 25/256 [03:01<27:52,  7.24s/it] 10%|█         | 26/256 [03:09<27:45,  7.24s/it] 11%|█         | 27/256 [03:16<27:38,  7.24s/it] 11%|█         | 28/256 [03:23<27:31,  7.24s/it] 11%|█▏        | 29/256 [03:30<27:23,  7.24s/it] 12%|█▏        | 30/256 [03:38<27:16,  7.24s/it] 12%|█▏        | 31/256 [03:45<27:09,  7.24s/it] 12%|█▎        | 32/256 [03:52<27:01,  7.24s/it] 13%|█▎        | 33/256 [03:59<26:54,  7.24s/it] 13%|█▎        | 34/256 [04:07<26:46,  7.24s/it] 14%|█▎        | 35/256 [04:14<26:39,  7.24s/it] 14%|█▍        | 36/256 [04:21<26:32,  7.24s/it] 14%|█▍        | 37/256 [04:28<26:25,  7.24s/it] 15%|█▍        | 38/256 [04:35<26:17,  7.24s/it] 15%|█▌        | 39/256 [04:43<26:10,  7.24s/it] 16%|█▌        | 40/256 [04:50<26:04,  7.24s/it] 16%|█▌        | 41/256 [04:57<25:56,  7.24s/it] 16%|█▋        | 42/256 [05:04<25:48,  7.24s/it] 17%|█▋        | 43/256 [05:12<25:41,  7.24s/it] 17%|█▋        | 44/256 [05:19<25:34,  7.24s/it] 18%|█▊        | 45/256 [05:26<25:27,  7.24s/it] 18%|█▊        | 46/256 [05:33<25:19,  7.24s/it] 18%|█▊        | 47/256 [05:41<25:12,  7.24s/it] 19%|█▉        | 48/256 [05:48<25:05,  7.24s/it] 19%|█▉        | 49/256 [05:55<24:57,  7.24s/it] 20%|█▉        | 50/256 [06:02<24:50,  7.24s/it] 20%|█▉        | 51/256 [06:10<24:43,  7.24s/it] 20%|██        | 52/256 [06:17<24:36,  7.24s/it] 21%|██        | 53/256 [06:24<24:28,  7.24s/it] 21%|██        | 54/256 [06:31<24:22,  7.24s/it] 21%|██▏       | 55/256 [06:38<24:14,  7.24s/it] 22%|██▏       | 56/256 [06:46<24:07,  7.24s/it] 22%|██▏       | 57/256 [06:53<24:00,  7.24s/it] 23%|██▎       | 58/256 [07:00<23:52,  7.24s/it] 23%|██▎       | 59/256 [07:07<23:45,  7.24s/it] 23%|██▎       | 60/256 [07:15<23:39,  7.24s/it] 24%|██▍       | 61/256 [07:22<23:31,  7.24s/it] 24%|██▍       | 62/256 [07:29<23:24,  7.24s/it] 25%|██▍       | 63/256 [07:36<23:17,  7.24s/it] 25%|██▌       | 64/256 [07:44<23:09,  7.24s/it] 25%|██▌       | 65/256 [07:51<23:01,  7.24s/it] 26%|██▌       | 66/256 [07:58<22:55,  7.24s/it] 26%|██▌       | 67/256 [08:05<22:47,  7.24s/it] 27%|██▋       | 68/256 [08:13<22:40,  7.24s/it] 27%|██▋       | 69/256 [08:20<22:40,  7.27s/it] 27%|██▋       | 70/256 [08:27<22:31,  7.26s/it] 28%|██▊       | 71/256 [08:34<22:23,  7.26s/it] 28%|██▊       | 72/256 [08:42<22:15,  7.26s/it] 29%|██▊       | 73/256 [08:49<22:07,  7.25s/it] 29%|██▉       | 74/256 [08:56<21:59,  7.25s/it] 29%|██▉       | 75/256 [09:03<21:52,  7.25s/it] 30%|██▉       | 76/256 [09:11<21:45,  7.25s/it] 30%|███       | 77/256 [09:18<21:37,  7.25s/it] 30%|███       | 78/256 [09:25<21:30,  7.25s/it] 31%|███       | 79/256 [09:32<21:23,  7.25s/it] 31%|███▏      | 80/256 [09:40<21:16,  7.25s/it] 32%|███▏      | 81/256 [09:47<21:08,  7.25s/it] 32%|███▏      | 82/256 [09:54<21:01,  7.25s/it] 32%|███▏      | 83/256 [10:01<20:53,  7.25s/it] 33%|███▎      | 84/256 [10:09<20:46,  7.25s/it] 33%|███▎      | 85/256 [10:16<20:39,  7.25s/it] 34%|███▎      | 86/256 [10:23<20:31,  7.25s/it] 34%|███▍      | 87/256 [10:30<20:24,  7.25s/it] 34%|███▍      | 88/256 [10:38<20:17,  7.25s/it] 35%|███▍      | 89/256 [10:45<20:10,  7.25s/it] 35%|███▌      | 90/256 [10:52<20:03,  7.25s/it] 36%|███▌      | 91/256 [10:59<19:56,  7.25s/it] 36%|███▌      | 92/256 [11:07<19:48,  7.25s/it] 36%|███▋      | 93/256 [11:14<19:41,  7.25s/it] 37%|███▋      | 94/256 [11:21<19:34,  7.25s/it] 37%|███▋      | 95/256 [11:28<19:27,  7.25s/it] 38%|███▊      | 96/256 [11:36<19:20,  7.25s/it] 38%|███▊      | 97/256 [11:43<19:12,  7.25s/it] 38%|███▊      | 98/256 [11:50<19:05,  7.25s/it] 39%|███▊      | 99/256 [11:57<18:58,  7.25s/it] 39%|███▉      | 100/256 [12:05<18:51,  7.25s/it] 39%|███▉      | 101/256 [12:12<18:43,  7.25s/it] 40%|███▉      | 102/256 [12:19<18:36,  7.25s/it] 40%|████      | 103/256 [12:26<18:28,  7.25s/it] 41%|████      | 104/256 [12:34<18:21,  7.25s/it] 41%|████      | 105/256 [12:41<18:14,  7.25s/it] 41%|████▏     | 106/256 [12:48<18:06,  7.25s/it] 42%|████▏     | 107/256 [12:55<17:59,  7.25s/it] 42%|████▏     | 108/256 [13:03<17:52,  7.25s/it] 43%|████▎     | 109/256 [13:10<17:45,  7.25s/it] 43%|████▎     | 110/256 [13:17<17:38,  7.25s/it] 43%|████▎     | 111/256 [13:24<17:30,  7.25s/it] 44%|████▍     | 112/256 [13:32<17:23,  7.25s/it] 44%|████▍     | 113/256 [13:39<17:16,  7.25s/it] 45%|████▍     | 114/256 [13:46<17:09,  7.25s/it] 45%|████▍     | 115/256 [13:53<17:02,  7.25s/it] 45%|████▌     | 116/256 [14:01<16:54,  7.25s/it] 46%|████▌     | 117/256 [14:08<16:47,  7.25s/it] 46%|████▌     | 118/256 [14:15<16:40,  7.25s/it] 46%|████▋     | 119/256 [14:22<16:32,  7.25s/it] 47%|████▋     | 120/256 [14:30<16:25,  7.25s/it] 47%|████▋     | 121/256 [14:37<16:18,  7.25s/it] 48%|████▊     | 122/256 [14:44<16:11,  7.25s/it] 48%|████▊     | 123/256 [14:51<16:04,  7.25s/it] 48%|████▊     | 124/256 [14:59<15:56,  7.25s/it] 49%|████▉     | 125/256 [15:06<15:49,  7.25s/it] 49%|████▉     | 126/256 [15:13<15:42,  7.25s/it] 50%|████▉     | 127/256 [15:20<15:35,  7.25s/it] 50%|█████     | 128/256 [15:28<15:27,  7.25s/it] 50%|█████     | 129/256 [15:35<15:20,  7.25s/it] 51%|█████     | 130/256 [15:42<15:13,  7.25s/it] 51%|█████     | 131/256 [15:50<15:24,  7.40s/it] 52%|█████▏    | 132/256 [15:57<15:11,  7.35s/it] 52%|█████▏    | 133/256 [16:04<14:59,  7.31s/it] 52%|█████▏    | 134/256 [16:12<14:49,  7.29s/it] 53%|█████▎    | 135/256 [16:19<14:40,  7.28s/it] 53%|█████▎    | 136/256 [16:26<14:31,  7.26s/it] 54%|█████▎    | 137/256 [16:33<14:23,  7.26s/it] 54%|█████▍    | 138/256 [16:41<14:15,  7.25s/it] 54%|█████▍    | 139/256 [16:48<14:07,  7.25s/it] 55%|█████▍    | 140/256 [16:55<14:00,  7.24s/it] 55%|█████▌    | 141/256 [17:02<13:52,  7.24s/it] 55%|█████▌    | 142/256 [17:09<13:45,  7.24s/it] 56%|█████▌    | 143/256 [17:17<13:38,  7.24s/it] 56%|█████▋    | 144/256 [17:24<13:30,  7.24s/it] 57%|█████▋    | 145/256 [17:31<13:23,  7.24s/it] 57%|█████▋    | 146/256 [17:38<13:16,  7.24s/it] 57%|█████▋    | 147/256 [17:46<13:08,  7.24s/it] 58%|█████▊    | 148/256 [17:53<13:01,  7.24s/it] 58%|█████▊    | 149/256 [18:00<12:54,  7.23s/it] 59%|█████▊    | 150/256 [18:07<12:46,  7.23s/it] 59%|█████▉    | 151/256 [18:15<12:39,  7.23s/it] 59%|█████▉    | 152/256 [18:22<12:32,  7.23s/it] 60%|█████▉    | 153/256 [18:29<12:25,  7.23s/it] 60%|██████    | 154/256 [18:36<12:17,  7.23s/it] 61%|██████    | 155/256 [18:44<12:10,  7.23s/it] 61%|██████    | 156/256 [18:51<12:03,  7.23s/it] 61%|██████▏   | 157/256 [18:58<11:56,  7.23s/it] 62%|██████▏   | 158/256 [19:05<11:48,  7.23s/it] 62%|██████▏   | 159/256 [19:12<11:41,  7.23s/it] 62%|██████▎   | 160/256 [19:20<11:37,  7.26s/it] 63%|██████▎   | 161/256 [19:27<11:28,  7.25s/it] 63%|██████▎   | 162/256 [19:34<11:21,  7.25s/it] 64%|██████▎   | 163/256 [19:41<11:13,  7.24s/it] 64%|██████▍   | 164/256 [19:49<11:05,  7.24s/it] 64%|██████▍   | 165/256 [19:56<10:58,  7.24s/it] 65%|██████▍   | 166/256 [20:03<10:51,  7.24s/it] 65%|██████▌   | 167/256 [20:10<10:44,  7.24s/it] 66%|██████▌   | 168/256 [20:18<10:36,  7.24s/it] 66%|██████▌   | 169/256 [20:25<10:29,  7.23s/it] 66%|██████▋   | 170/256 [20:32<10:22,  7.24s/it] 67%|██████▋   | 171/256 [20:39<10:15,  7.24s/it] 67%|██████▋   | 172/256 [20:47<10:07,  7.24s/it] 68%|██████▊   | 173/256 [20:54<10:00,  7.24s/it] 68%|██████▊   | 174/256 [21:01<09:53,  7.24s/it] 68%|██████▊   | 175/256 [21:08<09:46,  7.24s/it] 69%|██████▉   | 176/256 [21:16<09:38,  7.24s/it] 69%|██████▉   | 177/256 [21:23<09:31,  7.24s/it] 70%|██████▉   | 178/256 [21:30<09:24,  7.24s/it] 70%|██████▉   | 179/256 [21:37<09:17,  7.24s/it] 70%|███████   | 180/256 [21:45<09:09,  7.24s/it] 71%|███████   | 181/256 [21:52<09:02,  7.23s/it] 71%|███████   | 182/256 [21:59<08:55,  7.24s/it] 71%|███████▏  | 183/256 [22:06<08:48,  7.24s/it] 72%|███████▏  | 184/256 [22:13<08:40,  7.23s/it] 72%|███████▏  | 185/256 [22:21<08:33,  7.23s/it] 73%|███████▎  | 186/256 [22:28<08:26,  7.23s/it] 73%|███████▎  | 187/256 [22:35<08:19,  7.23s/it] 73%|███████▎  | 188/256 [22:42<08:11,  7.23s/it] 74%|███████▍  | 189/256 [22:50<08:10,  7.32s/it] 74%|███████▍  | 190/256 [22:57<08:01,  7.29s/it] 75%|███████▍  | 191/256 [23:04<07:53,  7.28s/it] 75%|███████▌  | 192/256 [23:12<07:45,  7.27s/it] 75%|███████▌  | 193/256 [23:19<07:37,  7.27s/it] 76%|███████▌  | 194/256 [23:26<07:30,  7.26s/it] 76%|███████▌  | 195/256 [23:33<07:22,  7.26s/it] 77%|███████▋  | 196/256 [23:41<07:15,  7.26s/it] 77%|███████▋  | 197/256 [23:48<07:08,  7.25s/it] 77%|███████▋  | 198/256 [23:55<07:00,  7.25s/it] 78%|███████▊  | 199/256 [24:02<06:53,  7.25s/it] 78%|███████▊  | 200/256 [24:10<06:46,  7.25s/it] 79%|███████▊  | 201/256 [24:17<06:38,  7.25s/it] 79%|███████▉  | 202/256 [24:24<06:31,  7.25s/it] 79%|███████▉  | 203/256 [24:31<06:24,  7.25s/it] 80%|███████▉  | 204/256 [24:39<06:17,  7.25s/it] 80%|████████  | 205/256 [24:46<06:09,  7.25s/it] 80%|████████  | 206/256 [24:53<06:02,  7.25s/it] 81%|████████  | 207/256 [25:00<05:55,  7.26s/it] 81%|████████▏ | 208/256 [25:08<05:48,  7.26s/it] 82%|████████▏ | 209/256 [25:15<05:41,  7.26s/it] 82%|████████▏ | 210/256 [25:22<05:33,  7.26s/it] 82%|████████▏ | 211/256 [25:29<05:26,  7.25s/it] 83%|████████▎ | 212/256 [25:37<05:19,  7.26s/it] 83%|████████▎ | 213/256 [25:44<05:12,  7.26s/it] 84%|████████▎ | 214/256 [25:51<05:04,  7.25s/it] 84%|████████▍ | 215/256 [25:58<04:57,  7.26s/it] 84%|████████▍ | 216/256 [26:06<04:50,  7.26s/it] 85%|████████▍ | 217/256 [26:13<04:42,  7.25s/it] 85%|████████▌ | 218/256 [26:20<04:35,  7.26s/it] 86%|████████▌ | 219/256 [26:27<04:28,  7.26s/it] 86%|████████▌ | 220/256 [26:35<04:21,  7.25s/it] 86%|████████▋ | 221/256 [26:42<04:13,  7.25s/it] 87%|████████▋ | 222/256 [26:49<04:07,  7.27s/it] 87%|████████▋ | 223/256 [26:57<04:00,  7.28s/it] 88%|████████▊ | 224/256 [27:04<03:52,  7.27s/it] 88%|████████▊ | 225/256 [27:11<03:45,  7.26s/it] 88%|████████▊ | 226/256 [27:18<03:37,  7.25s/it] 89%|████████▊ | 227/256 [27:26<03:30,  7.25s/it] 89%|████████▉ | 228/256 [27:33<03:22,  7.24s/it] 89%|████████▉ | 229/256 [27:40<03:15,  7.24s/it] 90%|████████▉ | 230/256 [27:47<03:08,  7.24s/it] 90%|█████████ | 231/256 [27:54<03:00,  7.24s/it] 91%|█████████ | 232/256 [28:02<02:53,  7.24s/it] 91%|█████████ | 233/256 [28:09<02:46,  7.24s/it] 91%|█████████▏| 234/256 [28:16<02:39,  7.24s/it] 92%|█████████▏| 235/256 [28:23<02:31,  7.24s/it] 92%|█████████▏| 236/256 [28:31<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:38<02:17,  7.23s/it] 93%|█████████▎| 238/256 [28:45<02:10,  7.23s/it] 93%|█████████▎| 239/256 [28:52<02:02,  7.24s/it] 94%|█████████▍| 240/256 [29:00<01:55,  7.23s/it] 94%|█████████▍| 241/256 [29:07<01:48,  7.23s/it] 95%|█████████▍| 242/256 [29:14<01:41,  7.23s/it] 95%|█████████▍| 243/256 [29:21<01:34,  7.23s/it] 95%|█████████▌| 244/256 [29:29<01:26,  7.23s/it] 96%|█████████▌| 245/256 [29:36<01:19,  7.24s/it] 96%|█████████▌| 246/256 [29:43<01:12,  7.24s/it] 96%|█████████▋| 247/256 [29:50<01:05,  7.24s/it] 97%|█████████▋| 248/256 [29:57<00:57,  7.23s/it] 97%|█████████▋| 249/256 [30:05<00:50,  7.23s/it] 98%|█████████▊| 250/256 [30:12<00:43,  7.23s/it] 98%|█████████▊| 251/256 [30:19<00:36,  7.24s/it] 98%|█████████▊| 252/256 [30:26<00:28,  7.24s/it] 99%|█████████▉| 253/256 [30:34<00:21,  7.24s/it] 99%|█████████▉| 254/256 [30:41<00:14,  7.24s/it]100%|█████████▉| 255/256 [30:48<00:07,  7.23s/it]100%|██████████| 256/256 [30:55<00:00,  7.23s/it]100%|██████████| 256/256 [30:56<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [37.47, 47.49]
Multiscale SSIM on Highres [0.969, 0.996]
Range Invariant Multiscale SSIM on Highres [0.97, 0.996]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/stats_disentangle_2405_D18-M3-S0-L8_12.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F11.43/kth_0/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif
data:
  background_quantile: 0.0
  channel_idx_list:
  - GT_Cy5
  - GT_TRITC
  - 555-647
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/6
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: caa1d41d654fb423a7c3abc700486f87d132a2f7
  untracked_files: []
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/6

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Train

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Test

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 93
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:20,  8.22s/it]  5%|▌         | 2/40 [00:15<04:51,  7.68s/it]  8%|▊         | 3/40 [00:22<04:36,  7.46s/it] 10%|█         | 4/40 [00:29<04:25,  7.37s/it] 12%|█▎        | 5/40 [00:37<04:15,  7.31s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.28s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.26s/it] 20%|██        | 8/40 [00:59<03:53,  7.31s/it] 22%|██▎       | 9/40 [01:06<03:45,  7.28s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.26s/it] 28%|██▊       | 11/40 [01:20<03:30,  7.25s/it] 30%|███       | 12/40 [01:27<03:22,  7.24s/it] 32%|███▎      | 13/40 [01:35<03:15,  7.25s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.24s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.23s/it] 40%|████      | 16/40 [01:56<02:53,  7.23s/it] 42%|████▎     | 17/40 [02:04<02:46,  7.23s/it] 45%|████▌     | 18/40 [02:11<02:38,  7.23s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:40<02:09,  7.22s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.23s/it] 60%|██████    | 24/40 [02:54<01:55,  7.24s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.25s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.25s/it] 68%|██████▊   | 27/40 [03:16<01:34,  7.26s/it] 70%|███████   | 28/40 [03:23<01:27,  7.26s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.26s/it] 75%|███████▌  | 30/40 [03:38<01:12,  7.25s/it] 78%|███████▊  | 31/40 [03:45<01:05,  7.24s/it] 80%|████████  | 32/40 [03:52<00:57,  7.23s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.23s/it] 85%|████████▌ | 34/40 [04:07<00:43,  7.22s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.22s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.24s/it] 92%|█████████▎| 37/40 [04:29<00:21,  7.31s/it] 95%|█████████▌| 38/40 [04:36<00:14,  7.30s/it] 98%|█████████▊| 39/40 [04:43<00:07,  7.29s/it]100%|██████████| 40/40 [04:44<00:00,  5.40s/it]100%|██████████| 40/40 [04:44<00:00,  7.12s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [43.14, 31.38]
Multiscale SSIM on Highres [0.988, 0.958]
Range Invariant Multiscale SSIM on Highres [0.988, 0.959]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/stats_disentangle_2404_D21-M3-S0-L8_6.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  - 9
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/120
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/120

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:12,  8.00s/it]  5%|▌         | 2/40 [00:15<04:47,  7.56s/it]  8%|▊         | 3/40 [00:22<04:34,  7.41s/it] 10%|█         | 4/40 [00:29<04:24,  7.34s/it] 12%|█▎        | 5/40 [00:36<04:15,  7.30s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.28s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.26s/it] 20%|██        | 8/40 [00:58<03:52,  7.25s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.25s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.24s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.24s/it] 30%|███       | 12/40 [01:27<03:22,  7.23s/it] 32%|███▎      | 13/40 [01:34<03:15,  7.24s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.24s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.23s/it] 40%|████      | 16/40 [01:56<02:53,  7.23s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.24s/it] 45%|████▌     | 18/40 [02:11<02:39,  7.25s/it] 48%|████▊     | 19/40 [02:18<02:32,  7.26s/it] 50%|█████     | 20/40 [02:25<02:25,  7.25s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.25s/it] 55%|█████▌    | 22/40 [02:39<02:10,  7.24s/it] 57%|█████▊    | 23/40 [02:47<02:03,  7.24s/it] 60%|██████    | 24/40 [02:54<01:55,  7.23s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.23s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.23s/it] 68%|██████▊   | 27/40 [03:16<01:33,  7.23s/it] 70%|███████   | 28/40 [03:23<01:26,  7.23s/it] 72%|███████▎  | 29/40 [03:30<01:20,  7.29s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.26s/it] 78%|███████▊  | 31/40 [03:45<01:05,  7.25s/it] 80%|████████  | 32/40 [03:52<00:57,  7.24s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.23s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.22s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.22s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.22s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.22s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.21s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.22s/it]100%|██████████| 40/40 [04:43<00:00,  5.30s/it]100%|██████████| 40/40 [04:43<00:00,  7.10s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.22, 33.75]
Multiscale SSIM on Highres [0.847, 0.951]
Range Invariant Multiscale SSIM on Highres [0.848, 0.951]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/stats_disentangle_2404_D25-M3-S0-L8_120.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  - 10
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/111
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/111

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 334
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:07<05:11,  7.99s/it]  5%|▌         | 2/40 [00:15<04:47,  7.55s/it]  8%|▊         | 3/40 [00:22<04:34,  7.42s/it] 10%|█         | 4/40 [00:29<04:24,  7.36s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.33s/it] 15%|█▌        | 6/40 [00:44<04:08,  7.29s/it] 18%|█▊        | 7/40 [00:51<04:00,  7.27s/it] 20%|██        | 8/40 [00:58<03:52,  7.26s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.25s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.25s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.24s/it] 30%|███       | 12/40 [01:27<03:22,  7.24s/it] 32%|███▎      | 13/40 [01:34<03:15,  7.23s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.23s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.23s/it] 40%|████      | 16/40 [01:56<02:53,  7.23s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.23s/it] 45%|████▌     | 18/40 [02:11<02:39,  7.23s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.23s/it] 50%|█████     | 20/40 [02:25<02:24,  7.23s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.23s/it] 55%|█████▌    | 22/40 [02:39<02:10,  7.23s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.23s/it] 60%|██████    | 24/40 [02:54<01:55,  7.23s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.23s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.23s/it] 68%|██████▊   | 27/40 [03:16<01:33,  7.23s/it] 70%|███████   | 28/40 [03:23<01:26,  7.23s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.23s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.23s/it] 78%|███████▊  | 31/40 [03:44<01:05,  7.23s/it] 80%|████████  | 32/40 [03:52<00:57,  7.23s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.23s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.23s/it] 88%|████████▊ | 35/40 [04:13<00:36,  7.23s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.23s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.23s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.23s/it]100%|██████████| 40/40 [04:43<00:00,  5.35s/it]100%|██████████| 40/40 [04:43<00:00,  7.10s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.24, 35.41]
Multiscale SSIM on Highres [0.849, 0.964]
Range Invariant Multiscale SSIM on Highres [0.849, 0.964]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/stats_disentangle_2404_D25-M3-S0-L8_111.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  - 11
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/125
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/125

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 279
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:07<05:10,  7.97s/it]  5%|▌         | 2/40 [00:15<04:46,  7.55s/it]  8%|▊         | 3/40 [00:22<04:34,  7.41s/it] 10%|█         | 4/40 [00:29<04:23,  7.33s/it] 12%|█▎        | 5/40 [00:36<04:15,  7.29s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.27s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.25s/it] 20%|██        | 8/40 [00:58<03:51,  7.24s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.24s/it] 25%|██▌       | 10/40 [01:12<03:36,  7.23s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.23s/it] 30%|███       | 12/40 [01:27<03:22,  7.22s/it] 32%|███▎      | 13/40 [01:34<03:14,  7.22s/it] 35%|███▌      | 14/40 [01:41<03:07,  7.22s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.22s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:03<02:45,  7.22s/it] 45%|████▌     | 18/40 [02:10<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:17<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:39<02:09,  7.22s/it] 57%|█████▊    | 23/40 [02:46<02:02,  7.21s/it] 60%|██████    | 24/40 [02:54<01:55,  7.22s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.22s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.22s/it] 68%|██████▊   | 27/40 [03:15<01:33,  7.21s/it] 70%|███████   | 28/40 [03:22<01:26,  7.21s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.21s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.21s/it] 78%|███████▊  | 31/40 [03:44<01:04,  7.21s/it] 80%|████████  | 32/40 [03:51<00:57,  7.21s/it] 82%|████████▎ | 33/40 [03:58<00:50,  7.21s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.21s/it] 88%|████████▊ | 35/40 [04:13<00:36,  7.21s/it] 90%|█████████ | 36/40 [04:20<00:28,  7.21s/it] 92%|█████████▎| 37/40 [04:27<00:21,  7.21s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.24s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.24s/it]100%|██████████| 40/40 [04:43<00:00,  5.32s/it]100%|██████████| 40/40 [04:43<00:00,  7.08s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [34.95, 33.69]
Multiscale SSIM on Highres [0.96, 0.95]
Range Invariant Multiscale SSIM on Highres [0.96, 0.951]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/stats_disentangle_2404_D25-M3-S0-L8_125.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  - 12
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/139
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/139

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 375
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:07<05:11,  7.99s/it]  5%|▌         | 2/40 [00:15<04:47,  7.56s/it]  8%|▊         | 3/40 [00:22<04:34,  7.41s/it] 10%|█         | 4/40 [00:29<04:24,  7.35s/it] 12%|█▎        | 5/40 [00:36<04:16,  7.32s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.28s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.26s/it] 20%|██        | 8/40 [00:58<03:52,  7.25s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.24s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.23s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.23s/it] 30%|███       | 12/40 [01:27<03:22,  7.23s/it] 32%|███▎      | 13/40 [01:34<03:15,  7.22s/it] 35%|███▌      | 14/40 [01:41<03:07,  7.23s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.22s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.22s/it] 45%|████▌     | 18/40 [02:10<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:39<02:09,  7.22s/it] 57%|█████▊    | 23/40 [02:46<02:02,  7.22s/it] 60%|██████    | 24/40 [02:54<01:55,  7.22s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.22s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.22s/it] 68%|██████▊   | 27/40 [03:15<01:33,  7.22s/it] 70%|███████   | 28/40 [03:23<01:26,  7.22s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.22s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.22s/it] 78%|███████▊  | 31/40 [03:44<01:04,  7.22s/it] 80%|████████  | 32/40 [03:51<00:57,  7.22s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.22s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.22s/it] 88%|████████▊ | 35/40 [04:13<00:36,  7.22s/it] 90%|█████████ | 36/40 [04:20<00:28,  7.22s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.22s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.23s/it]100%|██████████| 40/40 [04:43<00:00,  5.32s/it]100%|██████████| 40/40 [04:43<00:00,  7.09s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [35.01, 35.25]
Multiscale SSIM on Highres [0.961, 0.963]
Range Invariant Multiscale SSIM on Highres [0.961, 0.963]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/stats_disentangle_2404_D25-M3-S0-L8_139.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  - 13
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/143
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/143

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 223
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:07<05:11,  7.98s/it]  5%|▌         | 2/40 [00:15<04:47,  7.56s/it]  8%|▊         | 3/40 [00:22<04:34,  7.42s/it] 10%|█         | 4/40 [00:29<04:24,  7.36s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.33s/it] 15%|█▌        | 6/40 [00:44<04:08,  7.29s/it] 18%|█▊        | 7/40 [00:51<04:00,  7.27s/it] 20%|██        | 8/40 [00:58<03:52,  7.26s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.25s/it] 25%|██▌       | 10/40 [01:13<03:40,  7.34s/it] 28%|██▊       | 11/40 [01:20<03:31,  7.31s/it] 30%|███       | 12/40 [01:27<03:24,  7.29s/it] 32%|███▎      | 13/40 [01:35<03:16,  7.27s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.26s/it] 38%|███▊      | 15/40 [01:49<03:01,  7.25s/it] 40%|████      | 16/40 [01:56<02:53,  7.24s/it] 42%|████▎     | 17/40 [02:04<02:46,  7.24s/it] 45%|████▌     | 18/40 [02:11<02:39,  7.24s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.23s/it] 50%|█████     | 20/40 [02:25<02:24,  7.23s/it] 52%|█████▎    | 21/40 [02:33<02:17,  7.23s/it] 55%|█████▌    | 22/40 [02:40<02:10,  7.23s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.23s/it] 60%|██████    | 24/40 [02:54<01:55,  7.23s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.23s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.23s/it] 68%|██████▊   | 27/40 [03:16<01:34,  7.23s/it] 70%|███████   | 28/40 [03:23<01:26,  7.23s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.23s/it] 75%|███████▌  | 30/40 [03:38<01:12,  7.23s/it] 78%|███████▊  | 31/40 [03:45<01:05,  7.23s/it] 80%|████████  | 32/40 [03:52<00:57,  7.23s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.23s/it] 85%|████████▌ | 34/40 [04:07<00:43,  7.23s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.23s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.24s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.24s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:43<00:07,  7.25s/it]100%|██████████| 40/40 [04:44<00:00,  5.33s/it]100%|██████████| 40/40 [04:44<00:00,  7.11s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [33.75, 35.38]
Multiscale SSIM on Highres [0.951, 0.963]
Range Invariant Multiscale SSIM on Highres [0.951, 0.964]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/stats_disentangle_2404_D25-M3-S0-L8_143.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F11.43/kth_0/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif

##################################
Predicting 1th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:07<05:10,  7.97s/it]  5%|▌         | 2/40 [00:15<04:46,  7.55s/it]  8%|▊         | 3/40 [00:22<04:35,  7.46s/it] 10%|█         | 4/40 [00:29<04:25,  7.37s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.32s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.28s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.26s/it] 20%|██        | 8/40 [00:58<03:51,  7.24s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.23s/it] 25%|██▌       | 10/40 [01:13<03:36,  7.23s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.23s/it] 30%|███       | 12/40 [01:27<03:22,  7.23s/it] 32%|███▎      | 13/40 [01:34<03:15,  7.22s/it] 35%|███▌      | 14/40 [01:41<03:07,  7.22s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.23s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.23s/it] 45%|████▌     | 18/40 [02:10<02:39,  7.24s/it] 48%|████▊     | 19/40 [02:18<02:32,  7.25s/it] 50%|█████     | 20/40 [02:25<02:25,  7.25s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.26s/it] 55%|█████▌    | 22/40 [02:39<02:10,  7.26s/it] 57%|█████▊    | 23/40 [02:47<02:03,  7.26s/it] 60%|██████    | 24/40 [02:54<01:56,  7.26s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.26s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.26s/it] 68%|██████▊   | 27/40 [03:16<01:34,  7.26s/it] 70%|███████   | 28/40 [03:23<01:27,  7.26s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.26s/it] 75%|███████▌  | 30/40 [03:38<01:12,  7.26s/it] 78%|███████▊  | 31/40 [03:45<01:05,  7.25s/it] 80%|████████  | 32/40 [03:52<00:58,  7.32s/it] 82%|████████▎ | 33/40 [04:00<00:51,  7.30s/it] 85%|████████▌ | 34/40 [04:07<00:43,  7.29s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.28s/it] 90%|█████████ | 36/40 [04:21<00:29,  7.27s/it] 92%|█████████▎| 37/40 [04:29<00:21,  7.27s/it] 95%|█████████▌| 38/40 [04:36<00:14,  7.26s/it] 98%|█████████▊| 39/40 [04:43<00:07,  7.26s/it]100%|██████████| 40/40 [04:44<00:00,  5.37s/it]100%|██████████| 40/40 [04:44<00:00,  7.12s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_1/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [44.93, 35.07]
Multiscale SSIM on Highres [0.99, 0.977]
Range Invariant Multiscale SSIM on Highres [0.99, 0.978]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_1/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_1/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:08<02:00,  8.02s/it] 12%|█▎        | 2/16 [00:15<01:45,  7.56s/it] 19%|█▉        | 3/16 [00:22<01:36,  7.41s/it] 25%|██▌       | 4/16 [00:29<01:28,  7.35s/it] 31%|███▏      | 5/16 [00:36<01:20,  7.32s/it] 38%|███▊      | 6/16 [00:44<01:12,  7.30s/it] 44%|████▍     | 7/16 [00:51<01:05,  7.28s/it] 50%|█████     | 8/16 [00:58<00:58,  7.27s/it] 56%|█████▋    | 9/16 [01:05<00:50,  7.26s/it] 62%|██████▎   | 10/16 [01:13<00:43,  7.25s/it] 69%|██████▉   | 11/16 [01:20<00:36,  7.25s/it] 75%|███████▌  | 12/16 [01:27<00:29,  7.25s/it] 81%|████████▏ | 13/16 [01:34<00:21,  7.26s/it] 88%|████████▊ | 14/16 [01:42<00:14,  7.26s/it] 94%|█████████▍| 15/16 [01:49<00:07,  7.26s/it]100%|██████████| 16/16 [01:56<00:00,  7.26s/it]100%|██████████| 16/16 [01:56<00:00,  7.31s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [33.32, 33.52]
Multiscale SSIM on Highres [0.844, 0.837]
Range Invariant Multiscale SSIM on Highres [0.927, 0.875]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:08<04:56,  8.02s/it]  5%|▌         | 2/38 [00:15<04:32,  7.57s/it]  8%|▊         | 3/38 [00:22<04:19,  7.42s/it] 11%|█         | 4/38 [00:29<04:10,  7.36s/it] 13%|█▎        | 5/38 [00:37<04:01,  7.32s/it] 16%|█▌        | 6/38 [00:44<03:53,  7.30s/it] 18%|█▊        | 7/38 [00:51<03:45,  7.29s/it] 21%|██        | 8/38 [00:58<03:37,  7.27s/it] 24%|██▎       | 9/38 [01:05<03:30,  7.25s/it] 26%|██▋       | 10/38 [01:13<03:22,  7.24s/it] 29%|██▉       | 11/38 [01:20<03:15,  7.23s/it] 32%|███▏      | 12/38 [01:27<03:07,  7.23s/it] 34%|███▍      | 13/38 [01:34<03:00,  7.22s/it] 37%|███▋      | 14/38 [01:42<02:53,  7.22s/it] 39%|███▉      | 15/38 [01:49<02:45,  7.22s/it] 42%|████▏     | 16/38 [01:56<02:38,  7.22s/it] 45%|████▍     | 17/38 [02:03<02:31,  7.21s/it] 47%|████▋     | 18/38 [02:10<02:24,  7.21s/it] 50%|█████     | 19/38 [02:18<02:17,  7.21s/it] 53%|█████▎    | 20/38 [02:25<02:09,  7.21s/it] 55%|█████▌    | 21/38 [02:32<02:02,  7.21s/it] 58%|█████▊    | 22/38 [02:39<01:55,  7.21s/it] 61%|██████    | 23/38 [02:46<01:48,  7.21s/it] 63%|██████▎   | 24/38 [02:54<01:40,  7.21s/it] 66%|██████▌   | 25/38 [03:01<01:33,  7.21s/it] 68%|██████▊   | 26/38 [03:08<01:26,  7.21s/it] 71%|███████   | 27/38 [03:15<01:19,  7.21s/it] 74%|███████▎  | 28/38 [03:23<01:12,  7.21s/it] 76%|███████▋  | 29/38 [03:30<01:04,  7.21s/it] 79%|███████▉  | 30/38 [03:37<00:57,  7.21s/it] 82%|████████▏ | 31/38 [03:44<00:50,  7.22s/it] 84%|████████▍ | 32/38 [03:51<00:43,  7.22s/it] 87%|████████▋ | 33/38 [03:59<00:36,  7.22s/it] 89%|████████▉ | 34/38 [04:06<00:28,  7.22s/it] 92%|█████████▏| 35/38 [04:13<00:21,  7.22s/it] 95%|█████████▍| 36/38 [04:20<00:14,  7.22s/it] 97%|█████████▋| 37/38 [04:27<00:07,  7.22s/it]100%|██████████| 38/38 [04:31<00:00,  6.25s/it]100%|██████████| 38/38 [04:32<00:00,  7.16s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F12.57/kth_1/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [28.82, 25.44]
Multiscale SSIM on Highres [0.764, 0.808]
Range Invariant Multiscale SSIM on Highres [0.908, 0.812]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F12.57/kth_1/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F12.57/kth_1/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:13,  8.05s/it]  5%|▌         | 2/40 [00:15<04:47,  7.58s/it]  8%|▊         | 3/40 [00:22<04:34,  7.43s/it] 10%|█         | 4/40 [00:29<04:25,  7.38s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.34s/it] 15%|█▌        | 6/40 [00:44<04:08,  7.29s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.27s/it] 20%|██        | 8/40 [00:58<03:52,  7.25s/it] 22%|██▎       | 9/40 [01:05<03:44,  7.24s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.23s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.23s/it] 30%|███       | 12/40 [01:27<03:22,  7.22s/it] 32%|███▎      | 13/40 [01:34<03:15,  7.22s/it] 35%|███▌      | 14/40 [01:42<03:07,  7.22s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.22s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.22s/it] 45%|████▌     | 18/40 [02:10<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.21s/it] 50%|█████     | 20/40 [02:25<02:24,  7.21s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.21s/it] 55%|█████▌    | 22/40 [02:39<02:09,  7.22s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.22s/it] 60%|██████    | 24/40 [02:54<01:55,  7.22s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.22s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.22s/it] 68%|██████▊   | 27/40 [03:15<01:33,  7.22s/it] 70%|███████   | 28/40 [03:23<01:26,  7.22s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.22s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.22s/it] 78%|███████▊  | 31/40 [03:44<01:04,  7.22s/it] 80%|████████  | 32/40 [03:51<00:57,  7.22s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.22s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.21s/it] 88%|████████▊ | 35/40 [04:13<00:36,  7.21s/it] 90%|█████████ | 36/40 [04:20<00:28,  7.21s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.21s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.24s/it]100%|██████████| 40/40 [04:43<00:00,  5.31s/it]100%|██████████| 40/40 [04:43<00:00,  7.09s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [25.82, 28.53]
Multiscale SSIM on Highres [0.747, 0.869]
Range Invariant Multiscale SSIM on Highres [0.758, 0.88]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<34:25,  8.10s/it]  1%|          | 2/256 [00:15<32:09,  7.60s/it]  1%|          | 3/256 [00:22<31:21,  7.44s/it]  2%|▏         | 4/256 [00:29<30:55,  7.36s/it]  2%|▏         | 5/256 [00:37<30:38,  7.32s/it]  2%|▏         | 6/256 [00:44<30:25,  7.30s/it]  3%|▎         | 7/256 [00:51<30:14,  7.29s/it]  3%|▎         | 8/256 [00:58<30:04,  7.28s/it]  4%|▎         | 9/256 [01:06<29:55,  7.27s/it]  4%|▍         | 10/256 [01:13<29:47,  7.27s/it]  4%|▍         | 11/256 [01:20<29:39,  7.26s/it]  5%|▍         | 12/256 [01:27<29:31,  7.26s/it]  5%|▌         | 13/256 [01:35<29:23,  7.26s/it]  5%|▌         | 14/256 [01:42<29:17,  7.26s/it]  6%|▌         | 15/256 [01:49<29:09,  7.26s/it]  6%|▋         | 16/256 [01:56<29:02,  7.26s/it]  7%|▋         | 17/256 [02:04<28:55,  7.26s/it]  7%|▋         | 18/256 [02:11<28:47,  7.26s/it]  7%|▋         | 19/256 [02:18<28:40,  7.26s/it]  8%|▊         | 20/256 [02:25<28:32,  7.26s/it]  8%|▊         | 21/256 [02:33<28:25,  7.26s/it]  9%|▊         | 22/256 [02:40<28:18,  7.26s/it]  9%|▉         | 23/256 [02:47<28:10,  7.26s/it]  9%|▉         | 24/256 [02:54<28:03,  7.26s/it] 10%|▉         | 25/256 [03:02<27:55,  7.25s/it] 10%|█         | 26/256 [03:09<27:48,  7.25s/it] 11%|█         | 27/256 [03:16<27:41,  7.25s/it] 11%|█         | 28/256 [03:23<27:33,  7.25s/it] 11%|█▏        | 29/256 [03:31<27:26,  7.25s/it] 12%|█▏        | 30/256 [03:38<27:19,  7.26s/it] 12%|█▏        | 31/256 [03:46<27:44,  7.40s/it] 12%|█▎        | 32/256 [03:53<27:26,  7.35s/it] 13%|█▎        | 33/256 [04:00<27:11,  7.31s/it] 13%|█▎        | 34/256 [04:07<26:59,  7.29s/it] 14%|█▎        | 35/256 [04:15<26:48,  7.28s/it] 14%|█▍        | 36/256 [04:22<26:38,  7.26s/it] 14%|█▍        | 37/256 [04:29<26:28,  7.26s/it] 15%|█▍        | 38/256 [04:36<26:20,  7.25s/it] 15%|█▌        | 39/256 [04:44<26:12,  7.25s/it] 16%|█▌        | 40/256 [04:51<26:05,  7.25s/it] 16%|█▌        | 41/256 [04:58<25:57,  7.25s/it] 16%|█▋        | 42/256 [05:05<25:50,  7.24s/it] 17%|█▋        | 43/256 [05:13<25:42,  7.24s/it] 17%|█▋        | 44/256 [05:20<25:35,  7.24s/it] 18%|█▊        | 45/256 [05:27<25:28,  7.24s/it] 18%|█▊        | 46/256 [05:34<25:20,  7.24s/it] 18%|█▊        | 47/256 [05:42<25:13,  7.24s/it] 19%|█▉        | 48/256 [05:49<25:06,  7.24s/it] 19%|█▉        | 49/256 [05:56<24:59,  7.24s/it] 20%|█▉        | 50/256 [06:03<24:51,  7.24s/it] 20%|█▉        | 51/256 [06:11<24:44,  7.24s/it] 20%|██        | 52/256 [06:18<24:37,  7.24s/it] 21%|██        | 53/256 [06:25<24:29,  7.24s/it] 21%|██        | 54/256 [06:32<24:22,  7.24s/it] 21%|██▏       | 55/256 [06:39<24:15,  7.24s/it] 22%|██▏       | 56/256 [06:47<24:07,  7.24s/it] 22%|██▏       | 57/256 [06:54<24:00,  7.24s/it] 23%|██▎       | 58/256 [07:01<23:52,  7.24s/it] 23%|██▎       | 59/256 [07:08<23:45,  7.24s/it] 23%|██▎       | 60/256 [07:16<23:45,  7.27s/it] 24%|██▍       | 61/256 [07:23<23:35,  7.26s/it] 24%|██▍       | 62/256 [07:30<23:27,  7.25s/it] 25%|██▍       | 63/256 [07:37<23:18,  7.25s/it] 25%|██▌       | 64/256 [07:45<23:11,  7.25s/it] 25%|██▌       | 65/256 [07:52<23:03,  7.24s/it] 26%|██▌       | 66/256 [07:59<22:55,  7.24s/it] 26%|██▌       | 67/256 [08:06<22:48,  7.24s/it] 27%|██▋       | 68/256 [08:14<22:41,  7.24s/it] 27%|██▋       | 69/256 [08:21<22:33,  7.24s/it] 27%|██▋       | 70/256 [08:28<22:26,  7.24s/it] 28%|██▊       | 71/256 [08:35<22:19,  7.24s/it] 28%|██▊       | 72/256 [08:43<22:11,  7.24s/it] 29%|██▊       | 73/256 [08:50<22:04,  7.24s/it] 29%|██▉       | 74/256 [08:57<21:57,  7.24s/it] 29%|██▉       | 75/256 [09:04<21:50,  7.24s/it] 30%|██▉       | 76/256 [09:12<21:42,  7.24s/it] 30%|███       | 77/256 [09:19<21:35,  7.24s/it] 30%|███       | 78/256 [09:26<21:28,  7.24s/it] 31%|███       | 79/256 [09:33<21:21,  7.24s/it] 31%|███▏      | 80/256 [09:41<21:14,  7.24s/it] 32%|███▏      | 81/256 [09:48<21:06,  7.24s/it] 32%|███▏      | 82/256 [09:55<20:59,  7.24s/it] 32%|███▏      | 83/256 [10:02<20:52,  7.24s/it] 33%|███▎      | 84/256 [10:10<20:45,  7.24s/it] 33%|███▎      | 85/256 [10:17<20:37,  7.24s/it] 34%|███▎      | 86/256 [10:24<20:30,  7.24s/it] 34%|███▍      | 87/256 [10:31<20:23,  7.24s/it] 34%|███▍      | 88/256 [10:38<20:15,  7.24s/it] 35%|███▍      | 89/256 [10:46<20:13,  7.27s/it] 35%|███▌      | 90/256 [10:53<20:04,  7.26s/it] 36%|███▌      | 91/256 [11:00<19:56,  7.25s/it] 36%|███▌      | 92/256 [11:07<19:48,  7.25s/it] 36%|███▋      | 93/256 [11:15<19:40,  7.24s/it] 37%|███▋      | 94/256 [11:22<19:33,  7.24s/it] 37%|███▋      | 95/256 [11:29<19:25,  7.24s/it] 38%|███▊      | 96/256 [11:36<19:18,  7.24s/it] 38%|███▊      | 97/256 [11:44<19:10,  7.24s/it] 38%|███▊      | 98/256 [11:51<19:04,  7.24s/it] 39%|███▊      | 99/256 [11:58<18:56,  7.24s/it] 39%|███▉      | 100/256 [12:05<18:49,  7.24s/it] 39%|███▉      | 101/256 [12:13<18:41,  7.24s/it] 40%|███▉      | 102/256 [12:20<18:34,  7.24s/it] 40%|████      | 103/256 [12:27<18:27,  7.24s/it] 41%|████      | 104/256 [12:34<18:19,  7.24s/it] 41%|████      | 105/256 [12:42<18:12,  7.24s/it] 41%|████▏     | 106/256 [12:49<18:05,  7.24s/it] 42%|████▏     | 107/256 [12:56<17:58,  7.24s/it] 42%|████▏     | 108/256 [13:03<17:51,  7.24s/it] 43%|████▎     | 109/256 [13:11<17:43,  7.24s/it] 43%|████▎     | 110/256 [13:18<17:37,  7.24s/it] 43%|████▎     | 111/256 [13:25<17:29,  7.24s/it] 44%|████▍     | 112/256 [13:32<17:22,  7.24s/it] 44%|████▍     | 113/256 [13:39<17:14,  7.24s/it] 45%|████▍     | 114/256 [13:47<17:07,  7.24s/it] 45%|████▍     | 115/256 [13:54<17:00,  7.24s/it] 45%|████▌     | 116/256 [14:01<16:53,  7.24s/it] 46%|████▌     | 117/256 [14:08<16:46,  7.24s/it] 46%|████▌     | 118/256 [14:16<16:44,  7.28s/it] 46%|████▋     | 119/256 [14:23<16:35,  7.27s/it] 47%|████▋     | 120/256 [14:30<16:27,  7.26s/it] 47%|████▋     | 121/256 [14:38<16:19,  7.25s/it] 48%|████▊     | 122/256 [14:45<16:11,  7.25s/it] 48%|████▊     | 123/256 [14:52<16:03,  7.24s/it] 48%|████▊     | 124/256 [14:59<15:55,  7.24s/it] 49%|████▉     | 125/256 [15:06<15:48,  7.24s/it] 49%|████▉     | 126/256 [15:14<15:41,  7.24s/it] 50%|████▉     | 127/256 [15:21<15:33,  7.24s/it] 50%|█████     | 128/256 [15:28<15:26,  7.24s/it] 50%|█████     | 129/256 [15:35<15:19,  7.24s/it] 51%|█████     | 130/256 [15:43<15:12,  7.24s/it] 51%|█████     | 131/256 [15:50<15:06,  7.25s/it] 52%|█████▏    | 132/256 [15:57<14:58,  7.25s/it] 52%|█████▏    | 133/256 [16:04<14:51,  7.25s/it] 52%|█████▏    | 134/256 [16:12<14:44,  7.25s/it] 53%|█████▎    | 135/256 [16:19<14:37,  7.25s/it] 53%|█████▎    | 136/256 [16:26<14:30,  7.25s/it] 54%|█████▎    | 137/256 [16:33<14:23,  7.26s/it] 54%|█████▍    | 138/256 [16:41<14:16,  7.26s/it] 54%|█████▍    | 139/256 [16:48<14:08,  7.25s/it] 55%|█████▍    | 140/256 [16:55<14:01,  7.25s/it] 55%|█████▌    | 141/256 [17:02<13:54,  7.25s/it] 55%|█████▌    | 142/256 [17:10<13:47,  7.25s/it] 56%|█████▌    | 143/256 [17:17<13:39,  7.25s/it] 56%|█████▋    | 144/256 [17:24<13:32,  7.26s/it] 57%|█████▋    | 145/256 [17:31<13:25,  7.25s/it] 57%|█████▋    | 146/256 [17:39<13:17,  7.25s/it] 57%|█████▋    | 147/256 [17:46<13:10,  7.25s/it] 58%|█████▊    | 148/256 [17:53<13:03,  7.25s/it] 58%|█████▊    | 149/256 [18:00<12:55,  7.25s/it] 59%|█████▊    | 150/256 [18:08<12:48,  7.25s/it] 59%|█████▉    | 151/256 [18:15<12:41,  7.25s/it] 59%|█████▉    | 152/256 [18:22<12:34,  7.25s/it] 60%|█████▉    | 153/256 [18:29<12:26,  7.25s/it] 60%|██████    | 154/256 [18:37<12:19,  7.25s/it] 61%|██████    | 155/256 [18:44<12:12,  7.25s/it] 61%|██████    | 156/256 [18:51<12:05,  7.25s/it] 61%|██████▏   | 157/256 [18:58<11:57,  7.25s/it] 62%|██████▏   | 158/256 [19:06<11:50,  7.25s/it] 62%|██████▏   | 159/256 [19:13<11:43,  7.25s/it] 62%|██████▎   | 160/256 [19:20<11:36,  7.25s/it] 63%|██████▎   | 161/256 [19:28<11:28,  7.25s/it] 63%|██████▎   | 162/256 [19:35<11:21,  7.25s/it] 64%|██████▎   | 163/256 [19:42<11:14,  7.25s/it] 64%|██████▍   | 164/256 [19:49<11:07,  7.25s/it] 64%|██████▍   | 165/256 [19:56<10:59,  7.25s/it] 65%|██████▍   | 166/256 [20:04<10:52,  7.25s/it] 65%|██████▌   | 167/256 [20:11<10:45,  7.25s/it] 66%|██████▌   | 168/256 [20:18<10:38,  7.25s/it] 66%|██████▌   | 169/256 [20:26<10:30,  7.25s/it] 66%|██████▋   | 170/256 [20:33<10:23,  7.25s/it] 67%|██████▋   | 171/256 [20:40<10:16,  7.25s/it] 67%|██████▋   | 172/256 [20:47<10:08,  7.25s/it] 68%|██████▊   | 173/256 [20:55<10:01,  7.25s/it] 68%|██████▊   | 174/256 [21:02<09:54,  7.25s/it] 68%|██████▊   | 175/256 [21:09<09:47,  7.25s/it] 69%|██████▉   | 176/256 [21:16<09:40,  7.25s/it] 69%|██████▉   | 177/256 [21:24<09:32,  7.25s/it] 70%|██████▉   | 178/256 [21:31<09:25,  7.25s/it] 70%|██████▉   | 179/256 [21:38<09:18,  7.25s/it] 70%|███████   | 180/256 [21:46<09:22,  7.40s/it] 71%|███████   | 181/256 [21:53<09:11,  7.35s/it] 71%|███████   | 182/256 [22:00<09:01,  7.32s/it] 71%|███████▏  | 183/256 [22:07<08:52,  7.29s/it] 72%|███████▏  | 184/256 [22:15<08:43,  7.28s/it] 72%|███████▏  | 185/256 [22:22<08:35,  7.26s/it] 73%|███████▎  | 186/256 [22:29<08:27,  7.26s/it] 73%|███████▎  | 187/256 [22:36<08:20,  7.25s/it] 73%|███████▎  | 188/256 [22:44<08:12,  7.25s/it] 74%|███████▍  | 189/256 [22:51<08:05,  7.24s/it] 74%|███████▍  | 190/256 [22:58<07:57,  7.24s/it] 75%|███████▍  | 191/256 [23:05<07:50,  7.24s/it] 75%|███████▌  | 192/256 [23:13<07:43,  7.24s/it] 75%|███████▌  | 193/256 [23:20<07:36,  7.24s/it] 76%|███████▌  | 194/256 [23:27<07:28,  7.24s/it] 76%|███████▌  | 195/256 [23:34<07:21,  7.24s/it] 77%|███████▋  | 196/256 [23:42<07:14,  7.24s/it] 77%|███████▋  | 197/256 [23:49<07:06,  7.23s/it] 77%|███████▋  | 198/256 [23:56<06:59,  7.24s/it] 78%|███████▊  | 199/256 [24:03<06:52,  7.24s/it] 78%|███████▊  | 200/256 [24:10<06:45,  7.23s/it] 79%|███████▊  | 201/256 [24:18<06:37,  7.23s/it] 79%|███████▉  | 202/256 [24:25<06:30,  7.23s/it] 79%|███████▉  | 203/256 [24:32<06:23,  7.23s/it] 80%|███████▉  | 204/256 [24:39<06:16,  7.23s/it] 80%|████████  | 205/256 [24:47<06:08,  7.23s/it] 80%|████████  | 206/256 [24:54<06:01,  7.23s/it] 81%|████████  | 207/256 [25:01<05:54,  7.23s/it] 81%|████████▏ | 208/256 [25:08<05:47,  7.23s/it] 82%|████████▏ | 209/256 [25:16<05:41,  7.26s/it] 82%|████████▏ | 210/256 [25:23<05:33,  7.25s/it] 82%|████████▏ | 211/256 [25:30<05:25,  7.24s/it] 83%|████████▎ | 212/256 [25:37<05:18,  7.24s/it] 83%|████████▎ | 213/256 [25:45<05:11,  7.24s/it] 84%|████████▎ | 214/256 [25:52<05:03,  7.23s/it] 84%|████████▍ | 215/256 [25:59<04:56,  7.23s/it] 84%|████████▍ | 216/256 [26:06<04:49,  7.23s/it] 85%|████████▍ | 217/256 [26:14<04:41,  7.23s/it] 85%|████████▌ | 218/256 [26:21<04:34,  7.23s/it] 86%|████████▌ | 219/256 [26:28<04:27,  7.23s/it] 86%|████████▌ | 220/256 [26:35<04:20,  7.23s/it] 86%|████████▋ | 221/256 [26:42<04:13,  7.23s/it] 87%|████████▋ | 222/256 [26:50<04:05,  7.23s/it] 87%|████████▋ | 223/256 [26:57<03:58,  7.23s/it] 88%|████████▊ | 224/256 [27:04<03:51,  7.23s/it] 88%|████████▊ | 225/256 [27:11<03:44,  7.23s/it] 88%|████████▊ | 226/256 [27:19<03:36,  7.23s/it] 89%|████████▊ | 227/256 [27:26<03:29,  7.23s/it] 89%|████████▉ | 228/256 [27:33<03:22,  7.23s/it] 89%|████████▉ | 229/256 [27:40<03:15,  7.23s/it] 90%|████████▉ | 230/256 [27:48<03:08,  7.23s/it] 90%|█████████ | 231/256 [27:55<03:00,  7.24s/it] 91%|█████████ | 232/256 [28:02<02:53,  7.24s/it] 91%|█████████ | 233/256 [28:09<02:46,  7.23s/it] 91%|█████████▏| 234/256 [28:16<02:39,  7.23s/it] 92%|█████████▏| 235/256 [28:24<02:31,  7.24s/it] 92%|█████████▏| 236/256 [28:31<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:38<02:17,  7.23s/it] 93%|█████████▎| 238/256 [28:46<02:12,  7.34s/it] 93%|█████████▎| 239/256 [28:53<02:04,  7.31s/it] 94%|█████████▍| 240/256 [29:00<01:56,  7.28s/it] 94%|█████████▍| 241/256 [29:07<01:49,  7.27s/it] 95%|█████████▍| 242/256 [29:15<01:41,  7.26s/it] 95%|█████████▍| 243/256 [29:22<01:34,  7.25s/it] 95%|█████████▌| 244/256 [29:29<01:26,  7.24s/it] 96%|█████████▌| 245/256 [29:36<01:19,  7.24s/it] 96%|█████████▌| 246/256 [29:44<01:12,  7.24s/it] 96%|█████████▋| 247/256 [29:51<01:05,  7.24s/it] 97%|█████████▋| 248/256 [29:58<00:57,  7.23s/it] 97%|█████████▋| 249/256 [30:05<00:50,  7.23s/it] 98%|█████████▊| 250/256 [30:13<00:43,  7.23s/it] 98%|█████████▊| 251/256 [30:20<00:36,  7.23s/it] 98%|█████████▊| 252/256 [30:27<00:28,  7.23s/it] 99%|█████████▉| 253/256 [30:34<00:21,  7.23s/it] 99%|█████████▉| 254/256 [30:41<00:14,  7.23s/it]100%|█████████▉| 255/256 [30:49<00:07,  7.23s/it]100%|██████████| 256/256 [30:56<00:00,  7.23s/it]100%|██████████| 256/256 [30:56<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [42.75, 38.44]
Multiscale SSIM on Highres [0.992, 0.985]
Range Invariant Multiscale SSIM on Highres [0.992, 0.986]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<34:35,  8.14s/it]  1%|          | 2/256 [00:15<32:12,  7.61s/it]  1%|          | 3/256 [00:22<31:22,  7.44s/it]  2%|▏         | 4/256 [00:29<30:55,  7.36s/it]  2%|▏         | 5/256 [00:37<30:39,  7.33s/it]  2%|▏         | 6/256 [00:44<30:24,  7.30s/it]  3%|▎         | 7/256 [00:51<30:14,  7.29s/it]  3%|▎         | 8/256 [00:58<30:04,  7.28s/it]  4%|▎         | 9/256 [01:06<29:55,  7.27s/it]  4%|▍         | 10/256 [01:13<29:48,  7.27s/it]  4%|▍         | 11/256 [01:20<29:40,  7.27s/it]  5%|▍         | 12/256 [01:27<29:32,  7.26s/it]  5%|▌         | 13/256 [01:35<29:24,  7.26s/it]  5%|▌         | 14/256 [01:42<29:17,  7.26s/it]  6%|▌         | 15/256 [01:49<29:10,  7.26s/it]  6%|▋         | 16/256 [01:56<29:02,  7.26s/it]  7%|▋         | 17/256 [02:04<28:55,  7.26s/it]  7%|▋         | 18/256 [02:11<28:48,  7.26s/it]  7%|▋         | 19/256 [02:18<28:41,  7.26s/it]  8%|▊         | 20/256 [02:26<28:33,  7.26s/it]  8%|▊         | 21/256 [02:33<28:56,  7.39s/it]  9%|▊         | 22/256 [02:40<28:39,  7.35s/it]  9%|▉         | 23/256 [02:48<28:24,  7.32s/it]  9%|▉         | 24/256 [02:55<28:13,  7.30s/it] 10%|▉         | 25/256 [03:02<28:01,  7.28s/it] 10%|█         | 26/256 [03:09<27:51,  7.27s/it] 11%|█         | 27/256 [03:17<27:42,  7.26s/it] 11%|█         | 28/256 [03:24<27:33,  7.25s/it] 11%|█▏        | 29/256 [03:31<27:25,  7.25s/it] 12%|█▏        | 30/256 [03:38<27:17,  7.25s/it] 12%|█▏        | 31/256 [03:46<27:09,  7.24s/it] 12%|█▎        | 32/256 [03:53<27:02,  7.24s/it] 13%|█▎        | 33/256 [04:00<26:54,  7.24s/it] 13%|█▎        | 34/256 [04:07<26:46,  7.24s/it] 14%|█▎        | 35/256 [04:15<26:39,  7.24s/it] 14%|█▍        | 36/256 [04:22<26:32,  7.24s/it] 14%|█▍        | 37/256 [04:29<26:25,  7.24s/it] 15%|█▍        | 38/256 [04:36<26:17,  7.24s/it] 15%|█▌        | 39/256 [04:44<26:10,  7.24s/it] 16%|█▌        | 40/256 [04:51<26:04,  7.24s/it] 16%|█▌        | 41/256 [04:58<25:56,  7.24s/it] 16%|█▋        | 42/256 [05:05<25:49,  7.24s/it] 17%|█▋        | 43/256 [05:12<25:42,  7.24s/it] 17%|█▋        | 44/256 [05:20<25:34,  7.24s/it] 18%|█▊        | 45/256 [05:27<25:27,  7.24s/it] 18%|█▊        | 46/256 [05:34<25:20,  7.24s/it] 18%|█▊        | 47/256 [05:41<25:13,  7.24s/it] 19%|█▉        | 48/256 [05:49<25:05,  7.24s/it] 19%|█▉        | 49/256 [05:56<24:58,  7.24s/it] 20%|█▉        | 50/256 [06:03<24:55,  7.26s/it] 20%|█▉        | 51/256 [06:10<24:46,  7.25s/it] 20%|██        | 52/256 [06:18<24:38,  7.25s/it] 21%|██        | 53/256 [06:25<24:30,  7.25s/it] 21%|██        | 54/256 [06:32<24:23,  7.24s/it] 21%|██▏       | 55/256 [06:39<24:15,  7.24s/it] 22%|██▏       | 56/256 [06:47<24:08,  7.24s/it] 22%|██▏       | 57/256 [06:54<24:00,  7.24s/it] 23%|██▎       | 58/256 [07:01<23:53,  7.24s/it] 23%|██▎       | 59/256 [07:08<23:46,  7.24s/it] 23%|██▎       | 60/256 [07:16<23:38,  7.24s/it] 24%|██▍       | 61/256 [07:23<23:31,  7.24s/it] 24%|██▍       | 62/256 [07:30<23:24,  7.24s/it] 25%|██▍       | 63/256 [07:37<23:17,  7.24s/it] 25%|██▌       | 64/256 [07:45<23:09,  7.24s/it] 25%|██▌       | 65/256 [07:52<23:02,  7.24s/it] 26%|██▌       | 66/256 [07:59<22:54,  7.24s/it] 26%|██▌       | 67/256 [08:06<22:47,  7.24s/it] 27%|██▋       | 68/256 [08:14<22:40,  7.24s/it] 27%|██▋       | 69/256 [08:21<22:33,  7.24s/it] 27%|██▋       | 70/256 [08:28<22:26,  7.24s/it] 28%|██▊       | 71/256 [08:35<22:19,  7.24s/it] 28%|██▊       | 72/256 [08:42<22:11,  7.24s/it] 29%|██▊       | 73/256 [08:50<22:03,  7.23s/it] 29%|██▉       | 74/256 [08:57<21:56,  7.23s/it] 29%|██▉       | 75/256 [09:04<21:49,  7.24s/it] 30%|██▉       | 76/256 [09:11<21:42,  7.24s/it] 30%|███       | 77/256 [09:19<21:34,  7.23s/it] 30%|███       | 78/256 [09:26<21:27,  7.23s/it] 31%|███       | 79/256 [09:33<21:27,  7.27s/it] 31%|███▏      | 80/256 [09:40<21:18,  7.26s/it] 32%|███▏      | 81/256 [09:48<21:09,  7.25s/it] 32%|███▏      | 82/256 [09:55<21:01,  7.25s/it] 32%|███▏      | 83/256 [10:02<20:52,  7.24s/it] 33%|███▎      | 84/256 [10:09<20:45,  7.24s/it] 33%|███▎      | 85/256 [10:17<20:37,  7.24s/it] 34%|███▎      | 86/256 [10:24<20:29,  7.24s/it] 34%|███▍      | 87/256 [10:31<20:22,  7.23s/it] 34%|███▍      | 88/256 [10:38<20:15,  7.24s/it] 35%|███▍      | 89/256 [10:46<20:08,  7.23s/it] 35%|███▌      | 90/256 [10:53<20:01,  7.24s/it] 36%|███▌      | 91/256 [11:00<19:54,  7.24s/it] 36%|███▌      | 92/256 [11:07<19:46,  7.24s/it] 36%|███▋      | 93/256 [11:15<19:39,  7.24s/it] 37%|███▋      | 94/256 [11:22<19:32,  7.24s/it] 37%|███▋      | 95/256 [11:29<19:24,  7.24s/it] 38%|███▊      | 96/256 [11:36<19:17,  7.24s/it] 38%|███▊      | 97/256 [11:43<19:10,  7.24s/it] 38%|███▊      | 98/256 [11:51<19:03,  7.24s/it] 39%|███▊      | 99/256 [11:58<18:56,  7.24s/it] 39%|███▉      | 100/256 [12:05<18:48,  7.24s/it] 39%|███▉      | 101/256 [12:12<18:41,  7.24s/it] 40%|███▉      | 102/256 [12:20<18:34,  7.24s/it] 40%|████      | 103/256 [12:27<18:27,  7.24s/it] 41%|████      | 104/256 [12:34<18:20,  7.24s/it] 41%|████      | 105/256 [12:41<18:12,  7.24s/it] 41%|████▏     | 106/256 [12:49<18:05,  7.24s/it] 42%|████▏     | 107/256 [12:56<17:58,  7.24s/it] 42%|████▏     | 108/256 [13:03<17:54,  7.26s/it] 43%|████▎     | 109/256 [13:10<17:46,  7.25s/it] 43%|████▎     | 110/256 [13:18<17:37,  7.25s/it] 43%|████▎     | 111/256 [13:25<17:30,  7.24s/it] 44%|████▍     | 112/256 [13:32<17:22,  7.24s/it] 44%|████▍     | 113/256 [13:39<17:15,  7.24s/it] 45%|████▍     | 114/256 [13:47<17:08,  7.24s/it] 45%|████▍     | 115/256 [13:54<17:00,  7.24s/it] 45%|████▌     | 116/256 [14:01<16:52,  7.23s/it] 46%|████▌     | 117/256 [14:08<16:45,  7.23s/it] 46%|████▌     | 118/256 [14:15<16:38,  7.23s/it] 46%|████▋     | 119/256 [14:23<16:31,  7.24s/it] 47%|████▋     | 120/256 [14:30<16:23,  7.23s/it] 47%|████▋     | 121/256 [14:37<16:16,  7.23s/it] 48%|████▊     | 122/256 [14:44<16:09,  7.23s/it] 48%|████▊     | 123/256 [14:52<16:02,  7.24s/it] 48%|████▊     | 124/256 [14:59<15:55,  7.24s/it] 49%|████▉     | 125/256 [15:06<15:47,  7.23s/it] 49%|████▉     | 126/256 [15:13<15:40,  7.24s/it] 50%|████▉     | 127/256 [15:21<15:33,  7.24s/it] 50%|█████     | 128/256 [15:28<15:26,  7.24s/it] 50%|█████     | 129/256 [15:35<15:19,  7.24s/it] 51%|█████     | 130/256 [15:42<15:11,  7.23s/it] 51%|█████     | 131/256 [15:50<15:04,  7.23s/it] 52%|█████▏    | 132/256 [15:57<14:57,  7.24s/it] 52%|█████▏    | 133/256 [16:04<14:49,  7.23s/it] 52%|█████▏    | 134/256 [16:11<14:42,  7.23s/it] 53%|█████▎    | 135/256 [16:18<14:35,  7.23s/it] 53%|█████▎    | 136/256 [16:26<14:28,  7.23s/it] 54%|█████▎    | 137/256 [16:33<14:23,  7.26s/it] 54%|█████▍    | 138/256 [16:40<14:15,  7.25s/it] 54%|█████▍    | 139/256 [16:47<14:08,  7.25s/it] 55%|█████▍    | 140/256 [16:55<14:00,  7.24s/it] 55%|█████▌    | 141/256 [17:02<13:52,  7.24s/it] 55%|█████▌    | 142/256 [17:09<13:45,  7.24s/it] 56%|█████▌    | 143/256 [17:16<13:38,  7.24s/it] 56%|█████▋    | 144/256 [17:24<13:31,  7.24s/it] 57%|█████▋    | 145/256 [17:31<13:23,  7.24s/it] 57%|█████▋    | 146/256 [17:38<13:15,  7.24s/it] 57%|█████▋    | 147/256 [17:45<13:08,  7.23s/it] 58%|█████▊    | 148/256 [17:53<13:01,  7.23s/it] 58%|█████▊    | 149/256 [18:00<12:53,  7.23s/it] 59%|█████▊    | 150/256 [18:07<12:46,  7.23s/it] 59%|█████▉    | 151/256 [18:14<12:39,  7.23s/it] 59%|█████▉    | 152/256 [18:22<12:32,  7.23s/it] 60%|█████▉    | 153/256 [18:29<12:24,  7.23s/it] 60%|██████    | 154/256 [18:36<12:17,  7.23s/it] 61%|██████    | 155/256 [18:43<12:10,  7.23s/it] 61%|██████    | 156/256 [18:50<12:03,  7.23s/it] 61%|██████▏   | 157/256 [18:58<11:56,  7.24s/it] 62%|██████▏   | 158/256 [19:05<11:49,  7.24s/it] 62%|██████▏   | 159/256 [19:12<11:41,  7.24s/it] 62%|██████▎   | 160/256 [19:19<11:34,  7.23s/it] 63%|██████▎   | 161/256 [19:27<11:26,  7.23s/it] 63%|██████▎   | 162/256 [19:34<11:19,  7.23s/it] 64%|██████▎   | 163/256 [19:41<11:12,  7.23s/it] 64%|██████▍   | 164/256 [19:48<11:05,  7.23s/it] 64%|██████▍   | 165/256 [19:56<10:58,  7.23s/it] 65%|██████▍   | 166/256 [20:03<11:00,  7.33s/it] 65%|██████▌   | 167/256 [20:10<10:50,  7.31s/it] 66%|██████▌   | 168/256 [20:18<10:40,  7.28s/it] 66%|██████▌   | 169/256 [20:25<10:32,  7.27s/it] 66%|██████▋   | 170/256 [20:32<10:23,  7.25s/it] 67%|██████▋   | 171/256 [20:39<10:15,  7.25s/it] 67%|██████▋   | 172/256 [20:47<10:08,  7.25s/it] 68%|██████▊   | 173/256 [20:54<10:00,  7.24s/it] 68%|██████▊   | 174/256 [21:01<09:53,  7.24s/it] 68%|██████▊   | 175/256 [21:08<09:46,  7.24s/it] 69%|██████▉   | 176/256 [21:15<09:38,  7.23s/it] 69%|██████▉   | 177/256 [21:23<09:31,  7.24s/it] 70%|██████▉   | 178/256 [21:30<09:24,  7.24s/it] 70%|██████▉   | 179/256 [21:37<09:17,  7.24s/it] 70%|███████   | 180/256 [21:44<09:09,  7.23s/it] 71%|███████   | 181/256 [21:52<09:02,  7.24s/it] 71%|███████   | 182/256 [21:59<08:55,  7.24s/it] 71%|███████▏  | 183/256 [22:06<08:48,  7.23s/it] 72%|███████▏  | 184/256 [22:13<08:40,  7.23s/it] 72%|███████▏  | 185/256 [22:21<08:33,  7.23s/it] 73%|███████▎  | 186/256 [22:28<08:26,  7.23s/it] 73%|███████▎  | 187/256 [22:35<08:19,  7.23s/it] 73%|███████▎  | 188/256 [22:42<08:11,  7.23s/it] 74%|███████▍  | 189/256 [22:49<08:04,  7.23s/it] 74%|███████▍  | 190/256 [22:57<07:57,  7.23s/it] 75%|███████▍  | 191/256 [23:04<07:50,  7.23s/it] 75%|███████▌  | 192/256 [23:11<07:42,  7.23s/it] 75%|███████▌  | 193/256 [23:18<07:35,  7.23s/it] 76%|███████▌  | 194/256 [23:26<07:28,  7.23s/it] 76%|███████▌  | 195/256 [23:33<07:23,  7.26s/it] 77%|███████▋  | 196/256 [23:40<07:15,  7.26s/it] 77%|███████▋  | 197/256 [23:47<07:07,  7.25s/it] 77%|███████▋  | 198/256 [23:55<07:00,  7.25s/it] 78%|███████▊  | 199/256 [24:02<06:52,  7.24s/it] 78%|███████▊  | 200/256 [24:09<06:45,  7.25s/it] 79%|███████▊  | 201/256 [24:16<06:38,  7.24s/it] 79%|███████▉  | 202/256 [24:24<06:31,  7.24s/it] 79%|███████▉  | 203/256 [24:31<06:23,  7.24s/it] 80%|███████▉  | 204/256 [24:38<06:16,  7.24s/it] 80%|████████  | 205/256 [24:45<06:09,  7.24s/it] 80%|████████  | 206/256 [24:53<06:01,  7.24s/it] 81%|████████  | 207/256 [25:00<05:54,  7.24s/it] 81%|████████▏ | 208/256 [25:07<05:47,  7.24s/it] 82%|████████▏ | 209/256 [25:14<05:40,  7.24s/it] 82%|████████▏ | 210/256 [25:22<05:32,  7.24s/it] 82%|████████▏ | 211/256 [25:29<05:25,  7.24s/it] 83%|████████▎ | 212/256 [25:36<05:18,  7.24s/it] 83%|████████▎ | 213/256 [25:43<05:11,  7.24s/it] 84%|████████▎ | 214/256 [25:51<05:03,  7.24s/it] 84%|████████▍ | 215/256 [25:58<04:56,  7.24s/it] 84%|████████▍ | 216/256 [26:05<04:49,  7.24s/it] 85%|████████▍ | 217/256 [26:12<04:42,  7.24s/it] 85%|████████▌ | 218/256 [26:19<04:35,  7.24s/it] 86%|████████▌ | 219/256 [26:27<04:27,  7.24s/it] 86%|████████▌ | 220/256 [26:34<04:20,  7.24s/it] 86%|████████▋ | 221/256 [26:41<04:13,  7.24s/it] 87%|████████▋ | 222/256 [26:48<04:06,  7.24s/it] 87%|████████▋ | 223/256 [26:56<03:59,  7.24s/it] 88%|████████▊ | 224/256 [27:03<03:54,  7.33s/it] 88%|████████▊ | 225/256 [27:10<03:46,  7.30s/it] 88%|████████▊ | 226/256 [27:18<03:38,  7.28s/it] 89%|████████▊ | 227/256 [27:25<03:30,  7.27s/it] 89%|████████▉ | 228/256 [27:32<03:23,  7.26s/it] 89%|████████▉ | 229/256 [27:39<03:15,  7.25s/it] 90%|████████▉ | 230/256 [27:47<03:08,  7.25s/it] 90%|█████████ | 231/256 [27:54<03:01,  7.25s/it] 91%|█████████ | 232/256 [28:01<02:53,  7.24s/it] 91%|█████████ | 233/256 [28:08<02:46,  7.24s/it] 91%|█████████▏| 234/256 [28:16<02:39,  7.24s/it] 92%|█████████▏| 235/256 [28:23<02:32,  7.24s/it] 92%|█████████▏| 236/256 [28:30<02:24,  7.24s/it] 93%|█████████▎| 237/256 [28:37<02:17,  7.24s/it] 93%|█████████▎| 238/256 [28:45<02:10,  7.23s/it] 93%|█████████▎| 239/256 [28:52<02:03,  7.24s/it] 94%|█████████▍| 240/256 [28:59<01:55,  7.24s/it] 94%|█████████▍| 241/256 [29:06<01:48,  7.23s/it] 95%|█████████▍| 242/256 [29:13<01:41,  7.24s/it] 95%|█████████▍| 243/256 [29:21<01:34,  7.23s/it] 95%|█████████▌| 244/256 [29:28<01:26,  7.23s/it] 96%|█████████▌| 245/256 [29:35<01:19,  7.23s/it] 96%|█████████▌| 246/256 [29:42<01:12,  7.23s/it] 96%|█████████▋| 247/256 [29:50<01:05,  7.23s/it] 97%|█████████▋| 248/256 [29:57<00:57,  7.23s/it] 97%|█████████▋| 249/256 [30:04<00:50,  7.23s/it] 98%|█████████▊| 250/256 [30:11<00:43,  7.24s/it] 98%|█████████▊| 251/256 [30:19<00:36,  7.24s/it] 98%|█████████▊| 252/256 [30:26<00:28,  7.23s/it] 99%|█████████▉| 253/256 [30:33<00:21,  7.27s/it] 99%|█████████▉| 254/256 [30:40<00:14,  7.27s/it]100%|█████████▉| 255/256 [30:48<00:07,  7.26s/it]100%|██████████| 256/256 [30:55<00:00,  7.26s/it]100%|██████████| 256/256 [30:55<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [57.14, 43.96]
Multiscale SSIM on Highres [0.999, 0.982]
Range Invariant Multiscale SSIM on Highres [1.0, 0.996]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/stats_disentangle_2405_D18-M3-S0-L8_14.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_14_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/15
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/15


Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [2, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 111
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<34:36,  8.14s/it]  1%|          | 2/256 [00:15<32:10,  7.60s/it]  1%|          | 3/256 [00:22<31:20,  7.43s/it]  2%|▏         | 4/256 [00:29<30:53,  7.36s/it]  2%|▏         | 5/256 [00:37<30:34,  7.31s/it]  2%|▏         | 6/256 [00:44<30:21,  7.29s/it]  3%|▎         | 7/256 [00:51<30:09,  7.27s/it]  3%|▎         | 8/256 [00:58<29:59,  7.26s/it]  4%|▎         | 9/256 [01:06<29:51,  7.25s/it]  4%|▍         | 10/256 [01:13<29:43,  7.25s/it]  4%|▍         | 11/256 [01:20<29:35,  7.25s/it]  5%|▍         | 12/256 [01:27<29:28,  7.25s/it]  5%|▌         | 13/256 [01:34<29:21,  7.25s/it]  5%|▌         | 14/256 [01:42<29:14,  7.25s/it]  6%|▌         | 15/256 [01:49<29:06,  7.25s/it]  6%|▋         | 16/256 [01:56<29:17,  7.32s/it]  7%|▋         | 17/256 [02:04<29:07,  7.31s/it]  7%|▋         | 18/256 [02:11<28:55,  7.29s/it]  7%|▋         | 19/256 [02:18<28:47,  7.29s/it]  8%|▊         | 20/256 [02:26<28:38,  7.28s/it]  8%|▊         | 21/256 [02:33<28:29,  7.27s/it]  9%|▊         | 22/256 [02:40<28:20,  7.27s/it]  9%|▉         | 23/256 [02:47<28:11,  7.26s/it]  9%|▉         | 24/256 [02:55<28:03,  7.26s/it] 10%|▉         | 25/256 [03:02<27:56,  7.26s/it] 10%|█         | 26/256 [03:09<27:49,  7.26s/it] 11%|█         | 27/256 [03:16<27:41,  7.26s/it] 11%|█         | 28/256 [03:24<27:33,  7.25s/it] 11%|█▏        | 29/256 [03:31<27:26,  7.25s/it] 12%|█▏        | 30/256 [03:38<27:19,  7.25s/it] 12%|█▏        | 31/256 [03:45<27:11,  7.25s/it] 12%|█▎        | 32/256 [03:53<27:03,  7.25s/it] 13%|█▎        | 33/256 [04:00<26:56,  7.25s/it] 13%|█▎        | 34/256 [04:07<26:49,  7.25s/it] 14%|█▎        | 35/256 [04:14<26:42,  7.25s/it] 14%|█▍        | 36/256 [04:22<26:34,  7.25s/it] 14%|█▍        | 37/256 [04:29<26:27,  7.25s/it] 15%|█▍        | 38/256 [04:36<26:21,  7.25s/it] 15%|█▌        | 39/256 [04:43<26:13,  7.25s/it] 16%|█▌        | 40/256 [04:51<26:05,  7.25s/it] 16%|█▌        | 41/256 [04:58<25:58,  7.25s/it] 16%|█▋        | 42/256 [05:05<25:51,  7.25s/it] 17%|█▋        | 43/256 [05:12<25:43,  7.25s/it] 17%|█▋        | 44/256 [05:20<25:36,  7.25s/it] 18%|█▊        | 45/256 [05:27<25:29,  7.25s/it] 18%|█▊        | 46/256 [05:34<25:22,  7.25s/it] 18%|█▊        | 47/256 [05:41<25:15,  7.25s/it] 19%|█▉        | 48/256 [05:49<25:07,  7.25s/it] 19%|█▉        | 49/256 [05:56<25:00,  7.25s/it] 20%|█▉        | 50/256 [06:03<24:53,  7.25s/it] 20%|█▉        | 51/256 [06:10<24:46,  7.25s/it] 20%|██        | 52/256 [06:18<24:38,  7.25s/it] 21%|██        | 53/256 [06:25<24:31,  7.25s/it] 21%|██        | 54/256 [06:32<24:25,  7.25s/it] 21%|██▏       | 55/256 [06:39<24:18,  7.26s/it] 22%|██▏       | 56/256 [06:47<24:11,  7.26s/it] 22%|██▏       | 57/256 [06:54<24:03,  7.25s/it] 23%|██▎       | 58/256 [07:01<23:56,  7.26s/it] 23%|██▎       | 59/256 [07:08<23:48,  7.25s/it] 23%|██▎       | 60/256 [07:16<23:41,  7.25s/it] 24%|██▍       | 61/256 [07:23<23:33,  7.25s/it] 24%|██▍       | 62/256 [07:30<23:27,  7.25s/it] 25%|██▍       | 63/256 [07:37<23:19,  7.25s/it] 25%|██▌       | 64/256 [07:45<23:12,  7.25s/it] 25%|██▌       | 65/256 [07:52<23:04,  7.25s/it] 26%|██▌       | 66/256 [07:59<22:57,  7.25s/it] 26%|██▌       | 67/256 [08:06<22:50,  7.25s/it] 27%|██▋       | 68/256 [08:14<22:42,  7.25s/it] 27%|██▋       | 69/256 [08:21<22:35,  7.25s/it] 27%|██▋       | 70/256 [08:28<22:28,  7.25s/it] 28%|██▊       | 71/256 [08:35<22:21,  7.25s/it] 28%|██▊       | 72/256 [08:43<22:14,  7.25s/it] 29%|██▊       | 73/256 [08:50<22:06,  7.25s/it] 29%|██▉       | 74/256 [08:57<21:58,  7.25s/it] 29%|██▉       | 75/256 [09:04<21:51,  7.25s/it] 30%|██▉       | 76/256 [09:12<21:44,  7.25s/it] 30%|███       | 77/256 [09:19<21:37,  7.25s/it] 30%|███       | 78/256 [09:27<21:56,  7.40s/it] 31%|███       | 79/256 [09:34<21:41,  7.35s/it] 31%|███▏      | 80/256 [09:41<21:28,  7.32s/it] 32%|███▏      | 81/256 [09:48<21:17,  7.30s/it] 32%|███▏      | 82/256 [09:56<21:07,  7.28s/it] 32%|███▏      | 83/256 [10:03<20:58,  7.27s/it] 33%|███▎      | 84/256 [10:10<20:49,  7.27s/it] 33%|███▎      | 85/256 [10:17<20:41,  7.26s/it] 34%|███▎      | 86/256 [10:25<20:33,  7.26s/it] 34%|███▍      | 87/256 [10:32<20:26,  7.25s/it] 34%|███▍      | 88/256 [10:39<20:18,  7.25s/it] 35%|███▍      | 89/256 [10:46<20:11,  7.25s/it] 35%|███▌      | 90/256 [10:54<20:04,  7.25s/it] 36%|███▌      | 91/256 [11:01<19:56,  7.25s/it] 36%|███▌      | 92/256 [11:08<19:49,  7.25s/it] 36%|███▋      | 93/256 [11:15<19:41,  7.25s/it] 37%|███▋      | 94/256 [11:23<19:34,  7.25s/it] 37%|███▋      | 95/256 [11:30<19:27,  7.25s/it] 38%|███▊      | 96/256 [11:37<19:20,  7.25s/it] 38%|███▊      | 97/256 [11:44<19:12,  7.25s/it] 38%|███▊      | 98/256 [11:52<19:05,  7.25s/it] 39%|███▊      | 99/256 [11:59<18:57,  7.25s/it] 39%|███▉      | 100/256 [12:06<18:50,  7.25s/it] 39%|███▉      | 101/256 [12:13<18:43,  7.25s/it] 40%|███▉      | 102/256 [12:21<18:36,  7.25s/it] 40%|████      | 103/256 [12:28<18:29,  7.25s/it] 41%|████      | 104/256 [12:35<18:21,  7.25s/it] 41%|████      | 105/256 [12:42<18:14,  7.25s/it] 41%|████▏     | 106/256 [12:50<18:07,  7.25s/it] 42%|████▏     | 107/256 [12:57<18:00,  7.25s/it] 42%|████▏     | 108/256 [13:04<17:52,  7.25s/it] 43%|████▎     | 109/256 [13:11<17:45,  7.25s/it] 43%|████▎     | 110/256 [13:19<17:38,  7.25s/it] 43%|████▎     | 111/256 [13:26<17:31,  7.25s/it] 44%|████▍     | 112/256 [13:33<17:24,  7.25s/it] 44%|████▍     | 113/256 [13:40<17:16,  7.25s/it] 45%|████▍     | 114/256 [13:48<17:09,  7.25s/it] 45%|████▍     | 115/256 [13:55<17:02,  7.25s/it] 45%|████▌     | 116/256 [14:02<16:54,  7.25s/it] 46%|████▌     | 117/256 [14:09<16:47,  7.25s/it] 46%|████▌     | 118/256 [14:17<16:40,  7.25s/it] 46%|████▋     | 119/256 [14:24<16:33,  7.25s/it] 47%|████▋     | 120/256 [14:31<16:25,  7.25s/it] 47%|████▋     | 121/256 [14:38<16:18,  7.25s/it] 48%|████▊     | 122/256 [14:46<16:11,  7.25s/it] 48%|████▊     | 123/256 [14:53<16:04,  7.25s/it] 48%|████▊     | 124/256 [15:00<15:57,  7.25s/it] 49%|████▉     | 125/256 [15:07<15:49,  7.25s/it] 49%|████▉     | 126/256 [15:15<15:42,  7.25s/it] 50%|████▉     | 127/256 [15:22<15:35,  7.25s/it] 50%|█████     | 128/256 [15:29<15:28,  7.25s/it] 50%|█████     | 129/256 [15:36<15:20,  7.25s/it] 51%|█████     | 130/256 [15:44<15:13,  7.25s/it] 51%|█████     | 131/256 [15:51<15:06,  7.25s/it] 52%|█████▏    | 132/256 [15:58<14:59,  7.25s/it] 52%|█████▏    | 133/256 [16:05<14:51,  7.25s/it] 52%|█████▏    | 134/256 [16:13<14:44,  7.25s/it] 53%|█████▎    | 135/256 [16:20<14:37,  7.25s/it] 53%|█████▎    | 136/256 [16:27<14:30,  7.25s/it] 54%|█████▎    | 137/256 [16:34<14:22,  7.25s/it] 54%|█████▍    | 138/256 [16:42<14:15,  7.25s/it] 54%|█████▍    | 139/256 [16:49<14:08,  7.25s/it] 55%|█████▍    | 140/256 [16:57<14:20,  7.42s/it] 55%|█████▌    | 141/256 [17:04<14:06,  7.36s/it] 55%|█████▌    | 142/256 [17:11<13:55,  7.33s/it] 56%|█████▌    | 143/256 [17:18<13:44,  7.30s/it] 56%|█████▋    | 144/256 [17:26<13:35,  7.28s/it] 57%|█████▋    | 145/256 [17:33<13:26,  7.26s/it] 57%|█████▋    | 146/256 [17:40<13:18,  7.26s/it] 57%|█████▋    | 147/256 [17:47<13:10,  7.25s/it] 58%|█████▊    | 148/256 [17:55<13:02,  7.25s/it] 58%|█████▊    | 149/256 [18:02<12:54,  7.24s/it] 59%|█████▊    | 150/256 [18:09<12:47,  7.24s/it] 59%|█████▉    | 151/256 [18:16<12:39,  7.24s/it] 59%|█████▉    | 152/256 [18:23<12:32,  7.24s/it] 60%|█████▉    | 153/256 [18:31<12:24,  7.23s/it] 60%|██████    | 154/256 [18:38<12:17,  7.23s/it] 61%|██████    | 155/256 [18:45<12:10,  7.23s/it] 61%|██████    | 156/256 [18:52<12:03,  7.23s/it] 61%|██████▏   | 157/256 [19:00<11:55,  7.23s/it] 62%|██████▏   | 158/256 [19:07<11:48,  7.23s/it] 62%|██████▏   | 159/256 [19:14<11:41,  7.23s/it] 62%|██████▎   | 160/256 [19:21<11:34,  7.24s/it] 63%|██████▎   | 161/256 [19:29<11:27,  7.24s/it] 63%|██████▎   | 162/256 [19:36<11:20,  7.24s/it] 64%|██████▎   | 163/256 [19:43<11:12,  7.23s/it] 64%|██████▍   | 164/256 [19:50<11:05,  7.23s/it] 64%|██████▍   | 165/256 [19:57<10:58,  7.24s/it] 65%|██████▍   | 166/256 [20:05<10:51,  7.24s/it] 65%|██████▌   | 167/256 [20:12<10:43,  7.23s/it] 66%|██████▌   | 168/256 [20:19<10:36,  7.23s/it] 66%|██████▌   | 169/256 [20:27<10:38,  7.34s/it] 66%|██████▋   | 170/256 [20:34<10:28,  7.31s/it] 67%|██████▋   | 171/256 [20:41<10:19,  7.29s/it] 67%|██████▋   | 172/256 [20:48<10:10,  7.27s/it] 68%|██████▊   | 173/256 [20:56<10:02,  7.26s/it] 68%|██████▊   | 174/256 [21:03<09:54,  7.25s/it] 68%|██████▊   | 175/256 [21:10<09:46,  7.25s/it] 69%|██████▉   | 176/256 [21:17<09:39,  7.24s/it] 69%|██████▉   | 177/256 [21:25<09:31,  7.24s/it] 70%|██████▉   | 178/256 [21:32<09:24,  7.24s/it] 70%|██████▉   | 179/256 [21:39<09:17,  7.23s/it] 70%|███████   | 180/256 [21:46<09:09,  7.23s/it] 71%|███████   | 181/256 [21:54<09:02,  7.23s/it] 71%|███████   | 182/256 [22:01<08:55,  7.23s/it] 71%|███████▏  | 183/256 [22:08<08:47,  7.23s/it] 72%|███████▏  | 184/256 [22:15<08:40,  7.23s/it] 72%|███████▏  | 185/256 [22:22<08:33,  7.23s/it] 73%|███████▎  | 186/256 [22:30<08:26,  7.23s/it] 73%|███████▎  | 187/256 [22:37<08:18,  7.23s/it] 73%|███████▎  | 188/256 [22:44<08:11,  7.23s/it] 74%|███████▍  | 189/256 [22:51<08:04,  7.23s/it] 74%|███████▍  | 190/256 [22:59<07:57,  7.23s/it] 75%|███████▍  | 191/256 [23:06<07:50,  7.23s/it] 75%|███████▌  | 192/256 [23:13<07:42,  7.23s/it] 75%|███████▌  | 193/256 [23:20<07:35,  7.23s/it] 76%|███████▌  | 194/256 [23:28<07:28,  7.23s/it] 76%|███████▌  | 195/256 [23:35<07:21,  7.23s/it] 77%|███████▋  | 196/256 [23:42<07:13,  7.23s/it] 77%|███████▋  | 197/256 [23:49<07:06,  7.23s/it] 77%|███████▋  | 198/256 [23:57<07:02,  7.28s/it] 78%|███████▊  | 199/256 [24:04<06:54,  7.27s/it] 78%|███████▊  | 200/256 [24:11<06:46,  7.25s/it] 79%|███████▊  | 201/256 [24:18<06:38,  7.25s/it] 79%|███████▉  | 202/256 [24:26<06:31,  7.24s/it] 79%|███████▉  | 203/256 [24:33<06:23,  7.24s/it] 80%|███████▉  | 204/256 [24:40<06:16,  7.24s/it] 80%|████████  | 205/256 [24:47<06:09,  7.24s/it] 80%|████████  | 206/256 [24:55<06:01,  7.24s/it] 81%|████████  | 207/256 [25:02<05:54,  7.23s/it] 81%|████████▏ | 208/256 [25:09<05:47,  7.23s/it] 82%|████████▏ | 209/256 [25:16<05:40,  7.23s/it] 82%|████████▏ | 210/256 [25:23<05:32,  7.23s/it] 82%|████████▏ | 211/256 [25:31<05:25,  7.23s/it] 83%|████████▎ | 212/256 [25:38<05:18,  7.23s/it] 83%|████████▎ | 213/256 [25:45<05:10,  7.23s/it] 84%|████████▎ | 214/256 [25:52<05:03,  7.23s/it] 84%|████████▍ | 215/256 [26:00<04:56,  7.23s/it] 84%|████████▍ | 216/256 [26:07<04:49,  7.23s/it] 85%|████████▍ | 217/256 [26:14<04:42,  7.23s/it] 85%|████████▌ | 218/256 [26:21<04:34,  7.23s/it] 86%|████████▌ | 219/256 [26:29<04:27,  7.23s/it] 86%|████████▌ | 220/256 [26:36<04:20,  7.23s/it] 86%|████████▋ | 221/256 [26:43<04:13,  7.23s/it] 87%|████████▋ | 222/256 [26:50<04:05,  7.23s/it] 87%|████████▋ | 223/256 [26:57<03:58,  7.23s/it] 88%|████████▊ | 224/256 [27:05<03:51,  7.23s/it] 88%|████████▊ | 225/256 [27:12<03:44,  7.23s/it] 88%|████████▊ | 226/256 [27:19<03:36,  7.23s/it] 89%|████████▊ | 227/256 [27:26<03:30,  7.25s/it] 89%|████████▉ | 228/256 [27:34<03:22,  7.25s/it] 89%|████████▉ | 229/256 [27:41<03:15,  7.24s/it] 90%|████████▉ | 230/256 [27:48<03:08,  7.24s/it] 90%|█████████ | 231/256 [27:55<03:00,  7.24s/it] 91%|█████████ | 232/256 [28:03<02:53,  7.24s/it] 91%|█████████ | 233/256 [28:10<02:46,  7.24s/it] 91%|█████████▏| 234/256 [28:17<02:39,  7.24s/it] 92%|█████████▏| 235/256 [28:24<02:31,  7.23s/it] 92%|█████████▏| 236/256 [28:32<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:39<02:17,  7.23s/it] 93%|█████████▎| 238/256 [28:46<02:10,  7.23s/it] 93%|█████████▎| 239/256 [28:53<02:02,  7.23s/it] 94%|█████████▍| 240/256 [29:00<01:55,  7.23s/it] 94%|█████████▍| 241/256 [29:08<01:48,  7.23s/it] 95%|█████████▍| 242/256 [29:15<01:41,  7.24s/it] 95%|█████████▍| 243/256 [29:22<01:34,  7.24s/it] 95%|█████████▌| 244/256 [29:29<01:26,  7.24s/it] 96%|█████████▌| 245/256 [29:37<01:19,  7.24s/it] 96%|█████████▌| 246/256 [29:44<01:12,  7.24s/it] 96%|█████████▋| 247/256 [29:51<01:05,  7.24s/it] 97%|█████████▋| 248/256 [29:58<00:57,  7.23s/it] 97%|█████████▋| 249/256 [30:06<00:50,  7.24s/it] 98%|█████████▊| 250/256 [30:13<00:43,  7.24s/it] 98%|█████████▊| 251/256 [30:20<00:36,  7.23s/it] 98%|█████████▊| 252/256 [30:27<00:28,  7.23s/it] 99%|█████████▉| 253/256 [30:35<00:21,  7.23s/it] 99%|█████████▉| 254/256 [30:42<00:14,  7.23s/it]100%|█████████▉| 255/256 [30:49<00:07,  7.23s/it]100%|██████████| 256/256 [30:57<00:00,  7.31s/it]100%|██████████| 256/256 [30:57<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [59.12, 41.38]
Multiscale SSIM on Highres [1.0, 0.983]
Range Invariant Multiscale SSIM on Highres [1.0, 0.992]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/stats_disentangle_2405_D18-M3-S0-L8_15.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_15_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/10
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/10


Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 357
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<34:58,  8.23s/it]  1%|          | 2/256 [00:15<32:21,  7.64s/it]  1%|          | 3/256 [00:22<31:26,  7.46s/it]  2%|▏         | 4/256 [00:29<30:57,  7.37s/it]  2%|▏         | 5/256 [00:37<30:37,  7.32s/it]  2%|▏         | 6/256 [00:44<30:23,  7.29s/it]  3%|▎         | 7/256 [00:51<30:11,  7.28s/it]  3%|▎         | 8/256 [00:58<30:01,  7.27s/it]  4%|▎         | 9/256 [01:06<29:52,  7.26s/it]  4%|▍         | 10/256 [01:13<29:50,  7.28s/it]  4%|▍         | 11/256 [01:20<29:41,  7.27s/it]  5%|▍         | 12/256 [01:27<29:32,  7.26s/it]  5%|▌         | 13/256 [01:35<29:24,  7.26s/it]  5%|▌         | 14/256 [01:42<29:16,  7.26s/it]  6%|▌         | 15/256 [01:49<29:08,  7.25s/it]  6%|▋         | 16/256 [01:56<29:01,  7.26s/it]  7%|▋         | 17/256 [02:04<28:52,  7.25s/it]  7%|▋         | 18/256 [02:11<28:45,  7.25s/it]  7%|▋         | 19/256 [02:18<28:36,  7.24s/it]  8%|▊         | 20/256 [02:25<28:29,  7.24s/it]  8%|▊         | 21/256 [02:33<28:21,  7.24s/it]  9%|▊         | 22/256 [02:40<28:13,  7.24s/it]  9%|▉         | 23/256 [02:47<28:06,  7.24s/it]  9%|▉         | 24/256 [02:54<27:59,  7.24s/it] 10%|▉         | 25/256 [03:02<27:51,  7.24s/it] 10%|█         | 26/256 [03:09<27:44,  7.24s/it] 11%|█         | 27/256 [03:16<27:37,  7.24s/it] 11%|█         | 28/256 [03:23<27:30,  7.24s/it] 11%|█▏        | 29/256 [03:31<27:23,  7.24s/it] 12%|█▏        | 30/256 [03:38<27:16,  7.24s/it] 12%|█▏        | 31/256 [03:45<27:08,  7.24s/it] 12%|█▎        | 32/256 [03:52<27:01,  7.24s/it] 13%|█▎        | 33/256 [04:00<26:53,  7.24s/it] 13%|█▎        | 34/256 [04:07<26:46,  7.24s/it] 14%|█▎        | 35/256 [04:14<26:38,  7.23s/it] 14%|█▍        | 36/256 [04:21<26:31,  7.23s/it] 14%|█▍        | 37/256 [04:28<26:23,  7.23s/it] 15%|█▍        | 38/256 [04:36<26:17,  7.23s/it] 15%|█▌        | 39/256 [04:43<26:22,  7.29s/it] 16%|█▌        | 40/256 [04:50<26:11,  7.28s/it] 16%|█▌        | 41/256 [04:58<26:03,  7.27s/it] 16%|█▋        | 42/256 [05:05<25:53,  7.26s/it] 17%|█▋        | 43/256 [05:12<25:44,  7.25s/it] 17%|█▋        | 44/256 [05:19<25:37,  7.25s/it] 18%|█▊        | 45/256 [05:27<25:28,  7.25s/it] 18%|█▊        | 46/256 [05:34<25:21,  7.25s/it] 18%|█▊        | 47/256 [05:41<25:13,  7.24s/it] 19%|█▉        | 48/256 [05:48<25:06,  7.24s/it] 19%|█▉        | 49/256 [05:55<24:58,  7.24s/it] 20%|█▉        | 50/256 [06:03<24:50,  7.24s/it] 20%|█▉        | 51/256 [06:10<24:43,  7.24s/it] 20%|██        | 52/256 [06:17<24:36,  7.24s/it] 21%|██        | 53/256 [06:24<24:28,  7.23s/it] 21%|██        | 54/256 [06:32<24:21,  7.23s/it] 21%|██▏       | 55/256 [06:39<24:14,  7.24s/it] 22%|██▏       | 56/256 [06:46<24:07,  7.24s/it] 22%|██▏       | 57/256 [06:53<23:59,  7.23s/it] 23%|██▎       | 58/256 [07:01<23:52,  7.23s/it] 23%|██▎       | 59/256 [07:08<23:45,  7.24s/it] 23%|██▎       | 60/256 [07:15<23:37,  7.23s/it] 24%|██▍       | 61/256 [07:22<23:30,  7.23s/it] 24%|██▍       | 62/256 [07:30<23:23,  7.23s/it] 25%|██▍       | 63/256 [07:37<23:15,  7.23s/it] 25%|██▌       | 64/256 [07:44<23:08,  7.23s/it] 25%|██▌       | 65/256 [07:51<23:02,  7.24s/it] 26%|██▌       | 66/256 [07:58<22:54,  7.23s/it] 26%|██▌       | 67/256 [08:06<22:47,  7.23s/it] 27%|██▋       | 68/256 [08:13<22:48,  7.28s/it] 27%|██▋       | 69/256 [08:20<22:38,  7.27s/it] 27%|██▋       | 70/256 [08:28<22:29,  7.26s/it] 28%|██▊       | 71/256 [08:35<22:21,  7.25s/it] 28%|██▊       | 72/256 [08:42<22:13,  7.25s/it] 29%|██▊       | 73/256 [08:49<22:05,  7.25s/it] 29%|██▉       | 74/256 [08:57<21:58,  7.24s/it] 29%|██▉       | 75/256 [09:04<21:50,  7.24s/it] 30%|██▉       | 76/256 [09:11<21:43,  7.24s/it] 30%|███       | 77/256 [09:18<21:36,  7.24s/it] 30%|███       | 78/256 [09:25<21:28,  7.24s/it] 31%|███       | 79/256 [09:33<21:21,  7.24s/it] 31%|███▏      | 80/256 [09:40<21:14,  7.24s/it] 32%|███▏      | 81/256 [09:47<21:06,  7.24s/it] 32%|███▏      | 82/256 [09:54<20:59,  7.24s/it] 32%|███▏      | 83/256 [10:02<20:52,  7.24s/it] 33%|███▎      | 84/256 [10:09<20:45,  7.24s/it] 33%|███▎      | 85/256 [10:16<20:38,  7.24s/it] 34%|███▎      | 86/256 [10:23<20:30,  7.24s/it] 34%|███▍      | 87/256 [10:31<20:23,  7.24s/it] 34%|███▍      | 88/256 [10:38<20:15,  7.24s/it] 35%|███▍      | 89/256 [10:45<20:08,  7.24s/it] 35%|███▌      | 90/256 [10:52<20:01,  7.24s/it] 36%|███▌      | 91/256 [11:00<19:53,  7.23s/it] 36%|███▌      | 92/256 [11:07<19:46,  7.24s/it] 36%|███▋      | 93/256 [11:14<19:39,  7.24s/it] 37%|███▋      | 94/256 [11:21<19:32,  7.24s/it] 37%|███▋      | 95/256 [11:29<19:24,  7.23s/it] 38%|███▊      | 96/256 [11:36<19:17,  7.24s/it] 38%|███▊      | 97/256 [11:43<19:16,  7.27s/it] 38%|███▊      | 98/256 [11:50<19:07,  7.26s/it] 39%|███▊      | 99/256 [11:58<18:58,  7.25s/it] 39%|███▉      | 100/256 [12:05<18:50,  7.25s/it] 39%|███▉      | 101/256 [12:12<18:42,  7.24s/it] 40%|███▉      | 102/256 [12:19<18:35,  7.24s/it] 40%|████      | 103/256 [12:27<18:27,  7.24s/it] 41%|████      | 104/256 [12:34<18:20,  7.24s/it] 41%|████      | 105/256 [12:41<18:12,  7.24s/it] 41%|████▏     | 106/256 [12:48<18:05,  7.24s/it] 42%|████▏     | 107/256 [12:55<17:57,  7.23s/it] 42%|████▏     | 108/256 [13:03<17:50,  7.23s/it] 43%|████▎     | 109/256 [13:10<17:43,  7.23s/it] 43%|████▎     | 110/256 [13:17<17:36,  7.23s/it] 43%|████▎     | 111/256 [13:24<17:28,  7.23s/it] 44%|████▍     | 112/256 [13:32<17:21,  7.23s/it] 44%|████▍     | 113/256 [13:39<17:14,  7.23s/it] 45%|████▍     | 114/256 [13:46<17:07,  7.23s/it] 45%|████▍     | 115/256 [13:53<17:00,  7.24s/it] 45%|████▌     | 116/256 [14:01<16:53,  7.24s/it] 46%|████▌     | 117/256 [14:08<16:45,  7.24s/it] 46%|████▌     | 118/256 [14:15<16:38,  7.23s/it] 46%|████▋     | 119/256 [14:22<16:31,  7.23s/it] 47%|████▋     | 120/256 [14:29<16:23,  7.23s/it] 47%|████▋     | 121/256 [14:37<16:16,  7.23s/it] 48%|████▊     | 122/256 [14:44<16:09,  7.23s/it] 48%|████▊     | 123/256 [14:51<16:02,  7.23s/it] 48%|████▊     | 124/256 [14:58<15:55,  7.24s/it] 49%|████▉     | 125/256 [15:06<15:47,  7.23s/it] 49%|████▉     | 126/256 [15:13<15:48,  7.30s/it] 50%|████▉     | 127/256 [15:20<15:39,  7.28s/it] 50%|█████     | 128/256 [15:28<15:30,  7.27s/it] 50%|█████     | 129/256 [15:35<15:21,  7.26s/it] 51%|█████     | 130/256 [15:42<15:13,  7.25s/it] 51%|█████     | 131/256 [15:49<15:06,  7.25s/it] 52%|█████▏    | 132/256 [15:57<14:58,  7.24s/it] 52%|█████▏    | 133/256 [16:04<14:50,  7.24s/it] 52%|█████▏    | 134/256 [16:11<14:43,  7.24s/it] 53%|█████▎    | 135/256 [16:18<14:35,  7.24s/it] 53%|█████▎    | 136/256 [16:25<14:28,  7.24s/it] 54%|█████▎    | 137/256 [16:33<14:20,  7.23s/it] 54%|█████▍    | 138/256 [16:40<14:13,  7.23s/it] 54%|█████▍    | 139/256 [16:47<14:06,  7.23s/it] 55%|█████▍    | 140/256 [16:54<13:59,  7.23s/it] 55%|█████▌    | 141/256 [17:02<13:52,  7.24s/it] 55%|█████▌    | 142/256 [17:09<13:44,  7.23s/it] 56%|█████▌    | 143/256 [17:16<13:37,  7.23s/it] 56%|█████▋    | 144/256 [17:23<13:30,  7.23s/it] 57%|█████▋    | 145/256 [17:31<13:23,  7.24s/it] 57%|█████▋    | 146/256 [17:38<13:16,  7.24s/it] 57%|█████▋    | 147/256 [17:45<13:08,  7.24s/it] 58%|█████▊    | 148/256 [17:52<13:01,  7.24s/it] 58%|█████▊    | 149/256 [18:00<12:53,  7.23s/it] 59%|█████▊    | 150/256 [18:07<12:46,  7.23s/it] 59%|█████▉    | 151/256 [18:14<12:39,  7.23s/it] 59%|█████▉    | 152/256 [18:21<12:32,  7.23s/it] 60%|█████▉    | 153/256 [18:28<12:24,  7.23s/it] 60%|██████    | 154/256 [18:36<12:17,  7.23s/it] 61%|██████    | 155/256 [18:43<12:16,  7.29s/it] 61%|██████    | 156/256 [18:50<12:07,  7.27s/it] 61%|██████▏   | 157/256 [18:58<11:58,  7.26s/it] 62%|██████▏   | 158/256 [19:05<11:50,  7.25s/it] 62%|██████▏   | 159/256 [19:12<11:43,  7.25s/it] 62%|██████▎   | 160/256 [19:19<11:35,  7.24s/it] 63%|██████▎   | 161/256 [19:27<11:27,  7.24s/it] 63%|██████▎   | 162/256 [19:34<11:20,  7.24s/it] 64%|██████▎   | 163/256 [19:41<11:12,  7.23s/it] 64%|██████▍   | 164/256 [19:48<11:05,  7.23s/it] 64%|██████▍   | 165/256 [19:55<10:58,  7.23s/it] 65%|██████▍   | 166/256 [20:03<10:51,  7.23s/it] 65%|██████▌   | 167/256 [20:10<10:43,  7.23s/it] 66%|██████▌   | 168/256 [20:17<10:36,  7.23s/it] 66%|██████▌   | 169/256 [20:24<10:29,  7.23s/it] 66%|██████▋   | 170/256 [20:32<10:21,  7.23s/it] 67%|██████▋   | 171/256 [20:39<10:14,  7.23s/it] 67%|██████▋   | 172/256 [20:46<10:07,  7.23s/it] 68%|██████▊   | 173/256 [20:53<10:00,  7.23s/it] 68%|██████▊   | 174/256 [21:01<09:52,  7.23s/it] 68%|██████▊   | 175/256 [21:08<09:45,  7.23s/it] 69%|██████▉   | 176/256 [21:15<09:38,  7.23s/it] 69%|██████▉   | 177/256 [21:22<09:31,  7.23s/it] 70%|██████▉   | 178/256 [21:29<09:23,  7.23s/it] 70%|██████▉   | 179/256 [21:37<09:17,  7.23s/it] 70%|███████   | 180/256 [21:44<09:09,  7.23s/it] 71%|███████   | 181/256 [21:51<09:02,  7.23s/it] 71%|███████   | 182/256 [21:58<08:55,  7.23s/it] 71%|███████▏  | 183/256 [22:06<08:47,  7.23s/it] 72%|███████▏  | 184/256 [22:13<08:46,  7.31s/it] 72%|███████▏  | 185/256 [22:20<08:37,  7.29s/it] 73%|███████▎  | 186/256 [22:28<08:29,  7.27s/it] 73%|███████▎  | 187/256 [22:35<08:20,  7.26s/it] 73%|███████▎  | 188/256 [22:42<08:13,  7.25s/it] 74%|███████▍  | 189/256 [22:49<08:05,  7.25s/it] 74%|███████▍  | 190/256 [22:57<07:57,  7.24s/it] 75%|███████▍  | 191/256 [23:04<07:50,  7.24s/it] 75%|███████▌  | 192/256 [23:11<07:43,  7.24s/it] 75%|███████▌  | 193/256 [23:18<07:35,  7.24s/it] 76%|███████▌  | 194/256 [23:25<07:28,  7.24s/it] 76%|███████▌  | 195/256 [23:33<07:21,  7.23s/it] 77%|███████▋  | 196/256 [23:40<07:14,  7.24s/it] 77%|███████▋  | 197/256 [23:47<07:06,  7.23s/it] 77%|███████▋  | 198/256 [23:54<06:59,  7.23s/it] 78%|███████▊  | 199/256 [24:02<06:52,  7.23s/it] 78%|███████▊  | 200/256 [24:09<06:44,  7.23s/it] 79%|███████▊  | 201/256 [24:16<06:37,  7.23s/it] 79%|███████▉  | 202/256 [24:23<06:30,  7.23s/it] 79%|███████▉  | 203/256 [24:31<06:23,  7.23s/it] 80%|███████▉  | 204/256 [24:38<06:16,  7.23s/it] 80%|████████  | 205/256 [24:45<06:08,  7.23s/it] 80%|████████  | 206/256 [24:52<06:01,  7.23s/it] 81%|████████  | 207/256 [24:59<05:54,  7.23s/it] 81%|████████▏ | 208/256 [25:07<05:47,  7.23s/it] 82%|████████▏ | 209/256 [25:14<05:39,  7.23s/it] 82%|████████▏ | 210/256 [25:21<05:32,  7.23s/it] 82%|████████▏ | 211/256 [25:28<05:25,  7.23s/it] 83%|████████▎ | 212/256 [25:36<05:18,  7.23s/it] 83%|████████▎ | 213/256 [25:43<05:12,  7.27s/it] 84%|████████▎ | 214/256 [25:50<05:04,  7.26s/it] 84%|████████▍ | 215/256 [25:57<04:57,  7.25s/it] 84%|████████▍ | 216/256 [26:05<04:49,  7.24s/it] 85%|████████▍ | 217/256 [26:12<04:42,  7.24s/it] 85%|████████▌ | 218/256 [26:19<04:34,  7.24s/it] 86%|████████▌ | 219/256 [26:26<04:27,  7.23s/it] 86%|████████▌ | 220/256 [26:34<04:20,  7.23s/it] 86%|████████▋ | 221/256 [26:41<04:13,  7.23s/it] 87%|████████▋ | 222/256 [26:48<04:05,  7.23s/it] 87%|████████▋ | 223/256 [26:55<03:58,  7.23s/it] 88%|████████▊ | 224/256 [27:02<03:51,  7.23s/it] 88%|████████▊ | 225/256 [27:10<03:44,  7.23s/it] 88%|████████▊ | 226/256 [27:17<03:36,  7.23s/it] 89%|████████▊ | 227/256 [27:24<03:29,  7.23s/it] 89%|████████▉ | 228/256 [27:31<03:22,  7.23s/it] 89%|████████▉ | 229/256 [27:39<03:15,  7.23s/it] 90%|████████▉ | 230/256 [27:46<03:08,  7.23s/it] 90%|█████████ | 231/256 [27:53<03:00,  7.23s/it] 91%|█████████ | 232/256 [28:00<02:53,  7.23s/it] 91%|█████████ | 233/256 [28:08<02:46,  7.23s/it] 91%|█████████▏| 234/256 [28:15<02:39,  7.23s/it] 92%|█████████▏| 235/256 [28:22<02:31,  7.23s/it] 92%|█████████▏| 236/256 [28:29<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:36<02:17,  7.23s/it] 93%|█████████▎| 238/256 [28:44<02:10,  7.23s/it] 93%|█████████▎| 239/256 [28:51<02:02,  7.23s/it] 94%|█████████▍| 240/256 [28:58<01:55,  7.23s/it] 94%|█████████▍| 241/256 [29:05<01:48,  7.23s/it] 95%|█████████▍| 242/256 [29:13<01:41,  7.26s/it] 95%|█████████▍| 243/256 [29:20<01:34,  7.26s/it] 95%|█████████▌| 244/256 [29:27<01:27,  7.25s/it] 96%|█████████▌| 245/256 [29:34<01:19,  7.25s/it] 96%|█████████▌| 246/256 [29:42<01:12,  7.25s/it] 96%|█████████▋| 247/256 [29:49<01:05,  7.25s/it] 97%|█████████▋| 248/256 [29:56<00:57,  7.25s/it] 97%|█████████▋| 249/256 [30:03<00:50,  7.25s/it] 98%|█████████▊| 250/256 [30:11<00:43,  7.25s/it] 98%|█████████▊| 251/256 [30:18<00:36,  7.25s/it] 98%|█████████▊| 252/256 [30:25<00:28,  7.25s/it] 99%|█████████▉| 253/256 [30:32<00:21,  7.25s/it] 99%|█████████▉| 254/256 [30:40<00:14,  7.25s/it]100%|█████████▉| 255/256 [30:47<00:07,  7.25s/it]100%|██████████| 256/256 [30:54<00:00,  7.25s/it]100%|██████████| 256/256 [30:54<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [56.23, 40.04]
Multiscale SSIM on Highres [0.999, 0.976]
Range Invariant Multiscale SSIM on Highres [1.0, 0.989]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/stats_disentangle_2405_D18-M3-S0-L8_10.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_10_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/11
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode12
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/11


Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 366
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<35:13,  8.29s/it]  1%|          | 2/256 [00:15<32:25,  7.66s/it]  1%|          | 3/256 [00:22<31:28,  7.46s/it]  2%|▏         | 4/256 [00:29<30:58,  7.37s/it]  2%|▏         | 5/256 [00:37<30:38,  7.32s/it]  2%|▏         | 6/256 [00:44<30:24,  7.30s/it]  3%|▎         | 7/256 [00:51<30:13,  7.28s/it]  3%|▎         | 8/256 [00:58<30:02,  7.27s/it]  4%|▎         | 9/256 [01:06<29:53,  7.26s/it]  4%|▍         | 10/256 [01:13<29:44,  7.26s/it]  4%|▍         | 11/256 [01:20<29:36,  7.25s/it]  5%|▍         | 12/256 [01:27<29:29,  7.25s/it]  5%|▌         | 13/256 [01:35<29:30,  7.29s/it]  5%|▌         | 14/256 [01:42<29:20,  7.27s/it]  6%|▌         | 15/256 [01:49<29:10,  7.27s/it]  6%|▋         | 16/256 [01:57<29:02,  7.26s/it]  7%|▋         | 17/256 [02:04<28:54,  7.26s/it]  7%|▋         | 18/256 [02:11<28:45,  7.25s/it]  7%|▋         | 19/256 [02:18<28:37,  7.25s/it]  8%|▊         | 20/256 [02:25<28:29,  7.25s/it]  8%|▊         | 21/256 [02:33<28:22,  7.24s/it]  9%|▊         | 22/256 [02:40<28:15,  7.25s/it]  9%|▉         | 23/256 [02:47<28:08,  7.24s/it]  9%|▉         | 24/256 [02:54<28:00,  7.24s/it] 10%|▉         | 25/256 [03:02<27:52,  7.24s/it] 10%|█         | 26/256 [03:09<27:45,  7.24s/it] 11%|█         | 27/256 [03:16<27:38,  7.24s/it] 11%|█         | 28/256 [03:23<27:31,  7.24s/it] 11%|█▏        | 29/256 [03:31<27:24,  7.24s/it] 12%|█▏        | 30/256 [03:38<27:17,  7.25s/it] 12%|█▏        | 31/256 [03:45<27:09,  7.24s/it] 12%|█▎        | 32/256 [03:52<27:01,  7.24s/it] 13%|█▎        | 33/256 [04:00<26:55,  7.24s/it] 13%|█▎        | 34/256 [04:07<26:47,  7.24s/it] 14%|█▎        | 35/256 [04:14<26:39,  7.24s/it] 14%|█▍        | 36/256 [04:21<26:32,  7.24s/it] 14%|█▍        | 37/256 [04:29<26:25,  7.24s/it] 15%|█▍        | 38/256 [04:36<26:18,  7.24s/it] 15%|█▌        | 39/256 [04:43<26:10,  7.24s/it] 16%|█▌        | 40/256 [04:50<26:02,  7.24s/it] 16%|█▌        | 41/256 [04:58<25:55,  7.23s/it] 16%|█▋        | 42/256 [05:05<26:06,  7.32s/it] 17%|█▋        | 43/256 [05:12<25:54,  7.30s/it] 17%|█▋        | 44/256 [05:20<25:43,  7.28s/it] 18%|█▊        | 45/256 [05:27<25:33,  7.27s/it] 18%|█▊        | 46/256 [05:34<25:24,  7.26s/it] 18%|█▊        | 47/256 [05:41<25:15,  7.25s/it] 19%|█▉        | 48/256 [05:48<25:07,  7.25s/it] 19%|█▉        | 49/256 [05:56<24:59,  7.24s/it] 20%|█▉        | 50/256 [06:03<24:51,  7.24s/it] 20%|█▉        | 51/256 [06:10<24:43,  7.24s/it] 20%|██        | 52/256 [06:17<24:36,  7.24s/it] 21%|██        | 53/256 [06:25<24:28,  7.24s/it] 21%|██        | 54/256 [06:32<24:21,  7.23s/it] 21%|██▏       | 55/256 [06:39<24:14,  7.23s/it] 22%|██▏       | 56/256 [06:46<24:06,  7.23s/it] 22%|██▏       | 57/256 [06:54<23:59,  7.23s/it] 23%|██▎       | 58/256 [07:01<23:53,  7.24s/it] 23%|██▎       | 59/256 [07:08<23:47,  7.25s/it] 23%|██▎       | 60/256 [07:15<23:40,  7.25s/it] 24%|██▍       | 61/256 [07:23<23:33,  7.25s/it] 24%|██▍       | 62/256 [07:30<23:26,  7.25s/it] 25%|██▍       | 63/256 [07:37<23:18,  7.25s/it] 25%|██▌       | 64/256 [07:44<23:11,  7.25s/it] 25%|██▌       | 65/256 [07:52<23:04,  7.25s/it] 26%|██▌       | 66/256 [07:59<22:58,  7.25s/it] 26%|██▌       | 67/256 [08:06<22:50,  7.25s/it] 27%|██▋       | 68/256 [08:13<22:43,  7.25s/it] 27%|██▋       | 69/256 [08:21<22:36,  7.25s/it] 27%|██▋       | 70/256 [08:28<22:28,  7.25s/it] 28%|██▊       | 71/256 [08:35<22:25,  7.28s/it] 28%|██▊       | 72/256 [08:42<22:17,  7.27s/it] 29%|██▊       | 73/256 [08:50<22:09,  7.26s/it] 29%|██▉       | 74/256 [08:57<22:01,  7.26s/it] 29%|██▉       | 75/256 [09:04<21:54,  7.26s/it] 30%|██▉       | 76/256 [09:11<21:46,  7.26s/it] 30%|███       | 77/256 [09:19<21:38,  7.25s/it] 30%|███       | 78/256 [09:26<21:30,  7.25s/it] 31%|███       | 79/256 [09:33<21:24,  7.25s/it] 31%|███▏      | 80/256 [09:40<21:16,  7.26s/it] 32%|███▏      | 81/256 [09:48<21:09,  7.25s/it] 32%|███▏      | 82/256 [09:55<21:02,  7.26s/it] 32%|███▏      | 83/256 [10:02<20:54,  7.25s/it] 33%|███▎      | 84/256 [10:09<20:47,  7.25s/it] 33%|███▎      | 85/256 [10:17<20:40,  7.25s/it] 34%|███▎      | 86/256 [10:24<20:33,  7.25s/it] 34%|███▍      | 87/256 [10:31<20:25,  7.25s/it] 34%|███▍      | 88/256 [10:38<20:18,  7.25s/it] 35%|███▍      | 89/256 [10:46<20:11,  7.25s/it] 35%|███▌      | 90/256 [10:53<20:04,  7.25s/it] 36%|███▌      | 91/256 [11:00<19:56,  7.25s/it] 36%|███▌      | 92/256 [11:07<19:48,  7.25s/it] 36%|███▋      | 93/256 [11:15<19:40,  7.24s/it] 37%|███▋      | 94/256 [11:22<19:33,  7.25s/it] 37%|███▋      | 95/256 [11:29<19:26,  7.24s/it] 38%|███▊      | 96/256 [11:36<19:18,  7.24s/it] 38%|███▊      | 97/256 [11:44<19:10,  7.24s/it] 38%|███▊      | 98/256 [11:51<19:03,  7.24s/it] 39%|███▊      | 99/256 [11:58<18:56,  7.24s/it] 39%|███▉      | 100/256 [12:05<18:49,  7.24s/it] 39%|███▉      | 101/256 [12:13<18:41,  7.24s/it] 40%|███▉      | 102/256 [12:20<18:34,  7.24s/it] 40%|████      | 103/256 [12:27<18:27,  7.24s/it] 41%|████      | 104/256 [12:34<18:22,  7.25s/it] 41%|████      | 105/256 [12:42<18:17,  7.27s/it] 41%|████▏     | 106/256 [12:49<18:08,  7.26s/it] 42%|████▏     | 107/256 [12:56<18:00,  7.25s/it] 42%|████▏     | 108/256 [13:03<17:52,  7.25s/it] 43%|████▎     | 109/256 [13:11<17:45,  7.25s/it] 43%|████▎     | 110/256 [13:18<17:37,  7.25s/it] 43%|████▎     | 111/256 [13:25<17:30,  7.24s/it] 44%|████▍     | 112/256 [13:32<17:22,  7.24s/it] 44%|████▍     | 113/256 [13:40<17:16,  7.25s/it] 45%|████▍     | 114/256 [13:47<17:08,  7.25s/it] 45%|████▍     | 115/256 [13:54<17:01,  7.24s/it] 45%|████▌     | 116/256 [14:01<16:53,  7.24s/it] 46%|████▌     | 117/256 [14:09<16:46,  7.24s/it] 46%|████▌     | 118/256 [14:16<16:39,  7.24s/it] 46%|████▋     | 119/256 [14:23<16:31,  7.24s/it] 47%|████▋     | 120/256 [14:30<16:24,  7.24s/it] 47%|████▋     | 121/256 [14:38<16:17,  7.24s/it] 48%|████▊     | 122/256 [14:45<16:09,  7.24s/it] 48%|████▊     | 123/256 [14:52<16:02,  7.24s/it] 48%|████▊     | 124/256 [14:59<15:55,  7.23s/it] 49%|████▉     | 125/256 [15:06<15:48,  7.24s/it] 49%|████▉     | 126/256 [15:14<15:41,  7.24s/it] 50%|████▉     | 127/256 [15:21<15:33,  7.24s/it] 50%|█████     | 128/256 [15:28<15:26,  7.24s/it] 50%|█████     | 129/256 [15:35<15:19,  7.24s/it] 51%|█████     | 130/256 [15:43<15:12,  7.24s/it] 51%|█████     | 131/256 [15:50<15:05,  7.24s/it] 52%|█████▏    | 132/256 [15:57<14:57,  7.24s/it] 52%|█████▏    | 133/256 [16:04<14:53,  7.26s/it] 52%|█████▏    | 134/256 [16:12<14:47,  7.27s/it] 53%|█████▎    | 135/256 [16:19<14:38,  7.26s/it] 53%|█████▎    | 136/256 [16:26<14:30,  7.25s/it] 54%|█████▎    | 137/256 [16:33<14:22,  7.25s/it] 54%|█████▍    | 138/256 [16:41<14:15,  7.25s/it] 54%|█████▍    | 139/256 [16:48<14:07,  7.25s/it] 55%|█████▍    | 140/256 [16:55<14:00,  7.24s/it] 55%|█████▌    | 141/256 [17:02<13:52,  7.24s/it] 55%|█████▌    | 142/256 [17:10<13:45,  7.24s/it] 56%|█████▌    | 143/256 [17:17<13:38,  7.24s/it] 56%|█████▋    | 144/256 [17:24<13:31,  7.24s/it] 57%|█████▋    | 145/256 [17:31<13:23,  7.24s/it] 57%|█████▋    | 146/256 [17:39<13:16,  7.24s/it] 57%|█████▋    | 147/256 [17:46<13:09,  7.24s/it] 58%|█████▊    | 148/256 [17:53<13:02,  7.25s/it] 58%|█████▊    | 149/256 [18:00<12:55,  7.25s/it] 59%|█████▊    | 150/256 [18:08<12:47,  7.24s/it] 59%|█████▉    | 151/256 [18:15<12:40,  7.24s/it] 59%|█████▉    | 152/256 [18:22<12:33,  7.24s/it] 60%|█████▉    | 153/256 [18:29<12:25,  7.24s/it] 60%|██████    | 154/256 [18:37<12:18,  7.24s/it] 61%|██████    | 155/256 [18:44<12:11,  7.24s/it] 61%|██████    | 156/256 [18:51<12:04,  7.24s/it] 61%|██████▏   | 157/256 [18:58<11:56,  7.24s/it] 62%|██████▏   | 158/256 [19:06<11:49,  7.24s/it] 62%|██████▏   | 159/256 [19:13<11:42,  7.24s/it] 62%|██████▎   | 160/256 [19:20<11:35,  7.24s/it] 63%|██████▎   | 161/256 [19:27<11:28,  7.24s/it] 63%|██████▎   | 162/256 [19:35<11:34,  7.39s/it] 64%|██████▎   | 163/256 [19:42<11:23,  7.35s/it] 64%|██████▍   | 164/256 [19:50<11:13,  7.32s/it] 64%|██████▍   | 165/256 [19:57<11:04,  7.30s/it] 65%|██████▍   | 166/256 [20:04<10:55,  7.29s/it] 65%|██████▌   | 167/256 [20:11<10:47,  7.28s/it] 66%|██████▌   | 168/256 [20:19<10:39,  7.27s/it] 66%|██████▌   | 169/256 [20:26<10:31,  7.26s/it] 66%|██████▋   | 170/256 [20:33<10:24,  7.26s/it] 67%|██████▋   | 171/256 [20:40<10:16,  7.26s/it] 67%|██████▋   | 172/256 [20:48<10:09,  7.25s/it] 68%|██████▊   | 173/256 [20:55<10:02,  7.26s/it] 68%|██████▊   | 174/256 [21:02<09:54,  7.26s/it] 68%|██████▊   | 175/256 [21:09<09:47,  7.25s/it] 69%|██████▉   | 176/256 [21:17<09:40,  7.25s/it] 69%|██████▉   | 177/256 [21:24<09:32,  7.25s/it] 70%|██████▉   | 178/256 [21:31<09:25,  7.25s/it] 70%|██████▉   | 179/256 [21:38<09:18,  7.26s/it] 70%|███████   | 180/256 [21:46<09:11,  7.25s/it] 71%|███████   | 181/256 [21:53<09:03,  7.25s/it] 71%|███████   | 182/256 [22:00<08:56,  7.25s/it] 71%|███████▏  | 183/256 [22:07<08:49,  7.25s/it] 72%|███████▏  | 184/256 [22:15<08:42,  7.25s/it] 72%|███████▏  | 185/256 [22:22<08:34,  7.25s/it] 73%|███████▎  | 186/256 [22:29<08:27,  7.25s/it] 73%|███████▎  | 187/256 [22:36<08:20,  7.25s/it] 73%|███████▎  | 188/256 [22:44<08:13,  7.25s/it] 74%|███████▍  | 189/256 [22:51<08:05,  7.25s/it] 74%|███████▍  | 190/256 [22:58<07:58,  7.25s/it] 75%|███████▍  | 191/256 [23:05<07:51,  7.25s/it] 75%|███████▌  | 192/256 [23:13<07:44,  7.25s/it] 75%|███████▌  | 193/256 [23:20<07:36,  7.25s/it] 76%|███████▌  | 194/256 [23:27<07:29,  7.25s/it] 76%|███████▌  | 195/256 [23:34<07:23,  7.27s/it] 77%|███████▋  | 196/256 [23:42<07:16,  7.28s/it] 77%|███████▋  | 197/256 [23:49<07:08,  7.27s/it] 77%|███████▋  | 198/256 [23:56<07:01,  7.26s/it] 78%|███████▊  | 199/256 [24:03<06:53,  7.26s/it] 78%|███████▊  | 200/256 [24:11<06:46,  7.26s/it] 79%|███████▊  | 201/256 [24:18<06:39,  7.26s/it] 79%|███████▉  | 202/256 [24:25<06:31,  7.26s/it] 79%|███████▉  | 203/256 [24:32<06:24,  7.25s/it] 80%|███████▉  | 204/256 [24:40<06:17,  7.25s/it] 80%|████████  | 205/256 [24:47<06:09,  7.25s/it] 80%|████████  | 206/256 [24:54<06:02,  7.25s/it] 81%|████████  | 207/256 [25:01<05:55,  7.25s/it] 81%|████████▏ | 208/256 [25:09<05:48,  7.25s/it] 82%|████████▏ | 209/256 [25:16<05:40,  7.25s/it] 82%|████████▏ | 210/256 [25:23<05:33,  7.25s/it] 82%|████████▏ | 211/256 [25:30<05:26,  7.25s/it] 83%|████████▎ | 212/256 [25:38<05:18,  7.25s/it] 83%|████████▎ | 213/256 [25:45<05:11,  7.25s/it] 84%|████████▎ | 214/256 [25:52<05:04,  7.25s/it] 84%|████████▍ | 215/256 [26:00<04:57,  7.25s/it] 84%|████████▍ | 216/256 [26:07<04:50,  7.25s/it] 85%|████████▍ | 217/256 [26:14<04:42,  7.25s/it] 85%|████████▌ | 218/256 [26:21<04:35,  7.25s/it] 86%|████████▌ | 219/256 [26:28<04:28,  7.25s/it] 86%|████████▌ | 220/256 [26:36<04:21,  7.25s/it] 86%|████████▋ | 221/256 [26:43<04:13,  7.25s/it] 87%|████████▋ | 222/256 [26:50<04:06,  7.25s/it] 87%|████████▋ | 223/256 [26:58<03:59,  7.25s/it] 88%|████████▊ | 224/256 [27:05<03:56,  7.39s/it] 88%|████████▊ | 225/256 [27:12<03:47,  7.34s/it] 88%|████████▊ | 226/256 [27:20<03:39,  7.31s/it] 89%|████████▊ | 227/256 [27:27<03:31,  7.29s/it] 89%|████████▉ | 228/256 [27:34<03:23,  7.27s/it] 89%|████████▉ | 229/256 [27:41<03:16,  7.26s/it] 90%|████████▉ | 230/256 [27:49<03:08,  7.25s/it] 90%|█████████ | 231/256 [27:56<03:01,  7.25s/it] 91%|█████████ | 232/256 [28:03<02:53,  7.25s/it] 91%|█████████ | 233/256 [28:10<02:46,  7.24s/it] 91%|█████████▏| 234/256 [28:18<02:39,  7.24s/it] 92%|█████████▏| 235/256 [28:25<02:31,  7.24s/it] 92%|█████████▏| 236/256 [28:32<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:39<02:17,  7.24s/it] 93%|█████████▎| 238/256 [28:47<02:10,  7.24s/it] 93%|█████████▎| 239/256 [28:54<02:03,  7.24s/it] 94%|█████████▍| 240/256 [29:01<01:55,  7.24s/it] 94%|█████████▍| 241/256 [29:08<01:48,  7.23s/it] 95%|█████████▍| 242/256 [29:15<01:41,  7.23s/it] 95%|█████████▍| 243/256 [29:23<01:34,  7.23s/it] 95%|█████████▌| 244/256 [29:30<01:26,  7.23s/it] 96%|█████████▌| 245/256 [29:37<01:19,  7.23s/it] 96%|█████████▌| 246/256 [29:44<01:12,  7.23s/it] 96%|█████████▋| 247/256 [29:52<01:05,  7.23s/it] 97%|█████████▋| 248/256 [29:59<00:57,  7.23s/it] 97%|█████████▋| 249/256 [30:06<00:50,  7.23s/it] 98%|█████████▊| 250/256 [30:13<00:43,  7.24s/it] 98%|█████████▊| 251/256 [30:21<00:36,  7.24s/it] 98%|█████████▊| 252/256 [30:28<00:28,  7.23s/it] 99%|█████████▉| 253/256 [30:35<00:21,  7.30s/it] 99%|█████████▉| 254/256 [30:42<00:14,  7.28s/it]100%|█████████▉| 255/256 [30:50<00:07,  7.27s/it]100%|██████████| 256/256 [30:57<00:00,  7.26s/it]100%|██████████| 256/256 [30:57<00:00,  7.26s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [44.25, 45.6]
Multiscale SSIM on Highres [0.995, 0.995]
Range Invariant Multiscale SSIM on Highres [0.996, 0.995]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/stats_disentangle_2405_D18-M3-S0-L8_11.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_11_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/12
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode15
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/12


Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 2]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/7/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 399
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<35:38,  8.39s/it]  1%|          | 2/256 [00:15<32:40,  7.72s/it]  1%|          | 3/256 [00:22<31:34,  7.49s/it]  2%|▏         | 4/256 [00:30<31:05,  7.40s/it]  2%|▏         | 5/256 [00:37<30:42,  7.34s/it]  2%|▏         | 6/256 [00:44<30:25,  7.30s/it]  3%|▎         | 7/256 [00:51<30:11,  7.27s/it]  3%|▎         | 8/256 [00:59<30:00,  7.26s/it]  4%|▎         | 9/256 [01:06<29:50,  7.25s/it]  4%|▍         | 10/256 [01:13<29:41,  7.24s/it]  4%|▍         | 11/256 [01:20<29:33,  7.24s/it]  5%|▍         | 12/256 [01:27<29:25,  7.24s/it]  5%|▌         | 13/256 [01:35<29:17,  7.23s/it]  5%|▌         | 14/256 [01:42<29:11,  7.24s/it]  6%|▌         | 15/256 [01:49<29:05,  7.24s/it]  6%|▋         | 16/256 [01:56<28:58,  7.25s/it]  7%|▋         | 17/256 [02:04<28:51,  7.25s/it]  7%|▋         | 18/256 [02:11<28:44,  7.25s/it]  7%|▋         | 19/256 [02:18<28:37,  7.25s/it]  8%|▊         | 20/256 [02:25<28:29,  7.24s/it]  8%|▊         | 21/256 [02:33<28:23,  7.25s/it]  9%|▊         | 22/256 [02:40<28:15,  7.25s/it]  9%|▉         | 23/256 [02:47<28:07,  7.24s/it]  9%|▉         | 24/256 [02:54<28:01,  7.25s/it] 10%|▉         | 25/256 [03:02<27:53,  7.24s/it] 10%|█         | 26/256 [03:09<27:45,  7.24s/it] 11%|█         | 27/256 [03:16<27:38,  7.24s/it] 11%|█         | 28/256 [03:23<27:30,  7.24s/it] 11%|█▏        | 29/256 [03:31<27:23,  7.24s/it] 12%|█▏        | 30/256 [03:38<27:15,  7.24s/it] 12%|█▏        | 31/256 [03:45<27:07,  7.24s/it] 12%|█▎        | 32/256 [03:52<27:00,  7.23s/it] 13%|█▎        | 33/256 [04:00<27:17,  7.34s/it] 13%|█▎        | 34/256 [04:07<27:04,  7.32s/it] 14%|█▎        | 35/256 [04:14<26:51,  7.29s/it] 14%|█▍        | 36/256 [04:22<26:40,  7.27s/it] 14%|█▍        | 37/256 [04:29<26:30,  7.26s/it] 15%|█▍        | 38/256 [04:36<26:21,  7.25s/it] 15%|█▌        | 39/256 [04:43<26:12,  7.25s/it] 16%|█▌        | 40/256 [04:51<26:04,  7.24s/it] 16%|█▌        | 41/256 [04:58<25:56,  7.24s/it] 16%|█▋        | 42/256 [05:05<25:49,  7.24s/it] 17%|█▋        | 43/256 [05:12<25:41,  7.24s/it] 17%|█▋        | 44/256 [05:19<25:34,  7.24s/it] 18%|█▊        | 45/256 [05:27<25:27,  7.24s/it] 18%|█▊        | 46/256 [05:34<25:19,  7.23s/it] 18%|█▊        | 47/256 [05:41<25:11,  7.23s/it] 19%|█▉        | 48/256 [05:48<25:04,  7.23s/it] 19%|█▉        | 49/256 [05:56<24:57,  7.24s/it] 20%|█▉        | 50/256 [06:03<24:50,  7.24s/it] 20%|█▉        | 51/256 [06:10<24:43,  7.24s/it] 20%|██        | 52/256 [06:17<24:35,  7.23s/it] 21%|██        | 53/256 [06:25<24:28,  7.23s/it] 21%|██        | 54/256 [06:32<24:21,  7.23s/it] 21%|██▏       | 55/256 [06:39<24:14,  7.24s/it] 22%|██▏       | 56/256 [06:46<24:07,  7.24s/it] 22%|██▏       | 57/256 [06:54<23:59,  7.23s/it] 23%|██▎       | 58/256 [07:01<23:52,  7.24s/it] 23%|██▎       | 59/256 [07:08<23:45,  7.24s/it] 23%|██▎       | 60/256 [07:15<23:38,  7.24s/it] 24%|██▍       | 61/256 [07:22<23:30,  7.23s/it] 24%|██▍       | 62/256 [07:30<23:33,  7.29s/it] 25%|██▍       | 63/256 [07:37<23:24,  7.28s/it] 25%|██▌       | 64/256 [07:44<23:14,  7.26s/it] 25%|██▌       | 65/256 [07:52<23:05,  7.26s/it] 26%|██▌       | 66/256 [07:59<22:57,  7.25s/it] 26%|██▌       | 67/256 [08:06<22:49,  7.25s/it] 27%|██▋       | 68/256 [08:13<22:41,  7.24s/it] 27%|██▋       | 69/256 [08:21<22:33,  7.24s/it] 27%|██▋       | 70/256 [08:28<22:26,  7.24s/it] 28%|██▊       | 71/256 [08:35<22:19,  7.24s/it] 28%|██▊       | 72/256 [08:42<22:11,  7.24s/it] 29%|██▊       | 73/256 [08:50<22:04,  7.24s/it] 29%|██▉       | 74/256 [08:57<21:57,  7.24s/it] 29%|██▉       | 75/256 [09:04<21:50,  7.24s/it] 30%|██▉       | 76/256 [09:11<21:42,  7.24s/it] 30%|███       | 77/256 [09:18<21:35,  7.24s/it] 30%|███       | 78/256 [09:26<21:27,  7.24s/it] 31%|███       | 79/256 [09:33<21:20,  7.24s/it] 31%|███▏      | 80/256 [09:40<21:13,  7.23s/it] 32%|███▏      | 81/256 [09:47<21:05,  7.23s/it] 32%|███▏      | 82/256 [09:55<20:59,  7.24s/it] 32%|███▏      | 83/256 [10:02<20:52,  7.24s/it] 33%|███▎      | 84/256 [10:09<20:45,  7.24s/it] 33%|███▎      | 85/256 [10:16<20:37,  7.24s/it] 34%|███▎      | 86/256 [10:24<20:29,  7.23s/it] 34%|███▍      | 87/256 [10:31<20:22,  7.23s/it] 34%|███▍      | 88/256 [10:38<20:15,  7.23s/it] 35%|███▍      | 89/256 [10:45<20:08,  7.23s/it] 35%|███▌      | 90/256 [10:52<20:00,  7.23s/it] 36%|███▌      | 91/256 [11:00<19:58,  7.26s/it] 36%|███▌      | 92/256 [11:07<19:50,  7.26s/it] 36%|███▋      | 93/256 [11:14<19:42,  7.26s/it] 37%|███▋      | 94/256 [11:22<19:35,  7.26s/it] 37%|███▋      | 95/256 [11:29<19:28,  7.26s/it] 38%|███▊      | 96/256 [11:36<19:20,  7.25s/it] 38%|███▊      | 97/256 [11:43<19:13,  7.25s/it] 38%|███▊      | 98/256 [11:51<19:05,  7.25s/it] 39%|███▊      | 99/256 [11:58<18:59,  7.26s/it] 39%|███▉      | 100/256 [12:05<18:51,  7.25s/it] 39%|███▉      | 101/256 [12:12<18:44,  7.25s/it] 40%|███▉      | 102/256 [12:20<18:36,  7.25s/it] 40%|████      | 103/256 [12:27<18:29,  7.25s/it] 41%|████      | 104/256 [12:34<18:21,  7.25s/it] 41%|████      | 105/256 [12:41<18:14,  7.25s/it] 41%|████▏     | 106/256 [12:49<18:07,  7.25s/it] 42%|████▏     | 107/256 [12:56<18:00,  7.25s/it] 42%|████▏     | 108/256 [13:03<17:52,  7.25s/it] 43%|████▎     | 109/256 [13:10<17:45,  7.25s/it] 43%|████▎     | 110/256 [13:18<17:38,  7.25s/it] 43%|████▎     | 111/256 [13:25<17:31,  7.25s/it] 44%|████▍     | 112/256 [13:32<17:24,  7.25s/it] 44%|████▍     | 113/256 [13:39<17:16,  7.25s/it] 45%|████▍     | 114/256 [13:47<17:09,  7.25s/it] 45%|████▍     | 115/256 [13:54<17:02,  7.25s/it] 45%|████▌     | 116/256 [14:01<16:54,  7.25s/it] 46%|████▌     | 117/256 [14:08<16:47,  7.25s/it] 46%|████▌     | 118/256 [14:16<16:40,  7.25s/it] 46%|████▋     | 119/256 [14:23<16:33,  7.25s/it] 47%|████▋     | 120/256 [14:30<16:26,  7.25s/it] 47%|████▋     | 121/256 [14:37<16:18,  7.25s/it] 48%|████▊     | 122/256 [14:45<16:11,  7.25s/it] 48%|████▊     | 123/256 [14:52<16:04,  7.25s/it] 48%|████▊     | 124/256 [15:00<16:17,  7.40s/it] 49%|████▉     | 125/256 [15:07<16:03,  7.35s/it] 49%|████▉     | 126/256 [15:14<15:51,  7.32s/it] 50%|████▉     | 127/256 [15:21<15:40,  7.29s/it] 50%|█████     | 128/256 [15:29<15:30,  7.27s/it] 50%|█████     | 129/256 [15:36<15:21,  7.26s/it] 51%|█████     | 130/256 [15:43<15:13,  7.25s/it] 51%|█████     | 131/256 [15:50<15:05,  7.25s/it] 52%|█████▏    | 132/256 [15:57<14:57,  7.24s/it] 52%|█████▏    | 133/256 [16:05<14:50,  7.24s/it] 52%|█████▏    | 134/256 [16:12<14:43,  7.24s/it] 53%|█████▎    | 135/256 [16:19<14:35,  7.24s/it] 53%|█████▎    | 136/256 [16:26<14:28,  7.24s/it] 54%|█████▎    | 137/256 [16:34<14:20,  7.23s/it] 54%|█████▍    | 138/256 [16:41<14:13,  7.24s/it] 54%|█████▍    | 139/256 [16:48<14:06,  7.23s/it] 55%|█████▍    | 140/256 [16:55<13:58,  7.23s/it] 55%|█████▌    | 141/256 [17:03<13:51,  7.23s/it] 55%|█████▌    | 142/256 [17:10<13:44,  7.23s/it] 56%|█████▌    | 143/256 [17:17<13:37,  7.23s/it] 56%|█████▋    | 144/256 [17:24<13:30,  7.23s/it] 57%|█████▋    | 145/256 [17:31<13:22,  7.23s/it] 57%|█████▋    | 146/256 [17:39<13:15,  7.23s/it] 57%|█████▋    | 147/256 [17:46<13:07,  7.23s/it] 58%|█████▊    | 148/256 [17:53<13:00,  7.23s/it] 58%|█████▊    | 149/256 [18:00<12:53,  7.23s/it] 59%|█████▊    | 150/256 [18:08<12:46,  7.23s/it] 59%|█████▉    | 151/256 [18:15<12:39,  7.23s/it] 59%|█████▉    | 152/256 [18:22<12:31,  7.23s/it] 60%|█████▉    | 153/256 [18:30<12:34,  7.32s/it] 60%|██████    | 154/256 [18:37<12:24,  7.30s/it] 61%|██████    | 155/256 [18:44<12:15,  7.28s/it] 61%|██████    | 156/256 [18:51<12:06,  7.27s/it] 61%|██████▏   | 157/256 [18:59<11:58,  7.26s/it] 62%|██████▏   | 158/256 [19:06<11:50,  7.25s/it] 62%|██████▏   | 159/256 [19:13<11:42,  7.25s/it] 62%|██████▎   | 160/256 [19:20<11:35,  7.24s/it] 63%|██████▎   | 161/256 [19:28<11:27,  7.24s/it] 63%|██████▎   | 162/256 [19:35<11:20,  7.24s/it] 64%|██████▎   | 163/256 [19:42<11:13,  7.24s/it] 64%|██████▍   | 164/256 [19:49<11:05,  7.24s/it] 64%|██████▍   | 165/256 [19:56<10:58,  7.24s/it] 65%|██████▍   | 166/256 [20:04<10:51,  7.24s/it] 65%|██████▌   | 167/256 [20:11<10:44,  7.24s/it] 66%|██████▌   | 168/256 [20:18<10:36,  7.24s/it] 66%|██████▌   | 169/256 [20:25<10:29,  7.24s/it] 66%|██████▋   | 170/256 [20:33<10:22,  7.24s/it] 67%|██████▋   | 171/256 [20:40<10:15,  7.24s/it] 67%|██████▋   | 172/256 [20:47<10:07,  7.24s/it] 68%|██████▊   | 173/256 [20:54<10:00,  7.24s/it] 68%|██████▊   | 174/256 [21:02<09:53,  7.24s/it] 68%|██████▊   | 175/256 [21:09<09:46,  7.24s/it] 69%|██████▉   | 176/256 [21:16<09:38,  7.23s/it] 69%|██████▉   | 177/256 [21:23<09:31,  7.23s/it] 70%|██████▉   | 178/256 [21:31<09:24,  7.24s/it] 70%|██████▉   | 179/256 [21:38<09:16,  7.23s/it] 70%|███████   | 180/256 [21:45<09:09,  7.23s/it] 71%|███████   | 181/256 [21:52<09:02,  7.23s/it] 71%|███████   | 182/256 [22:00<08:56,  7.25s/it] 71%|███████▏  | 183/256 [22:07<08:48,  7.24s/it] 72%|███████▏  | 184/256 [22:14<08:41,  7.24s/it] 72%|███████▏  | 185/256 [22:21<08:33,  7.23s/it] 73%|███████▎  | 186/256 [22:28<08:26,  7.23s/it] 73%|███████▎  | 187/256 [22:36<08:19,  7.23s/it] 73%|███████▎  | 188/256 [22:43<08:11,  7.23s/it] 74%|███████▍  | 189/256 [22:50<08:04,  7.23s/it] 74%|███████▍  | 190/256 [22:57<07:57,  7.23s/it] 75%|███████▍  | 191/256 [23:05<07:49,  7.23s/it] 75%|███████▌  | 192/256 [23:12<07:42,  7.23s/it] 75%|███████▌  | 193/256 [23:19<07:35,  7.23s/it] 76%|███████▌  | 194/256 [23:26<07:28,  7.23s/it] 76%|███████▌  | 195/256 [23:33<07:21,  7.23s/it] 77%|███████▋  | 196/256 [23:41<07:14,  7.23s/it] 77%|███████▋  | 197/256 [23:48<07:06,  7.24s/it] 77%|███████▋  | 198/256 [23:55<06:59,  7.24s/it] 78%|███████▊  | 199/256 [24:02<06:52,  7.24s/it] 78%|███████▊  | 200/256 [24:10<06:45,  7.24s/it] 79%|███████▊  | 201/256 [24:17<06:38,  7.24s/it] 79%|███████▉  | 202/256 [24:24<06:31,  7.24s/it] 79%|███████▉  | 203/256 [24:31<06:23,  7.24s/it] 80%|███████▉  | 204/256 [24:39<06:16,  7.25s/it] 80%|████████  | 205/256 [24:46<06:09,  7.24s/it] 80%|████████  | 206/256 [24:53<06:02,  7.24s/it] 81%|████████  | 207/256 [25:00<05:55,  7.25s/it] 81%|████████▏ | 208/256 [25:08<05:47,  7.25s/it] 82%|████████▏ | 209/256 [25:15<05:40,  7.25s/it] 82%|████████▏ | 210/256 [25:22<05:33,  7.25s/it] 82%|████████▏ | 211/256 [25:29<05:27,  7.27s/it] 83%|████████▎ | 212/256 [25:37<05:19,  7.26s/it] 83%|████████▎ | 213/256 [25:44<05:12,  7.26s/it] 84%|████████▎ | 214/256 [25:51<05:04,  7.25s/it] 84%|████████▍ | 215/256 [25:58<04:57,  7.25s/it] 84%|████████▍ | 216/256 [26:06<04:50,  7.25s/it] 85%|████████▍ | 217/256 [26:13<04:42,  7.25s/it] 85%|████████▌ | 218/256 [26:20<04:35,  7.24s/it] 86%|████████▌ | 219/256 [26:27<04:28,  7.25s/it] 86%|████████▌ | 220/256 [26:35<04:20,  7.24s/it] 86%|████████▋ | 221/256 [26:42<04:13,  7.24s/it] 87%|████████▋ | 222/256 [26:49<04:06,  7.24s/it] 87%|████████▋ | 223/256 [26:56<03:59,  7.25s/it] 88%|████████▊ | 224/256 [27:04<03:51,  7.24s/it] 88%|████████▊ | 225/256 [27:11<03:44,  7.24s/it] 88%|████████▊ | 226/256 [27:18<03:36,  7.23s/it] 89%|████████▊ | 227/256 [27:25<03:29,  7.23s/it] 89%|████████▉ | 228/256 [27:33<03:22,  7.23s/it] 89%|████████▉ | 229/256 [27:40<03:15,  7.23s/it] 90%|████████▉ | 230/256 [27:47<03:07,  7.23s/it] 90%|█████████ | 231/256 [27:54<03:00,  7.23s/it] 91%|█████████ | 232/256 [28:01<02:53,  7.23s/it] 91%|█████████ | 233/256 [28:09<02:46,  7.23s/it] 91%|█████████▏| 234/256 [28:16<02:39,  7.23s/it] 92%|█████████▏| 235/256 [28:23<02:31,  7.23s/it] 92%|█████████▏| 236/256 [28:30<02:24,  7.23s/it] 93%|█████████▎| 237/256 [28:38<02:17,  7.23s/it] 93%|█████████▎| 238/256 [28:45<02:10,  7.22s/it] 93%|█████████▎| 239/256 [28:52<02:02,  7.23s/it] 94%|█████████▍| 240/256 [29:00<01:58,  7.39s/it] 94%|█████████▍| 241/256 [29:07<01:50,  7.34s/it] 95%|█████████▍| 242/256 [29:14<01:42,  7.31s/it] 95%|█████████▍| 243/256 [29:21<01:34,  7.29s/it] 95%|█████████▌| 244/256 [29:29<01:27,  7.27s/it] 96%|█████████▌| 245/256 [29:36<01:19,  7.26s/it] 96%|█████████▌| 246/256 [29:43<01:12,  7.25s/it] 96%|█████████▋| 247/256 [29:50<01:05,  7.25s/it] 97%|█████████▋| 248/256 [29:58<00:57,  7.24s/it] 97%|█████████▋| 249/256 [30:05<00:50,  7.24s/it] 98%|█████████▊| 250/256 [30:12<00:43,  7.24s/it] 98%|█████████▊| 251/256 [30:19<00:36,  7.24s/it] 98%|█████████▊| 252/256 [30:27<00:28,  7.24s/it] 99%|█████████▉| 253/256 [30:34<00:21,  7.24s/it] 99%|█████████▉| 254/256 [30:41<00:14,  7.24s/it]100%|█████████▉| 255/256 [30:48<00:07,  7.24s/it]100%|██████████| 256/256 [30:56<00:00,  7.23s/it]100%|██████████| 256/256 [30:56<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [40.94, 38.94]
Multiscale SSIM on Highres [0.989, 0.982]
Range Invariant Multiscale SSIM on Highres [0.989, 0.983]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/stats_disentangle_2405_D18-M3-S0-L8_12.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.57/kth_1/pred_disentangle_2405_D18-M3-S0-L8_12_1.tif
data:
  background_quantile: 0.0
  channel_idx_list:
  - GT_Cy5
  - GT_TRITC
  - 555-647
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/6
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: caa1d41d654fb423a7c3abc700486f87d132a2f7
  untracked_files: []
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/6

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Train

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC', '555-647'], datasplit_type Test

Warning: channel_idx_list is not a list of integers, but a list of strings. No selection of channels is done
Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 93
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:29,  8.46s/it]  5%|▌         | 2/40 [00:15<04:54,  7.76s/it]  8%|▊         | 3/40 [00:23<04:38,  7.54s/it] 10%|█         | 4/40 [00:30<04:26,  7.41s/it] 12%|█▎        | 5/40 [00:37<04:17,  7.35s/it] 15%|█▌        | 6/40 [00:44<04:08,  7.31s/it] 18%|█▊        | 7/40 [00:51<04:00,  7.28s/it] 20%|██        | 8/40 [00:59<03:52,  7.27s/it] 22%|██▎       | 9/40 [01:06<03:45,  7.28s/it] 25%|██▌       | 10/40 [01:13<03:38,  7.27s/it] 28%|██▊       | 11/40 [01:20<03:30,  7.26s/it] 30%|███       | 12/40 [01:28<03:23,  7.25s/it] 32%|███▎      | 13/40 [01:35<03:15,  7.25s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.25s/it] 38%|███▊      | 15/40 [01:49<03:01,  7.24s/it] 40%|████      | 16/40 [01:57<02:53,  7.24s/it] 42%|████▎     | 17/40 [02:04<02:46,  7.24s/it] 45%|████▌     | 18/40 [02:11<02:39,  7.24s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.24s/it] 50%|█████     | 20/40 [02:26<02:24,  7.24s/it] 52%|█████▎    | 21/40 [02:33<02:17,  7.24s/it] 55%|█████▌    | 22/40 [02:40<02:10,  7.24s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.23s/it] 60%|██████    | 24/40 [02:54<01:55,  7.23s/it] 62%|██████▎   | 25/40 [03:02<01:48,  7.23s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.23s/it] 68%|██████▊   | 27/40 [03:16<01:34,  7.23s/it] 70%|███████   | 28/40 [03:23<01:26,  7.23s/it] 72%|███████▎  | 29/40 [03:31<01:19,  7.23s/it] 75%|███████▌  | 30/40 [03:38<01:12,  7.23s/it] 78%|███████▊  | 31/40 [03:45<01:05,  7.23s/it] 80%|████████  | 32/40 [03:52<00:57,  7.23s/it] 82%|████████▎ | 33/40 [04:00<00:50,  7.23s/it] 85%|████████▌ | 34/40 [04:07<00:43,  7.23s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.23s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.24s/it] 92%|█████████▎| 37/40 [04:29<00:21,  7.24s/it] 95%|█████████▌| 38/40 [04:36<00:14,  7.26s/it] 98%|█████████▊| 39/40 [04:43<00:07,  7.27s/it]100%|██████████| 40/40 [04:44<00:00,  5.34s/it]100%|██████████| 40/40 [04:44<00:00,  7.12s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [42.17, 31.37]
Multiscale SSIM on Highres [0.985, 0.955]
Range Invariant Multiscale SSIM on Highres [0.986, 0.957]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/stats_disentangle_2404_D21-M3-S0-L8_6.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D21-M3-S0-L8_6_1.tif
data:
  channel_idx_list:
  - 0
  - 2
  - 9
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/120
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/120

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:26,  8.38s/it]  5%|▌         | 2/40 [00:15<04:53,  7.71s/it]  8%|▊         | 3/40 [00:22<04:37,  7.50s/it] 10%|█         | 4/40 [00:30<04:26,  7.40s/it] 12%|█▎        | 5/40 [00:37<04:17,  7.34s/it] 15%|█▌        | 6/40 [00:44<04:08,  7.31s/it] 18%|█▊        | 7/40 [00:51<04:00,  7.28s/it] 20%|██        | 8/40 [00:59<03:52,  7.26s/it] 22%|██▎       | 9/40 [01:06<03:44,  7.25s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.26s/it] 28%|██▊       | 11/40 [01:20<03:30,  7.26s/it] 30%|███       | 12/40 [01:28<03:22,  7.25s/it] 32%|███▎      | 13/40 [01:35<03:15,  7.24s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.23s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.23s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:04<02:46,  7.22s/it] 45%|████▌     | 18/40 [02:11<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:33<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:40<02:10,  7.23s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.23s/it] 60%|██████    | 24/40 [02:54<01:55,  7.23s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.23s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.24s/it] 68%|██████▊   | 27/40 [03:16<01:34,  7.23s/it] 70%|███████   | 28/40 [03:23<01:26,  7.23s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.23s/it] 75%|███████▌  | 30/40 [03:38<01:12,  7.23s/it] 78%|███████▊  | 31/40 [03:45<01:05,  7.23s/it] 80%|████████  | 32/40 [03:52<00:57,  7.23s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.23s/it] 85%|████████▌ | 34/40 [04:07<00:43,  7.23s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.29s/it] 90%|█████████ | 36/40 [04:21<00:29,  7.27s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.25s/it] 95%|█████████▌| 38/40 [04:36<00:14,  7.24s/it] 98%|█████████▊| 39/40 [04:43<00:07,  7.24s/it]100%|██████████| 40/40 [04:44<00:00,  5.32s/it]100%|██████████| 40/40 [04:44<00:00,  7.11s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.91, 33.65]
Multiscale SSIM on Highres [0.807, 0.949]
Range Invariant Multiscale SSIM on Highres [0.809, 0.95]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/stats_disentangle_2404_D25-M3-S0-L8_120.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_120_1.tif
data:
  channel_idx_list:
  - 0
  - 3
  - 10
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/111
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 977cf6eced66f89198dacc3e4ac285d797e6ce40
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/111

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 334
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:22,  8.28s/it]  5%|▌         | 2/40 [00:15<04:52,  7.69s/it]  8%|▊         | 3/40 [00:22<04:36,  7.47s/it] 10%|█         | 4/40 [00:29<04:25,  7.38s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.33s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.29s/it] 18%|█▊        | 7/40 [00:51<04:00,  7.27s/it] 20%|██        | 8/40 [00:58<03:52,  7.26s/it] 22%|██▎       | 9/40 [01:06<03:44,  7.25s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.25s/it] 28%|██▊       | 11/40 [01:20<03:30,  7.25s/it] 30%|███       | 12/40 [01:27<03:22,  7.24s/it] 32%|███▎      | 13/40 [01:35<03:15,  7.24s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.24s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.24s/it] 40%|████      | 16/40 [01:56<02:53,  7.23s/it] 42%|████▎     | 17/40 [02:04<02:46,  7.24s/it] 45%|████▌     | 18/40 [02:11<02:39,  7.24s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.23s/it] 50%|█████     | 20/40 [02:25<02:24,  7.23s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.23s/it] 55%|█████▌    | 22/40 [02:40<02:10,  7.23s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.23s/it] 60%|██████    | 24/40 [02:54<01:55,  7.24s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.23s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.24s/it] 68%|██████▊   | 27/40 [03:16<01:34,  7.27s/it] 70%|███████   | 28/40 [03:23<01:27,  7.26s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.25s/it] 75%|███████▌  | 30/40 [03:38<01:12,  7.24s/it] 78%|███████▊  | 31/40 [03:45<01:05,  7.23s/it] 80%|████████  | 32/40 [03:52<00:57,  7.22s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.22s/it] 85%|████████▌ | 34/40 [04:07<00:43,  7.22s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.22s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.21s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.21s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.22s/it] 98%|█████████▊| 39/40 [04:43<00:07,  7.21s/it]100%|██████████| 40/40 [04:43<00:00,  5.30s/it]100%|██████████| 40/40 [04:44<00:00,  7.10s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.88, 39.17]
Multiscale SSIM on Highres [0.806, 0.982]
Range Invariant Multiscale SSIM on Highres [0.806, 0.983]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/stats_disentangle_2404_D25-M3-S0-L8_111.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_111_1.tif
data:
  channel_idx_list:
  - 1
  - 2
  - 11
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/125
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/125

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 279
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:23,  8.30s/it]  5%|▌         | 2/40 [00:15<04:52,  7.69s/it]  8%|▊         | 3/40 [00:22<04:36,  7.48s/it] 10%|█         | 4/40 [00:30<04:25,  7.38s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.33s/it] 15%|█▌        | 6/40 [00:44<04:08,  7.30s/it] 18%|█▊        | 7/40 [00:51<04:00,  7.28s/it] 20%|██        | 8/40 [00:58<03:52,  7.27s/it] 22%|██▎       | 9/40 [01:06<03:44,  7.26s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.25s/it] 28%|██▊       | 11/40 [01:20<03:30,  7.25s/it] 30%|███       | 12/40 [01:27<03:22,  7.24s/it] 32%|███▎      | 13/40 [01:35<03:15,  7.24s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.24s/it] 38%|███▊      | 15/40 [01:49<03:01,  7.24s/it] 40%|████      | 16/40 [01:56<02:53,  7.24s/it] 42%|████▎     | 17/40 [02:04<02:46,  7.24s/it] 45%|████▌     | 18/40 [02:11<02:39,  7.24s/it] 48%|████▊     | 19/40 [02:18<02:32,  7.26s/it] 50%|█████     | 20/40 [02:25<02:25,  7.26s/it] 52%|█████▎    | 21/40 [02:33<02:17,  7.25s/it] 55%|█████▌    | 22/40 [02:40<02:10,  7.24s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.23s/it] 60%|██████    | 24/40 [02:54<01:55,  7.23s/it] 62%|██████▎   | 25/40 [03:02<01:48,  7.23s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.22s/it] 68%|██████▊   | 27/40 [03:16<01:33,  7.22s/it] 70%|███████   | 28/40 [03:23<01:26,  7.22s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.22s/it] 75%|███████▌  | 30/40 [03:38<01:12,  7.22s/it] 78%|███████▊  | 31/40 [03:45<01:04,  7.22s/it] 80%|████████  | 32/40 [03:52<00:57,  7.22s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.22s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.22s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.22s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.23s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.24s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.25s/it] 98%|█████████▊| 39/40 [04:43<00:07,  7.25s/it]100%|██████████| 40/40 [04:44<00:00,  5.33s/it]100%|██████████| 40/40 [04:44<00:00,  7.11s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.9, 29.79]
Multiscale SSIM on Highres [0.884, 0.888]
Range Invariant Multiscale SSIM on Highres [0.886, 0.887]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/stats_disentangle_2404_D25-M3-S0-L8_125.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_125_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  - 12
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/139
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/139

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 375
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:24,  8.32s/it]  5%|▌         | 2/40 [00:15<04:52,  7.69s/it]  8%|▊         | 3/40 [00:22<04:36,  7.47s/it] 10%|█         | 4/40 [00:29<04:25,  7.37s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.33s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.29s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.27s/it] 20%|██        | 8/40 [00:58<03:52,  7.26s/it] 22%|██▎       | 9/40 [01:06<03:44,  7.25s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.24s/it] 28%|██▊       | 11/40 [01:20<03:30,  7.25s/it] 30%|███       | 12/40 [01:27<03:22,  7.24s/it] 32%|███▎      | 13/40 [01:35<03:15,  7.24s/it] 35%|███▌      | 14/40 [01:42<03:07,  7.23s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.23s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.22s/it] 45%|████▌     | 18/40 [02:11<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:40<02:09,  7.22s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.22s/it] 60%|██████    | 24/40 [02:54<01:55,  7.22s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.21s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.22s/it] 68%|██████▊   | 27/40 [03:16<01:33,  7.22s/it] 70%|███████   | 28/40 [03:23<01:26,  7.22s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.22s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.21s/it] 78%|███████▊  | 31/40 [03:45<01:04,  7.21s/it] 80%|████████  | 32/40 [03:52<00:57,  7.22s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.22s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.21s/it] 88%|████████▊ | 35/40 [04:13<00:36,  7.22s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.22s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.22s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.23s/it]100%|██████████| 40/40 [04:43<00:00,  5.31s/it]100%|██████████| 40/40 [04:43<00:00,  7.10s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [28.18, 37.16]
Multiscale SSIM on Highres [0.85, 0.96]
Range Invariant Multiscale SSIM on Highres [0.859, 0.963]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/stats_disentangle_2404_D25-M3-S0-L8_139.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_139_1.tif
data:
  channel_idx_list:
  - 2
  - 3
  - 13
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/143
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 855cec2e4fbd12aeefcc5827cfa3ec1f0e84c49e
  untracked_files: []
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/143

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/65/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/68/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel3__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 223
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:23,  8.30s/it]  5%|▌         | 2/40 [00:15<04:51,  7.67s/it]  8%|▊         | 3/40 [00:22<04:36,  7.48s/it] 10%|█         | 4/40 [00:30<04:25,  7.38s/it] 12%|█▎        | 5/40 [00:37<04:16,  7.32s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.28s/it] 18%|█▊        | 7/40 [00:51<03:59,  7.26s/it] 20%|██        | 8/40 [00:58<03:52,  7.25s/it] 22%|██▎       | 9/40 [01:06<03:44,  7.24s/it] 25%|██▌       | 10/40 [01:13<03:36,  7.23s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.23s/it] 30%|███       | 12/40 [01:27<03:22,  7.22s/it] 32%|███▎      | 13/40 [01:34<03:15,  7.23s/it] 35%|███▌      | 14/40 [01:42<03:07,  7.22s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.22s/it] 40%|████      | 16/40 [01:56<02:53,  7.22s/it] 42%|████▎     | 17/40 [02:03<02:45,  7.22s/it] 45%|████▌     | 18/40 [02:11<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:39<02:09,  7.22s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.22s/it] 60%|██████    | 24/40 [02:54<01:55,  7.22s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.22s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.22s/it] 68%|██████▊   | 27/40 [03:15<01:33,  7.21s/it] 70%|███████   | 28/40 [03:23<01:26,  7.22s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.22s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.22s/it] 78%|███████▊  | 31/40 [03:44<01:04,  7.21s/it] 80%|████████  | 32/40 [03:52<00:57,  7.21s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.21s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.21s/it] 88%|████████▊ | 35/40 [04:13<00:36,  7.21s/it] 90%|█████████ | 36/40 [04:20<00:28,  7.23s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.23s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.24s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.25s/it]100%|██████████| 40/40 [04:43<00:00,  5.33s/it]100%|██████████| 40/40 [04:43<00:00,  7.09s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [31.13, 37.95]
Multiscale SSIM on Highres [0.905, 0.97]
Range Invariant Multiscale SSIM on Highres [0.909, 0.97]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/stats_disentangle_2404_D25-M3-S0-L8_143.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.57/kth_1/pred_disentangle_2404_D25-M3-S0-L8_143_1.tif

##################################
Predicting 2th frame
##################################
Using patch,grid size [(None, 32)]
data:
  background_quantile: 0.0
  channel_1: GT_Cy5
  channel_2: GT_TRITC
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 21
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/acquisition2/
exptname: 2404/D21-M3-S0-L8/1
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: bdfe15d58867991fddaaed09cd2b4efdcf3132d4
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=399-step=320000.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
  - bsd_test/lightning_logs/version_4/checkpoints/epoch=89-step=19440.ckpt
  - bsd_test/lightning_logs/version_4/hparams.yaml
  - bsd_test/lightning_logs/version_4/metrics.csv
  - bsd_test/lightning_logs/version_5/checkpoints/epoch=299-step=64800.ckpt
  - bsd_test/lightning_logs/version_5/hparams.yaml
  - bsd_test/lightning_logs/version_5/metrics.csv
hostname: gnode07
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D21-M3-S0-L8/1

Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Train

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 292/365 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 292
Loading data from /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ with channel names ['GT_Cy5', 'GT_TRITC'], datasplit_type Test

Loaded from MultiChannel /group/jug/ashesh/data//TavernaSox2Golgi/acquisition2/ 36/365 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2500 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1608, avg width: 1608, count: 36
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/112/GMMNoiseModel_N2V_data-sox2golgiv2_GT_Cy5__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/113/GMMNoiseModel_N2V_data-sox2golgiv2_GT_TRITC__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 248
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:25,  8.34s/it]  5%|▌         | 2/40 [00:15<04:52,  7.70s/it]  8%|▊         | 3/40 [00:22<04:37,  7.50s/it] 10%|█         | 4/40 [00:30<04:26,  7.41s/it] 12%|█▎        | 5/40 [00:37<04:17,  7.36s/it] 15%|█▌        | 6/40 [00:44<04:09,  7.33s/it] 18%|█▊        | 7/40 [00:51<04:01,  7.31s/it] 20%|██        | 8/40 [00:59<03:53,  7.29s/it] 22%|██▎       | 9/40 [01:06<03:45,  7.29s/it] 25%|██▌       | 10/40 [01:13<03:38,  7.28s/it] 28%|██▊       | 11/40 [01:21<03:31,  7.28s/it] 30%|███       | 12/40 [01:28<03:23,  7.28s/it] 32%|███▎      | 13/40 [01:35<03:16,  7.28s/it] 35%|███▌      | 14/40 [01:42<03:09,  7.28s/it] 38%|███▊      | 15/40 [01:50<03:01,  7.28s/it] 40%|████      | 16/40 [01:57<02:54,  7.27s/it] 42%|████▎     | 17/40 [02:04<02:47,  7.27s/it] 45%|████▌     | 18/40 [02:11<02:39,  7.27s/it] 48%|████▊     | 19/40 [02:19<02:32,  7.27s/it] 50%|█████     | 20/40 [02:26<02:25,  7.27s/it] 52%|█████▎    | 21/40 [02:33<02:18,  7.27s/it] 55%|█████▌    | 22/40 [02:40<02:10,  7.27s/it] 57%|█████▊    | 23/40 [02:48<02:03,  7.27s/it] 60%|██████    | 24/40 [02:55<01:56,  7.26s/it] 62%|██████▎   | 25/40 [03:02<01:48,  7.26s/it] 65%|██████▌   | 26/40 [03:09<01:41,  7.26s/it] 68%|██████▊   | 27/40 [03:17<01:34,  7.26s/it] 70%|███████   | 28/40 [03:24<01:27,  7.26s/it] 72%|███████▎  | 29/40 [03:31<01:19,  7.25s/it] 75%|███████▌  | 30/40 [03:39<01:12,  7.25s/it] 78%|███████▊  | 31/40 [03:46<01:05,  7.25s/it] 80%|████████  | 32/40 [03:53<00:58,  7.25s/it] 82%|████████▎ | 33/40 [04:00<00:50,  7.25s/it] 85%|████████▌ | 34/40 [04:08<00:43,  7.25s/it] 88%|████████▊ | 35/40 [04:15<00:36,  7.25s/it] 90%|█████████ | 36/40 [04:22<00:28,  7.25s/it] 92%|█████████▎| 37/40 [04:29<00:21,  7.25s/it] 95%|█████████▌| 38/40 [04:37<00:14,  7.25s/it] 98%|█████████▊| 39/40 [04:44<00:07,  7.25s/it]100%|██████████| 40/40 [04:45<00:00,  5.32s/it]100%|██████████| 40/40 [04:45<00:00,  7.14s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_2/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 2)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [44.85, 34.69]
Multiscale SSIM on Highres [0.99, 0.975]
Range Invariant Multiscale SSIM on Highres [0.991, 0.975]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_2/stats_disentangle_2404_D21-M3-S0-L8_1.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F-1.00/kth_2/pred_disentangle_2404_D21-M3-S0-L8_1_1.tif
data:
  background_quantile: 0.0
  channel_1: SOX2
  channel_2: GOLGI
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 17
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  skip_normalization_using_mean: false
  subdset_type: 0
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/TavernaSox2Golgi/
exptname: 2404/D17-M3-S0-L8/4
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: 5695e2ee3fdffb3dafb31e18f6f79aca999b4bac
  untracked_files: []
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D17-M3-S0-L8/4


Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 306/382 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1555, avg width: 1555, count: 306

Loaded from TwoChannel /group/jug/ashesh/data//TavernaSox2Golgi/ 37/382 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:1024 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1398, avg width: 1398, count: 37
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/116/GMMNoiseModel_SOX2-C2__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/115/GMMNoiseModel_GOLGI-C1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 107
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:08<02:04,  8.27s/it] 12%|█▎        | 2/16 [00:15<01:47,  7.67s/it] 19%|█▉        | 3/16 [00:22<01:37,  7.47s/it] 25%|██▌       | 4/16 [00:30<01:28,  7.39s/it] 31%|███▏      | 5/16 [00:37<01:20,  7.34s/it] 38%|███▊      | 6/16 [00:44<01:13,  7.31s/it] 44%|████▍     | 7/16 [00:51<01:05,  7.30s/it] 50%|█████     | 8/16 [00:59<00:58,  7.29s/it] 56%|█████▋    | 9/16 [01:06<00:50,  7.28s/it] 62%|██████▎   | 10/16 [01:13<00:43,  7.26s/it] 69%|██████▉   | 11/16 [01:20<00:36,  7.25s/it] 75%|███████▌  | 12/16 [01:27<00:28,  7.24s/it] 81%|████████▏ | 13/16 [01:35<00:21,  7.24s/it] 88%|████████▊ | 14/16 [01:42<00:14,  7.23s/it] 94%|█████████▍| 15/16 [01:49<00:07,  7.23s/it]100%|██████████| 16/16 [01:56<00:00,  7.22s/it]100%|██████████| 16/16 [01:57<00:00,  7.32s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.72/kth_2/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1024, 1024, 2)
Stitched predictions shape after (1, 1024, 1024, 2)
PSNR on Highres [34.87, 34.29]
Multiscale SSIM on Highres [0.888, 0.865]
Range Invariant Multiscale SSIM on Highres [0.948, 0.897]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.72/kth_2/stats_disentangle_2404_D17-M3-S0-L8_4.pkl



Written (1, 1024, 1024, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.72/kth_2/pred_disentangle_2404_D17-M3-S0-L8_4_1.tif
data:
  background_quantile: 0.0
  clip_background_noise_to_zero: false
  clip_percentile: 1.0
  data_type: 19
  deterministic_grid: false
  image_size: 64
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  target_separate_normalization: true
  train_aug_rotate: false
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/expansion_microscopy_v2/datafiles/
exptname: 2404/D19-M3-S0-L8/5
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalNoiseModel.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/ExpansionMicroscopyV2.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: ae47f3ec8b40828292bbae579c2f5ececc19be06
  untracked_files:
  - bsd_test/lightning_logs/version_3/checkpoints/epoch=37-step=30400.ckpt
  - bsd_test/lightning_logs/version_3/hparams.yaml
  - bsd_test/lightning_logs/version_3/metrics.csv
hostname: gnode02
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 100
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 15
  max_epochs: 200
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D19-M3-S0-L8/5


Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 67/83 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 67

Loaded from MultiChannel /group/jug/ashesh/data//expansion_microscopy_v2/datafiles 7/83 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:2401 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 1584, avg width: 1584, count: 7
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/87/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/86/GMMNoiseModel_datafiles-Experiment__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 199
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:08<05:05,  8.26s/it]  5%|▌         | 2/38 [00:15<04:35,  7.66s/it]  8%|▊         | 3/38 [00:22<04:21,  7.47s/it] 11%|█         | 4/38 [00:29<04:11,  7.38s/it] 13%|█▎        | 5/38 [00:37<04:01,  7.32s/it] 16%|█▌        | 6/38 [00:44<03:53,  7.29s/it] 18%|█▊        | 7/38 [00:51<03:45,  7.27s/it] 21%|██        | 8/38 [00:58<03:37,  7.25s/it] 24%|██▎       | 9/38 [01:06<03:29,  7.24s/it] 26%|██▋       | 10/38 [01:13<03:22,  7.23s/it] 29%|██▉       | 11/38 [01:20<03:15,  7.23s/it] 32%|███▏      | 12/38 [01:27<03:07,  7.22s/it] 34%|███▍      | 13/38 [01:34<03:00,  7.22s/it] 37%|███▋      | 14/38 [01:42<02:53,  7.21s/it] 39%|███▉      | 15/38 [01:49<02:45,  7.21s/it] 42%|████▏     | 16/38 [01:56<02:38,  7.22s/it] 45%|████▍     | 17/38 [02:03<02:31,  7.21s/it] 47%|████▋     | 18/38 [02:10<02:24,  7.21s/it] 50%|█████     | 19/38 [02:18<02:17,  7.21s/it] 53%|█████▎    | 20/38 [02:25<02:09,  7.22s/it] 55%|█████▌    | 21/38 [02:32<02:02,  7.22s/it] 58%|█████▊    | 22/38 [02:39<01:55,  7.22s/it] 61%|██████    | 23/38 [02:47<01:48,  7.22s/it] 63%|██████▎   | 24/38 [02:54<01:41,  7.22s/it] 66%|██████▌   | 25/38 [03:01<01:33,  7.22s/it] 68%|██████▊   | 26/38 [03:09<01:28,  7.37s/it] 71%|███████   | 27/38 [03:16<01:20,  7.33s/it] 74%|███████▎  | 28/38 [03:23<01:12,  7.30s/it] 76%|███████▋  | 29/38 [03:30<01:05,  7.28s/it] 79%|███████▉  | 30/38 [03:38<00:58,  7.27s/it] 82%|████████▏ | 31/38 [03:45<00:50,  7.26s/it] 84%|████████▍ | 32/38 [03:52<00:43,  7.25s/it] 87%|████████▋ | 33/38 [03:59<00:36,  7.24s/it] 89%|████████▉ | 34/38 [04:07<00:28,  7.24s/it] 92%|█████████▏| 35/38 [04:14<00:21,  7.24s/it] 95%|█████████▍| 36/38 [04:21<00:14,  7.23s/it] 97%|█████████▋| 37/38 [04:28<00:07,  7.23s/it]100%|██████████| 38/38 [04:32<00:00,  6.26s/it]100%|██████████| 38/38 [04:33<00:00,  7.19s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F12.72/kth_2/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1584, 1584, 2)
Stitched predictions shape after (1, 1568, 1568, 2)
PSNR on Highres [28.51, 25.99]
Multiscale SSIM on Highres [0.757, 0.822]
Range Invariant Multiscale SSIM on Highres [0.904, 0.826]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F12.72/kth_2/stats_disentangle_2404_D19-M3-S0-L8_5.pkl



Written (1, 1568, 1568, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk16_F12.72/kth_2/pred_disentangle_2404_D19-M3-S0-L8_5_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  - 8
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 25
  deterministic_grid: false
  dset_type: verylow
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_idx: 2
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 3
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  synthetic_gaussian_scale: 100
  target_idx_list:
  - 0
  - 1
  target_separate_normalization: true
  threshold: 0.02
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/nikola_data/raw/
exptname: 2404/D25-M3-S0-L8/97
git:
  branch: lc_variant
  changedFiles:
  - disentangle/configs/nikola_7D_config.py
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  - disentangle/notebooks/datasets/nikola_dataset.ipynb
  latest_commit: 1a1e0224dac98d845e294a3c88b6fef8c2d3a594
  untracked_files: []
hostname: gnode03
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  num_targets: 2
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2404/D25-M3-S0-L8/97

Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:1 Sz:64 N:46 NumPatchPerN:2500 Rot:False RandCrop:True Channel:3 Pad:{'mode': 'reflect'}
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_14022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False
Loading from /group/jug/ashesh/data//nikola_data/raw/uSplit_20022025_001_verylowSNR.nd2
ND2 dimensions: {'P': 20, 'C': 19, 'Y': 1608, 'X': 1608}; RGB: False; datatype: uint16; legacy: False

[LCMultiChDloader] Train:0 Sz:64 N:5 NumPatchPerN:2500 Rot:False RandCrop:False Channel:3 Pad:{'mode': 'reflect'}
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2404/56/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel0__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2404/61/GMMNoiseModel_nikola_denoising_input-uSplit_14022025_verylowSNR_channel1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 390
Model has 3.567M parameters
[LCMultiChDloader] Data reduced. New data shape: (1, 1608, 1608, 3)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:08<05:23,  8.29s/it]  5%|▌         | 2/40 [00:15<04:51,  7.68s/it]  8%|▊         | 3/40 [00:22<04:36,  7.47s/it] 10%|█         | 4/40 [00:29<04:25,  7.37s/it] 12%|█▎        | 5/40 [00:37<04:15,  7.31s/it] 15%|█▌        | 6/40 [00:44<04:07,  7.28s/it] 18%|█▊        | 7/40 [00:51<04:00,  7.29s/it] 20%|██        | 8/40 [00:58<03:52,  7.26s/it] 22%|██▎       | 9/40 [01:06<03:44,  7.25s/it] 25%|██▌       | 10/40 [01:13<03:37,  7.25s/it] 28%|██▊       | 11/40 [01:20<03:29,  7.24s/it] 30%|███       | 12/40 [01:27<03:22,  7.24s/it] 32%|███▎      | 13/40 [01:35<03:15,  7.23s/it] 35%|███▌      | 14/40 [01:42<03:08,  7.23s/it] 38%|███▊      | 15/40 [01:49<03:00,  7.23s/it] 40%|████      | 16/40 [01:56<02:53,  7.23s/it] 42%|████▎     | 17/40 [02:03<02:46,  7.22s/it] 45%|████▌     | 18/40 [02:11<02:38,  7.22s/it] 48%|████▊     | 19/40 [02:18<02:31,  7.22s/it] 50%|█████     | 20/40 [02:25<02:24,  7.22s/it] 52%|█████▎    | 21/40 [02:32<02:17,  7.22s/it] 55%|█████▌    | 22/40 [02:40<02:10,  7.22s/it] 57%|█████▊    | 23/40 [02:47<02:02,  7.22s/it] 60%|██████    | 24/40 [02:54<01:55,  7.22s/it] 62%|██████▎   | 25/40 [03:01<01:48,  7.22s/it] 65%|██████▌   | 26/40 [03:08<01:41,  7.22s/it] 68%|██████▊   | 27/40 [03:16<01:33,  7.22s/it] 70%|███████   | 28/40 [03:23<01:26,  7.22s/it] 72%|███████▎  | 29/40 [03:30<01:19,  7.22s/it] 75%|███████▌  | 30/40 [03:37<01:12,  7.22s/it] 78%|███████▊  | 31/40 [03:45<01:04,  7.22s/it] 80%|████████  | 32/40 [03:52<00:57,  7.23s/it] 82%|████████▎ | 33/40 [03:59<00:50,  7.24s/it] 85%|████████▌ | 34/40 [04:06<00:43,  7.24s/it] 88%|████████▊ | 35/40 [04:14<00:36,  7.24s/it] 90%|█████████ | 36/40 [04:21<00:28,  7.23s/it] 92%|█████████▎| 37/40 [04:28<00:21,  7.23s/it] 95%|█████████▌| 38/40 [04:35<00:14,  7.23s/it] 98%|█████████▊| 39/40 [04:42<00:07,  7.22s/it]100%|██████████| 40/40 [04:43<00:00,  5.31s/it]100%|██████████| 40/40 [04:43<00:00,  7.10s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.72/kth_2/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 1608, 1608, 3)
Stitched predictions shape after (1, 1600, 1600, 2)
PSNR on Highres [26.53, 30.6]
Multiscale SSIM on Highres [0.775, 0.902]
Range Invariant Multiscale SSIM on Highres [0.777, 0.905]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.72/kth_2/stats_disentangle_2404_D25-M3-S0-L8_97.pkl



Written (1, 1600, 1600, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk8_F12.72/kth_2/pred_disentangle_2404_D25-M3-S0-L8_97_1.tif
data:
  channel_idx_list:
  - 0
  - 1
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/13
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode14
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/13


Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [0, 1]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/4/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 369
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<35:15,  8.30s/it]  1%|          | 2/256 [00:15<32:28,  7.67s/it]  1%|          | 3/256 [00:22<31:31,  7.48s/it]  2%|▏         | 4/256 [00:30<30:59,  7.38s/it]  2%|▏         | 5/256 [00:37<30:39,  7.33s/it]  2%|▏         | 6/256 [00:44<30:25,  7.30s/it]  3%|▎         | 7/256 [00:51<30:13,  7.28s/it]  3%|▎         | 8/256 [00:58<30:02,  7.27s/it]  4%|▎         | 9/256 [01:06<29:53,  7.26s/it]  4%|▍         | 10/256 [01:13<29:45,  7.26s/it]  4%|▍         | 11/256 [01:20<29:37,  7.25s/it]  5%|▍         | 12/256 [01:27<29:29,  7.25s/it]  5%|▌         | 13/256 [01:35<29:22,  7.25s/it]  5%|▌         | 14/256 [01:42<29:15,  7.25s/it]  6%|▌         | 15/256 [01:49<29:07,  7.25s/it]  6%|▋         | 16/256 [01:56<29:00,  7.25s/it]  7%|▋         | 17/256 [02:04<28:52,  7.25s/it]  7%|▋         | 18/256 [02:11<28:45,  7.25s/it]  7%|▋         | 19/256 [02:18<28:37,  7.25s/it]  8%|▊         | 20/256 [02:26<28:34,  7.27s/it]  8%|▊         | 21/256 [02:33<28:26,  7.26s/it]  9%|▊         | 22/256 [02:40<28:17,  7.25s/it]  9%|▉         | 23/256 [02:47<28:09,  7.25s/it]  9%|▉         | 24/256 [02:54<28:01,  7.25s/it] 10%|▉         | 25/256 [03:02<27:53,  7.25s/it] 10%|█         | 26/256 [03:09<27:45,  7.24s/it] 11%|█         | 27/256 [03:16<27:38,  7.24s/it] 11%|█         | 28/256 [03:23<27:31,  7.25s/it] 11%|█▏        | 29/256 [03:31<27:24,  7.24s/it] 12%|█▏        | 30/256 [03:38<27:16,  7.24s/it] 12%|█▏        | 31/256 [03:45<27:09,  7.24s/it] 12%|█▎        | 32/256 [03:52<27:02,  7.24s/it] 13%|█▎        | 33/256 [04:00<26:54,  7.24s/it] 13%|█▎        | 34/256 [04:07<26:47,  7.24s/it] 14%|█▎        | 35/256 [04:14<26:40,  7.24s/it] 14%|█▍        | 36/256 [04:21<26:32,  7.24s/it] 14%|█▍        | 37/256 [04:29<26:25,  7.24s/it] 15%|█▍        | 38/256 [04:36<26:17,  7.24s/it] 15%|█▌        | 39/256 [04:43<26:10,  7.24s/it] 16%|█▌        | 40/256 [04:50<26:03,  7.24s/it] 16%|█▌        | 41/256 [04:58<25:56,  7.24s/it] 16%|█▋        | 42/256 [05:05<25:48,  7.24s/it] 17%|█▋        | 43/256 [05:12<25:41,  7.24s/it] 17%|█▋        | 44/256 [05:19<25:34,  7.24s/it] 18%|█▊        | 45/256 [05:27<25:27,  7.24s/it] 18%|█▊        | 46/256 [05:34<25:20,  7.24s/it] 18%|█▊        | 47/256 [05:41<25:12,  7.24s/it] 19%|█▉        | 48/256 [05:48<25:05,  7.24s/it] 19%|█▉        | 49/256 [05:56<25:29,  7.39s/it] 20%|█▉        | 50/256 [06:03<25:13,  7.35s/it] 20%|█▉        | 51/256 [06:10<24:59,  7.32s/it] 20%|██        | 52/256 [06:18<24:47,  7.29s/it] 21%|██        | 53/256 [06:25<24:36,  7.27s/it] 21%|██        | 54/256 [06:32<24:27,  7.26s/it] 21%|██▏       | 55/256 [06:39<24:17,  7.25s/it] 22%|██▏       | 56/256 [06:47<24:09,  7.25s/it] 22%|██▏       | 57/256 [06:54<24:01,  7.24s/it] 23%|██▎       | 58/256 [07:01<23:54,  7.24s/it] 23%|██▎       | 59/256 [07:08<23:46,  7.24s/it] 23%|██▎       | 60/256 [07:16<23:38,  7.24s/it] 24%|██▍       | 61/256 [07:23<23:31,  7.24s/it] 24%|██▍       | 62/256 [07:30<23:24,  7.24s/it] 25%|██▍       | 63/256 [07:37<23:17,  7.24s/it] 25%|██▌       | 64/256 [07:45<23:10,  7.24s/it] 25%|██▌       | 65/256 [07:52<23:03,  7.24s/it] 26%|██▌       | 66/256 [07:59<22:55,  7.24s/it] 26%|██▌       | 67/256 [08:06<22:48,  7.24s/it] 27%|██▋       | 68/256 [08:14<22:40,  7.24s/it] 27%|██▋       | 69/256 [08:21<22:33,  7.24s/it] 27%|██▋       | 70/256 [08:28<22:25,  7.24s/it] 28%|██▊       | 71/256 [08:35<22:18,  7.24s/it] 28%|██▊       | 72/256 [08:42<22:11,  7.23s/it] 29%|██▊       | 73/256 [08:50<22:03,  7.23s/it] 29%|██▉       | 74/256 [08:57<21:56,  7.23s/it] 29%|██▉       | 75/256 [09:04<21:49,  7.23s/it] 30%|██▉       | 76/256 [09:11<21:42,  7.24s/it] 30%|███       | 77/256 [09:19<21:34,  7.23s/it] 30%|███       | 78/256 [09:26<21:36,  7.28s/it] 31%|███       | 79/256 [09:33<21:26,  7.27s/it] 31%|███▏      | 80/256 [09:40<21:17,  7.26s/it] 32%|███▏      | 81/256 [09:48<21:09,  7.25s/it] 32%|███▏      | 82/256 [09:55<21:01,  7.25s/it] 32%|███▏      | 83/256 [10:02<20:53,  7.24s/it] 33%|███▎      | 84/256 [10:09<20:45,  7.24s/it] 33%|███▎      | 85/256 [10:17<20:37,  7.24s/it] 34%|███▎      | 86/256 [10:24<20:30,  7.24s/it] 34%|███▍      | 87/256 [10:31<20:22,  7.24s/it] 34%|███▍      | 88/256 [10:38<20:15,  7.24s/it] 35%|███▍      | 89/256 [10:46<20:08,  7.24s/it] 35%|███▌      | 90/256 [10:53<20:01,  7.24s/it] 36%|███▌      | 91/256 [11:00<19:53,  7.23s/it] 36%|███▌      | 92/256 [11:07<19:46,  7.23s/it] 36%|███▋      | 93/256 [11:15<19:39,  7.23s/it] 37%|███▋      | 94/256 [11:22<19:32,  7.23s/it] 37%|███▋      | 95/256 [11:29<19:25,  7.24s/it] 38%|███▊      | 96/256 [11:36<19:17,  7.24s/it] 38%|███▊      | 97/256 [11:43<19:10,  7.23s/it] 38%|███▊      | 98/256 [11:51<19:03,  7.24s/it] 39%|███▊      | 99/256 [11:58<18:56,  7.24s/it] 39%|███▉      | 100/256 [12:05<18:48,  7.24s/it] 39%|███▉      | 101/256 [12:12<18:41,  7.23s/it] 40%|███▉      | 102/256 [12:20<18:33,  7.23s/it] 40%|████      | 103/256 [12:27<18:27,  7.24s/it] 41%|████      | 104/256 [12:34<18:19,  7.23s/it] 41%|████      | 105/256 [12:41<18:12,  7.24s/it] 41%|████▏     | 106/256 [12:49<18:05,  7.24s/it] 42%|████▏     | 107/256 [12:56<18:05,  7.29s/it] 42%|████▏     | 108/256 [13:03<17:56,  7.27s/it] 43%|████▎     | 109/256 [13:10<17:47,  7.26s/it] 43%|████▎     | 110/256 [13:18<17:38,  7.25s/it] 43%|████▎     | 111/256 [13:25<17:30,  7.25s/it] 44%|████▍     | 112/256 [13:32<17:23,  7.25s/it] 44%|████▍     | 113/256 [13:39<17:15,  7.24s/it] 45%|████▍     | 114/256 [13:47<17:08,  7.24s/it] 45%|████▍     | 115/256 [13:54<17:00,  7.24s/it] 45%|████▌     | 116/256 [14:01<16:52,  7.23s/it] 46%|████▌     | 117/256 [14:08<16:45,  7.24s/it] 46%|████▌     | 118/256 [14:16<16:38,  7.23s/it] 46%|████▋     | 119/256 [14:23<16:31,  7.23s/it] 47%|████▋     | 120/256 [14:30<16:23,  7.23s/it] 47%|████▋     | 121/256 [14:37<16:16,  7.23s/it] 48%|████▊     | 122/256 [14:45<16:09,  7.24s/it] 48%|████▊     | 123/256 [14:52<16:02,  7.24s/it] 48%|████▊     | 124/256 [14:59<15:55,  7.24s/it] 49%|████▉     | 125/256 [15:06<15:47,  7.24s/it] 49%|████▉     | 126/256 [15:13<15:40,  7.24s/it] 50%|████▉     | 127/256 [15:21<15:33,  7.24s/it] 50%|█████     | 128/256 [15:28<15:26,  7.24s/it] 50%|█████     | 129/256 [15:35<15:18,  7.24s/it] 51%|█████     | 130/256 [15:42<15:11,  7.24s/it] 51%|█████     | 131/256 [15:50<15:04,  7.23s/it] 52%|█████▏    | 132/256 [15:57<14:57,  7.24s/it] 52%|█████▏    | 133/256 [16:04<14:50,  7.24s/it] 52%|█████▏    | 134/256 [16:11<14:42,  7.24s/it] 53%|█████▎    | 135/256 [16:19<14:35,  7.23s/it] 53%|█████▎    | 136/256 [16:26<14:30,  7.26s/it] 54%|█████▎    | 137/256 [16:33<14:22,  7.25s/it] 54%|█████▍    | 138/256 [16:40<14:15,  7.25s/it] 54%|█████▍    | 139/256 [16:48<14:07,  7.25s/it] 55%|█████▍    | 140/256 [16:55<13:59,  7.24s/it] 55%|█████▌    | 141/256 [17:02<13:52,  7.24s/it] 55%|█████▌    | 142/256 [17:09<13:45,  7.24s/it] 56%|█████▌    | 143/256 [17:17<13:38,  7.24s/it] 56%|█████▋    | 144/256 [17:24<13:30,  7.24s/it] 57%|█████▋    | 145/256 [17:31<13:23,  7.24s/it] 57%|█████▋    | 146/256 [17:38<13:15,  7.24s/it] 57%|█████▋    | 147/256 [17:45<13:08,  7.23s/it] 58%|█████▊    | 148/256 [17:53<13:01,  7.23s/it] 58%|█████▊    | 149/256 [18:00<12:54,  7.23s/it] 59%|█████▊    | 150/256 [18:07<12:46,  7.24s/it] 59%|█████▉    | 151/256 [18:14<12:39,  7.23s/it] 59%|█████▉    | 152/256 [18:22<12:32,  7.23s/it] 60%|█████▉    | 153/256 [18:29<12:25,  7.23s/it] 60%|██████    | 154/256 [18:36<12:18,  7.24s/it] 61%|██████    | 155/256 [18:43<12:10,  7.24s/it] 61%|██████    | 156/256 [18:51<12:03,  7.24s/it] 61%|██████▏   | 157/256 [18:58<11:56,  7.24s/it] 62%|██████▏   | 158/256 [19:05<11:48,  7.23s/it] 62%|██████▏   | 159/256 [19:12<11:41,  7.23s/it] 62%|██████▎   | 160/256 [19:20<11:34,  7.23s/it] 63%|██████▎   | 161/256 [19:27<11:27,  7.23s/it] 63%|██████▎   | 162/256 [19:34<11:20,  7.23s/it] 64%|██████▎   | 163/256 [19:41<11:12,  7.23s/it] 64%|██████▍   | 164/256 [19:48<11:05,  7.23s/it] 64%|██████▍   | 165/256 [19:56<11:00,  7.26s/it] 65%|██████▍   | 166/256 [20:03<10:52,  7.25s/it] 65%|██████▌   | 167/256 [20:10<10:44,  7.24s/it] 66%|██████▌   | 168/256 [20:17<10:37,  7.24s/it] 66%|██████▌   | 169/256 [20:25<10:29,  7.24s/it] 66%|██████▋   | 170/256 [20:32<10:22,  7.24s/it] 67%|██████▋   | 171/256 [20:39<10:14,  7.23s/it] 67%|██████▋   | 172/256 [20:46<10:07,  7.23s/it] 68%|██████▊   | 173/256 [20:54<10:00,  7.23s/it] 68%|██████▊   | 174/256 [21:01<09:52,  7.23s/it] 68%|██████▊   | 175/256 [21:08<09:45,  7.23s/it] 69%|██████▉   | 176/256 [21:15<09:38,  7.23s/it] 69%|██████▉   | 177/256 [21:23<09:31,  7.23s/it] 70%|██████▉   | 178/256 [21:30<09:24,  7.23s/it] 70%|██████▉   | 179/256 [21:37<09:16,  7.23s/it] 70%|███████   | 180/256 [21:44<09:09,  7.23s/it] 71%|███████   | 181/256 [21:51<09:02,  7.23s/it] 71%|███████   | 182/256 [21:59<08:54,  7.23s/it] 71%|███████▏  | 183/256 [22:06<08:48,  7.23s/it] 72%|███████▏  | 184/256 [22:13<08:40,  7.23s/it] 72%|███████▏  | 185/256 [22:20<08:33,  7.23s/it] 73%|███████▎  | 186/256 [22:28<08:26,  7.23s/it] 73%|███████▎  | 187/256 [22:35<08:18,  7.23s/it] 73%|███████▎  | 188/256 [22:42<08:11,  7.23s/it] 74%|███████▍  | 189/256 [22:49<08:04,  7.23s/it] 74%|███████▍  | 190/256 [22:57<07:57,  7.23s/it] 75%|███████▍  | 191/256 [23:04<07:50,  7.23s/it] 75%|███████▌  | 192/256 [23:11<07:42,  7.23s/it] 75%|███████▌  | 193/256 [23:18<07:35,  7.23s/it] 76%|███████▌  | 194/256 [23:26<07:30,  7.26s/it] 76%|███████▌  | 195/256 [23:33<07:22,  7.26s/it] 77%|███████▋  | 196/256 [23:40<07:15,  7.25s/it] 77%|███████▋  | 197/256 [23:47<07:07,  7.24s/it] 77%|███████▋  | 198/256 [23:55<06:59,  7.24s/it] 78%|███████▊  | 199/256 [24:02<06:52,  7.24s/it] 78%|███████▊  | 200/256 [24:09<06:45,  7.24s/it] 79%|███████▊  | 201/256 [24:16<06:37,  7.23s/it] 79%|███████▉  | 202/256 [24:23<06:30,  7.23s/it] 79%|███████▉  | 203/256 [24:31<06:23,  7.23s/it] 80%|███████▉  | 204/256 [24:38<06:16,  7.23s/it] 80%|████████  | 205/256 [24:45<06:08,  7.23s/it] 80%|████████  | 206/256 [24:52<06:01,  7.24s/it] 81%|████████  | 207/256 [25:00<05:54,  7.23s/it] 81%|████████▏ | 208/256 [25:07<05:47,  7.23s/it] 82%|████████▏ | 209/256 [25:14<05:39,  7.23s/it] 82%|████████▏ | 210/256 [25:21<05:32,  7.23s/it] 82%|████████▏ | 211/256 [25:29<05:25,  7.23s/it] 83%|████████▎ | 212/256 [25:36<05:18,  7.23s/it] 83%|████████▎ | 213/256 [25:43<05:10,  7.23s/it] 84%|████████▎ | 214/256 [25:50<05:03,  7.23s/it] 84%|████████▍ | 215/256 [25:57<04:56,  7.23s/it] 84%|████████▍ | 216/256 [26:05<04:49,  7.23s/it] 85%|████████▍ | 217/256 [26:12<04:41,  7.23s/it] 85%|████████▌ | 218/256 [26:19<04:34,  7.23s/it] 86%|████████▌ | 219/256 [26:26<04:27,  7.23s/it] 86%|████████▌ | 220/256 [26:34<04:20,  7.23s/it] 86%|████████▋ | 221/256 [26:41<04:13,  7.23s/it] 87%|████████▋ | 222/256 [26:48<04:05,  7.23s/it] 87%|████████▋ | 223/256 [26:56<04:03,  7.39s/it] 88%|████████▊ | 224/256 [27:03<03:55,  7.35s/it] 88%|████████▊ | 225/256 [27:10<03:46,  7.32s/it] 88%|████████▊ | 226/256 [27:18<03:38,  7.30s/it] 89%|████████▊ | 227/256 [27:25<03:31,  7.28s/it] 89%|████████▉ | 228/256 [27:32<03:23,  7.27s/it] 89%|████████▉ | 229/256 [27:39<03:16,  7.26s/it] 90%|████████▉ | 230/256 [27:47<03:08,  7.26s/it] 90%|█████████ | 231/256 [27:54<03:01,  7.25s/it] 91%|█████████ | 232/256 [28:01<02:54,  7.25s/it] 91%|█████████ | 233/256 [28:08<02:46,  7.25s/it] 91%|█████████▏| 234/256 [28:16<02:39,  7.25s/it] 92%|█████████▏| 235/256 [28:23<02:32,  7.25s/it] 92%|█████████▏| 236/256 [28:30<02:25,  7.25s/it] 93%|█████████▎| 237/256 [28:37<02:17,  7.25s/it] 93%|█████████▎| 238/256 [28:45<02:10,  7.25s/it] 93%|█████████▎| 239/256 [28:52<02:03,  7.25s/it] 94%|█████████▍| 240/256 [28:59<01:56,  7.25s/it] 94%|█████████▍| 241/256 [29:06<01:48,  7.25s/it] 95%|█████████▍| 242/256 [29:14<01:41,  7.25s/it] 95%|█████████▍| 243/256 [29:21<01:34,  7.25s/it] 95%|█████████▌| 244/256 [29:28<01:26,  7.25s/it] 96%|█████████▌| 245/256 [29:35<01:19,  7.25s/it] 96%|█████████▌| 246/256 [29:43<01:12,  7.25s/it] 96%|█████████▋| 247/256 [29:50<01:05,  7.25s/it] 97%|█████████▋| 248/256 [29:57<00:57,  7.25s/it] 97%|█████████▋| 249/256 [30:04<00:50,  7.25s/it] 98%|█████████▊| 250/256 [30:12<00:43,  7.25s/it] 98%|█████████▊| 251/256 [30:19<00:36,  7.25s/it] 98%|█████████▊| 252/256 [30:26<00:28,  7.25s/it] 99%|█████████▉| 253/256 [30:33<00:21,  7.25s/it] 99%|█████████▉| 254/256 [30:41<00:14,  7.25s/it]100%|█████████▉| 255/256 [30:48<00:07,  7.25s/it]100%|██████████| 256/256 [30:55<00:00,  7.24s/it]100%|██████████| 256/256 [30:55<00:00,  7.25s/it]
/home/ashesh.ashesh/code/Disentangle/disentangle/core/tiff_reader.py:14: UserWarning: /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.72/kth_2/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif is a low contrast image
  imsave(path, data, plugin='tifffile')
Stitched predictions shape before ignoring boundary pixels (1, 4096, 4096, 2)
Stitched predictions shape after (1, 4096, 4096, 2)
PSNR on Highres [42.27, 41.57]
Multiscale SSIM on Highres [0.989, 0.994]
Range Invariant Multiscale SSIM on Highres [0.991, 0.994]

[PaperResultsHandler] Saved to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.72/kth_2/stats_disentangle_2405_D18-M3-S0-L8_13.pkl



Written (1, 4096, 4096, 2) to /group/jug/ashesh/data/paper_stats/Test_P64_G32_M50_Sk0_F12.72/kth_2/pred_disentangle_2405_D18-M3-S0-L8_13_1.tif
data:
  channel_idx_list:
  - 1
  - 3
  channelwise_quantile: false
  clip_percentile: 1
  data_type: 18
  deterministic_grid: false
  enable_gaussian_noise: false
  image_size: 64
  input_has_dependant_noise: true
  input_is_sum: false
  multiscale_lowres_count: 3
  normalized_input: true
  num_channels: 2
  padding_mode: reflect
  padding_value: null
  poisson_noise_factor: -1
  randomized_channels: false
  sampler_type: 0
  subdset_type: 2
  synthetic_gaussian_scale: 6675
  target_separate_normalization: true
  train_aug_rotate: false
  trainig_datausage_fraction: 1.0
  use_one_mu_std: true
datadir: /group/jug/ashesh/data/Dao3Channel/
exptname: 2405/D18-M3-S0-L8/14
git:
  branch: lc_variant
  changedFiles:
  - disentangle/notebooks/EvalOnMultiFileDataset.ipynb
  - disentangle/notebooks/EvalOnWholeFrames.ipynb
  latest_commit: b8f4a5c025603f7806abb8b58070d0dd88239c17
  untracked_files:
  - disentangle/notebooks/noise_variation_plot.ipynb
  - eccv_results.txt
  - samples_nikola.txt
hostname: gnode05
loss:
  denoisplit_w: 0.9
  free_bits: 1.0
  kl_annealing: false
  kl_annealtime: 10
  kl_loss_formulation: denoisplit_usplit
  kl_min: 1.0e-07
  kl_start: -1
  kl_weight: 1.0
  loss_type: 8
  reconstruction_weight: 1.0
  restricted_kl: true
  usplit_w: 0.1
model:
  analytical_kl: false
  decoder:
    batchnorm: true
    blocks_per_layer: 1
    conv2d_bias: true
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  enable_noise_model: true
  encoder:
    batchnorm: true
    blocks_per_layer: 1
    dropout: 0.1
    n_filters: 64
    res_block_kernel: 3
    res_block_skip_padding: false
  gated: true
  img_shape: null
  learn_top_prior: true
  logvar_lowerbound: -5
  merge_type: residual
  mode_pred: true
  model_type: 3
  monitor: val_loss
  multiscale_lowres_separate_branch: false
  multiscale_retain_spatial_dims: true
  no_initial_downscaling: true
  noise_model_ch1_fpath: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_ch2_fpath: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
  noise_model_learnable: false
  noise_model_type: gmm
  non_stochastic_version: false
  nonlin: elu
  predict_logvar: pixelwise
  res_block_type: bacdbacd
  skip_nboundary_pixels_from_loss: null
  stochastic_skip: true
  use_vampprior: false
  var_clip_max: 20
  z_dims:
  - 128
  - 128
  - 128
  - 128
training:
  batch_size: 32
  earlystop_patience: 200
  grad_clip_norm_value: 0.5
  gradient_clip_algorithm: value
  limit_train_batches: 2000
  lr: 0.001
  lr_scheduler_patience: 30
  max_epochs: 400
  num_workers: 4
  pre_trained_ckpt_fpath: ''
  precision: 16
  test_fraction: 0.1
  train_repeat_factor: null
  val_fraction: 0.1
  val_repeat_factor: null
workdir: /home/ashesh.ashesh/training/disentangle/2405/D18-M3-S0-L8/14


Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 90/112 frames
[SingleFileLCDset] Train:1 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:True Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 90

Selecting channels [1, 3]
Loaded from MultiChannel /group/jug/ashesh/data//Dao3Channel/ 10/112 frames
[SingleFileLCDset] Train:0 Sz:64 N:1 NumPatchPerN:16384 Rot:False RandCrop:False Channel:2 Pad:{'mode': 'reflect'}
MultiFileDset avg height: 4096, avg width: 4096, count: 10
Noise model Ch1: /home/ashesh.ashesh/training/noise_model/2405/5/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
Noise model Ch2: /home/ashesh.ashesh/training/noise_model/2405/6/GMMNoiseModel_Dao3Channel-SIM1__6_4_Clip0.0-1.0_Sig0.125_UpNone_Norm0_bootstrap.npz
[GaussianMixtureNoiseModel] min_sigma: 0.125
[GaussianMixtureNoiseModel] min_sigma: 0.125
Warning: channel_key is not found in noise model config: ch1_fname
Warning: channel_key is not found in noise model config: ch2_fname
[DisentNoiseModel] Nmodels count:2
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor2
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[BottomUpLayer] McEnabled:1 McParallelBeam:1 McFactor4
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[3, 3] [1, 1]
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[TopDownLayer] normalize_latent_factor:1.0
[3, 3] [1, 1]
[GaussianLikelihood] PredLVar:pixelwise LowBLVar:-5
[LadderVAE] Stoc:True RecMode:False TethInput:False TargetCh: 2
Loading from epoch 211
Model has 3.567M parameters
[MultiFileDset] Data reduced. New data count: 1
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:08<35:31,  8.36s/it]  1%|          | 2/256 [00:15<32:36,  7.70s/it]  1%|          | 3/256 [00:22<31:38,  7.50s/it]  2%|▏         | 4/256 [00:30<31:01,  7.39s/it]  2%|▏         | 5/256 [00:37<30:38,  7.32s/it]  2%|▏         | 6/256 [00:44<30:22,  7.29s/it]  3%|▎         | 7/256 [00:51<30:09,  7.27s/it]  3%|▎         | 8/256 [00:58<30:01,  7.26s/it]  4%|▎         | 9/256 [01:06<29:53,  7.26s/it]  4%|▍         | 10/256 [01:13<29:46,  7.26s/it]  4%|▍         | 11/256 [01:20<29:39,  7.26s/it]  5%|▍         | 12/256 [01:28<29:31,  7.26s/it]  5%|▌         | 13/256 [01:35<29:23,  7.26s/it]  5%|▌         | 14/256 [01:42<29:16,  7.26s/it]  6%|▌         | 15/256 [01:49<29:09,  7.26s/it]  6%|▋         | 16/256 [01:57<29:00,  7.25s/it]  7%|▋         | 17/256 [02:04<28:52,  7.25s/it]  7%|▋         | 18/256 [02:11<28:45,  7.25s/it]  7%|▋         | 19/256 [02:18<28:37,  7.25s/it]  8%|▊         | 20/256 [02:26<28:30,  7.25s/it]  8%|▊         | 21/256 [02:33<28:22,  7.25s/it]  9%|▊         | 22/256 [02:40<28:15,  7.24s/it]  9%|▉         | 23/256 [02:48<28:30,  7.34s/it]  9%|▉         | 24/256 [02:55<28:17,  7.32s/it] 10%|▉         | 25/256 [03:02<28:05,  7.30s/it] 10%|█         | 26/256 [03:09<27:55,  7.28s/it] 11%|█         | 27/256 [03:17<27:46,  7.28s/it] 11%|█         | 28/256 [03:24<27:37,  7.27s/it] 11%|█▏        | 29/256 [03:31<27:28,  7.26s/it] 12%|█▏        | 30/256 [03:38<27:20,  7.26s/it] 12%|█▏        | 31/256 [03:46<27:12,  7.25s/it] 12%|█▎        | 32/256 [03:53<27:04,  7.25s/it] 13%|█▎        | 33/256 [04:00<26:57,  7.25s/it] 13%|█▎        | 34/256 [04:07<26:50,  7.25s/it] 14%|█▎        | 35/256 [04:15<26:43,  7.25s/it] 14%|█▍        | 36/256 [04:22<26:35,  7.25s/it] 14%|█▍        | 37/256 [04:29<26:28,  7.25s/it] 15%|█▍        | 38/256 [04:36<26:21,  7.25s/it] 15%|█▌        | 39/256 [04:44<26:13,  7.25s/it] 16%|█▌        | 40/256 [04:51<26:06,  7.25s/it] 16%|█▌        | 41/256 [04:58<25:58,  7.25s/it] 16%|█▋        | 42/256 [05:05<25:51,  7.25s/it] 17%|█▋        | 43/256 [05:13<25:43,  7.25s/it] 17%|█▋        | 44/256 [05:20<25:37,  7.25s/it] 18%|█▊        | 45/256 [05:27<25:29,  7.25s/it] 18%|█▊        | 46/256 [05:34<25:22,  7.25s/it] 18%|█▊        | 47/256 [05:42<25:14,  7.25s/it] 19%|█▉        | 48/256 [05:49<25:07,  7.25s/it]